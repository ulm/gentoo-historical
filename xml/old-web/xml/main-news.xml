<?xml version='1.0'?>
<mainpage id="news">
<title>Gentoo Linux News</title>
<author title="Author"><mail link="drobbins@gentoo.org">Daniel Robbins</mail></author>

<version>1.0.4</version>
<date>19 Jan 2002</date>

<newsitems>
	<news align="left" graphic="/images/stick1.png">
		<poster>drobbins</poster>
		<date>23 Jan 2002</date>
		<title>AMD's official position: this is not a CPU bug</title>
		<body>
		<p>Yesterday, Rik van Riel, William Lee Irwin and myself were able to discuss this issue of Athlon/AGP instability
		with AMD.  This converation was very enlightening, to say the least.</p>

		<p><b>Let's start with some facts.  The issue that is being discussed here
		is not related to the so-called "INVPLG bug".</b>  So, what is the issue,
		and who's at fault?  <b>Yesterday, AMD offered us an explanation of what <i>may</i> be happening
		to cause AGP instability on Linux systems.</b>  This explanation appears to be the exact
		scenario that bit Windows 2000 in September 2000.  AMD characterizes this
		issue as a cache coherency problem resulting from how other components
		on the motherboard (the GART in particular) interact with a particular
		performance-enhancing feature of the Athlon Processor called
		speculative writes.  The GART and the CPU have two different views of
		memory -- the GART's view does not "see" the contents of the Athlon's
		internal caches, and herein lies the problem.  <b>In
		certain situations the CPU and the GART can step on each other's toes,
		resulting in memory corruption.</b>   For more information, see my <uri
		link="http://www.geocrawler.com/lists/3/Linux/35/175/7626960/">Linux
		kernel mailing list post</uri> that  contains an explanation of this
		particular problem in AMD's own words.</p>

		<p><b>So, is the Linux kernel affected by this problem?  It appears
		so.</b> The GART and the CPU see two different views of memory, and
		it's the kernel's responsibility to map memory in such a way as to
		prevent bad interactions.  Currently, that isn't happening. Third-party
		drivers such as the NVIDIA driver for Linux may also have some problems
		in this area.
		Now that the Linux kernel development community is aware of the issue,
		they have started the process of devising a good approach to avoid
		this memory corruption problem.
		Disabling extended paging via the <c>mem=nopentium</c> boot option is
		really not a good long-term solution since it can impact
		performance, so a better solution is needed.</p>

		<p>I guess the big question on everyone's mind is this -- who's to
		blame for this very real problem?  Strangely enough, no one party
		appears to be at fault here.  But now that the problem is out in the
		open, the solution is clear.  <b>The Linux kernel's approach to memory
		management must become more sophisticated in order to address potential
		conflicts between the highly-speculative nature of Athlon processors
		and the non-cache-coherent AGP GART.</b></p> 

		<p>I'll be following the resolution of this issue closely and post
		information here as I get it.</p>
		

		</body>
	</news>
	
	<news align="right" graphic="/images/icon-linux.png">
		<poster>drobbins</poster>
		<date>19 Jan 2002</date>
		<title>A new killer kernel, Gentoo news -- and a major Linux/Athlon CPU bug discovered</title>
		<body>
		<p><b>First, some quick news.  Gentoo Linux is now using a <uri link="http://lists.gentoo.org/pipermail/gentoo-dev/2002-January/009279.html">Linux 2.4.18-pre3-mjc-XFS kernel</uri>, and it's blazingly fast.  It includes
		nearly every major performance-enhancing patch currently available including preempt, lock-break, the O(1)
		scheduler, and the reverse-mapping patch.  And even better -- it appears to be very stable.  Many thanks to Michael
		J. Cohen for his great work on the -mjc kernel.  I plan to offer -mjc as our default kernel from this
		point forward.  Oh, Xfree86 4.2.0 has also been added to Portage.  Enjoy!</b></p>
		
		<p><b>Also, Portage 1.8.5+ (our ports system) now has a number of really nice new features</b>,
including faster merging, path sandboxing, <c>emerge update</c>, an <c>emerge update --world</c> functionality.
You can use <c>emerge update</c> to update the "core" packages on your system, or use <c>emerge update --world</c>
to update all packages on your system to the most recent version. 
<b>Also note that Portage can now be accessed using anonymous CVS in
addition to rsync.</b> You can find more information on how to do this in <uri link="http://lists.gentoo.org/pipermail/gentoo-dev/2002-January/008954.html">this
gentoo-dev mailing list post</uri>.  </p>
	
		<p>That's the good news.  The bad news is that a <b>major Athlon CPU bug has been discovered, and it affects Linux 2.4</b>.  Note
		that this is a bug in the actual CPU itself, and is not a Linux bug.  However, it becomes our problem because
		there are very many semi-broken Athlon/Duron/Athlon MP CPUs out there.</p>
		<p>Here are the details.  As you may know, x86 systems have 
		traditionally managed memory using 4K pages.  However, with the introduction of the Pentium processor, Intel
		added a new feature called <i>extended paging</i>, which allows 4Mb pages to be used instead.  Here's the problem -- <b>many Athlon and Duron CPUs experience memory corruption when extended paging is used in conjunction
		with AGP.  And, this problem hits us because Linux 2.4 kernels compiled with a <c>Pentium-Classic</c> or higher <c>Processor family</c> kernel configuration
		setting will automatically take advantage of extended paging (for kernel hackers out there, this is the <c>X86_FEATURE_PSE</c> constant defined in <c>include/asm-i386/cpufeature.h</c>.)</b>
Fortunately, there is a quick and easy fix for this problem.  If you have been experiencing lockups on your
		Athlon, Duron or Athlon MP system when using AGP video, try passing the <c>mem=nopentium</c> option to your kernel
		(using GRUB or LILO) at boot-time.  This tells Linux to go back to using 4K pages, avoiding this CPU bug.  In
		addition, it should also be possible to avoid this problem by not using AGP on affected systems.  As soon
		as I discovered that this CPU bug existed (which happened, unfortunately, because <e>my</e> CPU has the bug),
		I informed kernel hacker Andrew Morton of the issue; he put me in touch with Alan Cox.  Alan is going to try to add some kind
		of Athlon/AGP CPU bug detection code to the kernel so that it will be able to auto-downgrade to 4K pages when
		necessary.</p>
		<p>The unfortunate thing about this situation is that AMD and others have known of this bug since <b>September 2000</b>.
		In fact, AMD's CPG technical marketing division announced this bug on September 21, 2000 in a technical note entitled
		<i>Microsoft Windows 2000 Patch for AGP Applications on AMD Athlon and AMD Duron Processors</i> (Technical Note TN17 revision 1).
		And, the kind folks at AMD even created a simple patch for Windows 2000 that disables extended paging by tweaking the registry.
		However, apparently AMD didn't realize that Linux 2.4 also uses extended paging when the kernel is compiled with 
		a <c>Pentium-Classic</c> or higher <c>Processor family</c> kernel configuration setting.   And, it looks like no one in the Linux community 
		noticed that this "Microsoft Windows 2000/AGP Athlon/Duron bug" also applied to Linux 2.4 systems, probably because it was
		presented by AMD technical marketing as just that -- a Windows 2000-related AGP bug. An unfortunate miscommunication, which
		has resulted in lots of problems for Athlon, Duron and Athlon MP users.  <i>Here's something that's even more unsettling --
		consider what kind of Linux users actually use AGP.  That's right -- desktop users.  And in what area has Linux been struggling?  Yes, the desktop.
		One wonders how many negative desktop Linux experiences have resulted from this unfortunate problem.</i>  I don't know if any 
		particular party is to blame for this issue.  After all, AMD <e>did</e> prominently announce this bug when it was discovered.
		But due to an apparently unfortunate series of events, us Linux people never benefitted from this knowledge.  But Microsoft
		Windows 2000 and XP users did.  Let's hope that all parties involved can keep things like this from happening in the future.</p>
		
		<p>The good news is that we now have the information to work around this problem, and (hopefully) soon the Linux kernel
		itself will be able to detect and adjust for this particular issue.  Many thanks to Terrence Ripperda of NVIDIA, Andrew
		Morton and Alan Cox for informing/communicating/investigating this issue respectively. :)</p>
		</body>
	</news>
	<news align="left" graphic="/images/icon-stick1.png">
		<poster>drobbins</poster>
		<date>25 Dec 2001</date>
		<title>Christmas Gentoo Linux Update</title>
		<body>
		
<p><b>There's been a tremendous amount of work going into Gentoo Linux in the past few months, and
Gentoo Linux 1.0_rc6 has become, well, pretty amazing.</b>  Very refined, and lots of new capabilities and
fixes have been added.  Here is an incomplete list:  New <b>2.4.16</b> kernel with ACPI, <b>XFS</b>, LVM, low
latency and preemptive kernel patches, a <b>new binutils</b> to fix Athlon and PIII-specific instruction
compilation problems -- resulting in rock-solid kernels even when configured for higher-end CPU
types, a new Portage release that allows you to <b>safely upgrade glibc even while you're in X</b> without
causing any applications to segfault or otherwise mess up, a <b>completely reworked and improved
install CD</b> that supports installation to LVM, software RAID, ext2, ext3, ReiserFS and XFS filesystems,
and much more.  Oh, our new glibc includes <b>a fix for the recent glibc "glob" security hole</b>.  And, of
course, the <b>latest NVIDIA drivers</b> and a very fast and stable platform to run them on, not to mention
around 1100 ports-based packages in total, and still counting.</p>
		</body>
	</news>
	<news align="right" graphic="/images/icon-linux.png">
		<poster>drobbins</poster>
		<date>12 Oct 2001</date>
		<title>October Gentoo Linux Update</title>
		<body>
		<p>
		<b>We are currently putting the finishing touches on Gentoo Linux 1.0_rc6.</b>  In fact, things are looking so good that the release <i>after</i>
		1.0_rc6 will likely be 1.0 final!  Until 1.0 final, we won't be building any binary packages except build images, and will only support the "build from scratch" install method.  This makes things a lot easier for us and allows us to focus our efforts on working towards the 1.0 final release.
		</p>
		<p>
		<b>On another note, I'm currently looking for new and exciting contracts/employment.</b>  If you're working on a challenging 
		Linux, Unix or Web development project and would like my help, please be sure to <uri link="/resume.html">check out my resume</uri>
		and <mail link="drobbins@gentoo.org">email me</mail> directly.  Thanks!
		</p>
		<p>My new articles on <uri link="http://www.ibm.com/developerworks/linux">IBM developerWorks</uri>: Advanced Filesystem Implementor's Guide <uri link="http://www-106.ibm.com/developerworks/linux/library/l-fs3.html?dwzone=linux">part 3</uri> (tmpfs and bind mounts), <uri link="http://www-106.ibm.com/developerworks/linux/library/l-fs4.html?dwzone=linux">part 4</uri> (devfs, part 1) and <uri link="http://www-106.ibm.com/developerworks/linux/library/l-fs5.html?dwzone=linux">part 5</uri> (devfs, part 2).  Also be sure to check out my articles on OpenSSH RSA/DSA key management: <uri link="http://www-106.ibm.com/developerworks/linux/library/l-keyc.html?dwzone=linux">part 1</uri> and <uri link="http://www-106.ibm.com/developerworks/linux/library/l-keyc2/?dwzone=linux">part 2</uri>.  Part three (covering OpenSSH authentication agent forwarding) will be appearing shortly.  If you haven't done so already, try out <uri link="/projects/keychain">keychain</uri>, my OpenSSH RSA/DSA key management application.</p>
		</body>
	</news>
</newsitems>
</mainpage>

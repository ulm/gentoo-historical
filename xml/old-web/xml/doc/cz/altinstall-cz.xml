<?xml version='1.0'?>

<!DOCTYPE guide SYSTEM "../../../dtd/guide.dtd">

<guide link="doc/altinstall.html">
<title>The Gentoo Linux alternativní instalaèní HOWTO</title>
<author title="Author"><mail link="lordviram@rebelpacket.net">Travis Tilley</mail></author>
<author title="Contributor"><mail link="davoid@gentoo.org">Faust A.  Tanasescu</mail></author>
<abstract>
Tento návod (Howto) je mínìn jako seznam alternativních metod instalace pro ty,
kteøí mají speciální situaci jako nepøítomnost cdrom mechaniky, nebo
poèítaè, který neumí startovat z cdrom mechaniky.
</abstract>

<version>0.2</version>
<date>12 July 2002</date>

<chapter>
<title>O tomto dokumentu</title>
<section>
<body>

<p>Jestli¾e nemù¾ete pou¾ít standardní startuj-z-CD instalaèní metodu
(nebo ji prostì nemáte rádi), exsistuje pro vás øe¹ení.
Tento dokument slou¾í jako seznam alternativních instalaèních metod 
pro ty, jen¾ je potøebují.
Nebo, pokud se vám to bude líbit více, jako místo pro "neobvyklé"
metody instalace. Pokud máte nìjakou instalaèní metodu, kterou pokládáte
za u¾iteènou, nebo jste objevili nìjaký "zábavný" zpùsob instalace,
nestyïte se nìco sepsat a
<mail link="lordviram@rebelpacket.net">poslat mi to.</mail></p>


</body>
</section>
</chapter>

<chapter>
<title>Instalace pomocí startování ze sítì</title>
<section>
<title>Po¾adavky</title>
<body>
<p>Po¾adavky pro instalaci pomocí startování ze sítì jsou: 
server, který poskytuje tftp slu¾bu a poèítaè, který je schopen nastartovat
ze sítì pomocí sí»ové podpory v BIOSu nebo pomocí diskety s GRUBem nebo jiným
zavadìèem se sí»ovými slu¾bami. Eventuálnì je tøeba také DHCP server.
Samozøejmì je tøeba té¾ poslední ISO build, který je mo¾no nalézt na
<uri>http://www.ibiblio.org/gentoo/snapshots/build/</uri></p>
</body>
</section>

<section>
<title>Pøehled</title>
<body>

<p>Pokud chceme nahrát "image" ze sítì, musí nastartovaný poèítaè obdr¾et
IP adresu. Je nìkolik zpùsobù, jak to provést a ka¾dý z nich poslou¾í.
Osobnì preferuji GRUB na v¹echno, ale pokuï vá¹ poèítaè umí startovat ze sítì,
GRUB není podmínkou, i kdy¾ je snadnìj¹í pou¾ít jeho pøíkaz <c>ifconfig</c>
místo nastavování bootp nebo dhcp serveru.</p>

<p>Jakmile vá¹ poèítaè obdr¾í IP adresu, pøí¹tím logickým krokem je nalézt to,
co budete startovat a kde to ulo¾it. Je¹tì jednou, jde to snadnìji pomocí
pøíkazù GRUBu, ne¾ nastavovat bootp nebo dhcp server. Je potøeba také
specifikovat, jak získat initrd a øíci kernelu, ¾e to bude jeho
koøenový souborový systém.</p>

<p>S nahraným kernelem a pøipojeným koøenovým souborovým systémem mù¾ete
pokraèovat v instalaci jako obvykle. Build image mù¾e být nahrán z cd
nebo stáhnut ze sítì pomocí tftp.</p>

</body>
</section>
<section>
<title>Pou¾ití GRUBu/title>
<body>

<p>Pro vyu¾ití schopností GRUBu pro startovaní ze sítì musíte mít
GRUB zkompilovaný s podporou va¹í sí»ové karty. Nezále¾í, zda GRUB
instalujete na disketu nebo na pevný disk, který bude v poèítaèi, na kterém
pozdìji bude Gentoo systém. Pokud vá¹ cíl ji¾ má GRUB s touto
podporou, jste o jeden krok dále. GRUB je mo¾no získat z
<uri>ftp://alpha.gnu.org/gnu/grub/</uri></p>

<p>Pøíklad parametrù configure, které nastaví podporu karty tulip, sí»ové
karty v mém poèítaèi:</p>

<pre caption="Samostatná instalace GRUBu">
# <i>./configure --enable-tulip --prefix=/usr</i>
# <i>make &amp;&amp; make install</i>
</pre>

<p>Pokud jste právì v systému Gentoo a pøejete si instalovat GRUB pomocí
jeho nástrojù, je potøeba instalovat krok po kroku pro dodání podpory
sí»ové karty. Následuje pøíklad vyu¾ití pøíkazu ebuild pro instalaci
GRUBu s podporou sí»ové karty tulip:</p>

<pre caption="Instalace and konfigurace GRUBu v Gentoo Linuxu">
# <i>ebuild /usr/portage/sys-apps/grub/grub-0.91.ebuild clean fetch unpack</i>
# <i>cd /var/tmp/portage/grub-0.91/work/grub-0.91/</i>
# <i>./configure --prefix=/usr --sbindir=/sbin --mandir=/usr/share/man \ </i>
> <i>--infodir=/usr/share/info --enable-tulip</i>
# <i>make</i>
# <i>touch /var/tmp/portage/grub-0.91/.compiled</i>
# <i>cd /usr/portage/</i>
# <i>ebuild sys-apps/grub/grub-0.91.ebuild install merge</i>
</pre>

<p>Nyní máme nainstalován GRUB shell a je potøeba nainstalovat zavádìcí
sektor. Aèkoli je mo¾né nainstalovat zavádìcí sektor na pevný disk
va¹eho budoucího Gentoo systému, zde pøedpokládám instalaci na disketu.
Jsou dva zpùsoby, jak to provést. Mù¾ete pou¾ít pøíkazy GRUBu nebo
vyu¾ít dodávaného skriptu nazvaného <c>grub-install</c>. Je doporuèeno
vyu¾ít <c>grub-install<c> skriptu pøi instalaci na disketu.</p>

<pre caption="pøíklad s pou¾itím grub-install skriptu">
# <i>mkfs.ext2 /dev/fd0</i>
# <i>mount /dev/fd0 /mnt/floppy/</i>
# <i>grub-install --root-directory=/mnt/floppy/ '(fd0)'</i>
# <i>umount /mnt/floppy/</i>
</pre>

<p><c>grub-install</c> nepracuje v¾dy spolehlivì... a není v¾dy nejlep¹ím
zpùsobem pro instalaci GRUBu. A proto¾e GRUB shell pracuje stejnì jako v pøípadì
jeho spu¹tìní pøi startu poèítaèe, je nìkdy výhodnìj¹í pou¾ít pøímo jeho.
Zde je pøíklad pou¾ití pøíkazù GRUBu pro instalaci zavádìcího sektoru
na disketu:</p>

<pre caption="Instalace pomocí pøíkazù GRUBu">
# <i>mkfs.ext2 /dev/fd0</i>
# <i>mount /dev/fd0 /mnt/floppy/</i>
# <i>mkdir -p /mnt/floppy/boot/grub/</i>
# <i>cp -v /usr/share/grub/i386-pc/* /mnt/floppy/boot/grub/</i>
# <i>grub</i>
grub> <i>root (fd0)</i>
grub> <i>setup (fd0)</i>
grub> <i>quit</i>
# <i>umount /mnt/floppy/</i>
</pre>

<p>Nyní, kdy¾ máme bootovací GRUB disketu, potøebujeme je¹tì nastavit tftp server
(doporuèuji netkit tftp server) pro nahrání na¹eho kernelu a initrd. Pokud
pou¾íváte inetd, je tøeba dodat øádku do va¹eho <path>/etc/inetd.conf</path>,
která bude vypadat takto:</p>

<pre caption="/etc/inetd.conf">
tftp	dgram	udp	wait	nobody	/usr/sbin/tcpd	in.tftpd
</pre>

<p>Pro nainstalování balíku netkit tftp serveru pod gentoo linuxem pou¾ijte
pøíkaz: emerge net-misc/netkit-tftp</p>

<note>Existuje té¾ ebuild pro xinetd... pokud mu dáváte pøednost, lze jej vu¾ít také.
Ale já nepou¾ívám xinetd a nevím jak nakonfigurovat tftp server pomocí xinetd.
Pokud jej vyu¾íváte, prosím, za¹lete mi informaci, jak jej nastavit, a já ji
doplním do tohoto howto.</note>

<p>Nyní, kdy¾ máme pøipraven tftp server, je potøeba do nìj vlo¾it kernel a
initrd. Lze zkompilovat vlastní kernel, ale je potøeba zajistit, aby obsahoval
v¹e, co je potøeba pro bìh gentoo linuxu (jako devfs) a pro start ze sítì
(jako podporu initrd). Jako initrd pou¾ijeme rescue.gz, které je souèástí
gentoo ISO.</p>

<impo>Pøipojení ISO souboru bez potøeby jeho vypálení na cd vy¾aduje podporu
loopback souborového systému.</impo>

<pre>
# <i>mkdir /tftpboot</i>
# <i>mount -o loop /path/to/build-ix86-1.0_rc6-r14.iso /mnt/cdrom/</i>
# <i>cp /mnt/cdrom/isolinux/kernel /mnt/cdrom/isolinux/rescue.gz /tftpboot</i>
# <i>chmod 644 /tftpboot/*</i>
# <i>umount /mnt/cdrom/</i>
</pre>

<p>Nastartujte poèítaè z va¹í neskuteènì u¾iteèné grub diskety.
Jakmile systém nabìhne, je tøeba specifikovat zpùsob, jakým vá¹ poèítaè
získá IP adresu, kernel s parametry a kde získá initrd.</p>

<pre>
grub> <i>ifconfig --address=192.168.0.10 --server=192.168.0.2</i>
grub> <i>root (nd)</i>
grub> <i>kernel /tftpboot/kernel devfs=nomount vga=normal load_ramdisk=1 </i>
      <i>prompt_ramdisk=0 ramdisk_size=18580 root=/dev/ram0 rw</i> <comment>(all on one line)</comment>
grub> <i>initrd /tftpboot/rescue.gz</i>
grub> <i>boot</i>
</pre>

<note>Grub lze také vyu¾ít pro konfiguraci IP s pomocí bootp a dhcp. Pou¾ijte
bootp a dhcp pøíkazy.</note>

<p>Nyní, kdy je vá¹ poèítaè spu¹tìn, mù¾ete pokraèovat jako pøi normální instalaci.
Viz. návod k instalaci na instalaèním gentoo cd.</p>

</body>
</section>
</chapter>





<chapter> <title>Instalace Gentoo z existující Linuxové distribuce</title> 
<section> <title> Po¾adavky </title> 
<body>
<p>Pro instalaci Gentoo z ji¾ existující Linuxové distribuce je tøeba mít
nainstalován pøíkaz chroot a mít zkopírován Gentoo instalaèní tar balík nebo
ISO, které chcete instalovat. Pøipojení k síti je tøeba v pøípadì, ¾e chcete
více, ne¾ je obsa¾eno ve va¹em balíku (mimochodem, tar balík je prostì
soubor zakonèený pøíponou .tbz nebo .tar.gz). Autor pou¾il RedHat Linux 7.3
jako "host" operaèní systém, ale to není pøíli¹ dùle¾ité. Zaènìme!</p>
</body>
</section>

<section> <title> Pøehled </title>
<body>
<p>Za prvé uvolníme místo na disku a vytvoøíme nový oddíl pro ná¹ budoucí systém Gentoo 
pomocí zmìny velikosti ji¾ existujícího Linuxového oddílu. Pak pøipojíme tento nový oddíl, 
rozpakujeme tar balík, pomocí pøíkazu chroot se pøepneme do na¹eho "proto" systému a zahájíme 
vytváøení. Jakmile bude dokonèen proces bootstrap, provedeme koneènou konfiguraci na systému 
pro jeho nastartování. A jsme pøipraveni nastartovat a pou¾ívat systém Gentoo. </p>
</body>
</section>

<section> <title> Jak vytvoøit místo pro ná¹ Gentoo systém? </title>
<body>

<p>
Koøenový oddíl je souborový systém pøipojený pod "/". Rychlé provedení pøíkazu mount uká¾e o èem hovoøím.
Pou¾ijeme také pøíkaz df (disk free) pro zji¹tìní, kolik je volného místa a jak zmìnit velikost.
Uvìdomte si, ¾e není povinné mìnit velikost "root" systému! Je mo¾no zmìnit velikost jakéhokoliv
jiného oddílu, ale o tom se zmíním pozdìji.</p>


<pre caption="Informace o systému souborù">
# <i>mount</i>
/dev/hdb2 on / type ext3 (rw) 
none on /proc type proc (rw) 
none on /dev/pts type devpts (rw,gid=5,mode=620) 
none on /dev/shm type tmpfs (rw) 
# <i>df -h </i>
Filesystem           Size Used Avail Use% Mounted on 
/dev/hdb2            4.0G 1.9G  2.4G  82% /
none		      38M    0    38M   0% /dev/shm 
</pre>

<p>Jak vidíme, oddíl pøipojený jako "/" pojmenovaný /dev/hdb2 má 2.4 gigabajtù volného místa.
V tomto pøípadì zmìním jeho velikost tak, aby zbylo 400M volného místa, tudí¾ zbydou 2 gigabajty
pro systém Gentoo. Docela dobré, budu moci nainstalovat mnoho vìcí. Mnoha u¾ivatelùm v¹ak
postaèí i jeden gigabajt. Nyní k vlastní zmìnì velikosti!</p>

</body> </section>

<section> <title> Sestavení parted pro zmìnu velikosti </title> 
<body>
<p>Parted je utilita vytvoøená GNU projektem, starou a respektovanou organizací, její¾ mnohé programy nyní vyu¾íváte.
Jedním z jejích velmi u¾iteèných programù je utilita parted. Parted je "partition editor" a lze jej 
získat na <uri> http://www.gnu.org/software/parted/ </uri> 
</p>
<note> Existují i jiné nástroje pro zmìnu velikosti diskového oddílu, ale autor
nezná/nezjímají ho programy typu PartitionMagic(tm) nebo jiné tohoto druhu.
Je na ètenáøi, zda je pou¾ije. </note>

<p>Zjistìte, zda je parted schopen pracovat se souborovým systémem toho typu,
kde chcete mìnit velikost. Pokud ne, nemáte ¹tìstí a budete muset znièit
nìkterý oddíl, abyjste uvolnili místo pro Gentoo systém, a poté obnovit pùvodní
data. Stáhnìte software, nainstalujte. V na¹em pøípadì chceme
zmìnit velikost na¹eho "root" oddílu a zde je problém. Proto musíme nastartovat 
z disket s minimálním linuxovým systémem a nakopírovaným parted, které si pøedem vytvoøíme.
Pokud v¹ak chcete mìnit velikost jiného oddílu, který lze odpojit za bìhu systému,
máte ¹tìstí. Nemusíte provádìt následující kroky. Pouze zkompilujte parted a
pou¾ijte ho na odpojený oddíl. Zde je postup, jaký jsem pou¾il v mém pøípadì.</p>

<impo> Ujistìte se, ¾e parted podporuje typ souborového systému oddílu, 
jeho¾ velikost chcete mìnit! </impo>

<p> Stáhnìte si tomsrtbt boot/root disk (zadarmo) z <uri>
http://freshmeat.net/tomsrtbt/ </uri>, vytvoøte zavádìcí disketu podle
dokumentace pøilo¾ené k balíku. Pøipravte si dal¹í disketu a vlo¾te ji
do disketové mechaniky</p>

<note> Uvìdomte si opìt, ¾e Linux je synonymum pro "Je zde v¾dy dal¹í zpùsob,
jak to provést". Va¹ím cílem je spustit parted nad odpojeným oddílem.
Mù¾ete pou¾ít jiné "bootovací" diskety ne¾ tomsrtbt. Nìkdy není potøeba
tento krok vùbec provádìt, pokud lze odmontovat oddíl, který chcete
mìnit, pøímo z bì¾ícího systému. </note>

<pre caption="Vytvoøení diskety utilit">
# <i>mkfs.minix /dev/fd0</i>
480 inodes
1440 blocks
Firstdatazone=19 (19)
Zonesize=1024
Maxsize=268966912
</pre>

Nyní vytvoøíme parted. Pokud jste balík je¹tì nestáhli a nerozbalili, udìlejte to nyní a pøesuòte
se do odpovídajícího adresáøe. Pro vlastní vytvoøení utility a její zkopírování na
disketu proveïte následující posloupnost pøíkazù.

<pre caption="Sestavení diskety utilit">
# <i> mkdir /floppy; mount -t minix /dev/fd0 /floppy &amp;&amp; 
export CFLAGS="-O3 -pipe -fomit-frame-pointer -static" &amp;&amp; ./configure 
&amp;&amp; make &amp;&amp; cp parted/parted /floppy &amp;&amp; umount /floppy </i>
</pre>

<p>
Blahopøeji, nyní jste pøipraveni restartovat a zmìnit velikost oddílu. Udìlejte
to ov¹em a¾ po alespoò zbì¾ném pohledu na dokumentaci na GNU webu. Vlastní
proces by mìl zabrat nìco ménì ne¾ 30 minut na velkém oddílu, buïte trpìliví.
Restartujte z tomsrtbt zavádìcí diskety, a po pøihlá¹ení vymìòte tuto disketu
za disketu utilit, kterou jsme si pøedtím vytvoøili. Proveïte pøíkaz
mount /dev/fd0 /floppy pro pøipojení diskety pod adresáø /floppy.
Potom spust»e z tohoto adresáøe utilitu parted a mù¾ete zaèít se zmìnou
velikosti va¹eho oddílu. Jakmile tento pomìrnì dlouhý proces probìhne,
mù¾e zaèít skuteèná zábava s instalací Gentoo systému. Restartujte
zpìt do va¹eho starého Linux systému. Disk, na kterém budeme akci
provádìt, je disk s oddílem urèeným pro zmìnu velikosti.
Na pøíklad pokud chceme mìnit velikost oddílu /dev/hda3, disk bude
/dev/hda
</p>

<pre caption="Seznam pøíkazù po pøihlá¹ení do tomsrtbt systému">
# <i>mount /dev/fd0 /floppy </i>
# <i>cd /floppy; ./parted [drive you wish to operate on]</i>
(parted) <i> print </i>
Disk geometry for /dev/hdb: 0.000-9787.148 megabytes
Disk label type: msdos
Minor    Start       End     Type      Filesystem  Flags
1          0.031   2953.125  primary   ntfs        
3       2953.125   3133.265  primary   linux-swap  
2       3133.266   5633.085  primary   ext3        
4       5633.086   9787.148  extended              
5       5633.117   6633.210  logical               
6       6633.242   9787.148  logical   ext3        
(parted) <i> help resize </i>
  resize MINOR START END        resize filesystem on partition MINOR

        MINOR is the partition number used by Linux.  On msdos disk labels, the
        primary partitions number from 1-4, and logical partitions are 5
        onwards.
        START and END are in megabytes
(parted) <i> resize 2 3133.266 4000.000 </i>
</pre>

<impo> Buïte trpìliví! Poèítaè pracuje! Sledujte LEDku va¹eho disku pro kontrolu,
zda systém skuteènì pracuje. Mìlo by to trvat od 2 do 30 minut v závislosti
na velikosti disku. </impo>

<p>Jakmile je proces dokonèen (velikost zmìnìna), restartujte zpìt do va¹eho
starého Linux systému, jak ji¾ bylo øeèeno. Pak pokraèujte dále podle
<uri link="/doc/build.html">http://www.gentoo.org/doc/build.html</uri>
a proveïte kroky 6,7,9 a¾ 17.

U¾ijte si!
</p>
</body>
</section>
</chapter>
</guide>

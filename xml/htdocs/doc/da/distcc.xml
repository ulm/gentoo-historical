<?xml version='1.0' encoding="iso-8859-1"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/da/distcc.xml,v 1.11 2004/05/16 19:11:56 broeman Exp $ -->

<!--
 Synchronised with rev 1.15 on
 http://www.thedoh.com/viewcvs/distcc/html/distcc.xml
-->

<guide link="/doc/da/distcc.xml" lang="da">

<title>Distcc vejledningen</title>

<author title="Forfatter">
    <mail link="lisa@gentoo.org">Lisa M. Seelye</mail>
</author>

<author title="Redaktør">
    <mail link="vapier@gentoo.org">Mike Frysinger</mail>
</author>

<author title="Redaktør">
    <mail link="erwin@gentoo.org">Erwin</mail>
</author>

<author title="Redaktør">
    <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>

<author title="Anmelder, Redaktør">
    <mail link="blubber@gentoo.org">Tiemo Kieft</mail>
</author>

<author title="Oversætter">
    <mail link="aaby@gentoo.org">Arne Mejlholm</mail>
</author>

<author title="Korrektur">
    <mail link="broeman@gentoo.org">Jesper Brodersen</mail>
</author>

<abstract>
Dette dokument fungerer som en HOWTO for at bruge distcc med Gentoo.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->
<license/>

<version>1.6</version>
<date>12. Maj 2004</date>

<chapter>
<title>Introduktion</title>
<section>
<title>Hvad er distcc?</title>
<body>

<p>
Distcc er et program designet til at distribuere kompileringsopgaver
på tværs af et netværk til deltagende værtscomputere. Det er bestående
af en server, <c>distccd</c>, og et klient program,
<c>distcc</c>. Distcc kan fungere transparent med <uri
link="http://ccache.samba.org">ccache</uri> og Portage med lidt arbejde. 
</p>

</body>
</section>
<section>
<title>Brug af distcc til bootstrap</title>
<body>

<p>
Hvis du planlægger at bruge distcc til at hjælpe dig med at bootstrappe en Gentoo installation, vær sikker på at du læser delen om <uri link="#bootstrapping">Brug af distcc til bootstrapping</uri>, som er placeret længere ned i dette dokument.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Opsætning</title>
<section>
<title>Afhængigheder</title>
<body>

<p>
For at starte med at bruge Distcc, skal alle computere i dit netværk have samme GCC-versioner. Mix af 3.3.x (hvor x varierer) er ok, men mix af 3.3.x og 3.2.x er ikke: dine programmer <b>vil</b> have fejl i dem.
</p>

</body>
</section>
<section>
<title>Installation af Distcc</title>
<body>

<p>
Der er nogle få indstillinger som du bør vide før du begynder med installationen af distcc.
</p>

<p>
Distcc sendes med en grafisk overvåger til at overvåge opgaver, som
din computer sender afsted til kompileringen. Hvis du bruger Gnome, så
put 'gnome' i dine USE-flag. Imens, hvis du ikke bruger Gnome og
stadigvæk vil have overvågeren, så skal du putte 'gtk' i dine
USE-flag.
</p>

<pre caption="Installation af distcc">
# <i>emerge distcc</i>
</pre>

</body>
</section>
<section>
<title>At sætte Portage op til at bruge Distcc</title>
<body>

<p>
Opsætningen af distcc er meget nemt i Portage. Udfør disse
simple trin på hver af de computere, som skal være del i de distribuerede kompilinger:
</p>

<pre caption="Integration af Distcc og Portage">
# <i>emerge distcc</i>
# <i>nano -w /etc/make.conf</i>
<comment>(Indstil N til et brugbart nummer til specifikke opsætning)</comment>
<comment>(En typisk heuristic strategi er dobbelt så højt et nummmer af CPUer + 1)</comment>
MAKEOPTS="-jN"
<comment>(Tilføj distcc til dine FEATURES-variabler)</comment>
FEATURES="distcc"
<comment>(Indstil distcc's folder til midlertidig plads)</comment>
DISTCC_DIR="${PORTAGE_TMPDIR}/.distcc"
</pre>

<p>
Derefter skal du specificere hvilken vært du vil bruge. Brug <c>distcc-config</c> kommandoen for at indstille listen af værter. Her er et eksempel på nogle værter, som måske er med i din liste:
</p>

<pre caption="Eksempler på vært definitioner">
192.168.0.1        192.168.0.2                     192.168.0.3
192.168.0.1/2      192.168.0.2                     192.168.0.3/10
192.168.0.1:4000/2 192.168.0.2/1                   192.168.0.3:3632/4
@192.168.0.1       @192.168.0.2:/usr/bin/distccd   192.168.0.3
<comment>(Der er også adskillige andre metoder til at sætte værts
definitioner op. Se distcc man siderne for at få flere detajer.)</comment>
</pre>

<p>
Det kan godt se meget indviklet ud, men i de fleste tilfælde vil en
variation af linie 1 eller 2 virke.
</p>

<ul>
 <li>Linie 1 er bare en pladsbegrænsende liste af værter</li>
 <li>
  Linie 2 er en liste af værter, der specificerer det maksimale antal af jobs (ved at bruge /N) der højest kan sendes til en vært på ethvert givent tidspunkt (specificeret med <c>/n</c>).
 </li>
</ul>

<p>
Da de fleste folk ikke kommer til at bruge linerne 3 og 4, vil jeg blot pege på <uri 
link="http://distcc.samba.org/man/distcc_1.html">distcc docs</uri> for 
at få mere information.
</p>

<p>
F.eks. for at indstille den første linie i det foregående eksempel:
</p>

<pre caption="Kommando-eksempel for at indstille værter">
<i>/usr/bin/distcc-config --set-hosts "192.168.0.1 192.168.0.2 192.168.0.3"</i>
</pre>

<p>
Start nu distcc-daemonen for alle de involverede computere:
</p>

<pre caption="Start af distcc daemon">
<comment>(Tilføj distccd til standard runlevel)</comment>
# <i>rc-update add distccd default</i>
<comment>(Start af distcc daemon)</comment>
# <i>/etc/init.d/distccd start</i>
</pre>

</body>
</section>
<section>
<title>At sætte Distcc op til at virke med Automake</title>
<body>

<p>
Dette er i nogle tilfælde nemmere end opsætningen af Portage. Det du
skal gøre er at opdatere din <c>PATH</c> miljø-variabel til at
inkludere <path>/usr/lib/distcc/bin</path> før det bibliotek, hvor <c>gcc</c>
befinder sig (<path>/usr/bin</path>). Men ikke uden en advarsel. Hvis du
bruger ccache, skal du sætte distcc efter ccache delen:
</p>

<pre caption="Opsætning af din sti">
# <i>export PATH="/usr/lib/ccache/bin:/usr/lib/distcc/bin:${PATH}"</i>
</pre>

<p>
Derefter, når du normalt ville skrive <c>make</c>, skal du nu skrive 
<c>make -jN</c> 
(hvor N igen er et positivt heltal). Em værdi af N afhænger af dit netværk og typen af de computere du bruger til at kompilere. Jeg har selv en dual processor P3 og en K6-2/400 der
kompilerer alt til min desktop (en 1200MHz Athlon Thunderbird) og jeg
bruger -j5. Test dine egne indstillinger for at finde det rigtige tal.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Cross-Compiling</title>
<section>
<title>En note om Cross-Compiling</title>
<body>

<p>
Cross-compiling bruger en arkitektur til at bygge programmer til en
anden arkitektur. Dette er så simpelt som at bruge en Athlon (i686)
til at bygge et program til en K6-2 (i586), eller at bruge en Sparc
til at bygge at program til en ppc.
</p>

</body>
</section>
<section>
<title>Et personlig notat om Cross-compiling</title>
<body>

<p>
Jeg ville meget gerne være i stand til at hjælpe med på Gentoo's
indsats med Cross-compiling, men jeg har ikke nogen ikke-x86
maskiner. Jeg kan lave ting der virker <e>i teorien</e>, men jeg må
stole på andre personer til at teste det jeg skriver. Det virker til
et vist punkt, men det er svært ;-)
</p>

<p>
I den nærmeste fremtid håber jeg, at kunne skaffe en Sparc af en eller type
så jeg kan putte Gentoo på den og lege med det i min lejlighed.
</p>

</body>
</section>
</chapter>

<chapter id="bootstrapping">
<title>Brug af distcc til bootstrap</title>
<section>
<title>Trin 1: Indstilling a ny computer</title>
<body>

<p>
Opstart din nye box med en Gentoo Linux LiveCD og følg <uri link="/doc/da/handbook/hándbook-x86-xml?part=1">Installationsinstruktionerne</uri> indtil bootstrapping delen. Indstil så Portage til at bruge distcc:
</p>

<pre caption="Indledende indstillinger">
# <i>nano -w /etc/make.conf</i>
<comment>(Tilføj distcc til FEATURES-variablen</comment>
FEATURES="distcc"
<comment>(Sæt distccs folder til midlertidig plads)</comment>
DISTCC_DIR="${PORTAGE_TMPDIR}/.distcc"
<comment>(Modificer MAKEOPTS til at indeholde -jN men N i en passende integer)</comment>
MAKEOPTS="-jN"
</pre>

</body>
</section>
<section>
<title>Trin 2: At få fat i Distcc</title>
<body>

<p>
Installer distcc:
</p>
        
<pre caption="Få fat i Distcc på den nye computer">
# <i>USE='-*' emerge --nodeps distcc</i>
</pre>

</body>
</section>
<section>
<title>Trin 3: Indstilling af distcc</title>
<body>

<p>
Tilføj en "distcc"-bruger til <path>/etc/passwd</path>-filen og kør <c>distcc-config</c> for at opsætte distcc:
</p>

<pre caption="Afsluttende distcc opsætning">
# <i>echo "distcc:x:240:2:distccd:/dev/null/:/bin/false" &gt;&gt; /etc/passwd</i>
<comment>(Udskift host1, host2 ... med IP-numre på de pågældende værter</comment>
# <i>/usr/bin/distcc-config --set-hosts "localhost host1 host2 host3 ..."</i>
</pre>

<p>
distcc er nu sat op til bootstrap! Fortsæt med den officielle
installationsvejledning, og <e>glem ikke</e> at gen-emerge distcc efter
<c>emerge system</c>. Dette er for at være sikker på at afhængighederne du vil have også er installeret.
</p>

<note>
Under bootstrap og <c>emerge system</c> ser det måske ikke ud til at distcc bliver brugt. Dette kan forventes, idet nogle ebuilds eller pakker virker ikke godt med distcc, så
de slår med overlæg distcc fra.
</note>
   
</body>
</section>
</chapter>
<chapter>
<title>Fejlfinding</title>
<section>
<title>Mozilla og XFree</title>
<body>

<p>
Når du emerger forskellige pakker, vil du bemærke at de ikke bliver
distribueret (og virkelig ikke bliver bygget parallelt). Dette er
fordi at udviklerne af Mozilla og XFree .ebuild'ene har slået parallel
bygning fra, fordi det er kendt for at skabe problemer..
</p>

<p>
Nogen gange kan det ske at en pakke fejler i kompileringen. Hvis dette sker for dig, så send venligst en <uri link="http:/bugs.gentoo.org">rapport</uri> til os.
</p>

</body>
</section>
<section>
<title>En blanding af modstandsdygtig-gcc og ikke-modstandsdygtig-gcc værter vil være fejlfuld.</title>
<body>

<p>
Med sådan en lang titel, er næsten alt forklaring unødvendigt. Men,
hvis du planlægger at bruge distcc spredt over værter, som bruger <uri
link="/proj/en/hardened/etdyn-ssp.xml">PaX/hardened-gcc</uri>
modstandsdygtig projekt, og andre ikke har, vil du løbe ind i
problemer.
</p>

<p>
Løsningen kræver en lille smule fremsynethed fra din side; du bliver
nødt til at køre <c>hardened-gcc -R</c> på væreten, som har
PaX/hardened-gcc, eller du bliver nødt til at aktivere PaX
beskyttelser i din kerne og <c>emerge hardened-gcc</c>.  Begge ting er
godt at gør, siden for det meste er beskyttelserne tilbud af begge
pakker, og det er en god idé at være transparent over for brugeren.
</p>

</body>
</section>
<section>
<title>GCC-versionsmix</title>
<body>

<p>
Hvis du har forskellige versioner af GCC på dine værter, vil der
sikkert opstå mærkelige problemer. Løsningen er at blive sikker på at
alle væreter bruger samme GCC-version.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Distcc ekstra ting</title> 
<section> 
<title>Distcc overvågere</title> 
<body>

<p>
Distcc kommer med to overvågningsværktøjer. Den tekst-baserede bliver
altid bygget og kaldes <c>distccmon-text</c>. Når du kører den for den
første gang kan det godt virke lidt forvirrende, men den er faktisk
ganske nem at bruge. Hvis du kører programmet uden en parameter så
kører det kun en gang. Hvis du derimod giver den et tal så opdaterer
den hver N sekunder, hvor N er den parameter du giver den
</p>

<p>
Det andet overvågningsværktøj findes kun hvis du har <c>gtk</c> i dit 
<c>USE</c> flag. Denne er baseret på GTK+ og kører i et X miljø, og er
faktisk ret dejligt.
</p>

<p>
Der følger en advarsel med til brugeren af disse programmer. Hvis du
vil overvåge en vilkårlig emerge, så er du nødt til at starte
overvågningsværktøjet sådan:
</p>

<pre caption="At starte overvågningsværktøjerne">
# <i>distccmon-text N</i>
<comment>(Eller...)</comment>
# <i>distccmon-gnome</i>
</pre>

<impo>
Hvis du bruger Portage og brugte ovenstående eksemple, vil det være
<c>DISTCC_DIR=/var/tmp/portage/.distcc</c>.
</impo>

<note>
Hvis du ikke bruger Portage, behøver du ikke at specificere DISTCC_DIR
(med andre ord, bare taste distccmon-text N).  
</note>

</body>
</section>
</chapter>

<chapter>
<title>Fremtidige planer for Distcc og Gentoo</title>
<section>
<title>distcc-subnetscan</title>
<body>

<p>
<c>distcc-subnetscan</c> er et perl program under udvikling, der kommer
til at kunne skanne et del-netværk for værter, der har deltagende distcc
daemons (baggrundsprocesser). Dette vil blive forbedret til at teste om daemon'en på en
fjernvært vil tilpasses til en specifik <c>CHOST</c> indstilling for
at gøre cross-compiling nemmere.
</p>

<p>
Perl scriptet findes <uri
link="http://dev.gentoo.org/~lisa/distcc/distcc-subnetscan/distcc-subnetscan.pl">på lisa's udvikler-side</uri> indtil et mere formelt hjem bliver fundet.
</p>

</body>
</section>
</chapter>
</guide>

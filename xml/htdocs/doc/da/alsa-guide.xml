<?xml version='1.0' encoding="utf-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/da/alsa-guide.xml,v 1.10 2004/08/30 20:44:29 broeman Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link = "/doc/da/alsa-guide.xml" lang="da">
<title>Gentoo Linux ALSA Guide</title>
<author title="Forfatter">
  <mail link="zu@pandora.be">Vincent Verleye</mail>
</author>
<author title="Forfatter">
  <mail link="g2boojum@gentoo.org">Grant Goodyear</mail>
</author>
<author title="Forfatter">
  <mail link="agenkin@gentoo.org">Arcady Genkin</mail>
</author>
<author title="Forfatter">
   <mail link="eradicator@gentoo.org">Jeremy Huddleston</mail>
</author>
<author title="Redaktør"><!-- zhen@gentoo.org -->
	John P. Davis
</author>
<author title="Redaktør">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Redaktør">
  <mail link="bennyc@gentoo.org">Benny Chuang</mail>
</author>
<author title="Redaktør">
  <mail link="blubber@gentoo.org">Tiemo Kieft</mail>
</author>
<author title="Redaktør">
  <mail link="erwin@gentoo.org">Erwin</mail>
</author>
<author title="Oversætter">
  <mail link="aaby@gentoo.org">Arne Mejlholm</mail>
</author>
<author title="Korrektur">
  <mail link="broeman@gentoo.org">Jesper Brodersen</mail>
</author>

<abstract>
Denne vejledning viser hvordan du sætter Advanced Linux Sound
Architecture (ALSA) op på Gentoo Linux. I forbindelse med Gentoo Linux
Desktop Konfigurationsvejledningen er den ment til at give dig mere
information omkring dette emne.  
</abstract>

<license/>

<version>1.5.2</version>
<date>13. August 2004</date>

<chapter>
<title>Den advancerede Linux lyd-arkitektur</title>
<section>
<title>Hvad er ALSA?</title>
<body>

<p>
ALSA er <e>Advanced Linux Sound Architecture</e>, et projekt dedikeret til at udvikle et høj kvalitets Linux lyd-undersystem. Det har udskiftet Open Sound System (OSS), som standard lyd-undersystem i 2.6-kernen.
</p>

<p>
ALSA leverer nok understøttelse til alle typer af audio-grænseflader, den er fuldt modulariseret, er SMP- og thread-sikker og leverer et høj kvalitets brugerrum bibliotek kaldet <e>alsa-lib</e> for at forsimple applikationsprogrammering. Den leverer også bagudrettet kompatibilitet til OSS.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installation af ALSA</title>
<section>
<title>USE-flag</title>
<body>

<p>
Gentoo leverer et <c>alsa</c> USE-flag, som du bør indsætte i <path>/etc/make.conf</path> for at tillade vores pakker at blive samlet med ALSA-understøttelse. Hvis du også har <c>oss</c> i din USE-variabel, vil ALSA blive samlet med OSS bagudrettet kompatibilitet.
</p>

</body>
</section>
<section>
<title>Kerne-moduler</title>
<body>

<p>
Først, før du fortsætter, skal du være sikker på at din kerne har <e>Sound Card Support</e> aktiveret. Hvis du har brugt <c>genkernel</c> for at samle din kerne, så er det opsat automatisk. Ellers genindstil din kerne.
</p>

<p>
Hvis du bruger en 2.6-kerne, kan du springe resten af denne sektion over og fortsætte med <uri link="#alsa-utils">Installation af ALSA-værktøjer</uri>, idet 2.6 allerede har de nødvendige ALSA-drivere indbygget. Selvfølgelig skal du ikke glemme at aktivere understøttelse til dit lydkort, når du indstiller din kerne.
</p>

<p>
Brugere af 2.4-kernekildekoder skal installere de nødvendige ALSA-drivere til deres lydkort. Først, find ud hvilket lydkort du har. Det nemmeste er at søge efter "audio" i <path>/proc/pci</path>.
</p>

<pre caption="Søg efter lydkort-type">
# <i>grep -i audio /proc/pci</i>
Multimedia audio controller: VIA Technologies, Inc. VT82C686 AC97 Audio Controller (rev 64).
</pre>

<p>
Gå nu til <uri link="http://www.alsa-project.org/alsa-doc">ALSA lydkortsmatricen</uri> og søg efter dit lydkort. I det ovenstående eksempel, bør du gå til "VIA" manufacturer. Du vil modtage en tabel med de kendte chipsets fra denne producent. Chipsettet i ovenstående eksempel er "via82c686"; "Details" linket vil så informere mig at driveren er kaldet <path>via82xx</path>.
</p>

<p>
Baseret på denne information, kan vi nu installere <c>alsa-driver</c> til vores lydkort. Rediger først <path>/etc/make.conf</path> og <e>tilføj</e> en ny valgmuliged kaldet ALSA_CARDS til den. Inde i denne variabel, deklarerer du din lydkortsdriver, som du ønsker at bruge:
</p>

<pre caption="Redigering af /etc/make.conf til ALSA_CARDS">
ALSA_CARDS="via82xx"
</pre>

<p>
Installer du <c>alsa-driver</c>:
</p>
  	 
<pre caption="Installation af ALSA-drivere">
# <i>emerge alsa-driver</i>
</pre>

<impo>
Hver gang du (gen)samler dine kernekilder, er risikoen stor for at ALSA-driverne bliver overskrevet. Det er derfor meget tilrådigt at køre <c>emerge alsa-driver</c> igen efter hver gang du (gen)samler din kerne <e>efter</e> at du har opstartet med denne nye kerne.
</impo>

</body>
</section>
<section id="alsa-utils">
<title>Installation af ALSA-værktøjer</title>
<body>

<p>
Hvis du ønsker bagudrettet kompatibilitet med OSS, skal du installere <c>alsa-oss</c>:
</p>

<pre caption="Installation af ALSA OSS kompatibilitetslaget">
# <i>emerge alsa-oss</i>
</pre>

<p>
Installer nu ALSA-værtøjer på dit system (dette er et krav):
</p>

<pre caption="Installation af ALSA-værktøjer">
# <i>emerge alsa-utils</i> 
</pre>

<p>
Nu da værktøjerne er installeret, er det tid til at indstille ALSA...
</p>

</body>
</section>
</chapter>

<chapter>
<title>Opsætning af ALSA</title>
<section>
<title>Automatisk hentning af kerne-moduler</title>
<body>

<p>
Hvis du bruger en modulær kerne (som når du bruger <c>genkernel</c>) skal du redigere <path>/etc/modules.d/alsa</path>, så den aktiverer de nødvendige moduler ved opstart. For lydkortet i vores eksempel:
</p>

<pre caption="/etc/modules.d/alsa">
alias snd-card-0 snd-via82xx
<comment># Det følgende er kun nødvendigt, hvis du vil have OSS kompatibilitet</comment>
alias sound-slot-0 snd-card-0
alias /dev/mixer snd-mixer-oss
alias /dev/dsp snd-pcm-oss
alias /dev/midi snd-seq-oss
</pre>

<p>
Kør nu <c>modules-update</c> for at gemme ændringer du har lavet til <path>alsa</path> filen i <path>/etc/modules.conf</path>:
</p>

<pre caption="At køre modules-update">
# <i>modules-update</i>
</pre>

</body>
</section>
<section>
<title>Verifikation af enhedsfiler</title>
<body>

<p>
Hvis du bruger DevFS (som er standard i Gentoo installationen), vær sikker på at <path>/etc/devfsd.conf</path> har ALSA-enhederne og rettigheder korrekt registreret:
</p>

<pre caption="/etc/devfsd.conf">
# ALSA/OSS stuff
# Comment/change these if you want to change the permissions on
# the audio devices
LOOKUP          snd          MODLOAD ACTION snd
LOOKUP          dsp          MODLOAD
LOOKUP          mixer        MODLOAD
LOOKUP          midi         MODLOAD
REGISTER        sound/.*     PERMISSIONS root.audio 660
REGISTER        snd/.*       PERMISSIONS root.audio 660
</pre>

</body>
</section>
<section>
<title>At have ALSA aktiveret ved opstart</title>
<body>

<p>
For at aktivere ALSA-understøttelse ved opstart, tilføj <c>alsasound</c> opstartsscriptet til "boot" runlevel:
</p>

<pre caption="Tilføj ALSA til boot runlevel">
# <i>rc-update add alsasound boot</i>
# <i>/etc/init.d/alsasound start</i>
</pre>

</body>
</section>
<section>
<title>Unmute af kanaler</title>
<body>

<p>
Som standard er alle kanaler muted. For at ordne dette, kør <c>amixer</c>:
</p>

<pre caption = "At køre amixer">
# <i>amixer</i>
</pre>

<p>
Unmute nu <e>Master</e> og <e>PCM</e> kanalerne. Hvis dette ikke er nok, unmute også <e>Center</e> og <e>Surround</e> kanalerne.
</p>

<pre caption = "Unmute af lydkanaler">
# <i>amixer set Master 100 unmute</i>
# <i>amixer set PCM 100 unmute</i>
<comment>(Kun hvis det ovenstående ikke er nok:)</comment>
# <i>amixer set Center 100 unmute</i>
# <i>amixer set Surround 100 unmute</i>
</pre>

<p>
For at tjekke om lyden virker, afspil en lydfil (ved brug af <c>aplay</c>), en mp3 (ved brug af <c>mpg123</c> eller endda <c>mplayer</c>) eller en anden slags lydfil, som du ønsker.
</p>

<p>
For at fintune dine lydkanaler, kan du bruge <c>alsamixer</c> programmet.
</p>
	 
</body>
</section>
</chapter>
  	 
<chapter>
<title>Aktivering af MIDI-understøttelse</title>
<section>
<title>Installation af nødvendige pakker</title>
<body>

<p>
Nogle lydkort kommer med MIDI-synthesizers indbygget. For at bruge dem, skal du først installere <c>awesfx</c> pakken:
</p>

<pre caption="At installere awesfx">
# <i>emerge awesfx</i>
</pre>
  	 
<p>
Hvis du har en samling af lydfonte et sted, placer dem i
<path>/usr/share/sfbank/</path>. F.eks. har SBLive en lydfont fil
kaldet <path>8MBGMSFX.SF2</path> eller <path>CT4GMSFX.SF2</path>.
</p>

<p>
Efter at have kopieret den lydfont over, vælg den ved brug af <c>/usr/bin/asfxload</c>.
</p>

<pre caption="Start af lydfonten">
# <i>asfxload /usr/share/sfbank/8MBGMSFX.SF2</i>
</pre>
  	 
<p>
Denne kommando skal køres ved hver opstart, så det er tilrådigt at tilføje den til <path>/etc/conf.d/local.start</path> også.
</p>

<p>
Hvis du ikke kan finde nogle soundfonts på din driver-CD, så kan du hente nogen online på <uri>http://www.parabola.demon.co.uk/alsa/awe64.html</uri>
</p>

</body>
</section>
<section>
<title>Timidity++ virtuelle synthesizer</title>
<body>
  	 
<p>
Hvis du lydkort ikke kommer med en hardware synthesizer (eller du ikke
vil bruge den), så kan du bruge <c>timidity++</c> for at give dig en
virtuel synthesizer. Start ved at emerge denne pakke:
</p>
  	 
<pre caption="At installere Timidity++">
# <i>emerge timidity++</i>
</pre>
  	 
<p>
For at få timidity til at afspille lyde, skal den bruge en
lydfont. Hvis du ikke har nogen, installer <c>timidity-eawpatches</c>,
som vil give dig nogle soundfonts.
</p>

<pre caption="Installation af soundfonts">
# <i>emerge timidity-eawpatches</i>
</pre>

<p>
Glem ikke at tilføje <c>timidity</c> til "default" runlevel.
</p>
  	 
<pre caption="Tilføjelse af timidity til default runlevel">
# <i>rc-update add timidity default</i>
# <i>/etc/init.d/timidity start</i>
</pre>
  	 
</body>
</section>
<section>
<title>Test af MIDI-understøttelse</title>
<body>
  	 
<p>
Du kan bruge <c>pmidi</c> til at teste din MIDI opsætning:
</p>
  	 
<pre caption="At installere pmidi">
# <i>emerge pmidi</i>
</pre>
  	 
<p>
For at se hvilke MIDI-outputporte er tilgængelige på dit system, brug <c>-l</c>-valgmuligheden:
</p>
  	 
<pre caption="Se MIDI-outputporte">
# <i>pmidi -l</i>
</pre>
  	 
<p>
Hvis det ser fint ud, prøv nu at afspille en MIDI fil for at være sikker på at alting virker. Med <c>-p</c>-valgmuligheden kan du definere hvilken MIDI-port du ønsker at bruge.
</p>
  	 
<pre caption="Afspilning af MIDI">
# <i>pmidi -p 65:0 "Final Fantasy 7 - Aerith's Theme.mid"</i>
</pre>
  	 
</body>
</section>
</chapter>

<chapter>
<title>Endelige noter</title>
<section>
<title>Værktøjer og Firmware</title>
<body>

<p>
Nogle specifikke lydkorte kan drage nytte af nogle værktøjer leveret med <c>alsa-tools</c>- og <c>alsa-firmware</c>-pakkerne. Hvis du har brug for <c>alsa-tools</c>, vær sikker på at definere ALSA_TOOLS-variabelen i <path>/etc/make.conf</path> med de værktøjer som du behøver. F.eks:
</p>

<pre caption="Valg af ALSA-værktøjer i /etc/make.conf">
ALSA_UTILS="as10k1 ac3dec"
</pre>

<p>
Derefter installer <c>alsa-tools</c> (og/eller <c>alsa-firmware</c>) pakke(rne):
</p>

<pre caption="Installation af ALSA-værktøjer">
# <i>emerge alsa-tools</i>
</pre>

</body>
</section>
<section>
<title>At aktivere joystick-understøttelse</title>
<body>

<p>
Hvis dit lydkort har et joystick-stik, vil du måske være interesseret i
at aktivere joystick-understøttelse i dit lydkort. Hvis dette er
tilfældet, start med at verificere at dit lydkorts driver har en
joystick-parameter. Du kan verificere dette ved at køre <c>modinfo</c>
mod din kerne-modul. F.eks. <c>snd-via82xx</c>:
</p>

<pre caption="At køre modinfo">
# <i>modinfo snd-via82xx</i>
filename:    /lib/modules/2.4.22-ck2/snd-via82xx.o
description: "VIA VT82xx audio"
author:      "Jaroslav Kysela &lt;perex@suse.cz&gt;"
license:     "GPL"
parm:        index int array (min = 1, max = 8), description "Index value for
             VIA 82xx bridge."
parm:        id string array (min = 1, max = 8), description "ID string for VIA
             82xx bridge."
parm:        enable int array (min = 1, max = 8), description "Enable audio part
             of VIA 82xx bridge."
parm:        mpu_port long array (min = 1, max = 8), description "MPU-401 port.
             (VT82C686x only)"
<i>parm:        joystick int array (min = 1, max = 8), description "Enable
             joystick. (VT82C686x only)"</i>
parm:        ac97_clock int array (min = 1, max = 8), description "AC'97 codec 
             clock (default 48000Hz)."
parm:        dxs_support int array (min = 1, max = 8), description "Support for 
             DXS channels (0 = auto, 1 = enable, 2 = disable, 3 = 48k only, 4 = 
             no VRA)
</pre>

<p>
Hvis det har parameteren <c>joystick</c> så skal du tilføje <c>joystick=1</c> til din <c>options</c> linie i <path>/etc/modules.d/alsa</path>. F.eks.:
</p>

<pre caption="At tilføje parameteren joystick">
alias snd-card-0 snd-via82xx
options snd-via82xx joystick=1
</pre>

</body>
</section>
<section>
<title>Ressourcer</title>
<body>

<ul>
  <li><uri link="http://www.alsa-project.org">ALSA-projektet</uri></li>
  <li><uri link="http://www.djcj.org">ALSA Howto og FAQ'er</uri></li>
  <li><uri link="http://linux-sound.org/">Lyd og MIDI software til Linux</uri></li>
</ul>

</body>
</section>
</chapter>
</guide>

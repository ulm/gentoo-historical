<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/da/handbook/hb-install-mips-kernel.xml,v 1.6 2004/11/20 18:40:32 broeman Exp $ -->

<sections>

<version>1.6</version>
<date>1. September 2004</date>

<section>
<title>Tidszone</title>
<body>
  	 
<p>
Du bliver først nødt til at vælge din tidszone så. at dit system ved
hvor det er lokaliseret. Kig efter din tidszone i
<path>/usr/share/zoneinfo</path>, og lav derefter en symbolsk
henvisning til <path>/etc/localtime</path> ved brug af <c>ln</c>:
</p>
  	 
<pre caption="At sætte tidszone informationen">
# <i>ls /usr/share/zoneinfo</i>
<comment>(Hvis du vil bruge GMT)</comment>
# <i>ln -sf /usr/share/zoneinfo/GMT /etc/localtime</i>
</pre>
  	 
</body>
</section>

<section>
<title>Installation af kildekoderne</title>
<subsection>
<title>Valg af kerne</title>
<body>

<p>
Kernen omkring alle distributioner er bygget på Linux-kernen. Det er et
lag imellem bruger-programmer og dit systems hardware. Gentoo giver dens
brugere flere forskellige mulige kerne-kildekoder. En fuld liste med 
beskrivelser forefindes i <uri link="/doc/da/gentoo-kernel.xml">Gentoo 
Linux kerne vejledning</uri>. 
</p>

<p>
MIPS-baserede systemer kan vælge imellem <c>mips-sources</c> (standard 
kerne-kildekode til MIPS-arkitekturen) og <c>mips-prepatch-sources</c> 
(præ-udgivelse af kerne-træet).
</p>

<p>
Vælg din kerne-kildekode og installer den ved at bruge <c>emerge</c>. 
Selvfølgelig kan du udskifte dit valg af kildekode:
</p>

<pre caption="Installation af kerne-kildekode">
# <i>emerge mips-sources</i>
</pre>

<p>
Når du tager et kig i <path>/usr/src</path>, burde du se en genvej 
kaldet <path>linux</path>, som peger mod din kerne-kildekode:
</p>

<pre caption="Se genvej til kerne-kildekode">
# <i>ls -l /usr/src/linux</i>
lrwxrwxrwx    1 root     root           12 Oct 13 11:04 /usr/src/linux -&gt; linux-2.4.24
</pre>

<p>
Hvis det ikke er det (altså at genvejen peger mod en anden 
kerne-kildekode) skal du ændre genvejen før du fortsætter:
</p>

<pre caption="Ændring af genvejen til kerne-kildekode">
# <i>rm /usr/src/linux</i>
# <i>cd /usr/src</i>
# <i>ln -s linux-2.4.24 linux</i>
</pre>

<p>
Nu er det tid til at opsætte og kompilere din kernes kildekoderi
</p>

</body>
</subsection>
</section>
<section>
<title>Manuel opsætning</title>
<subsection>
<title>Introduktion</title>
<body>

<p>
At opsætte kernen manuelt bliver ofte anset som det sværeste, som enhver
Linux-bruger skal gå igennem. Intet er mindre rigtigt -- efter
opsætninger af nogle kerner, vil du ikke kunne huske at det var svært ;)
</p>

<p>
Én ting er dog <e>rigtigt</e>: du skal kende dit system, når du starter med at
opsætte en kerne manuelt. De fleste informationer kan blive indsamlet ved at se
på indholdet af <path>/proc/pci</path> (eller ved at bruge <c>lspci</c>, hvis 
den er tilgængelig). Du kan også køre <c>lsmod</c> for at se hvilke 
kerne-moduler, LiveCDen bruger (det vil måske give dig en god idé om hvad du 
skal aktivere).
</p>

<p>
Gå nu til kerne-kildekode mappen og udfør <c>make menuconfig</c>. Dette
vil starte en ncurses-baseret opsætningsmenu.
</p>

<pre caption="Påkalde menuconfig">
# <i>cd /usr/src/linux</i>
# <i>make menuconfig</i>
</pre>

<p>
Du vil blive hilst af flere opsætningssektioner. Vi vil først give dig
en liste af de valgmuligheder, som du skal aktivere (ellers vil Gentoo
ikke funktionere, eller funktionere ordentligt uden ekstra
finindstillinger).
</p>

</body>
</subsection>
<subsection>
<title>Aktivering af krævede valgmuligheder</title>
<body>

<p>
Først skal du aktivere brugen af udviklings- og forsøgskoder/-drivere.
Du vil få brug for dette, ellers vil meget vigtige koder/drivere ikke vise sig:
</p>

<pre caption="Valg af eksperimentielle koder/drivere">
Code maturity level options ---&gt;
  [*] Prompt for development and/or incomplete code/drivers
</pre>

<p>
Gå nu til <c>File Systems</c> og vælg understøttelse til de filsystemer, som 
du bruger.
Kompiler dem <e>ikke</e> som moduler, ellers vil dit Gentoo system ikke have 
mulighed for at montere dine partitioner. Vælg også <c>Virtual memory</c>, 
<c>/proc file system</c>, <c>/dev file system</c> og 
<c>Automatically mount at boot</c>:
</p>

<pre caption="Valg af nødvendige filsystemer">
<comment>(Med en 2.4.x kerne)</comment>
File systems ---&gt;
  [*] Virtual memory file system support (former shm fs)
  [*] /proc file system support
  [*] /dev file system support (EXPERIMENTAL)
  [*]   Automatically mount at boot
  [ ] /dev/pts file system for Unix98 PTYs

<comment>(Med en 2.6.x kerne)</comment>
File systems ---&gt;
  Pseudo Filesystems ---&gt;
    [*] /proc file system support
    [*] /dev file system support (OBSOLETE)
    [*]   Automatically mount at boot
    [*] Virtual memory file system support (former shm fs)

<comment>(Vælg en eller flere af de følgende valgmuligheder, som er nødvendige for dit system)</comment>
  &lt;*&gt; Reiserfs support
  &lt;*&gt; Ext3 journalling file system support
  &lt;*&gt; JFS filesystem support
  &lt;*&gt; Second extended fs support
  &lt;*&gt; XFS filesystem support
</pre>

<p>
Hvis du bruger PPPoE til at forbinde til Internettet eller du bruger en opkaldsmodem, vil du få brug for de følgende valgmuligheder i kernen:
</p>

<pre caption="Valg af PPPoE nødvendige drivere">
<comment>(Med en 2.4.x kerne</comment>
Network device support ---&gt;
  &lt;*&gt; PPP (point-to-point protocol) support
  &lt;*&gt;   PPP support for async serial ports
  &lt;*&gt;   PPP support for sync tty ports
<comment>(With a 2.6.x kernel)</comment>
Device Drivers ---&gt;
  Networking support ---&gt;
    &lt;*&gt; PPP (point-to-point protocol) support
    &lt;*&gt;   PPP support for async serial ports
    &lt;*&gt;   PPP support for sync tty ports
</pre>

<p>
De to kompressionsvalgmuligheder vil ikke være ubrugelige, men er slet ikke 
nødvendige, det samme med <c>PPP over Ethernet</c> valgmuligheden, som måske 
vil blive brugt af <c>rp-pppoe</c>, når den er opsat til at lave kerne-modus 
PPPoE.
</p>

<note>
Brugere af en 2.6 kerne vil finde nogle af de ovennævnte valgmuligheder under 
<c>Device Drivers</c>.
</note>

<p>
Hvis du kræver det, glem ikke at inkludere understøttelse af dit netkort
i kernen.
</p>

<p>
Hvis du bruger et Indy/Indigo2 baseret system, vil du få brug for at aktivere
understøttelse til det.
</p>

<pre caption="Aktivering af SGI IP22">
Machine selection ---&gt;
  [*] Support for SGI IP22 (Indy/Indigo2)
</pre>

<p>
Hvis du vil køre Irix binære filer, inkludér den følgende valgmulighed:
</p>

<pre caption="Inkludering af IRIX binær understøttelse">
General setup ---&gt;
  [*] Include IRIX binary compatibility
</pre>

<p>
Hvis du har ISA/EISA-kort i din SGI Indigo2, aktivér understøttelse til det.
</p>

<pre caption="Aktivering af ISA/EISA-understøttelse til SGI Indigo2">
General setup ---&gt;
  [*] Indigo-2 (IP22) EISA bus support
  [*]   ISA bus support
</pre>

<p>
Hvis du har en SGI parallel port, kan du aktivere understøttelse til den. Hvis 
du har en ISA parallel port bør du vælge "PC-style hardware" i stedet for.
</p>

<pre caption="Aktivering af SGI Parallel Port understøttelse">
Parallel port support  ---&gt;
  &lt;*&gt; Parallel port support
  &lt;*&gt;   SGI Indy/Indigo2 hardware (EXPERIMENTAL) (NEW)
  &lt;*&gt;   IEEE 1284 transfer modes (NEW)
</pre>

<p>
Hvis du vil bruge Indigo2 ISA-slots, aktivér 'plug and play' understøttelse.
</p>

<pre caption="Aktivering af PnP-understøttelse til ISA">
Plug and Play configuration  ---&gt;
  &lt;*&gt; Plug and Play support
  &lt;*&gt;   ISA Plug and Play support
</pre>

<p>
Glem ikke at aktivere SCSI-understøttelse, og brug SGI WD93C93 driveren:
</p>

<pre caption="Aktivering af WD93C93 driver-understøttelse">
SCSI low-level drivers  ---&gt;
  &lt;*&gt; SGI WD93C93 SCSI Driver
</pre>

<p>
Til netværkskort vil du sikkert gerne have understøttelse til SGI Seeq ethernet
controlleren:
</p>

<pre caption="Aktivering af SGI Seeq understøttelse">
Network device support  ---&gt;
  Ethernet (10 or 100Mbit)  ---&gt;
    [*] Ethernet (10 or 100Mbit)
    [*]   SGI Seeq ethernet controller support
</pre>

<p>
Glem ikke at aktivere seriel konsol-understøttelse og aktivere understøttelse 
til SGI Zilog85C30'en:
</p>

<pre caption="Aktivering af SGI Zilog85C30-understøttelse">
Character devices ---&gt;
  [*] Non-standard serial port support
  [*]   SGI Zilog85C30 serial support
</pre>

<p>
Glem heller ikke at aktivere Indy/I2 Watchdog-understøttelse, ligesom SGI
DS1286 RTC-understøttelse:
</p>

<pre caption="Aktivering af Watchdog og RTC Support">
Character Devices ---&gt;
  [*] SGI DS1286 RTC support
  Watchdog Cards  ---&gt;
    [*] Watchdog Timer Support
    &lt;*&gt;   Indy/I2 Hardware Watchdog
</pre>

<p>
Du bør også aktivere understøttelse til SGI partitioner :)
</p>

<pre caption="Aktivering af understøttelse til SGI partitioner">
File Systems ---&gt;
  Partition Types ---&gt;
    [*] Advanced partition selection
    [*]   SGI partition support
</pre>

<p>
Hvis du har et 'SGI Newport (XL Gfx) Card' og gerne vil bruge det, så skal du
aktivere understøttelse til det:
</p>

<pre caption="Aktivering af understøttelse til SGI Newport-kortet">
Console drivers  ---&gt;
  &lt;*&gt; SGI Newport Console support (NEW)
</pre>

<p>
Hvis du vil have lyd-understøttelse på din Indy/Indigo2, aktiver 
understøttelse til det:
</p>

<pre caption="Aktivering af understøttelse til SGI HAL2">
Sound  ---&gt;
  &lt;*&gt; Sound card support
  &lt;*&gt;   SGI HAL2 sound (EXPERIMENTAL)
</pre>

<p>
Når du er færdig med opsætte din kerne, fortsæt med <uri
link="#compiling">Kompilering og installation</uri>.
</p>

</body>
</subsection>
<subsection id="compiling">
<title>Kompilering og installation</title>
<body>

<p>
Nu da din kerne er opsat, er det tid til at kompilere og installere den. 
Afslut opsætningen (Exit) og kør <c>make dep &amp;&amp; make bzImage modules 
modules_install</c>:
</p>

<pre caption="Kompilering af kerne">
<comment>(Til x86-baserede systemer, 2.4 kerne)</comment>
# <i>make dep &amp;&amp; make bzImage modules modules_install</i>

<comment>(Til alle andre systemer, 2.4 kerne)</comment>
# <i>make dep &amp;&amp; make vmlinux modules modules_install</i>

<comment>(Til 2.6 kernen)</comment>
# <i>make &amp;&amp; make modules_install</i>
</pre>

<p>
Når kernen er færdig med at kompilere, kopier den da over til
<path>/boot</path>.
</p>

<pre caption="Installation af kerne">
# <i>cp vmlinux /boot/kernel-2.4.24</i>
# <i>cp System.map /boot/System.map-2.4.24</i>
</pre>

<p>
Det er også klogt at kopiere din kerneopsætningsfil til
<path>/boot</path>, bare for en sikkerheds skyld :)
</p>

<pre caption="Backup af din kerneopsætning">
# <i>cp .config /boot/config-2.4.25</i>
</pre>

<p>
Hvis dit system ikke vil starte ELF-kerner, kompiler
kernen ved brug af <c>make vmlinux.ecoff</c> i stedet for <c>make vmlinux</c>.
Kerne-billedfilen vil blive gemt som <path>arch/mips/boot/vmlinux.ecoff</path> 
i stedet for <path>vmlinux</path>.
</p>

<p>
Fortsæt nu med <uri link="#kernel_modules">Installation af separate
kernemoduler</uri>.
</p>

</body>
</subsection>
</section>
<section>
<title>Installation af separate kernemoduler</title>
<subsection>
<title>Opsætning af moduler</title>
<body>

<p>
Du bør opliste de moduler, som du vil have automatisk hentet, i <path>/etc/modules.autoload.d/kernel-2.4</path> (eller <path>kernel-2.6</path>). Du kan også tilføje ekstra valgmuligheder til modulerne, hvis du vil.
</p>

<p>
For at se alle de tilgængelige moduler, kør følgende <c>find</c>-kommando. Glem ikke
at udskifte "&lt;kernel version&gt;" med den version af kernen, du lige
har kompileret:
</p>

<pre caption="Se alle mulige moduler">
# <i>find /lib/modules/&lt;kernel version&gt;/ -type f -iname '*.o' -or -iname '*.ko'</i>
</pre>

<p>
For automatisk at hente f.eks <c>3c59x.o</c> modulet, skal du ændre
<path>kernel-2.4</path> eller <path>kernel-2.6</path> filen og skrive
modulnavnet i den.
</p>

<pre caption="At redigere /etc/modules.autoload.d/kernel-2.4">
<comment>(Eksempel for 2.4 kerner)</comment>
# <i>nano -w /etc/modules.autoload.d/kernel-2.4</i>
</pre>

<pre caption="/etc/modules.autoload.d/kernel-2.4 eller kernel-2.6">
3c59x
</pre>

<p>
Kør nu <c>modules-update</c> for at overgive dine ændringer til
<path>/etc/modules.conf</path> filen:
</p>

<pre caption="Start af modules-update">
# <i>modules-update</i>
</pre>

<p>
Fortsæt installationen med <uri link="?part=1&amp;chap=8">Opsætning af
dit system</uri>.
</p>

</body>
</subsection>
</section>
</sections>

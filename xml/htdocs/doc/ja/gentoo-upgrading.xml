<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!--
 $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ja/gentoo-upgrading.xml,v 1.2 2006/05/02 12:57:07 idani Exp $ 
-->
<guide link="/doc/ja/gentoo-upgrading.xml" lang="ja">
<title>Gentoo アップグレーディング ガイド</title>

<author title="Author">
  <mail link="g.guidi@gentoo.org">Gregorio Guidi</mail>
</author>
<author title="翻訳">
   <mail link="kminoru@jaist.ac.jp">木ノ下 稔</mail>
</author>
<author title="翻訳">
   <mail link="idani@gentoo.org">飴谷 茂寛</mail>
</author>
<author title="翻訳">
   <mail link="shindo@gentoo.gr.jp">しんどうなおあき</mail>
</author>


<abstract>
このドキュメントは、新しい Gentoo のリリースが既存のシステムにどのような影響を及ぼすかの説明です。
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>2.2</version>
<date>2006-02-12</date>
<!-- Original revision: 1.29 -->

<chapter>
<title>Gentoo と アップグレード</title>

<section>
<title>理念</title>


<body>

<p>
ここはGentooの世界、アップグレードの考え方は他のLinuxの世界と比べてまったく違います。
すでに御存じかもしれませんが、私達は、新しいリリースを待ち、
リリース版をダウンロードして、焼いて、CD-ROMドライブにセットして、
そしてアップグレード手順に従うような「伝統的」なソフトウェアアップグレードの方法を採用していません。
</p>

<p>
常に最新の環境でいたいパワーユーザにとって、
この手続きは非常にイライラするものだというのは
(なんといってもGentooユーザーであれば)お分かりになると思います。

素早くそして頻繁にアップデートができるaptやapt-rpmのような、
評判があり普及しているツールを考えると
他のディストリビューション出身のパワーユーザでさえ、たぶん同じ考えだと思います。

しかし、要望多いこうしたユーザを満足させるのにGenooよりも適したディストリビューションはありません。
なぜなら、当初より、Gentooは差分を更新するという考え方で設計されたからです。
</p>

<p>
理想としては、あなたは一度だけインストールし、そしてリリースによる苦労をしないことです。
<uri link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=1">A Portage
Introduction</uri><uri link="/doc/ja/handbook/handbook-x86.xml?part=2&amp;chap=1">(日本語訳)</uri> や<uri link="/doc/en/handbook/">Gentoo Handbook</uri><uri link="/doc/ja/handbook/">(日本語訳)</uri>の指示に従うだけでよく、
どのようにしてあなたのシステムを最新に保つかを説明しています。
普通はそれでうまくいくのですが、たまに、アップデートが必要なコアシステムへ手動設定を行います。
</p>

</body>
</section>
<section>
<title>リリースとプロファイル</title>
<body>


<p>
Gentooのリリースプロセスについて
"もし、ユーザにソフトウェアアップデートをさせることを目的としないなら、なぜ新しいリリースがたびたび提供されるのでしょうか？"
という質問が繰り返しされます。
それには、さまざまな理由があります。
</p>

<ul>
  <li>
    新しいリリースは、バグ修正と機能追加を施したインストールCDを意味します
  </li>
  <li>
    新しいリリースはアップデートされたGRPパッケージを提供し、
    それ故、ユーザにインストールへの近道(stage3 + コンパイル済のパッケージ)を選択して、最新のシステムを手に入れます。
  </li>
  <li>
  最後に、新しいリリースはときどき前リリースと互換性のないいくつかの機能を実装するかもしれません。
  </li>
</ul>

<p>
リリースが新しい互換性のない機能、またはコアパッケージのセットの提供、システムの動作の大きな修正を含む時、
私達はそれは新しい<e>プロファイル</e>を提供すると言います。
</p>


<p>
ここで言う<e>プロファイル</e>は設定ファイルの集まりで<path>/usr/portage/profiles</path>のサブディレクトリに保管され、
そこには、例えばシステムパッケージとみなされるebuild、
デフォルトのUSEフラグ、ヴァーチャルパッケージのためのデフォルトのマッピング、
そして、稼働するシステムのアーキテクチャが記述されています。
</p>

<p>
使用されるプロファイルは、プロファイルが保存される
<path>/usr/portage/profiles</path>
のサブディレクトリを指す
<path>/etc/make.profile</path>
のシンボリックリンクにより決定されます。
例えば、デフォルトのx86 2005.1 のプロファイルは
<path>/usr/portage/profiles/default-linux/x86/2005.1</path>
で見つかります。
親ディレクトリにあるファイルはプロファイルの一部にもなっています
(そのため、複数の異なるサブプロファイルから共有されます。)
そのため、これらを<e>カスケードプロファイル</e>と呼んでいます。
</p>

<p>
新しいプロファイルによって古くなったプロファイルは<path>/usr/portage/profiles</path>の中に現在のものと共に保管されていますが、
非推奨としてマークされます。
そうした場合、<path>depricated</path>と名前がつけられたファイルがプロファイルディレクトリに置かれます。
このファイルの中身はアップグレードの必要があるプロファイル名になっています。
portageは新しいプロファイルに更新しなければいけないときに、自動的に警告するためにこの情報を使います。
</p>

<p>
新しいプロファイルが作られるのには様々な理由があります。
その理由は、新コアパッケージ(例えば <c>baselayout</c>や<c>gcc</c>、
<c>glibc</c>)に前バージョンとの互換性がない場合や
デフォルトUSEフラグやバーチャルマッピングの変更、
システム全体の設定の変更の場合もありえます。
</p>

</body>
</section>
</chapter>

<chapter>
<title>最新リリースの状態に保つ</title>

<section>
<title>プロファイルを変更しないリリース</title>
<body>

<p>
もし、新たなプロファイルが含まれない新しいGentooリリースがアナウンスされても、
それがなかったことにできます:)。
</p>

<p>
もし、あなたが<uri link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=1"> Gentoo Handbookの中で説明した通り</uri><uri link="/doc/ja/handbook/handbook-x86.xml?part=2&amp;chap=1">(日本語訳)</uri>、インストールしたパッケージを更新するなら、
あなたのシステムは新しいリリースを使ってインストールされた状態とまったく同じになるでしょう。
</p>

</body>
</section>

<section>
<title>プロファイルの変更を含むリリース</title>
<body>


<p>
もし、リリース(x86の2005.1のように)に新しいプロファイルが導入されたら、
新しいプロファイルを選択して移行することもできます。
</p>


<p>
もちろん、無理にそれをしなくてもかまいません。あなたは古いプロファイルを使い続けることもできます。
そして当然、<uri link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=1">Gentoo Handbookの説明のように</uri><uri link="/doc/ja/handbook/handbook-x86.xml?part=2&amp;chap=1">(日本語訳)</uri>、パッケージを更新できます。
</p>


<p>
しかし、それが非推奨になるときは、Gentooはプロファイルの更新を強く推奨します。
(あなたの使用するプロファイルが)非推奨になった場合、それはGentoo開発者達がもはやそれをサポートする計画がない事を意味します。
以下の表により現在サポートされているプロファイルは何かを素早くチェックできます。
</p>

<p>
もし、新しいプロファイルに移行することを決めたならば、手動で更新を実行しなければいけません。
更新の道のりはリリースによって著しく異なるかもしれません。
それは、新しいプロファイルに取り入れられる変更の程度によります。
</p>

<p>
もっとも単純な場合、<path>/etc/make.profile</path>のシンボリックリンクを変更するだけです。
もっとも最悪な場合は、かっこいいvoodooダンスを踊りながら、
システムを一から再コンパイルしなければいけないかもしれません。
普通、移行はリリースノートに記載されています。
あなたはこのガイドの最後の<uri link="#instructions">更新の手引</uri>にも見つけることができます。
</p>

</body>
</section>

<section>
<title>サポートされているプロファイル</title>
<body>


<p>
次のプロファイルはGentooの開発者によって公式にサポートされています。
</p>

<table>
<tr>
  <th>アーキテクチャ</th>
  <th>もっとも最近のプロファイル</th>
  <th>他にサポートされたプロファイル</th>
</tr>
<tr>
  <th>alpha</th>
  <ti>2005.0, 2005.0/2.4</ti>
  <ti></ti>
</tr>
<tr>
  <th>arm</th>
  <ti>2004.3</ti>
  <ti></ti>
</tr>
<tr>
  <th>amd64</th>
  <ti>2005.1, 2005.1/no-multilib</ti>
  <ti>2005.0, 2005.0/no-multilib, 2004.3</ti>
</tr>
<tr>
  <th>hppa</th>
  <ti>2005.0, 2005.0/2.4</ti>
  <ti>2004.3, 2004.2</ti>
</tr>
<tr>
  <th>ia64</th>
  <ti>2005.0</ti>
  <ti>2004.3</ti>
</tr>
<tr>
  <th>ppc</th>
  <ti>2005.1</ti>
  <ti>2005.0, 2004.3, 2004.0</ti>
</tr>
<tr>
  <th>mips</th>
  <ti>2005.0</ti>
  <ti>2004.2</ti>
</tr>
<tr>
  <th>s390</th>
  <ti>2004.3</ti>
  <ti></ti>
</tr>
<tr>
  <th>sparc</th>
  <ti>2005.1</ti>
  <ti>2005.0</ti>
</tr>
<tr>
  <th>x86</th>
  <ti>2005.1, 2005.1/2.4</ti>
  <ti>2005.0, 2005.0/2.4</ti>
</tr>
</table>

</body>
</section>
</chapter>

<chapter id="instructions">
<title>プロファイル更新の手引</title>
<section>
<title>2005.1への更新</title>
<body>

<p>
2005.1 プロファイルに変更するためには、<path>/etc/make.profile</path>
シンボリックリンクを新しい場所へ向けてください。
また、プロファイルを変更する前にPortageがアップデートされていることを確認してください。
</p>

<pre caption="2005.1プロファイルへの変更">
# <i>rm /etc/make.profile</i>
# <i>ln -s ../usr/portage/profiles/</i>&lt;selected profile&gt;<i> /etc/make.profile</i>
</pre>

<p>
<b>全てのarch</b> - このプロファイルには基本的な変更はありません。
特に行わなければいけないことはありません。
</p>

<p>
<b>ppc</b> - 2005.1リリースで、ppcとppc64プロファイルは統合され
特定のサブアーキテクチャ向けのサブプロファイルが作成されました。
2005.1プロファイルへ移行するときはシステムに対応する正しいサブプロファイルを確実に選んでください。
</p>

</body>
</section>
<section>
<title>2005.0への更新</title>
<body>

<p>
2005.0の手引きでは、いくつかのアーキテクチャで追加のプロファイル定義が決定されています。
移行を決定する前にプロファイルの説明を確認してください。
ほとんどのアーキテクチャは、以前2.4が選択されていましたが、現在では
2.6カーネルツリーもデフォルトになっています。
</p>

<p>
あるアーキテクチャでは別なプロファイルに完全に切替えるためには、やや作業が必要です。
そういった場合の段階的な手順が次の表にあります。
</p>

<table>
<tr>
  <th>プロファイル</th>
  <th>説明</th>
  <th>特定のアップグレードガイド</th>
</tr>
<tr>
  <ti>default-linux/alpha/2005.0</ti>
  <ti>カーネル2.6用デフォルト Alpha 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/alpha/2005.0/2.4</ti>
  <ti>カーネル2.4用Alpha 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/amd64/2005.0</ti>
  <ti>カーネル2.6用デフォルト AMD64 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/amd64/2005.0/no-multilib</ti>
  <ti>multilibが無効になっているシステム導入用AMD64 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/arm/2005.0</ti>
  <ti>カーネル2.6用デフォルト ARM 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/hppa/2005.0</ti>
  <ti>カーネル2.6用デフォルト HPPA 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/hppa/2005.0/2.4</ti>
  <ti>カーネル2.4用HPPA 2005.0プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/mips/2005.0</ti>
  <ti>デフォルト MIPS 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/mips/cobalt/2005.0</ti>
  <ti>Cobalt 専用MIPS 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/mips/mips64/n32/2005.0</ti>
  <ti>n32-サポート MIPSプラットフォーム用 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/mips/mips64/ip28/2005.0</ti>
  <ti>Indigo2 Impact 専用64bit 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/mips/mips64/2005.0</ti>
  <ti>64-bit MIPS 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/ppc/2005.0</ti>
  <ti>カーネル2.6用デフォルト PPC 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/ppc64/2005.0</ti>
  <ti>カーネル2.6用デフォルト PPC64 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/s390/2005.0</ti>
  <ti>デフォルト S390 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/sparc/sparc32/2005.0</ti>
  <ti>デフォルト Sparc 32ビット 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<!-- http://dev.gentoo.org/~dsd/kernel-2.6.htm 
     No subprofiles for sparc
<tr>
  <ti>default-linux/sparc/sparc32/2005.0/2.6</ti>
  <ti>カーネル2.6 用Sparc 32ビット 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
-->
<tr>
  <ti>default-linux/sparc/sparc64/2005.0</ti>
  <ti>Default Sparc 64ビット 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<!-- http://dev.gentoo.org/~dsd/kernel-2.6.htm
     No subprofiles for sparc
<tr>
  <ti>default-linux/sparc/sparc64/2005.0/2.6</ti>
  <ti>カーネル2.6用 Sparc 64ビット 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
-->
<tr>
  <ti>default-linux/x86/2005.0</ti>
  <ti>カーネル2.6用デフォルト x86 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
<tr>
  <ti>default-linux/x86/2005.0/2.4</ti>
  <ti>カーネル2.4用 x86 2005.0 プロファイル</ti>
  <ti></ti>
</tr>
</table>

<p>
選択されたプロファイルに変えるには、<path>/etc/make.profile</path>シンボリックリンクを新しい場所に向けてください。
また、プロファイルを変更する前に確実にPortageをアップデートしてください!
</p>

<pre caption="2005.0への変更">
# <i>rm /etc/make.profile</i>
# <i>ln -s ../usr/portage/profiles/</i>&lt;selected profile&gt;<i> /etc/make.profile</i>
</pre>

<p>
もし、Linux2.4ベースシステムで稼働しているシステムを2.6ベースに移行したい場合は
<uri link="/doc/en/migration-to-2.6.xml">Gentoo Linux 2.6 Migration Guide</uri>
(<uri link="/doc/ja/migration-to-2.6.xml">日本語訳</uri>)を確認してください。
</p>
</body>
</section>

<section>
<title>2004.3への更新</title>
<body>


<p>
2004.3のプロファイルの導入の手引において、ユーザは膨大な修正をすることはないでしょう(詳細は以下を参照してください)。
しかし、Gentoo開発者達は<e>stacked profiles</e>の普及を促進させるために、
新しいプロファイルを推奨し、かなり多くの古いプロファイルを除くことを決めました。
このプロファイルは、<path>/usr/portage/profiles</path>ディレクトリに新しく配置され追従します。
例えば、(Portage 2.0.51か、それ以降でサポートされている)<path>/usr/portage/profiles/default-linux/x86/2004.3</path>のような配置です。
</p>

<p>
2004.3のプロファイルへの変更のため、<path>/etc/make.profile</path>シンボリックリンクを新しい場所へ向けてください
</p>

<warn>
プロファイルを変更する<e>前に</e>Portageをアップグレードすることを忘れないでください!!!
</warn>

<pre caption="/etc/make.profile のシンボリックリンクの更新">
<comment>&lt;arch&gt; をあなたのアーキテクチャに合わせて置き換えてください。</comment>
# <i>rm /etc/make.profile</i>
# <i>ln -s ../usr/portage/profiles/default-linux/&lt;arch&gt;/2004.3 /etc/make.profile</i>
</pre>

<p>
<b>すべてのアーキテクチャ</b> - 上記の通り、今回のプロファイル中に大きな変更はありません。
しかし、<c>sys-apps/slocate</c> と <c>net-misc/dhcpcd</c>はシステムパッケージと見なされていないということを憶えておきましょう
これはあなたが<c>emerge --depclean</c>を実行した時、
Portageはあなたのシステムからこれらを削除しようすることを意味します。
もし、あなたがこれらパッケージのどれかが必要なら、
プロファイルを切替えた後<path>/var/lib/portage/world</path>に加えるか、手動でそれらをemergeを実行します。
</p>

<p>
<b>ppc</b> - ppcでは、新しくインストールされたマシンから<c>sys-fs/udev</c> は <c>sys-fs/devfs</c>の代わりのデフォルトになります。
これは既にインストールされているマシンには影響しないでしょう。そのため、自分で切替える必要があります。
</p>

</body>
</section>

<section>
<title>カスケードプロファイルをサポートするようPortageをアップデートする</title>
<body>

<p>
このアップグレードガイドのなかでは、当セクションは流れにそぐわないよう見えるかもしれませんが、非常に重要です。
上にあげたプロファイルではPortageはカスケードプロファイルをサポートする必要があります。
しかし、古いプロファイルやPortageが更新できないことがあったり、
もはや通用しないプロファイルをずっと使っているユーザーではどのようにやってもPortageの更新に失敗してしまいます。
</p>

<p>
この問題を回避するためには、ユーザーは一時的に<e>古くなった</e>プロファイルにシンボリックリンクをはり、
このガイドにかかれたアップグレード手順を続行できるPortageにアップグレードすることができます。
<c>&lt;arch&gt;</c>をそれぞれのアーキテクチャにかえてください。
</p>

<pre caption="古いプロファイルを通してのPortage更新">
# <i>rm /etc/make.profile</i>
# <i>cd /etc</i>
# <i>ln -sf ../usr/portage/profiles/obsolete/&lt;arch&gt; make.profile</i>
# <i>emerge -n '>=sys-apps/portage-2.0.51'</i>
</pre>
</body>
</section>

<section>
<title>2004.2への更新</title>
<body>

<p>
2004.2のプロファイルへの変更のため、<path>/etc/make.profile</path>のシンボリックリンクを新しい場所へ指すように修正しましょう。
</p>

<warn>
 あなたのプロファイルを変更する<e>前に</e>Portageをアップグレードすることを忘れないでください!!!
</warn>

<pre caption="/etc/make.profileのシンボリックリンクの更新">
<comment> &lt;arch&gt; をあなたのアーキテクチャに合わせて置き換えてください。</comment>
# <i>rm /etc/make.profile</i>
# <i>ln -s ../usr/portage/profiles/default-linux/&lt;arch&gt;/2004.2 /etc/make.profile</i>
</pre>

<p>
<b>x86</b> - x86では、このプロファイルのデフォルトのx11は<c>x11-base/xfree</c> から <c>x11-base/xorg-x11</c>に変更になりました。
この変更は<e>default</e>の値のみで、
まだX 関連をインストールしていない場合のみ関係しています。
もし、既にインストールしてるなら、影響はないでしょう、
つまり、従来のように、あるX サーバから他のサーバへと自由に切替えられます。
</p>


<p>
<b>amd64</b> - 前のプロファイルからの基本的な変更はありません。そのため、特別な作業を行う必要はありません。
</p>

</body>
</section>

<section>
<title>2004.0への更新</title>
<body>

<p>
2004.0 のプロファイルへの変更のため、<path>/etc/make.profile</path>シンボリックリンクを新しい場所へ指すように修正しましょう。
</p>

<pre caption="/etc/make.profile シンボリックリンクの更新">
<comment> &lt;arch&gt; をあなたのアーキテクチャに合わせて置き換えてください。</comment>
# <i>rm /etc/make.profile</i>
# <i>ln -s ../usr/portage/profiles/default-&lt;arch&gt;-2004.0 /etc/make.profile</i>
</pre>

<p>
<b>すべてのアーキテクチャ</b> - 前のプロファイルからの基本的な変更はありません。そのため、特別な作業を行う必要はありません。
</p>

</body>
</section>

<section>
<title>1.4より古いプロファイルから1.4への更新</title>
<body>

<p>
このアップグレードの説明はかなり複雑です。
あなたは<uri link="/doc/en/new-upgrade-to-gentoo-1.4.xml">ここに
</uri><uri link="/doc/ja/new-upgrade-to-gentoo-1.4.xml">(日本語訳)</uri>アップグレードの手順があります。
</p>

</body>
</section>
</chapter>

</guide>


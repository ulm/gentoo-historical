<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/ja/gentoolkit.xml">
<title>Gentoolkit</title>
<author title="Author"><mail link="mbutcher@aleph-null.tv">
Matt Butcher</mail>
</author>
<author title="翻訳"><mail link="shindo-n@zephyr.dti.ne.jp">
シンドウ</mail>
</author>

<author title="Editor"><mail link="zhen@gentoo.org">John P. Davis</mail></author>
<!-- Licensed under GFDL -->

<abstract>
	Gentoolkit は Gentoo システム管理をしやすくする都合のよいツー
	ル類です。このドキュメントは現在 Gentoolkit にあるツールの基本
	的なことがらをカバーします。
</abstract>

<version>1.1</version>
<date>25 September 2002</date>
<!-- Original revision: 1.3 -->

<chapter>
	<title>イントロダクション</title>
	<section>
		<title>Gentoolkit とは何か?</title>
		<body>
			<p>Gentoo は他に例のない(unique)なディストリ
			ビューションであり、他のディストリビューション
			にはない複雑さがあります。Gentoo の開発者たち
			とコントリビューターたちがこれらの複雑さを見つ
			け、彼らはその複雑さに伴うユーザーと管理者の労
			力を軽減しようとツール類を開発しました。これら
			多くのツール類は Gentoo プロジェクトに寄与され、
			<path>app-admin/gentoolkit</path> に含まれてい
			ます。</p>

			<p>Gentoolkit には Portage と ebuild アーキテ
			クチャの管理に役立つたくさんの有用なツール類が
			入っています。ほとんどのユーザー -- 特にシステ
			ムを頻繁にアップデートするような人 -- にとって、
			gentoolkit をインストールすることで恩恵を受け
			られるでしょう。</p>
		</body>
	</section>
	<section>
		<title>インストール</title>
		<body>
			<p>ほかのどの Gentoo パッケージと全く同じよう
			に、インストール方法は単純な emerge です。</p>

			<pre>
<i>emerge gentoolkit </i>
			</pre>
			<note>gentoolkit のツール類の多くはあな
			たのシステムの重要情報を明らかにしたり、root 
			権限を要求します。そのため、root 権限をもつユー
			ザーに起動されたときのみ、いくつかのプログラム
			は実行されます。(もしくは、そのときのみ適切に機能
			します。)。</note>
		</body>
	</section>
	<section>
		<title>ドキュメントの発見</title>
		<body>

			<p>これを書いているときでは、gentoolkit にある
			プログラムのすべてに適切なドキュメントはありま
			せん。あるものは man ページがありますが、すべ
			てにはありません。プログラムが(man ページとは
			別に)持っているかもしれないドキュメント類は全
			て
			<path>/usr/doc/gentookit-[version]/[program-name]/</path> 
			以下に置かれています。</p>
		</body>
	</section>
</chapter>
<chapter>
	<title>qpkg でのパッケージ情報問い合わせ</title>
	<section>

		<title>序</title>
		<body>
			<p><c>qpkg</c> は ebuild がインストールされて
			いるかどうかについての情報を確定するための柔軟
			なツールです。qpkg は同じパッケージの複数バー
			ジョンがインストールされていたとしても、ファイ
			ルが何の ebuld に含まれているか、そして、ある
			特定の ebuild の動作についての情報を提供するこ
			とができます。</p>

			<p><c>qpkg</c> を引数なしで呼び出すことで、す
			べての ebuild のリストが表示され、パッケージの
			後ろにアスタリスク(*)付のものがシステムにイン
			ストールされたものです。</p>

			<note> デフォルトでは、<c>qpgk</c> はカラー
			の表示をします。カラーをオフにするにはコマンドラ
			インで <c>--no-color</c> もしくは <c>-nc</c> 
			フラグを使います。</note>
		</body>
	</section>
	<section>
		<title>パッケージ情報の問い合わせ</title>
		<body>
			<p>もっとも一般的な <c>qpkg</c> の使い方の一つ
			は与えられたパッケージが何かを確定することであ
			る。たとえば、<path>net-misc</path> にざっと目
			を通すと、<path>neon</path> と呼ばれるパッケー
			ジを見つけました。それがどういったものなのか分
			からなかったので、qpkg を起動しました。
			</p>

			<pre> 
hebron root # <i>qpkg -i net-misc/neon
net-misc/neon-0.15.3-r1
       HTTP and WebDAV client library [ http://www.webdav.org/neon ]
net-misc/neon-0.18.5
       HTTP and WebDAV client library [ http://www.webdav.org/neon ]
net-misc/neon-0.19.2
       HTTP and WebDAV client library [ http://www.webdav.org/neon ]
net-misc/neon-0.19.2-r1
       HTTP and WebDAV client library [ http://www.webdav.org/neon ]
net-misc/neon-0.21.1
       HTTP and WebDAV client library [ http://www.webdav.org/neon ] </i>
			</pre>
			<p><c>qpkg</c> は5つの net-misc/neon ebuild に対して 
			ebuild ファイルを通して読み込み、そして 
			DESCRIPTION と HOMEPAGE にある情報を出力します。
			</p>
		</body>

	</section>
	<section>
		<title>一つの ebuild にあるファイルのリスト</title>
		<body>
			<p><c>qpkg</c> はインストールされた ebuild に
			属しているファイルをリストすることもできます。
			私はgentoolkit がいくつかのツールをインストー
			ルしたのは知っていますが、それらのすべてが何で
			あるかを知っているわけではありません。<c>qpgk
			-l</c> で調べることができます。</p>

			<pre> 
hebron portage # <i>qpkg -l app-admin/gentoolkit
app-admin/gentoolkit-0.1.14-r1 *
CONTENTS:
/usr
/usr/share
/usr/share/gentoolkit
/usr/share/gentoolkit/histogram.awk
/usr/share/doc
/usr/share/doc/gentoolkit-0.1.14-r1
/usr/share/doc/gentoolkit-0.1.14-r1/gentool
/usr/share/doc/gentoolkit-0.1.14-r1/gentool/ChangeLog.gz
/usr/share/doc/gentoolkit-0.1.14-r1/lintool
/usr/share/doc/gentoolkit-0.1.14-r1/lintool/checklist-for-ebuilds.gz
/usr/share/doc/gentoolkit-0.1.14-r1/lintool/ChangeLog.gz
/usr/share/doc/gentoolkit-0.1.14-r1/etc-update
/usr/share/doc/gentoolkit-0.1.14-r1/etc-update/ChangeLog.gz
/usr/share/man
/usr/share/man/man1
/usr/share/man/man1/qpkg.1.gz
/usr/share/man/man1/lintool.1.gz
/usr/share/man/man1/etc-update.1.gz
/usr/bin
/usr/bin/gentool-bump-revision
/usr/bin/gentool-total-coverage
/usr/bin/gentool-author-coverage
/usr/bin/gentool-package-count
/usr/bin/qpkg
/usr/bin/pkg-size
/usr/bin/lintool
/usr/sbin
/usr/sbin/pkg-clean
/usr/sbin/mkebuild
/usr/sbin/emerge-webrsync
/usr/sbin/epm
/usr/sbin/etc-update
/etc
/etc/etc-update.conf </i>
			</pre>
		</body>
	</section>
	<section>
		<title>あるファイルがどのパッケージに由来するか調べること</title>
		<body>

			<p>あるファイルがどのパッケージに由来するか調
				べるためには、<c>-f</c>か 
				<c>--fine-file</c> フラグを使います。
			</p>
			<pre>
				hebron portage # <i>qpkg -f	net-www/mozilla * </i>
			</pre>

		</body>
	</section>
	<section>
		<title>二重パッケージをリストする</title>
		<body>
			<p>ときおり、同じパッケージで複数のバージョン
			が存在することがあるかもしれません。<c>qpkg
			-dup</c> は二重パッケージのリストを出力します。
			しかしながら二重バージョンの存在は古いバージョ
			ンが取り除かれたことを示すわけではありません。それら
			は異なるスロットを満たしているかも知れません。同
			じスロットで重複を探すには <c>qpkg --dups
			--slots</c> を使います。私は、丁度 KDE 3.0 を 
			3.0.2 にアップデートしたところです、そして同じス
			ロットにいくつかの重複があります。
			</p>

			<pre> 
hebron portage # <i>qpkg --dups --slot 
app-admin/gentoolkit
kde-base/kdeaddons
kde-base/kdeadmin
kde-base/kdeartwork
kde-base/kdebase
kde-base/kdegames
kde-base/kdelibs
kde-base/kdemultimedia
kde-base/kdenetwork
kde-base/kdetoys
kde-base/kdeutils
media-libs/freetype
x11-libs/qt </i>
			</pre>
		</body>
	</section>
	<section>
		<title>パッケージの完全性の検証</title>

		<body>
			<p>ファイルがインストールされてから消去されて
			いないことを知るために、ときおりパッケージの完
			全性をチェックすることは有用です。qpkg は パッケー
			ジのファイルが古くなったり、移動したり、消去さ
			れたとしても、インストール回数だけでなく md5
			sum も検証することができます。</p>

			<p>mtime と md5 sum をチェックするためには
			<c>-c</c> フラグを使います。</p>
			<pre>

hebron portage # <i>qpkg gnupg -c -v    
app-crypt/gnupg-1.0.6 *
/usr/lib/gnupg/rndunix !md5! !mtime!
/usr/lib/gnupg/rndegd !md5! !mtime!
/usr/lib/gnupg/tiger !md5! !mtime!
/usr/bin/gpg !md5! !mtime!
/usr/bin/gpgv !md5! !mtime!
/usr/share/gnupg/options.skel !md5! !mtime!
/usr/share/gnupg/FAQ !md5! !mtime!
/usr/share/gnupg/faq.html !md5! !mtime!
/usr/share/locale/da/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/de/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/eo/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/et/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/fr/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/id/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/it/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/ja/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/nl/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/pl/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/pt_BR/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/sv/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/locale/tr/LC_MESSAGES/gnupg.mo !md5! !mtime!
/usr/share/info/gpgv.info.gz !md5! !mtime!
/usr/share/man/man1/gpg.1.gz !md5! !mtime!
/usr/share/man/man1/gpgv.1.gz !md5! !mtime!
24/92

app-crypt/gnupg-1.0.7 *
0/101 </i>
			</pre>
			<p>見た通り、私は一つ以上 GnuPG のバージョンを
			インストールしてきました。<c>qpkg</c> は私がイ
			ンストールして以降、古いバージョンからのファイ
			ルの大部分が変えられたことを報告しています。こ
			れらのパッケージの多くは、おそらく、
			<path>gnupg-1.0.6</path> から 
			<path>gnupg-1.0.7</path> にアップデートしたときに
			変更されたのでしょう。最後の2行は私がインストー
			ルして以来 <c>gnupg-1.0.7</c>から 101 個のファ
			イルのうち 0 個のファイルが変えられたことを示
			していることに注意しておきます。これは良いこと
			で、もしそれらのうち一つでも変わっていたら、私
			は心配になったでしょう。</p>

		</body>
	</section>
	<section>
		<title>でも待って、もうすこし。</title>
		<body>
			<p><c>qpkg</c> はここで私が触れないであろう、
			他の問い合わせタスクにも使われます。<c>qpkg</c> 
			にはとても完成された manpage があります。より
			多くの情報に関してはそこを参照してください。
			</p>
		</body>
	</section>
</chapter>
<chapter>
	<title>lintool</title>
	<section>
		<title>序</title>
		<body>
			<p><c>lintool</c> は ebuild スクリプトが標準と
			必要条件に従っているかチェックするプログラムで
			す。ebuild 開発者にとっては <c>lintool</c> を
			使うことは正しい手順であるか、そして Gentoo の
			中核チームが ebuild を Gentoo リポジトリーに含
			めるためにすでに行ってきたこと以上のことを要求
			しないために重要です。</p>
		</body>
	</section>
	<section>
		<title>使用</title>

		<body>
			<p><c>lintool</c> を実行することで、きちんと整
			えられたチェックリストとチェックした結果が出力
			されます。</p>

			<pre> 
hebron portage # <i>lintool app-crypt/gnupg/gnupg-1.0.7.ebuild 
app-crypt/gnupg/gnupg-1.0.7.ebuild                                     : Not OK

-------------------------------------------------------------------------------
 Summary for all 1 ebuild(s) checked                             # errors/warns
 -------------------------------------------------------------------------------
 Testing for illegal space characters, weird backslash formatting  : 0 / 0
 Testing for malformed headers                                     : 0 / 1
 Testing for occurence of deprecated try                           : 0 / 0
 Testing for superfluous A=${P}.tar.gz                             : 0 / 0
 Testing for empty DEPEND                                          : 0 / 0
 Testing for empty HOMEPAGE                                        : 0 / 0
 Testing for empty DESCRIPTION                                     : 0 / 0
 Testing for presence of env vars                                  : 1 / 1
 Testing for sane USE flag usage                                   : 0 / 0

 Total number of ebuilds with errors                               : 1 (100%)
 Total number of ebuilds with warnings                             : 1 (100%)
		</i>	</pre>
			<p>

				最初のラインは ebuild が OK かどうかの
				まとめです。<c>gnupg-1.0.7</c> の場合
				では、OK にはなっていません。チェック
				項目をみていくと、malformed headers
				(おかしなヘッダー)と presence of env
				vars (env 設定の有り無し) にエラーが出
				ているのが分かります。
			</p>

			<p>

				ebuild を見てみると、要求されている 
				env vars(LICENSE と RDEPEND)がないこと
				がわかります。これらを付け足してエラー
				を直します。しかし、なおも二つの警告が
				でています-- 一つは malformed headers
				(おかしなヘッダー)と env val です。こ
				れらのエラーを見つけるのを助けるために、
				<c>lintoo</c> に <c>--show-details</c> 
				をつけて再度実行します。
			</p>
			<pre> 
hebron gnupg # <i>lintool --show-details ./gnupg-1.0.7.ebuild 
                                
-------------------------------------------------------------------------------
# Some data cut for brevity....

 Status for ./gnupg-1.0.7.ebuild
* Testing for malformed headers                                         : passed
- (W) Has illegal or suspect headers:
 |Suspect copyright year: # Copyright 1999-2000 Gentoo Technologies, Inc.
 * Testing for occurence of deprecated try                               : passed
 * Testing for superfluous A=${P}.tar.gz                                 : passed
 * Testing for empty DEPEND                                              : passed
 * Testing for empty HOMEPAGE                                            : passed
 * Testing for empty DESCRIPTION                                         : passed
 * Testing for presence of env vars                                      : passed
 - (W) Missing SLOT=
 * Testing for sane USE flag usage                                       : passed

 -------------------------------------------------------------------------------
  Summary for all 1 ebuild(s) checked                             # errors/warns
  -------------------------------------------------------------------------------
  Testing for illegal space characters, weird backslash formatting  : 0 / 0
  Testing for malformed headers                                     : 0 / 1
  Testing for occurence of deprecated try                           : 0 / 0
  Testing for superfluous A=${P}.tar.gz                             : 0 / 0
  Testing for empty DEPEND                                          : 0 / 0
  Testing for empty HOMEPAGE                                        : 0 / 0
  Testing for empty DESCRIPTION                                     : 0 / 0
  Testing for presence of env vars                                  : 0 / 1
  Testing for sane USE flag usage                                   : 0 / 0

  Total number of ebuilds with errors                               : 0 (0%)
  Total number of ebuilds with warnings                             : 1 (100%)
		</i>	</pre>
			
			<p>
			今度こそ、ebuild にある年の数字がおそらく間違っ
			ているのだろうということと、SLOT の値がないと
			いうことが分かりました。これらを直すことで警告
			を全部消えます。
			</p>
			
		</body>
	</section>
</chapter>
<chapter>

	<title>epm</title>
	<section>
		<title>Introduction</title>
		<body>
			<p>
				<c>epm</c> は Red Hat の rpm コマンド似せたパッケージ管理ツールです。
				rpm の全ての特徴を提供するものではありませんが、一部は rpm の問い合わ
				せオプションよりも強力です。
			</p>

			<p> 
				ここでは触れませんが、除去したパッケージも扱えます。<c>epm --help</c> で 
				<c>epm</c> を使ったパッケージの消去について学ぶことができます。
			</p>
		</body>
	</section>
	<section>

		<title>epm でのパッケージ問い合わせ</title>
		<body>
			<p>

				<c>epm</c> は Red Hat の rpm のコマン
				ドラインと本質的には同じように機能しま
				す。<c>epm -qa</c> はインストールされ
				たすべてのパッケージのリストを出力しま
				す。<c>epm -ql</c> はある特定の ebuld 
				に由来するすべてのファイルをリストしま
				す。

			</p>

			<pre> 
hebron etc # <i>epm -ql ethereal
/usr/lib/ethereal/plugins/0.8.20/gryphon.so
/usr/lib/ethereal/plugins/0.8.20/gryphon.la
/usr/lib/ethereal/plugins/0.8.20/gryphon.a
/usr/lib/ethereal/plugins/0.8.20/mgcp.so
/usr/lib/ethereal/plugins/0.8.20/mgcp.la
/usr/lib/ethereal/plugins/0.8.20/mgcp.a
/usr/lib/ethereal/plugins/0.8.20/cosnaming.so
/usr/lib/ethereal/plugins/0.8.20/cosnaming.la
/usr/lib/ethereal/plugins/0.8.20/cosnaming.a
/usr/lib/ethereal/plugins/0.8.20/coseventcomm.so
/usr/lib/ethereal/plugins/0.8.20/coseventcomm.la
/usr/lib/ethereal/plugins/0.8.20/coseventcomm.a
/usr/bin/ethereal
/usr/bin/editcap
/usr/bin/mergecap
/usr/bin/tethereal
/usr/bin/text2pcap
/usr/bin/idl2eth
/usr/share/man/man1/idl2eth.1.gz
/usr/share/man/man1/tethereal.1.gz
/usr/share/man/man1/text2pcap.1.gz
/usr/share/man/man1/editcap.1.gz
/usr/share/man/man1/ethereal.1.gz
/usr/share/man/man1/mergecap.1.gz
/usr/share/doc/ethereal-0.8.20/AUTHORS.gz
/usr/share/doc/ethereal-0.8.20/COPYING.gz
/usr/share/doc/ethereal-0.8.20/NEWS.gz
/usr/share/doc/ethereal-0.8.20/ChangeLog.gz
/usr/share/doc/ethereal-0.8.20/README.gz
/usr/share/doc/ethereal-0.8.20/INSTALL.configure.gz
/usr/share/doc/ethereal-0.8.20/TODO.gz
/usr/share/doc/ethereal-0.8.20/README.aix.gz
/usr/share/doc/ethereal-0.8.20/README.bsd.gz
/usr/share/doc/ethereal-0.8.20/README.hpux.gz
/usr/share/doc/ethereal-0.8.20/README.irix.gz
/usr/share/doc/ethereal-0.8.20/README.linux.gz
/usr/share/doc/ethereal-0.8.20/README.tru64.gz
/usr/share/doc/ethereal-0.8.20/README.win32.gz
/usr/share/doc/ethereal-0.8.20/README.vmware.gz
/etc/ethereal/manuf </i>
			</pre>
			<p>

				このドキュメントを書いている時点では 
				<c>qpkg</c> にはない <c>epm</c> の進ん
				だ問い合わせオプションが少々あります。
				たとえば、コンフィギュレーションファイ
				ルやドキュメンテーションファイルを問い
				合わせることができます。

			</p>
			<pre>

hebron etc # <i>epm -qc ethereal
/etc/ethereal/manuf

hebron etc # epm -qd ethereal
/usr/share/man/man1/idl2eth.1.gz
/usr/share/man/man1/tethereal.1.gz
/usr/share/man/man1/text2pcap.1.gz
/usr/share/man/man1/editcap.1.gz
/usr/share/man/man1/ethereal.1.gz
/usr/share/man/man1/mergecap.1.gz
/usr/share/doc/ethereal-0.8.20/AUTHORS.gz
/usr/share/doc/ethereal-0.8.20/COPYING.gz
/usr/share/doc/ethereal-0.8.20/NEWS.gz
/usr/share/doc/ethereal-0.8.20/ChangeLog.gz
/usr/share/doc/ethereal-0.8.20/README.gz
/usr/share/doc/ethereal-0.8.20/INSTALL.configure.gz
/usr/share/doc/ethereal-0.8.20/TODO.gz
/usr/share/doc/ethereal-0.8.20/README.aix.gz
/usr/share/doc/ethereal-0.8.20/README.bsd.gz
/usr/share/doc/ethereal-0.8.20/README.hpux.gz
/usr/share/doc/ethereal-0.8.20/README.irix.gz
/usr/share/doc/ethereal-0.8.20/README.linux.gz
/usr/share/doc/ethereal-0.8.20/README.tru64.gz
/usr/share/doc/ethereal-0.8.20/README.win32.gz
/usr/share/doc/ethereal-0.8.20/README.vmware.gz
		</i>	</pre>
			<note>
				<c>epm --help</c> で最後には 
				<c>epm</c> がサポートするであろうオプ
				ションをリストすることができる。しかし
				ながら、*(アスタリスク)がプレフィクス
				についているものは、まだ実装されていな
				いので注意してください。
			</note>
		</body>
	</section>
</chapter>

<chapter>
	<title>Others</title>
	<section>
		<title>etc-update</title>
		<body>
			<!-- 
			- Feel free to add more to this. It probably deserves its own chapter, but I don't 
			- use it, so I can't really write much about it.
			-->
			<p>

				<c>etc-update</c> は設定ファイルの手
				動更新を代わりにやってくれる便利なもの
				です。設定ファイルを変更する emerge を
				実行したあと、<c>etc-update</c> を実行
				することで埋め込まれた設定ファイルのアッ
				プデートを進めることができます。

			</p>

			<p> 
				これはメニューを中心に操作され、何をするか
				きめる前に設定ファイルをみたり、マージ
				したりする機能を含んでいます。

			</p>
		</body>
	</section>
	<section>
		<title>gentool</title>
		<body>
			<p>

				<c>gentool</c> は ebuild に関する統計
				を調べるいくつかの小さなスクリプトに対
				する総称です。たとえば、
				<c>gentool-total-coverage</c> は email 
				アドレスのリストや、それぞれが portage
				tree に持つ ebuild の数を出力します。
			
			</p>

		</body>
	</section>
	<section>
		<title>pkg-size</title>
		<body>

			<p><c>pkg-size</c> は与えられたパッケージにてインストールされたファイルのサイズを出力します。.
			</p>
			<pre>

hebron portage # <i>pkg-size nmap   
net-analyzer/nmap-2.54_beta24-r1 897024 (876KB) </i>
			</pre>
		</body>
	</section>
	<section>
		<title>mkebuild</title>
		<body>
			<p>

				<c>mkebuidl</c> はebuild の作成プロセ
				スをなるべく自動化することで新しい 
				ebuild の作成を簡単にします。
				<c>mkebuild [filename]</c> と実行する
				ことで、そのファイルに対する ebuild が
				作られます。そのファイルはある種のアー
				カイブでなければいけません。動作すると、
				あなたがしなければいけないかもしれない
				変更に関してフィードバックを提供するで
				しょう。
			</p>

		</body>
	</section>
	<section>
		<title>emerge-webrsync</title>
		<body>
			<!-- Can't find any documentation on this anywhere... not even a comment in the
code. -->
			<p>
				毎日のスナップショットを wget をつかって HTTP を通してダウンロードします、そして(オプションとして) portage を同期させます。
			</p>
		</body>

	</section>
</chapter>
</guide>


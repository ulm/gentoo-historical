<?xml version="1.0" encoding="UTF-8"?>

<guide link="/doc/ja/printing-howto.xml">
	<title>Gentoo プリンティング ガイド</title> 
	<author title="Author"><mail link="zhen@gentoo.org"> 
		John P. Davis</mail>
	</author>
	<author title="Copyeditor"><mail link="sunflare@gentoo.org">Phil Bordelon</mail>
	</author> 
	<author title="翻訳"><mail link="pocali77@hotmail.com">hibou</mail>
	</author>
 
	<abstract>Gentoo Linuxの包括的なプリンティングガイドです。 
	このドキュメントはlocal,network両方の印刷方式をカバーしています。
	</abstract> 
 
	<version>1.1.0</version> 
	<date>14 January 2003</date> 
 
		<chapter> 
			<title>CUPS を使用したローカルなプリンティングシステム</title> 
			<section> 
				<title>CUPS を使用したプリンティングシステムの導入方法</title> 

				<body> 
 
				<p>CUPS (the Common Unix Printing System) や foomatic などの素晴らしいプログラムのおかげで、Gentoo Linux でプリンティングシステムを構築することは比較的危険の伴わない作業になっています。 
				現在、これらのプログラムは共に portage tree に取り込まれていて、エンドユーザーの方にとっても、設定することは非常に簡単です。
				</p> 
 
				<p>cups は "cross-desktop" です。すなわち、このドキュメントに従うことで GNOME や KDE の元でプリントすることができます。
				KDE のプリンタ設定という別の選択肢もありますが、CUPS の方が設定が簡単であり、最も普及していると思います。
				</p>
 

				<p>CUPS を emerge する前に <path>/etc/make.conf</path>の USE 変数に CUPS を加えるのはいい考えです。
				</p>

				<pre caption = "Editing /etc/make.conf">
<comment>add <i>cups</i> to your existing USE var list. </comment>
USE="cups other_var1 other_var2
				</pre>

				<p>もっと詳細なUSE変数についての情報は、以下を参照してください。
				<uri link = "http://www.gentoo.org/doc/en/use-howto.xml">USE HOWTO</uri>.
				</p>

				
				<pre caption = "Emerging necessary packages"> 
# <c>emerge cups</c>  
# <c>emerge foomatic </c>
				</pre> 
 
				<p>必要なパッケージがインストールされた今、次はプリンタ自身のインストールになります。
				</p>

				<p>どのようなプリンタの接続タイプを使うかによりますが、パラレルポート接続のプリンタ、もしくは USB 接続のプリンタをカーネルに於いて有効にする必要があるでしょう。
				</p> 
 
 
				<note>カーネルの再構築の方法が分からない場合は、公式な <uri link="http://www.tldp.org/HOWTO/Kernel-HOWTO.html">Linux Kernel-HOWTO</uri> を参照してください。
				</note>
 
				<p>カーネルの再構築が済んだ後、システムを再起動させたなら、次は必要なモジュールの読み込みになります。
				</p> 
 
 
				<pre caption = "Loading USB modules"> 
# <c>modprobe usbcore</c> 
# <c>modprobe printer</c> 
				</pre> 
 
				<p>モジュールの読み込みに成功したらプリンタを接続してみます。そして <path>/var/log/messages</path> をチェックして、プリンタが認識されていることを確認してください。
				</p> 
 
				<pre caption = "Checking Kernel Messages"> 
# <c>tail /var/log/messages</c> 
				</pre> 
 
				<p>このようなメッセージを見られるはずです: 
				</p>
   
				<pre caption = "/var/log/messages Output">
<c>hub.c: USB new device connect on bus2/2, assigned device number 2 </c> 
<c>printer.c: usblp0: USB bidirectional printer dev 2 if 0 alt 1 proto 2 vid 0x03F0 pid 0x1104 </c>
				</pre>    
 
				<note>パラレル接続のプリンタを使用している場合、再起動する前にプリンタが接続されていることを確認してください。 再起動後 <c>dmesg</c> を実行してカーネルがプリンタを認識している形跡を探してください。
				</note> 
 
				<p>CUPS を使用したプリンタの設定の前にシンプルで基本的なコマンドを使ってプリンタのテストをすることができます。
				</p> 

				<pre caption = "Printer Testing Using cat">
# <c>touch test.txt</c>
# <c>echo "Hello World" > test.txt</c>
# <c>cat test.txt > /dev/usb/lp0 </c>

<comment> Alternatively, for parallel port printers: </comment>
# <c>cat test.txt > /dev/lp0 </c>
				</pre>

				</body> 
			</section> 
 
			<section> 
				<title>PPD ファイルの設定</title> 

				<body> 
				<p>プリンタと CUPS の設定をします。 HP 社のインクジェットプリンタを使用しているなら、<c>hpijs</c> (プリンタドライバ)をインストールする必要があります。 
				このドライバは HP 社のプリンタを動かすために必要な全ての Postscript の解釈、処理をします。 HP 社のプリンタを使用していないのなら、他の代りのドライバが必要になるでしょう。
				</p> 
 
				<note>この <c>hpijs</c> (プリンタドライバ)は HP 社のインクジェットプリンタ向けです。 HP 社のレーザージェットプリンタを使用しているなら、すでに "GNOME printing system" によってサポートが得られています。 
				HP 社のインクジェットプリンタを使用していないのなら下記の設定過程は飛ばしてください。
				</note> 
 
				<pre caption = "Emerging hpijs"> 
# <c>emerge hpijs</c> 
				</pre> 
 
				<impo>HP 社からの <c>hpijs</c> (プリンタドライバ)向のドキュメントは
				<path>/usr/share/doc/hpijs-&lt;version&gt;</path> にあります。 <i>高度</i>で詳細な説明が載っています。
				</impo> 
 
				<p>プリンタが Postscript を正確に解釈するために CUPS は PPD (Printer Postscript Definition) ファイルを必要とします。PPD を生成する一番簡単な方法は foomatic を介すことです。 
				</p>

				<p>下記のコマンドをうまく働かせる為に、プリンタのモデル、デバイス名、(hpijsを使っていないならば)ドライバの情報が必要です。
				プリンタの ID (モデル)やドライバは foomatic のデータベースの中から <c>grep</c> によって捜し出すことができ、プリンタのデバイス名とは <path>/dev/lp0</path> といったプリンタの接続先となります。
				下記の例ではドライバに <i>hpijs</i> を使っています。HP のプリンタを使っていないのなら、<i>hpijs</i> の部分をあなたが使っているプリンタのドライバ名に置き換えて下さい。
				</p>

				<pre caption = "Using foomatic">
# <c>grep $printer_model /usr/share/foomatic/db/source/printer/*</c>
# <c>grep $print_driver /usr/share/foomatic/db/source/driver/*</c>
# <c>foomatic-configure -s cups -p $printer_model -c $print_device -n queue name -d hpijs </c>
				</pre>
 
				<impo>もし何らかの問題があった場合は <uri link="http://www.linuxprinting.org/foomatic/USAGE">foomatic のドキュメント</uri>と
				<uri link="http://www.linuxprinting.org">linuxprinting.org</uri> を参照してください。
				</impo>

				</body> 
			</section> 
 
			<section> 
				<title>CUPS の設定</title> 
				<body>
 
				<p>プリンタ自身の設定が済んだなら、次はプリンタのキューを操作する為に CUPS の設定が必要です。 CUPS でウェブブラウザのポート番号631を通してプリンタ機器にアクセスすることができます。これはとても便利です。
				</p>

				<impo>CUPS はデーモンの為の作りつけの設定ファイルを持っていますが、それを修正したほうが良いでしょう(しなければならない訳ではありません)。 それをちらっと見たくなったら <path>/etc/cups/cupsd.conf</path> を見てください。
				</impo>
	
				<pre caption = "Adding CUPS to default runlevel, and starting CUPS">
# <c>rc-update add cupsd default</c>
# <c>/etc/init.d/cupsd start</c>
				</pre>

				<p>今 CUPS デーモンが走っているはずなので、好きなブラウザを開いて <uri link="http://127.0.0.1:631">ここ</uri> をクリックしてください。
				</p> 

				<p>うまくいけば CUPS の設定画面を見ることができるでしょう。  
				そのページの上部の <i>administration</i> タブをクリックして root のパスワード、又は <i>lp</i> グループに入っているユーザー名を入力してください。 
				一度ユーザー認証を済ませたなら <i>printers</i> セクションの下の <i>Add Printer</i> タブをクリックしてください。 そして必要となるプリンタの名前、説明、場所を入力してください。 
				プリンタの名前は foomatic の為に指定したプリンタのキューの名前と全く同じ名前にしてください。 今、接続デバイス名を選択してください。 
				プリンタの製造元を選択し、続けてください。次のページであなたのプリンタを一覧の中から選択してください。
				</p>

				<p>設定はこれで終りです。 プリンタの名前をクリックしてテストページのプリントを試してください。 プリンタの設定は完璧です。
				</p>

				<note>もしなんらかの原因でプリンタが動かない場合は教えられた CUPS のログが保管されるディレクトリへ行き、<i>error_log</i> に目を通してください。
				</note>
 
				</body> 
			</section>
		</chapter>

		<chapter>
			<title>CUPS を使用して GIMP、 OpenOffice.org1.0、Abiword でプリントする為の設定</title>
			<section>
				<title>The GIMP</title>
				<body>

				<p>まず始めに Gimp の CUPS printing extentions を emerge しましょう。
				</p>

				<pre caption="Emerging gimp-print-cups">
# <c>emerge gimp-print-cups </c>
				</pre>

				<p>GIMP を立ち上げて既存のファイルを開くか、新規にファイルを作成してください。<i>File</i> メニューを探しさえすればよいので、これはそんなに問題じゃないですね。
				画像上で右クリックして <i>File/Print</i> へ行ってください。プリントする為のダイアログが現れると思いますが、そこで新しいプリンタをクリックしてください。 
				あなたのプリンタがまだ一覧にないのならプリンタの名前を入力して、そのプリンタを選択してください。 さあ、今 GIMP からプリントする為の設定をしましょう。 設定を巧みに使って楽しんでください。
				</p>

				</body>
			</section>

			<section>
				<title>OpenOffice.org1.0</title>
				<body>	

				<p>OpenOffice.org1.0 でプリントすることは全然難しくありません。 <path>OpenOffice.org1.0/program </path>へ行き、 <c>spadmin</c> を走らせてください。 
				新規にプリンタを作成すると <i>Choose a Driver</i> という画面が現れるので <i>import</i> をクリックし、プリンタの PPD ファイルのある場所を指定してください。 私達の場合 <path>/etc/cups/ppd</path> にあると思います。 
				標準のプリントコマンドとプリンタの名前を使い、それを標準に設定し、プリントする準備は整いました。 OpenOffice.org1.0 を立ち上げてプリント画面に行って、あなたのプリンタを選択してください。 テストページをプリントして終りです。
				</p>

				</body>
			</section>

			<section>
				<title>Abiword</title>
				<body>

				<warn>Abiword は CUPS-1.1.15-r2 と使用すると segfault したりクラッシュしたりします。 CUPS を .14 シリーズに戻すことでこの問題は改善されるので、.14 シリーズに戻すことをお勧めします。
				</warn>

				<p>Abiword はサポート予定にあります。</p>

				</body>
			</section>

			<p>ローカルなプリンティングシステムは仕上りました。 次はネットワークサポートの追加へ移りましょう。
			</p>

		</chapter>

		<chapter>
			<title>CUPS と SAMBA を使用したネットワークプリンティングシステム</title>
			<section>
				<title>Linux マシンから Windows のプリンタでプリントする場合</title>
				<body>


				<p>プリントのオプションを有効にするには、まず SAMBA が隣り合った二つのコンピュータのネットワークの為にインストールされてなければなりません。
				</p>

				<pre caption = "Installing SAMBA">
# <c>emerge samba</c>
				</pre>

				<note>SAMBA に関するより詳細な情報は公式の
				<uri link="http://www.tldp.org/HOWTO/SMB-HOWTO.html">SAMBA HOWTO</uri> を参照してください。
				</note>

				<p> まず初めに <i>foomatic</i> を使ってリモートプリンタの為の PPD ファイルを作成してください。 あなたのプリンタが Linux で動くことを確認するか、
				<uri link="http://www.linuxprinting.org/printer_list.cgi">linuxprinting.org</uri>のプリンタのデータベースの中に名前があるか調べることを忘れないでください。 
				<i>foomatic</i> にプリンタが何で、どこにあるのか教えましょう。そして作成された PPD ファイルを正しい場所へ移しましょう。
				</p>

				<pre caption = "Using foomatic with Samba">
<codenote>Please acquire printer model and your driver name using the aforementioned steps. </codenote>
# <c>foomatic-configure -s cups -p $printer_model -c smb://user:password@server/share -n queue name -d hpijs </c>
				</pre>

				<p> <uri link="http://localhost:631">ここ</uri>をクリックして CUPS の設定画面を開いてください。 
				前述の手順を踏んでプリンタを追加してください。 ただしプリンタのポートを聞かれたら、<i>smb://user:password@server/share</i> を指定してください。
				ここが CUPS で Windows マシンのプリンタを使う為のポイントです。
				</p>

				</body>
			</section>

			<section>
				<title>Linux を Windows の共用プリントサーバーとして使う</title>
				<body>

				<p>Linux は素晴らしいプリントサーバーになります。そしてまた、素晴らしいどのようなサーバーにもなります。 まず最初にしなくてはならないことは、設定するために
				<path>/etc/samba/smb.conf</path> を編集することです。 この
				<i>smb.conf</i> ファイルは Linux マシンを Windows マシンの為の Windows NT サーバーと同じようにするためのすべての設定を含んでいます。 下記はとても実用的な
				<i>smb.conf</i> の例です。あなたのネットワーク環境に合わせて、必要に応じて編集してください。
				</p>

				<pre caption = "Sample smb.conf">
<c>[global]</c>

	<c>workgroup = YOUR_WORKGROUP</c>
	<c>server string = Gentoo Linux Server</c>
	<c>encrypt passwords = True</c>
	<c>security = user</c>
	<c>smb passwd file = /etc/samba/private/smbpasswd</c>
	<c>log file = /var/log/samba/log.%m</c>
	<c>socket options = IPTOS_LOWDELAY TCP_NODELAY</c>
	<c>domain master = Yes</c>
	<c>local master = Yes</c>
	<c>preferred master = Yes</c>
	<c>os level = 65</c>
	<c>dns proxy = No</c>
	<c>name resolve order = lmhosts host bcast</c>
	<c>bind interfaces only = True</c>
	<c>interfaces = eth0</c>
	<c>hosts deny = ALL</c>
	<c>hosts allow = 192.168.1.4 127.0.0.1 (list of allow hosts here) </c>
	<c>debug level = 1</c>
	<c>create mask = 0644</c>
	<c>directory mask = 0755</c>
	<c>level2 oplocks = True</c>
	<c>read raw = no</c>
	<c>write cache size = 262144</c>

<c>[printers]</c>
	<c>comment = All Printer</c>
	<c>path = /var/spool/samba</c>
	<c>browseable = no </c>
   
				</pre>

				<p>SAMBA の設定はこれで済みました。 samba を再起動させて Windows マシンへ行き、
				ネットワークプリンタをインストールしてください。 ね、簡単でしょ？ 
				</p>

				</body>
			</section>
		</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<guide link = "/doc/fr/env.d-howto.xml">
<title>Env.d HOWTO</title>
<author title="Auteur">
<mail link="zhen@gentoo.org">John P. Davis</mail>
</author>
<author title="Traducteur">
<mail link="arachne@frgentoo.net">Guillaume Morin</mail>
</author>

<abstract>
Ce guide décrit le concept et l'utilisation du repertoire
<path>/etc/env.d</path> et son contenu.
</abstract>

<version>1.5</version>
<date>14 Janvier 2003</date>

<chapter>

<title>Introduction à <c>env.d</c> et ses Variables Génériques</title>

<section>
<title>Variables d'Environnement Gentoo de base</title>
<body>
<p>Une des plus fréquentes questions des utilisateurs de Gentoo est "Où sont mes variables d'environnement, et quelles sont leurs valeurs?". 
Pour comprendre cette question, nous devons tout d'abord savoir ce qu'est une variable d'environnement. 
Une variable d'environnement est définie lors de l'utilisation de la commande <c>export</c>.
Par exemple, si vous tapez <c>export EDITOR="/usr/sbin/vim" </c>, vous définissez une variable d'environnement qui indique au système que votre éditeur de texte par défaut est vim.
Il y a différentes sortes de variables d'environnement qui peuvent être définies sur votre système Gentoo, en voici quelques exemples:
</p>

<note><c>export</c> définit une Variable d'Environnement dans le shell *et* tous ses processus fils. Si vous voulez juste définir la variable sans affecter les processus fils, tapez juste quelque chose comme
<i>FOO="bar"</i>. </note>

<note>Votre fichier <i>00basic</i> peut être différent. Ce n'est pas un problème, car toutes ses variables sont celles par défaut inclues dans Gentoo. </note>

<info>Ces exemples peuvent être trouvés dans <path>/etc/env.d/00basic</path>. </info>

<table>
<tr><th>Variable</th><th>Fonction</th></tr>
<tr><ti>PATH</ti><ti>Définit le chemin (PATH) par défaut où trouver les programmes. Les répertoires sont délimités par ':'.
Une variable path ressemblerait à quelque chose comme <c>PATH=/usr/local/bin:/opt/bin</c>. </ti></tr>

<tr><ti>ROOTPATH</ti><ti>Cette variable ressemble à la précédente, mais définit le chemin par défaut des programmes de l'utilisateur 
<c>root</c>. Un exemple ressemblerait à quelque chose comme <c>ROOTPATH=/usr/local/bin:/opt/bin</c>. </ti></tr>

<tr><ti>LDPATH</ti><ti> Cette variable spécifie le chemin des bibliothèques à lier. Les répertoires sont ici aussi délimités par ':'.
Un exemple serait <c>LDPATH=/usr/local/lib</c>. </ti></tr>

<tr><ti>MANPATH</ti><ti>Indique où les pages de manuel sont stockées sur votre machine. Elle ressemble à <i>PATH</i>,
mais pour les pages de manuel. Exemple : <c>MANPATH=/usr/share/man:/usr/local/share/man</c>.
</ti></tr>

<tr><ti>INFODIR</ti><ti>Spécifie où sont conservés les fichiers info. Exemple : <c>INFODIR=/usr/share/info</c>.  </ti></tr>

<tr><ti>PAGER</ti><ti>Définit le pager à utiliser, par exemple less ou more. Ce pourrait être <c>PAGER=/usr/bin/less</c>. </ti></tr>

<tr><ti>EDITOR</ti><ti>Indique au système quel est l'éditeur par défaut. Exemple : <c>EDITOR=/usr/bin/vim</c>. </ti></tr>
</table>


<p>Ce qui suit est un exemple de fichier <i>00basic</i> simple, afin de vous donner une idée de son apparence.
Si votre fichier <c>00basic</c> est défectueux, vous pouvez utiliser celui-ci! </p>

<pre caption = "00basic">
# Copyright 1999-2002 Gentoo Technologies, Inc.
# Distributed under the terms of the GNU General Public License, v2 or later
# $Header: /home/cvsroot/gentoo-src/rc-scripts/etc/env.d/00basic,v 1.6 2002/06/20 22:07
:37 azarah Exp $

PATH=/usr/local/bin:/opt/bin
ROOTPATH=/usr/local/bin:/opt/bin
LDPATH=/usr/local/lib
MANPATH=/usr/share/man:/usr/local/share/man
INFODIR=/usr/share/info
CVS_RSH=ssh
PAGER=/usr/bin/less
EDITOR=/usr/bin/vim
LESSOPEN="|lesspipe.sh %s"
</pre>

</body>
</section>

<section>
<title>Format de env.d</title>

<body>
<p>
Les fichiers à l'intérieur de <c>env.d</c> sont organisés dans un ordre logique afin que lorsque <c>env-update</c> est lancé, il ordonne correctement les variables. Les chiffres au début des fichiers indiquent dans quel ordre ils sont parcourus. 
Donc <i>00basic</i> sera le premier, et ensuite <i>01quelquechose</i> et ainsi de suite. Le contenu de ces fichiers a un format spécifique : </p>

<pre caption = "Format du Contenu">
<comment># Ceci est un commentaire, comme en BASH </comment>
<i>VARIABLE1=/chemin/vers/quelquechose </i>
<comment># Quelques variables peuvent avoir des arguments délimités par ":" . </comment>
<i>VAR1A=/chemin/vers/quelquechose:/chemin/vers/autrechose/ </i>
<i>VARIABLE2=nom_de_quelquechose </i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Variables Spéciales et Fonctionnement Global</title>

<section>
<title>Variables spéciales</title>
<body>

<p>il y a quelques variables spéciales inclues dans <c>env.d </c> : 
<i>KDEDIRS, PATH, CLASSPATH, LDPATH, MANPATH, INFODIR, ROOTPATH, CONFIG_PROTECT, CONFIG_PROTECT_MASK </i> Elles sont spéciales car elles sont traitées de manière spéciale et définies dans des fichiers spéciaux, comme expliqué plus loin.</p>

<note>Quelques unes des variables mentionnées ci-dessous sont aussi contenues dans  <i>00basic</i>.
C'est parce qu'elles peuvent être utilisées plus d'une fois dans des fichiers séparés, comme expliqué plus bas. </note>

<table>
<tr><th>Variable</th><th>Fonction</th></tr>
<tr><ti>KDEDIRS</ti><ti> Chemin vers tous les fichiers de KDE. </ti></tr>

<tr><ti>PATH</ti><ti>Précédemment mentionné, délimité par ':' (voir plus haut).</ti></tr>

<tr><ti>CLASSPATH</ti><ti>Définit le chemin vers les Classes Java, délimité par ':'.</ti></tr>

<tr><ti>LDPATH</ti><ti>Précédemment mentionné ( voir plus haut ).</ti></tr>

<tr><ti>MANPATH</ti><ti>Précédemment mentionné, délimité par ':' (voir plus haut).</ti></tr>

<tr><ti>INFODIR</ti><ti>Précédemment mentionné, délimité par ':' (voir plus haut).</ti></tr>

<tr><ti>ROOTPATH</ti><ti>Précédemment mentionné, délimité par ':' (voir plus haut).</ti></tr>

<tr><ti>CONFIG_PROTECT</ti><ti>Ceci spécifie quels fichiers de configuration dans <path>/etc </path> vous voulez protéger des nouveaux ebuilds, les arguments donnés sont délimités par des espaces.</ti></tr>

<tr><ti>CONFIG_PROTECT_MASK</ti><ti>C'est simplement l'inverse de CONFIG_PROTECT, elle enlève la protection de certains fichiers dans <path>/etc </path> que vous voulez voir changer automatiquement par emerge. </ti></tr>
</table>

</body>
</section>

<section>
<title> Fonctionnement global</title>
<body>

<p>OK, maintenant que nous avons tout défini, vous êtes probablement en train de vous demander en quoi tout cela pourrait bien avoir un rapport avec vous et votre Gentoo. La puissance de <i>env.d</i> réside dans le fait de pouvoir changer ces variables en ce dont vous avez besoin. 
Avec les définitions ci-dessus, vous devriez être capable de le faire.</p>

<p> Maintenant que nous avons un aperçu de ce qui se passe, il est temps d'expliquer ce qui arrive à ces variables.
Quand <c>env-update</c> est appelé, il relie tous ces fichiers dans l'ordre. Souvenez vous que je disais qu'il était possible d'avoir de multiples variables <i>PATH</i> si elles sont dans des fichiers différents.
Ceci est du au fait que <c>env-update</c> parcourt les fichiers séquentiellement et fusionne les chemins. 
Ainsi, si vous avez un <i>PATH</i> pour KDE, GNOME, votre <i>PATH</i> par défaut, et un autre pour X, <c>env-update</c> va concaténer tous ces PATH ensemble, si bien que votre <i>PATH</i> par défaut deviendra tous ces PATH combinés. Merveilleux n'est-ce pas ? </p> 

<p> Maintenant que ces variables sont liées ensemble, il est important de noter où elles sont stockées.</p>

<note>Les fichiers ci-dessous sont créés par la commande <c>env-update</c> </note>

<pre caption = "Fichiers créés par l'addition de tous les fichiers dans env.d">
<i>LDPATH ----> /etc/ld.so.conf </i>
<i>CONFIG_PROTECT et CONFIG_PROTECT_MASK ----> /etc/profile.env (comme les variables exportées)</i>
<i>Speciales et Autres ----> /etc/profile.env </i>
</pre>

<p>Si vous regardez dans <path>/etc/ld.so.conf</path>, vous pouvez clairement voir que <i>env.d</i> est la source des informations qu'il contient.</p>

<pre caption = "/etc/ld.so.conf">
# ld.so.conf autogenerated by env-update; make all changes to
# contents of /etc/env.d directory
/usr/local/lib
/usr/lib/gcc-lib/i686-pc-linux-gnu/3.2
/usr/lib/opengl/nvidia/lib
/usr/lib/mozilla
/usr/X11R6/lib
/opt/blackdown-jdk-1.3.1/jre/lib/i386/
/opt/blackdown-jdk-1.3.1/jre/lib/i386/native_threads/
/usr/qt/3/lib
/usr/qt/2/lib
/usr/kde/3/lib
</pre>

<p>IL est intéressant de savoir que<path>/etc/profile.env</path>
est lu et exécuté par votre session shell. C'est une bonne chose; la prochaine fois que vous vous connecterez, vous pourrez utiliser toutes les variables fraichement définies.</p>

<pre capton = "Sequence d'évênements de env-update">
<i>paramètres /etc/env.d  ----env-update----> /etc/profile.env ---> /etc/profile 
---> bash ---> tous vos programmes</i>
</pre>

<p>Maintenant que vous avez un <i>profile.env</i> il devrait ressembler à quelquechose comme ceci : </p>

<pre caption = "/etc/profile.env">
export CONFIG_PROTECT='/usr/kde/3/share/config /usr/share/config'
export KDEDIRS='/usr/kde/3:/usr'
export MANPATH='/usr/share/man:/usr/local/share/man:/usr/X11R6/man:/opt/blackdown-jdk-1
.3.1/man'
export INFODIR='/usr/share/info:/usr/X11R6/info'
export PATH='/usr/local/bin:/opt/bin:/opt/rar/bin:/usr/X11R6/bin:/opt/blackdown-jdk-1.3
.1/bin:/opt/blackdown-jdk-1.3.1/jre/bin:/usr/qt/3/bin:/usr/qt/2/bin:/usr/kde/3/bin'
export CONFIG_PROTECT_MASK='/etc/gconf'
export CLASSPATH='/opt/blackdown-jdk-1.3.1/jre/lib/rt.jar:.'
export ROOTPATH='/usr/local/bin:/opt/bin:/opt/rar:/usr/X11R6/bin:/opt/blackdown-jdk-1.3
.1/bin:/opt/blackdown-jdk-1.3.1/jre/bin:/usr/qt/3/bin:/usr/qt/2/bin:/usr/kde/3/bin'
export KDEDIR='/usr/kde/3'
export VIMRUNTIME='/usr/share/vim/vim61'
export JDK_HOME='/opt/blackdown-jdk-1.3.1'
export JAVAC='/opt/blackdown-jdk-1.3.1/bin/javac'
export PAGER='/usr/bin/less'
export HOSTNAME='l00ser.muc.edu'
export QMAKESPEC='linux-g++'
export LESSOPEN='|lesspipe.sh %s'
export CVS_RSH='ssh'
export EDITOR='/usr/bin/vim'
export QTDIR='/usr/qt/3'
export JAVA_HOME='/opt/blackdown-jdk-1.3.1'
export XINITRC='/etc/X11/xinit/xinitrc'
export MOZILLA_FIVE_HOME='/usr/lib/mozilla'
</pre>

<p>Voilà, c'est tout ce qu'il y a à dire, alors amusez-vous bien et ne cassez pas tout! </p>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/altinstall.xml,v 1.6 2004/07/16 11:18:38 neysx Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/altinstall.xml" lang="fr">

<title>Méthodes alternatives pour l'installation de Gentoo Linux</title>

<author title="Contributeur">
  <mail link="r@gentoo.org">Gerald Normandin Jr.</mail>
</author>
<author title="Contributeur">
  <mail link="lordviram@rebelpacket.net">Travis Tilley</mail>
</author>
<author title="Contributeur">
  <mail link="volontir@yahoo.com">Oleg Raisky</mail>
</author>
<author title="Contributeur">
  <mail link="luminousit@hotmail.com">Alex Garbutt</mail>
</author>
<author title="Contributeur">
  <mail link="alex@openvs.com">Alexandre Georges</mail>
</author>
<author title="Contributeur">
  <mail link="vargen@b0d.org">Magnus Backanda</mail>
</author>
<author title="Contributeur">
  <mail link="davoid@gentoo.org">Faust A. Tanasescu</mail>
</author>
<author title="Contributeur">
  <mail link="aliz@gentoo.org">Daniel Ahlberg</mail>
</author>
<author title="Correcteur">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Relecteur">
  <mail link="antifa@gentoo.org">Ken Nowack</mail>
</author>
<author title="Correcteur">
  <mail link="blubber@gentoo.org">Tiemo Kieft</mail>
</author>
<author title="Traducteur">
  <mail link="ribosome@gentoo.org">Olivier Fisette</mail>
</author>

<abstract>
Ce guide se veut un répertoire de méthodes alternatives pour installer Gentoo
et est destiné à ceux qui ont des besoins particuliers lors de l'installation.
Il couvre des problèmes comme l'absence d'un lecteur de CD-ROM ou
l'impossibilité d'amorcer l'ordinateur à partir d'un CD-ROM.
</abstract>

<license/>

<version>0.43</version>
<date>12 juillet 2004</date>

<chapter>
<title>À propos de ce document</title>
<section>
<body>

<p>
Si la méthode d'installation standard qui consiste à démarrer à partir d'un
CD-ROM d'installation ne fonctionne pas pour vous (ou si vous n'aimez pas cette
prodécure), ce document vous aidera. Il s'agit d'une compilation des méthodes
alternatives pour l'installation de Gentoo Linux. Si vous préférez, ce guide
est la place pour des méthodes d'installation incongrues. Si vous connaissez
une méthode d'installation utile ou si vous avez concocté une drôle de façon
d'installer Gentoo, n'hésitez pas à l'écrire et à <mail
link="antifa@gentoo.org">me l'envoyer</mail> (N.D.T.&nbsp;: en anglais).
</p>

</body>
</section>
</chapter>

<chapter>
<title>Amorcer un LiveCD avec Smart BootManager</title>
<section>
<body>

<p>
Téléchargez Smart BootManager (<uri
link="http://btmgr.sourceforge.net/index.php3?body=download.html">http://btmgr.sourceforge.net/index.php3?body=download.html</uri>).
Les sources et des paquets binaires pour Linux sont disponibles ainsi qu'une
version .exe pour Windows. Des ensembles pour le support de différentes langues
sont aussi disponibles. Pour l'instant, nous recommandons d'utiliser un paquet
binaire puisque la compilation du code source ne fonctionne pas avec les
versions récentes de NASM.
</p>

<p>
Compilez le logiciel à partir des sources ou téléchargez simplement le paquet
binaire. De nombreuses options sont disponibles lors de la création de votre
disquette de démarrage, tel qu'indiqué ci-dessous&nbsp;:
</p>

<pre caption="Options de Smart BootManager">
<i>sbminst [-t theme] [-d drv] [-b backup_file] [-u backup_file]

   -t theme     select the theme to be used, in which the theme could be:
                   us = English theme       de = German theme
                  hu = Hungarian theme     zh = Chinese theme
                  ru = Russian theme       cz = Czech theme
                  es = Spanish theme       fr = French theme
                   pt = Portuguese theme


  -d drv       set the drive that you want to install Smart BootManager on;
                for Linux:
                  /dev/fd0 is the first floppy driver,
                  /dev/hda is the first IDE harddisk driver.
                   /dev/sda is the first SCSI harddisk driver.
                for DOS:
                   0   is the first floppy drive
                   128 is the first hard drive;

   -c             disable CD-ROM booting feature;

   -b backup_file backup the data that will be overwritten for
                  future uninstallation;

   -u backup_file uninstall Smart BootManager, should be used alone;

   -y             do not ask any question or warning.</i>
</pre>

<pre caption="Utiliser sbminst pour créer votre disquette de démarrage">
# <i>sbminst -t us  -d /dev/fd0</i>
</pre>

<note>
Remplacez fd0 par le nom de votre lecteur de disquette si nécessaire.
</note>

<p>
Ensuite, insérez simplement la disquette dans le lecteur de l'ordinateur avec
lequel vous souhaitez amorcer le LiveCD et insérez également le LiveCD dans le
lecteur de CD-ROM, puis démarrez l'ordinateur.
</p>

<p>
Vous serez accueilli par le dialogue de Smart BootManager. Choisissez votre
CD-ROM et appuyer sur Entrée pour amorcer le LiveCD. Après le démarrage,
poursuivez avec les instructions d'installation standard.
</p>

<p>
Vous trouverez de l'information supplémentaire sur Smart BootManager à
<uri>http://btmgr.sourceforge.net/</uri>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installation avec Knoppix</title>
<section>
<body>

<p>
L'amorçage à partir du LiveCD Knoppix permet d'avoir un système Linux
complètement fonctionnel pendant que vous compilez Gentoo. Tux Racer vous
aidera à tuer le temps pendant le «&nbsp;bootstrap&nbsp;» du système.
</p>

<p>
Démarrez avec le LiveCD Knoppix. Ce dernier est habituellement très efficace
pour la détection du matériel. Toutefois, vous devrez peut-être ajuster
quelques options de démarrage.
</p>

<p>
Par défaut, Knoppix lance le bureau KDE 3.0. La première chose que j'ai faite a
été d'ouvrir Konsole et de taper <c>sudo passwd root</c>. Cela vous permet de
définir le mot de passe root pour Knoppix.
</p>

<p>
Ensuite, j'ai utilisé la commande <c>su</c> pour ouvrir une session en tant que
root, puis j'ai tapé <c>usermod -d /root -m root</c>. Cette commande change le
répertoire personnel de l'utilisateur root de /home/root (la façon Knoppix) à
/root (la façon Gentoo). Si vous ne faites pas ce changement, vous obtiendrez
des erreurs telles que «&nbsp;/home/root: not found&nbsp;» lorsque vous
utiliserez <c>emerge</c>.
</p>

<p>
Ensuite, j'ai tapé <c>exit</c>, puis j'ai utilisé <c>su</c> pour ouvrir une
session en tant qu'utilisateur root. Cela permet au changement fait avec la
commande <c>usermod</c> de prendre effet. Maintenant, créez le point de montage
<path>/mnt/gentoo</path> en utilisant <c>mkdir</c>&nbsp;:
</p>

<pre caption="Créer le point de montage /mnt/gentoo">
# <i>mkdir /mnt/gentoo</i>
</pre>

<p>
À partir de ce point, vous pouvez continuez avec le <uri
link="/doc/en/handbook/handbook-x86.xml?part=1&amp;chap=4">chapitre 4</uri> des
instructions d'installation standard. Toutefois, lorsque l'on vous indique de
monter le système proc, exécutez plutôt la commande suivante&nbsp;:
</p>

<pre caption="Lier-monter le pseudo-système de fichiers proc">
# <i>mount -o bind /proc /mnt/gentoo/proc</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Installer à partir du stage 1 sans accès réseau</title>
<section>
<body>

<p>
Gravez une image ISO d'un LiveCD.
</p>

<p>
Récupérez le dernier instantané de Portage à partir de
<uri>http://distro.ibiblio.org/pub/linux/distributions/gentoo/snapshots/</uri>
(ou de votre <uri link="http://www.gentoo.org/main/en/mirrors.xml">miroir</uri>
favori). Copiez cette archive tar sur une partition de l'ordinateur où vous
souhaitez installer Gentoo ou bien gravez-la sur un CD-ROM.
</p>

<p>
Suivez les instructions d'installation de Gentoo jusqu'à <c>chroot
/mnt/gentoo</c> (sans toutefois exécuter cette étape). Si vous n'avez qu'un
seul lecteur de CD-ROM, n'oubliez pas d'utiliser l'option <c>cdcache</c> lors
du démarrage afin de pouvoir démonter le LiveCD et monter votre CD contenant
l'instantané de Portage.
</p>

<p>
Ouvrez une nouvelle console (Alt+F2) et poursuivez l'installation jusqu'à
l'étape du script bootstrap.sh (sans toutefois exécuter cette étape).
</p>

<warn>
Avec les vieilles versions des LiveCD, il est nécessaire de définir le mot de
passe avec la commande <c>passwd</c> avant de pouvoir ouvrir une session
manuellement.
</warn>

<p>
Retournez à la première console (Alt+F1, sans chroot) et montez votre second
CD-ROM sur <path>/mnt/gentoo/mnt/cdrom2</path>. Copiez l'archive tar à partir
de <path>cdrom2</path> et décompressez-la dans
<path>/mnt/gentoo/usr/portage</path>.
</p>

<pre caption="Monter le CD-ROM contenant l'instantané">
# <i>umount /mnt/cdrom</i>
# <i>mkdir /mnt/gentoo/mnt/cdrom2</i>
# <i>mount /dev/cdroms/cdrom0 /mnt/gentoo/mnt/cdrom2</i>
# <i>cp /mnt/gentoo/mnt/cdrom2/portage-$date.tar.bz2 /mnt/gentoo/usr/portage</i>
# <i>cd /mnt/gentoo/usr/portage</i>
# <i>tar xvjpf portage-$date.tar.bz2</i>
</pre>

<p>
Retournez à la console F2. Si vous essayez d'exécuter <c>bootstrap.sh</c>
maintenant, le script échouera, car il ne pourra télécharger les fichiers
nécessaires. Nous allons récupérer ces fichiers à partir d'un autre emplacement
et les copierons dans <path>/usr/portage/distfiles</path> (à partir de la
console F2).
</p>

<p>
Vous avez besoin d'une liste des paquets logiciels du stage 1&nbsp;: glibc,
baselayout, texinfo, gettext, zlib, binutils, gcc, ncurses ainsi que leurs
dépendances.
</p>

<note>
Vous aurez besoin des versions de chaque paquet associé à votre arbre Portage.
</note>

<pre caption="Récupérer la liste des téléchargements">
<comment>(N'oubliez pas le 2 devant &gt;.)</comment>
# <i>emerge -fp glibc baselayout texinfo gettext zlib binutils gcc ncurses 2&gt; stage1.list</i>
# <i>mount -t vfat /dev/fd0 /mnt/floppy</i>
# <i>cp /mnt/gentoo/stage1.list /mnt/floppy</i>
# <i>umount /mnt/floppy</i>
</pre>

<p>
Transférez le contenu de la disquette à un ordinateur disposant d'un accès
rapide au réseau. Si vous jetez un œil au fichier <path>stage1.list</path>,
vous verrez qu'il propose plusieurs URL pour le téléchargement.
Malheureusement, chaque paquet correspond à plusieurs URL possibles, ce qui
n'est pas ce que nous souhaitons. Ne conservez que le premier URL pour chaque
paquet&nbsp;:
</p>

<pre caption="Retirer des URL">
<comment>(Ce script dépend du format de la sortie de la commande emerge,
format qui peut changer sans préavis. Faites attention !)</comment>
# <i>cut -f 1 -d ' ' stage1.list > stage1.download</i>
</pre>

<p>
Ensuite, utilisez <c>wget</c> pour télécharger les sources&nbsp;:
</p>

<pre caption="Utiliser wget pour obtenir les sources des paquets requis">
# <i>wget -N -i stage1.download</i>
</pre>

<p>
Une fois que vous aurez récupéré tous les fichiers, transférez-les sur
l'ordinateur où vous installez Gentoo et copiez-les dans
<path>/mnt/gentoo/usr/portage/distfiles</path>. Vous pourrez alors exécuter
<c>bootstrap.sh</c>. Répétez cette procédure de téléchargement avec wget pour
les stages 2 et 3.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installation sur une machine sans disque avec PXE boot</title>
<section>
<title>Prérequis</title>
<body>

<p>
Sur le client sans disque, vous aurez besoin d'un adaptateur réseau supportant
le protocole PXE pour le démarrage. Plusieurs cartes de 3com supportent ce
protocole. Vous aurez aussi besoin d'un BIOS qui supporte le démarrage par PXE.
</p>

</body>
</section>
<section>
<title>Configuration de base du serveur</title>
<body>

<p>
Création des répertoires&nbsp;: la première chose à faire est de créer les
répertoires où votre système sans disque sera entreposé. Créez un répertoire
nommé <path>/diskless</path> qui contiendra un sous-répertoire pour chaque
client sans disque. Pour le reste de ce document, nous utiliserons
«&nbsp;eta&nbsp;» comme nom de client.
</p>

<pre caption="Configurer les répertoires">
# <i>mkdir /diskless</i>
# <i>mkdir /diskless/eta</i>
# <i>mkdir /diskless/eta/boot</i>
</pre>

<p>
Configuration DHCP et TFTP&nbsp;: le client obtiendra l'information de
démarrage par DHCP et téléchargera tous les fichiers requis par TFTP.
Installez DHCP avec <c>emerge</c> et configurez-le selon vos besoins de base.
Ensuite, ajoutez ce qui suit dans <path>/etc/dhcp/dhcpd.conf</path>.
</p>

<note>
Cette configuration fournit au client une adresse IP statique ainsi que le
chemin de l'image de démarrage PXE (pxegrub dans le cas présent). Vous devez
remplacer l'adresse MAC de la carte Ethernet du client ainsi que le répertoire
où vous conservez les fichiers du client par vos propres valeurs.
</note>

<pre caption="dhcp.conf">
option option-150 code 150 = text ;
host eta {
hardware ethernet 00:00:00:00:00:00;
fixed-address <i>ad.res.se.ip</i>;
option option-150 "/eta/boot/grub.lst";
filename "/eta/boot/pxegrub";
}
</pre>

<p>
Pour TFTP, installez (avec <c>emerge</c>) <c>app-admin/tftp-hpa</c>. Dans le
fichier <path>/etc/conf.d/in.tftpd</path>, ajoutez ce qui suit&nbsp;:
</p>

<pre caption="in.tftpd">
INTFTPD_PATH="/diskless"
INTFTPD_USER="nobody"
INTFTPD_OPTS="-u ${INTFTPD_USER} -l -vvvvvv -p -c -s ${INTFTPD_PATH}"
</pre>

<p>
Configuration de GRUB&nbsp;: pour fournir aux client le démarrage par
PXE, j'utilise GRUB. Vous devrez le compiler vous-même pour activer la
compilation d'image PXE. Heureusement, c'est plutôt simple. D'abord,
téléchargez la dernière version du code source de GRUB (<c>emerge -f grub</c>
placera l'archive tar dans <path>/usr/portage/distfiles</path>). Copiez cette
archive dans <path>/diskless</path> puis compilez GRUB avec le support pour
PXE. Une fois le fichier binaire produit, copiez-le dans le répertoire de
démarrage du client sans disque. Puis, éditez le fichier de configuration
<path>grub.lst</path>.
</p>

<pre caption="Configurer GRUB">
# <i>tar zxvf grub-0.92.tar.gz</i>
# <i>cd grub-0.92</i>
# <i>./configure --help</i>
<codenote>Parmi les options, vous verrez une liste de pilotes pour les interfaces </codenote>
<codenote>réseau supportées. Choisissez le pilote compatible avec votre adaptateur.</codenote>
<codenote>Nous le désignons ci-dessous par $nic.</codenote>
# <i>./configure --enable-diskless --enable-$nic</i>
# <i>make</i>
# <i>cd stage2</i>
# <i>cp pxegrub /diskless/eta/boot/pxegrub</i>
# <i>nano -w /diskless/eta/boot/grub.lst</i>
</pre>

<pre caption="grub.lst">
default 0
timeout 30

title=Diskless Gentoo
root (nd)
kernel /eta/bzImage ip=dhcp root=/dev/nfs nfsroot=<i>ad.res.se.ip</i>:/diskless/eta

<codenote>Pour l'option nfsroot, l'adresse IP à fournir est celle du serveur et</codenote>
<codenote>le répertoire est celui où sont conservés les fichiers de votre client</codenote>
<codenote>sans disque (sur le serveur).</codenote>
</pre>

<p>
Configuration de NFS&nbsp;: NFS est relativement simple à configurer. La seule
chose que avez à faire est d'ajouter une ligne au fichier de configuration
<path>/etc/exports</path> &nbsp;:
</p>

<pre caption="/etc/exports">
# <i>nano -w /etc/exports</i>
# /etc/exports: NFS file systems being exported.  See exports(5).
/diskless/eta eta(rw,sync,no_root_squash)
</pre>

<p>
Mise à jour des hôtes&nbsp;: il est important de modifier votre fichier
<path>/etc/hosts</path> pour qu'il satisfasse vos besoins.
</p>

<pre caption="/etc/hosts">
127.0.0.1 localhost

192.168.1.10 eta.exemple.com eta
192.168.1.20 sigma.exemple.com sigma
</pre>

</body>
</section>
<section>
<title>Créer le système sur le serveur</title>
<body>

<p>
Redémarrez le serveur et amorcez le système avec un LiveCD. Suivez les
instructions d'installation standard avec la modification suivante&nbsp;:
lorsque vous montez le système de fichiers, exécutez la commande ci-dessous
(remplacez hda3 par la partition où vous avez créé le répertoire
<path>/diskless</path>). Vous n'avez pas à monter d'autre partition puisque
tous les fichiers requis résident dans le répertoire
<path>/diskless/eta</path>.
</p>

<pre caption="Monter le système de fichiers">
#<i> mount /dev/hda3 /mnt/gentoo</i>
</pre>

<p>
Archives tar des stages et chroot&nbsp;: cet exemple utilise une archive tar
stage 3. Montez <path>/proc</path> dans le répertoire de votre client sans
disque et définissez ce répertoire comme racine du système (chroot) avant de
poursuivre l'installation. Suivez les instructions jusqu'à la configuration du
noyau.
</p>

<warn>
Soyez vigilant lors de l'extraction des fichiers de l'archive stage. Vous ne
souhaitez certainement pas remplacer les fichiers de votre système actuel par
ceux de l'archive...
</warn>

<pre caption="Extraire l'archive tar du stage">
# <i>cd /mnt/gentoo/diskless/eta/</i>
# <i>tar -xvjpf  /mnt/cdrom/gentoo/stage3-*.tar.bz2</i>
# <i>mount -t proc /proc /mnt/gentoo/diskless/eta/proc</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/diskless/eta/etc/resolv.conf</i>
# <i>chroot /mnt/gentoo/diskless/eta/ /bin/bash</i>
# <i>env-update</i>
# <i>source /etc/profile</i>
</pre>

<p>
Configuration du noyau&nbsp;: lorsque vous exécutez <c>make menuconfig</c> pour
configurer votre noyau, n'oubliez pas d'ajouter les options suivantes en plus
de celles recommandées dans les instructions d'installation.
</p>

<pre caption="Options de menuconfig">
- Support pour votre adaptateur réseau

- Dans la section "Networking options" :

[*] TCP/IP networking
[*] IP: kernel level autoconfiguration
[*] IP: DHCP support
[*] IP: BOOTP support


- Dans la section "File systems --> Network File Systems" :

&lt;*&gt; NFS file system support
[*] Provide NFSv3 client support
[*] Root file system on NFS
</pre>

<p>
Ensuite, configurez le fichier <path>/etc/fstab</path> de votre client sans
disque.
</p>

<pre caption="/etc/fstab">
# <i>nano -w /etc/fstab</i>
/dev/cdroms/cdrom0 /mnt/cdrom iso9660 noauto,ro 0 0
proc /proc proc defaults 0 0
tmpfs /dev/shm tmpfs defaults 0 0
</pre>

<p>
Chargeur de démarrage. N'installez pas un autre chargeur de démarrage puisque
nous en avons déjà un&nbsp;: pxegrub. Terminez simplement l'installation et
redémarrez le serveur. Démarrez les services dont vous avez besoin pour
démarrer le nouveau client, soit&nbsp;: DHCP, TFTPD et NFS.
</p>

<pre caption="Démarrage des services">
# <i>/etc/init.d/dhcp start</i>
# <i>/etc/init.d/tftpd start</i>
# <i>/etc/init.d/nfs start</i>
</pre>

</body>
</section>
<section>
<title>Démarrer le nouveau client</title>
<body>

<p>
Pour que le nouveau client démarre correctement, vous devez configurer le BIOS
et l'adaptateur réseau afin d'utiliser PXE comme première méthode de démarrage
(avant le CD-ROM ou la disquette). Pour obtenir de l'aide à ce sujet, consultez
les manuels pour votre matériel ou les sites Web des constructeurs.
L'adaptateur réseau devrait obtenir une adresse IP par DHCP et télécharger
l'image PXE de GRUB par TFTP. Vous verrez alors un élégant menu de démarrage
GRUB en noir et blanc. Choisissez le noyau à démarrer puis tapez Entrée. Si
tout se passe bien, le noyau devrait démarrer, monter le système de fichiers
racine par NFS et afficher une invite de connexion. Appréciez&nbsp;!
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installer Gentoo à partir d'une distribution Linux déjà installée</title>
<section>
<title>Prérequis</title>
<body>

<p>
Afin d'installer Gentoo à partir de votre distribution déjà installée, la
commande <c>chroot</c> doit être installée sur votre système. Vous devez aussi
disposer du fichier ISO ou de l'archive tar Gentoo que vous souhaitez installer.
</p>

</body>
</section>
<section>
<title>Vue d'ensemble</title>
<body>

<p>
Nous allons d'abord allouer une partition à Gentoo en redimensionnant la
partition Linux existante. Puis, nous monterons la partition et y
désarchiverons le fichier tar. Nous entrerons ensuite dans ce pseudo-système
avec la commande <c>chroot</c>. Nous pourrons alors débuter l'installation du
système. Une fois le «&nbsp;bootstrap&nbsp;» terminé, nous procéderons à la
configuration finale du système afin de s'assurer qu'il puisse démarrer. Nous
serons alors prêt à redémarrer et à utiliser Gentoo.
</p>

</body>
</section>
<section>
<title>Comment faire de la place à Gentoo&nbsp;?</title>
<body>

<p>
La partition racine contient le système fichiers monté sur <path>/</path>.
Exécuter simplement <c>mount</c> sans argument permet de visualiser les
différents points de montage. Nous utiliserons aussi df («&nbsp;disk
free&nbsp;») pour savoir quelle quantité d'espace disque est disponible et
comment la partition sera redimensionnée. Notez bien qu'il n'est pas
obligatoire de redimensionner votre partition racine&nbsp;! Vous pouvez choisir
n'importe quelle partition supportée par le programme de redimensionnement.
(Nous en reparlerons un peu plus loin.)
</p>

<pre caption="Obtenir de l'information sur le système de fichiers">
# <i>mount</i>
/dev/hdb2 on / type ext3 (rw)
none on /proc type proc (rw)
none on /dev/pts type devpts (rw,gid=5,mode=620)
none on /dev/shm type tmpfs (rw)
# <i>df -h </i>
Filesystem           Size Used Avail Use% Mounted on
/dev/hdb2            4.0G 1.9G  2.4G  82% /
none		      38M    0    38M   0% /dev/shm
</pre>

<p>
On remarque que la partition montée sur <path>/</path> se nomme
<path>/dev/hdb2</path> et dispose de 2,4&nbsp;Go d'espace libre. Je vais
redimensionner cette partition pour laisser 400&nbsp;Mo d'espace libre, ce qui
permettra d'allouer 2&nbsp;Go à Gentoo. Ça me semble approprié, car j'ai
l'intention d'y installer beaucoup de choses. Toutefois, un&nbsp;Go est
suffisant pour la plupart des utilisateurs. Maintenant, partitionnons&nbsp;!
</p>

</body>
</section>
<section>
<title>Installer parted pour le redimensionnement des partitions</title>
<body>

<p>
Parted est un utilitaire conçu par la fondation GNU, un immense et vénérable
projet. (Vous utilisez probablement des logiciels GNU en ce moment même.) Cet
utilitaire sera pour nous un outil précieux. Le nom parted signifie
«&nbsp;partition editor&nbsp;». Vous pouvez le télécharger à partir de
<uri>http://www.gnu.org/software/parted/</uri>.
</p>

<note>
Il existe d'autres outils servant à redimensionner des paritions. Toutefois,
l'auteur ne prétend pas savoir si ces outils (PartitionMagic(tm) et autres)
conviennent à ce que nous tentons de faire dans ce guide. (L'auteur ne
s'intéresse d'ailleurs pas à ce type de logiciels.) S'il souhaite utiliser un
outil alternatif, le lecteur devra déterminer lui-même si celui-ci est
approprié.
</note>

<p>
Recherchez sur cette page le type de système de fichiers que vous souhaitez
redimensionner et vérifiez si parted le supporte. Si ce n'est pas le cas, c'est
peine perdue&nbsp;; vous devrez détruire une partition afin de faire de
l'espace pour Gentoo et réinstaller ensuite ce que vous aurez détruit. Si votre
système de fichiers est supporté, téléchargez le logiciel et installez-le.
Vous ferez alors face à un problème&nbsp;: puisque l'on souhaite redimensionner
la partition racine, il est nécessaire de redémarrer le système à partir d'une
disquette contenant un système Linux minimum ainsi que le programme parted,
pré-compilé puis copié sur cette disquette. Toutefois, si vous pouvez démonter
la partition que vous souhaitez redimensionner sans quitter Linux, vous n'avez
pas besoin de suivre les instructions suivantes. Vous n'avez qu'à compiler
parted et à l'exécuter sur la partition démontée de votre choix. Voici ce que
j'ai fait pour mon système.
</p>

<impo>
Assurez-vous que les opérations que vous voulez faire sur vos partitions sont
supportées par parted&nbsp;!
</impo>

<p>
Téléchargez la disquette démarrage/administration tomsrtbt (logiciel gratuit)
à partir de <uri>http://freshmeat.net/tomsrtbt </uri>. Créez une disquette tel
que suggéré dans la documentation qui accompagne le programme et insérez une
nouvelle disquette dans le lecteur pour l'étape suivante.
</p>

<note>
Bien sûr, Linux est synonyme de «&nbsp;Il y a plus d'une façon de le
faire.&nbsp;». Notre objectif est d'exécuter parted sur une partition démontée.
Vous pouvez utiliser une disquette de démarrage/administration autre que
tomsrtbt. Cette étape n'est d'ailleurs pas toujours nécessaire&nbsp;; dans
certains cas, vous pouvez simplement démonter le système de fichiers de la
partition à repartitionner puis exécuter parted sans quitter votre session
Linux.
</note>

<pre caption="Création d'une disquette pour l'utilitaire parted">
# <i>mkfs.minix /dev/fd0</i>
480 inodes
1440 blocks
Firstdatazone=19 (19)
Zonesize=1024
Maxsize=268966912
</pre>

<p>
Nous allons maintenant procéder à la compilation de parted. Si le logiciel
n'est pas déjà téléchargé et désarchivé, faites-le maintenant et placez-vous
dans le répertoire correspondant avec la commande <c>cd</c>. Exécutez
les commandes suivantes afin de construire l'utilitaire et de le copier sur
votre disquette.
</p>

<pre caption="Compilation et installation de parted sur la disquette">
# <i> mkdir /floppy; mount -t minix /dev/fd0 /floppy &amp;&amp;
export CFLAGS="-O3 -pipe -fomit-frame-pointer -static" &amp;&amp; ./configure
&amp;&amp; make &amp;&amp; cp parted/parted /floppy &amp;&amp; umount /floppy
</i>
</pre>

<p>
Félicitations&nbsp;! Vous êtes prêt à redémarrer et à redimensionner votre
partition. Avant de faire cela, parcourez rapidement la documentation de parted
sur le site Web de GNU. Le redimensionnement ne devrait pas prendre plus de 30
minutes, même pour les disques les plus spacieux. Soyez patient. Redémarrez
votre système avec la disquette de démarrage tomsrtbt (insérez-la simplement
dans le lecteur) et, une fois votre session ouverte, remplacez la disquette par
celle contenant l'utilitaire parted. Ensuite, tapez mount /dev/fd0 /floppy pour
que parted soit monté sur /floppy. Et voilà&nbsp;! Exécutez parted et commencez
le redimensionnement. Une fois cette longue procédure terminée, vous serez prêt
pour votre divertissement principal&nbsp;: installer Gentoo.  Pour l'instant,
redémarrez votre vieux système Linux. Le disque dur sur lequel vous voulez
opérer est celui qui contient la partition à redimensionner. Par exemple, si
vous redimensionnez /dev/hda3, le disque est /dev/hda.
</p>

<pre caption="Commandes à exécuter dans le système tomsrtbt">
# <i>mount /dev/fd0 /floppy </i>
# <i>cd /floppy; ./parted [disque sur lequel vous vous opérer]</i>
(parted) <i> print </i>
Disk geometry for /dev/hdb: 0.000-9787.148 megabytes
Disk label type: msdos
Minor    Start       End     Type      Filesystem  Flags
1          0.031   2953.125  primary   ntfs
3       2953.125   3133.265  primary   linux-swap
2       3133.266   5633.085  primary   ext3
4       5633.086   9787.148  extended
5       5633.117   6633.210  logical
6       6633.242   9787.148  logical   ext3
(parted) <i> help resize </i>
  resize MINOR START END        resize filesystem on partition MINOR

        MINOR is the partition number used by Linux.  On msdos disk labels, the
        primary partitions number from 1-4, and logical partitions are 5
        onwards.
        START and END are in megabytes
(parted) <i> resize 2 3133.266 4000.000 </i>
</pre>

<impo>Soyez patient&nbsp;! L'ordinateur travaille&nbsp;! Vérifiez la
diode du disque dur sur votre boîtier pour le confirmer. La procédure
devrait prendre entre 2 et 30 minutes.</impo>

<p>
Après le redimensionnement, redémarrez votre vieux système Linux. Ensuite,
suivez les instructions du <uri
link="/doc/fr/handbook/handbook-x86.xml?part=1&amp;chap=4">Manuel Gentoo,
chapitre&nbsp;: Préparer les disques</uri>. Lorsqu'il est temps d'entrer dans
le nouveau système avec <c>chroot</c>, utilisez la commande suivante pour
nettoyer votre environnement&nbsp;:
</p>

<pre caption="Nettoyer l'environnement lors de l'utilisation de chroot">
# <i>env -i /usr/sbin/chroot /mnt/gentoo /bin/bash</i>
</pre>

<p>
Appréciez&nbsp;!
</p>

</body>
</section>
</chapter>

</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/Attic/doc-tipsntricks.xml,v 1.2 2004/03/13 01:18:02 neysx Exp $ -->

<guide link="/doc/fr/doc-tipsntricks.xml" lang="fr">
<title>Trucs et astuces pour le développement de la documentation</title>
<author title="Auteur">
    <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Traducteur">
    <mail link="olivier.fisette@sympatico.ca">Olivier Fisette</mail>
</author>

<abstract>
Quelques trucs et astuces qui faciliteront le travail des développeurs Gentoo 
(ou qui le rendront impossible :)
</abstract>

<license/>

<version>0.7</version>
<date>13 mars 2004</date>

<chapter>
<title>Paramétrer votre environnement local</title>
<section>
<title>Environnement local pour les contributeurs</title>
<body>

<p>
Créez un répertoire dédié au développement de la documentation. À titre
d'exemple, nous utiliserons <path>~/work/gentoo/doc</path>. Dans ce répertoire,
créez un sous-répertoire dans lequel vous conserverez la documentation (à jour)
en anglais (par exemple, <path>en/</path>).
</p>

<p>
Téléchargez l'archive tar la plus récente de la documentation anglaise&nbsp;:
</p>

<pre caption="Télécharger la documentation anglaise">
# <i>wget http://www.gentoo.org/dyn/doc-snapshots/docs-latest-en.tar.bz2</i>
</pre>

<p>
Désarchivez la documentation dans le répertoire <path>en/</path>. Vous 
disposez maintenant d'un instantané à jour de la documentation anglaise. 
Chaque fois que vous souhaiterez mettre à jour votre instantané, vous pourrez 
télécharger l'archive à nouveau, ou alors naviguer dans la documentation et 
ajouter <path>?passthru=1</path> à l'URL. Par exemple&nbsp;:
</p>

<pre caption="Mettre à jour un document en anglais">
# <i>wget http://www.gentoo.org/doc/en/alsa-guide.xml?passthru=1 -O alsa-guide.xml</i>
</pre>

<p>
Si vous voulez participer à la traduction de la documentation, créez un 
répertoire pour votre langue dans lequel vous garderez les traductions 
courantes&nbsp;:
</p>

<pre caption="Télécharger un instantané pour votre langue">
# <i>mkdir </i><comment>${LANG}</comment>
# <i>cd </i><comment>${LANG}</comment>
# <i>wget http://www.gentoo.org/dyn/doc-snapshots/docs-latest-</i><comment>${LANG}</comment><i>.tar.bz2</i>
# <i>tar xvjf docs-latest-*.tar.bz2</i>
</pre>

<p>
Lorsque vous mettez un document à jour, copiez-le toujours à partir de
<path>${LANG}/</path> vers le répertoire racine
(<path>~/work/gentoo/doc</path>). Ensuite, modifiez cette copie. Vous devez
conserver l'original afin de créer un correctif («&nbsp;patch&nbsp;»)&nbsp;:
</p>

<pre caption="Créer un correctif pour une mise à jour">
# <i>diff -uNt </i><comment>${LANG}</comment><i>/alsa-guide.xml alsa-guide.xml</i> > alsa-guide.diff
</pre>

</body>
</section>
<section>
<title>Dépôt CVS en ligne</title>
<body>

<p>
Vous pouvez utiliser notre <uri link="/cgi-bin/viewcvs.cgi">dépôt CVS en
ligne</uri> pour déterminer les différences entre des versions d'un même
document. Le dépôt principal pour les documents en anglais est <uri
link="/cgi-bin/viewcvs.cgi/gentoo/xml/htdocs/doc/en/?sortby=date">intégralement
disponible</uri>. Notez que le dépôt CVS en ligne est mis à jour toutes les
heures.
</p>

</body>
</section>
<section>
<title>Dépôt local pour les développeurs</title>
<body>

<p>
Créez un répertoire dédié à Gentoo, par exemple 
<path>~/work/gentoo/doc</path>. Ensuite, créez un sous-répertoire nommé 
<path>cvs/</path> dans lequel vous conserverez un instantané du CVS&nbsp;:
</p>

<pre caption="Obtenir un instantané du CVS">
# <i>mkdir cvs; cd cvs/</i>
# <i>export CVSROOT=</i><comment>&lt;votre nom d'utilisateur&gt;</comment><i>@cvs.gentoo.org:/home/cvsroot</i>
# <i>cvs co doc</i>
</pre>

<p>
Pour mettre à jour l'instantané du CVS, exécutez <c>cvs update -dP</c> dans 
le répertoire <path>cvs/doc</path>.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Tester GuideXML</title>
<section>
<title>Environnement de test</title>
<body>

<p>
D'abord, créez un répertoire <path>test/</path> dans lequel vous conserverez 
<path>guide.dtd</path>, <path>main.css</path> ainsi que quelques images&nbsp;:
</p>

<pre caption="Créer l'environnement de test">
# <i>mkdir test</i>
# <i>cd test</i>
# <i>mkdir dtd css images</i>
# <i>wget -P dtd/ http://www.gentoo.org/dtd/guide.dtd</i>
# <i>wget -P dtd/ http://www.gentoo.org/dtd/book.dtd</i>
# <i>wget -P css/ http://www.gentoo.org/css/main.css</i>
# <i>wget -P images/ http://www.gentoo.org/images/gbot-s.gif \
  http://www.gentoo.org/images/gridtest.gif \
  http://www.gentoo.org/images/gtop-s.jpg \
  http://www.gentoo.org/images/line.gif \
  http://www.gentoo.org/images/netraverse-gentoo.gif</i>
</pre>

<p>
Téléchargez une version spéciale de <path>guide.xsl</path> disponible sur <uri
link="http://dev.gentoo.org/~swift/local/guide.xsl">l'espace Web de 
SwifT</uri>. Cette version est adaptée pour la transformation locale de 
GuideXML en HTML.
</p>

<pre caption="Télécharger guide.xsl">
# <i>wget http://dev.gentoo.org/~swift/local/guide.xsl</i>
</pre>

<p>
Terminez en éditant <path>/etc/xml/catalog</path> pour y ajouter la ligne 
suivante&nbsp;:
</p>

<pre caption="Addenda à /etc/xml/catalog">
&lt;rewriteURI uriStartString="/dtd" rewritePrefix="<i>/chemin/vers/répertoire-dtd</i>"/&gt;
</pre>

<p>
Bien sûr, changez <c>/chemin/vers/répertoire-dtd</c> par le chemin du répertoire
où vous avez téléchargé les fichiers <path>guide.dtd</path> et 
<path>book.dtd</path>.
</p>

</body>
</section>
<section>
<title>Tester un guide Gentoo</title>
<body>

<p>
Pour tester un guide Gentoo, vérifiez d'abord si sa syntaxe XML est 
valide&nbsp;:
</p>

<pre caption="Utiliser xmllint pour vérifier les guides">
# <i>xmllint --valid --noout alsa-guide.xml</i>
</pre>

<p>
Si <c>xmllint</c> se termine sans afficher quoi que ce soit, cela indique que 
le fichier est exempt d'erreurs (du moins en ce qui concerne les balises XML). 
La prochaine étape est la conversion du fichier en HTML. L'outil idoine est 
<c>xsltproc</c>&nbsp;:
</p>

<pre caption="Conversion en HTML">
# <i>xsltproc --novalid test/guide.xsl alsa-guide.xml &gt; test/alsa-guide.html</i>
</pre>

<p>
Si aucune erreur n'est affichée, vous devriez pouvoir pointer votre
navigateur vers 
<uri>file:///home/user/work/gentoo/doc/test/alsa-guide.html</uri> pour 
consulter le document résultant de la conversion. Dans tous les autres cas, 
vous devrez corriger votre guide jusqu'à ce qu'il fonctionne convenablement.
</p>

</body>
</section>
<section>
<title>Tester le Manuel Gentoo</title>
<body>

<p>
Le manuel Gentoo est divisé en chapitres. Pour traiter un chapitre, vous 
devez utiliser à la fois le fichier <path>handbook.xml</path> et le fichier 
<path>hb-</path> (tel que <path>hb-install-about.xml</path>). Vous devez 
également fournir à <c>xsltproc</c> des paramètres identiques à ceux qui sont 
utilisés pour la navigation en ligne du Manuel, soit <c>part</c> et 
<c>chap</c>. Par exemple, pour valider 
<path>hb-install-about.xml</path>&nbsp;:
</p>

<pre caption="Valider hb-install-about.xml">
# <i>xmllint --valid --noout handbook.xml</i>
# <i>xmllint --valid --noout hb-install-about.xml</i>
# <i>xsltproc --stringparam part 1 --stringparam chap 1 test/guide.xsl handbook.xml &gt; test/hb-install-about.html</i>
</pre>

</body>
</section>
</chapter>
</guide>

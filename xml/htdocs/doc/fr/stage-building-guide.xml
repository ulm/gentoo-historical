<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/Attic/stage-building-guide.xml,v 1.1 2003/10/27 19:22:11 neysx Exp $-->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/stage-building-guide.xml">

<author title="Auteur"><!--zhen@gentoo.org-->John P. Davis</author>
<author title="Auteur"><mail link="avenj@gentoo.org">Jon Portnoy</mail></author>
<author title="Correcteur"><mail link="peesh@gentoo.org">Jorge Paulo</mail></author>
<author title="Traducteur"><mail link="mat@frheaven.com">Matthieu Montaudouin</mail></author>

<license/>

<version>1.1</version>
<date>15 juin 2003</date>

<abstract>
Ce guide explique comment compiler des stages pour Gentoo Linux.
</abstract>

<chapter>
<title>Préliminaires</title>
<section>
<title>Introduction</title>
<body>
<p>
Ce guide est une explication sur la façon de compiler de nouveaux stages
pour Gentoo Linux en utilisant stager, notre application de compilation de
stage.
</p>

</body>
</section>
<section>
<title>Obtenir les sources</title>
<body>
<p>
Avant de compiler quoi que ce soit, il est nécessaire d'obtenir les sources
et outils nécessaires.  Tout d'abord, assurez-vous d'avoir le module
<i>gentoo-src</i> récupéré depuis le CVS et qu'il est à jour.  Les scripts
de compilation changent fréquemment, assurez-vous d'être à jour.  Si vous
n'avez pas accès au module gentoo-src, vous pouvez trouver un instantané de
stager à <uri>http://dev.gentoo.org/~avenj/stager/</uri>.  De plus, vous
aurez besoin du tout dernier tarball du stage 1 expérimental.  Il peut
normalement être trouvé sur <path>experimental/x86/stages</path> sur
n'importe quel miroir Gentoo.  Le tarball que vous recherchez est
stage1-x86-1.4_pre<i>DATE</i>.tar.bz2, où <i>DATE</i> est la date la plus
récente disponible.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Le processus de compilation</title>
<section>
<title>Première étape</title>
<body>
<p>
Commencez par créer un répertoire sur une grande partition qui contiendra
tous les fichiers de compilation.  Ensuite, copiez le répertoire
<path>stager</path> depuis <i>gentoo-src</i> dans ce nouveau répertoire
(<path>/usr/src/build</path> dans ce document).  Sinon, extrayez le tarball
de l'instantané dans ce répertoire.  Finalement, créez un répertoire dans
<path>/usr/src/build</path> nommé <i>stages</i> et mettez y le tarball
expérimental du stage 1.
</p>

<pre caption="Se préparer">
# <c>mkdir /usr/src/build</c>
<comment>
(Vous pouvez utiliser le chemin que vous souhaitez.)
</comment>
# <c>cp -R /gentoo-src/stager/ /usr/src/build</c>
# <c>cd /usr/src/build/stager ; mkdir stages</c>
# <c>mv stage1-x86-1.4_preDATE.tar.bz2 /usr/src/build/stager/stages</c>
</pre>

</body>
</section>

<section>
<title>Compilation</title>
<body>
<p>
Tout d'abord, nous avons besoin de compiler un tarball de stage2 qui
utilise les optimisations standard.  Ce tarball sera utilisé pour compiler
n'importe quel nouveau stage, y compris un stage1 tout frais.
</p>

<pre caption="Compiler un stage2">
# <c>./stager x86 2 orig dest</c>
<comment>
(Ci-dessus, orig corresponds à la date dans le nom du tarball expérimental,
dest corresponds à la date du nouveau tarball. Remplacez-les par ce qu'il faut.)
</comment>		
</pre>

<p>
Une fois cette compilation terminée, vous devriez avoir un tarball tout
neuf à côté de votre tarball de stage1 dans le répertoire
<path>stages</path>.  Maintenant, vous pouvez compiler un nouveau stage 1
depuis votre stage 2 en utilisant la même méthode&nbsp;:
</p>

<pre caption="Compiler un nouveau stage1">
# <c>./stager x86 1 dest dest</c>
</pre>

<p>
Et voilà! Vous avez compilé un nouveau stage 1 à côté de votre stage 1
original et de votre nouveau stage 2.  Vous pouvez maintenant compiler des
tarball non génériques optimisés pour certains types de processeurs.
Rappelez-vous que ces tarballs optimisés ne <i>peuvent pas</i> être
utilisés pour compiler d'autres stages.  Seuls des tarballs génériques
doivent être utilisés pour compiler d'autres stages.  Compiler pour
d'autres sous-types est similaire, remplacez simplement x86 par le
sous-type spécifique.  Pour obtenir une liste des sous-types, exécutez
stager sans argument.
</p>

</body>
</section>

</chapter>

<chapter>
<title>Notes finales</title>
<section>
<title>Contacts</title>
<body>

<table>
<tr>
  <th>Contact</th>
  <th>Fonction</th>
</tr>
<tr>
  <ti><mail link="avenj@gentoo.org">Jon Portnoy</mail></ti>
  <ti>Gestionnaire des versions de Gentoo Linux, auteur</ti>
</tr>
<tr>
  <ti><mail link="jhhudso@gentoo.org">Jared Hudson</mail></ti>
  <ti>Assurance qualité des versions</ti>
</tr>
<tr>
  <ti><!--zhen@gentoo.org-->John Davis</ti>
  <ti>Auteur</ti>
</tr>
<!--Jon apparaît déjà ci-dessus
<tr>
  <ti><mail link="avenj@gentoo.org">Jon Portnoy</mail></ti>
  <ti>Auteur</ti>
</tr>
-->
</table>

</body>
</section>
</chapter>
</guide>

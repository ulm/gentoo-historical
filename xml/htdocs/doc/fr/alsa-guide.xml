<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/alsa-guide.xml,v 1.14 2004/05/11 12:15:51 neysx Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/alsa-guide.xml" lang="fr">
<title>Guide ALSA pour Gentoo Linux</title>
<author title="Auteur">
 <mail link="zu@pandora.be">Vincent Verleye</mail>
</author>
<author title="Auteur">
 <mail link="g2boojum@gentoo.org">Grant Goodyear</mail>
</author>
<author title="Auteur">
 <mail link="agenkin@gentoo.org">Arcady Genkin</mail>
</author>
<author title="Auteur">
<mail link="eradicator@gentoo.org">Jeremy Huddleston</mail>
</author>
<author title="Correcteur"><!--zhen@gentoo.org" -->
 John P. Davis
</author>
<author title="Correcteur">
 <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Correcteur">
 <mail link="bennyc@gentoo.org">Benny Chuang</mail>
</author>
<author title="Correcteur">
 <mail link="blubber@gentoo.org">Tiemo Kieft</mail>
</author>
<author title="Correcteur">
 <mail link="erwin@gentoo.org">Erwin</mail>
</author>
<author title="Traducteur">
 <mail link="takezo@skynet.be">Olivier Roomans</mail>
</author>
<author title="Traducteur">
 <mail link="cam@cameuh.net">Camille Huot</mail>
</author>

<abstract>
Ce guide vous explique comment mettre en place ALSA (Advanced Linux Sound
Architecture) sur Linux Gentoo.  En complément du guide de configuration du
bureau («&nbsp;Gentoo Linux Desktop Configuration Guide&nbsp;»), ce guide est
supposé vous donner plus d'informations à ce sujet.
</abstract>

<license/>

<version>1.4.3</version>
<date>9 mai 2004</date>

<chapter>
<title>Introduction</title>
<section>
<title>Qu'est-ce que ALSA ?</title>
<body>

<p>
L'architecture son avancée Linux (ALSA) est un projet pour améliorer le
sous-système sonore en en récrivant une grande partie. ALSA a remplacé OSS
(Open Sound System) en tant que sous-système sonore par défaut dans le noyau
2.6, mais il peut très bien être utilisé avec un noyau 2.4.
</p>

<p>
ALSA fournit des fonctionnalités audio et MIDI à Linux.
</p>

<p>
En reprenant <uri>http://www.alsa-project.org/</uri>, ALSA a les
caractéristiques suivantes&nbsp;:
</p>

<ul>
<li>
  Support efficace de tous les types d'interface audio, des cartes son de
  l'utilisateur normal aux interfaces audio multicanaux professionnelles&nbsp;;
</li>
<li>Pilotes son complètement modularisés&nbsp;;</li>
<li>SMP et design thread-safe&nbsp;;</li>
<li>
  Bibliothèque d'espace utilisateur (user space) (alsa-lib) pour simplifier la
  programmation d'applications et fournir des fonctionnalités de plus haut
  niveau&nbsp;;
</li>
<li>
  Support des anciennes API OSS qui fournissent une compatibilité binaire pour
  la majorité des programmes OSS.
</li>
</ul>

<p>
Cependant, ALSA a beaucoup d'autres fonctionnalités telles que le support de 
la restitution et l'enregistrement Full Duplex, le support de cartes son 
multiples, le mixage matériel de flux, des capacités de mixage étendues (pour 
supporter les fonctionnalités avancées des nouvelles cartes son), etc.
</p>

</body>
</section>

<section>
<title>Pourquoi utiliser ALSA ?</title>
<body>

<p>
Votre carte son est peut-être supportée par des modules disponibles dans le
noyau 2.4 (ils sont aussi disponibles dans le noyau 2.6 sous l'option
«&nbsp;Open Sound System (DEPRECATED)&nbsp;»). Vous pouvez aussi peut-être
utiliser les pilotes commerciaux OSS/4Front. Si vous souhaitez utiliser un de
ces systèmes, alors lisez le <uri
link="http://www.tldp.org/HOWTO/Sound-HOWTO/index.html">Linux Sound HOWTO</uri>.
</p>

<p>
Cependant, ces pilotes OSS/4 ont quelques limitations, notamment celle d'être
commerciaux.  ALSA est un projet qui souhaite se débarrasser de ces limites en
utilisant un modèle de développement à code ouvert.  ALSA est un système de
pilotes son complètement GPL et LGPL qui fournit un système de qualité
professionnelle pour enregistrer, jouer et faire du séquençage MIDI.
</p>

</body>
</section>

<section>
<title>Quelles sont les cartes supportées par ALSA ?</title>
<body>

<p>
ALSA essaie de supporter autant de (nouvelles) cartes son que possible en
fournissant des pilotes Open Source. Cependant, quelques fournisseurs ne donnent
que des paquets binaires.
</p>

<p>
Pour savoir si votre carte est supportée, vous trouverez un tableau des cartes
son supportées et non-supportées ici&nbsp;:
<uri>http://www.alsa-project.org/alsa-doc/</uri>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installation</title>
<section>
<title>Les variables USE utilisées par ALSA</title>
<body>

<p>
Pour compiler vos programmes avec le support pour ALSA, ajoutez <e>alsa</e> à
votre variable USE. Certains logiciels ne supportent pas encore ALSA et ont
besoin de OSS. ALSA fournit une émulation de OSS si vous ajoutez <e>oss</e>
dans votre variable USE avant de l'installer.
</p>

</body>
</section>

<section>
<title>Les modules du noyau</title>
<body>

<p>
Si vous utilisez un noyau 2.4, vous devrez compiler les pilotes ALSA séparément
du reste du noyau. Si vous utilisez un noyau 2.6, vous avez le choix d'utiliser
les modules ALSA fournis dans le noyau ou d'utiliser ceux du paquet
<c>alsa-driver</c>.
</p>

<p>
Premièrement, nous allons nous assurer que notre configuration du noyau est
prête pour être utilisée avec ALSA.  Tout ce dont vous avez besoin dans la
configuration de votre noyau est le support pour les cartes son (Sound Card
Support) sélectionné en tant que module (M). Ceci va compiler
<c>soundcore.o</c>.
</p>

<note>
Cela devrait fonctionner avec le support pour carte son (Sound Card Support)
intégré au noyau (Y) au lieu d'être en module (M).  Cependant, la documentation
officielle d'ALSA suggère de le compiler en module, car ALSA va essayer de le
charger.
</note>

<p>
Si vous avez déjà une configuration de noyau en fonctionnement, assurez-vous
que vous avez enlevé tous les pilotes de son (excepté celui pour le support de
la carte son qu'on vient d'activer).  Pour faire ça sans devoir redémarrer,
procédez ainsi&nbsp;:
</p>

<pre caption="Configuration du noyau">
# <i>cd /usr/src/linux</i>
# <i>cp .config ~/</i>
# <i>make mrproper</i>
# <i>cp ~/.config .</i>
# <i>make menuconfig</i>
</pre>

<p>
Maintenant, sélectionnez <e>Sound Card Support</e> en tant que module (M) et
désélectionnez tous les autres pilotes son. Si vous utilisez un 2.6 avec les
modules ALSA fournis par le noyau, sélectionnez également les pilotes pour
votre carte son (jetez un œil à la section <uri link="#doc_chap2_sect3">Modules
ALSA</uri> si vous avez du mal à choisir les bons pilotes. Quittez et répondez
Y pour sauver la configuration de votre noyau. Après cela, compilez les
modules&nbsp;:
</p>

<pre caption="Compilation d'un noyau 2.4">
# <i>make dep clean</i>
# <i>make modules modules_install</i>
</pre>

<pre caption="Compilation d'un noyau 2.6">
# <i>make</i>
# <i>make modules_install</i>
</pre>

<p>
Si vous avez compilé un 2.6 avec les modules ALSA fournis par le noyau, vous
pouvez sauter à la section <uri link="#doc_chap2_sect4">Configuration
d'ALSA</uri> plus bas.
</p>

<p>
Avant d'installer vos nouveaux modules, cette dernière ligne va supprimer tous 
les modules précédents, même ceux d'une installation précedente d'ALSA.
</p>

<impo>
Cela signifie que, chaque fois que vous recompilerez votre noyau plus tard,
vous DEVREZ recompiler <c>alsa-driver</c>.
</impo>

</body>
</section>

<section>
<title>Les modules ALSA </title>
<body>

<p>
Maintenant, il est temps d'installer les pilotes ALSA pour votre(vos) carte(s) 
son. Si votre carte son est en PCI, vous pouvez trouver le nom et le type de 
votre carte son en regardant la sortie de <path>/proc/pci</path>.
</p>

<pre caption="Chercher des informations sur les cartes son">
# <i>grep audio /proc/pci</i>
</pre>

<warn>
Si vous avez déjà des modules de son installés, déchargez-les <e>maintenant</e>.
Vérifiez avec <c>lsmod</c> et utilisez <c>rmmod</c> pour décharger tous les
modules son de votre système. Si <c>rmmod</c> se plaint de ne pas pouvoir
décharger les modules parce qu'ils sont en cours d'utilisation, essayez
d'utiliser <c>/etc/init.d/alsasound stop</c> pour les enlever.
</warn>

<p>
Il ne nous reste plus qu'à faire un <c>emerge alsa-driver</c> maintenant, cela 
va compiler et installer <e>tous</e> les pilotes son ALSA.
</p>

<p>
Cependant, pour ne pas perdre de temps, vous pouvez regarder le <e>Module
Name</e> (Ndt: Nom du module) de votre(vos) carte(s) son sur le <uri
link="http://www.alsa-project.org/alsa-doc">tableau des cartes son ALSA</uri>
en suivant le lien <e>Details</e> de la colonne <e>Driver &amp; Docs</e> de la
ligne correspondant à votre carte son.  Pour moi, c'est <c>snd-emu10k1</c>
puisque j'ai une SBlive! qui intègre un chipset <e>EMU10K1</e>.  Nous allons
mettre la variable d'environnement ALSA_CARDS à la valeur du nom du module
(sans le "snd-") avant l'installation, ainsi emerge ne compilera que le(s)
pilote(s) dont nous avons besoin.
</p>

<pre caption="Avec un noyau 2.4">
# <i>env ALSA_CARDS='emu10k1' emerge alsa-driver</i>
</pre>

<pre caption="Avec un noyau 2.6">
# <i>env ALSA_CARDS='emu10k1' emerge \>=media-sound/alsa-driver-1.0.2c</i>
</pre>

<note>
Les noyaux 2.6 ont besoin de la version 1.0.2c d'alsa-driver au minimum.
</note>

<note>
Vous pouvez aussi placer cette variable d'environnement dans votre fichier
<path>/etc/make.conf</path> pour que la prochaine fois que vous aurez besoin
d'installer alsa-driver vous puissiez seulement faire un <c>emerge
alsa-driver</c>.
</note>

<note>
Si vous voulez installer les pilotes ALSA pour plusieurs cartes son, vous devez
configurer ALSA_CARDS avec une liste de noms de pilotes séparés par des espaces
comme ceci&nbsp;: <c>env ALSA_CARDS='emu10k1 intel8x0 ens1370' emerge
alsa-driver</c>.
</note>

<note>
Si vous désirez avoir la compatibilité avec OSS, vous devez avoir installé
<c>alsa-oss</c> qui offre une interface compatible avec celle de OSS.
</note>

<note>
Si vous comptez recompiler votre noyau plusieurs fois, il serait préférable 
d'installer <c>alsa-driver</c> avec l'option <c>--buildpkg</c>. Cela créera un 
paquet binaire d'alsa-driver. Plus tard, après avoir recompilé votre noyau, 
vous pourrez juste faire un <c>emerge --usepkg alsa-driver</c> ce qui installera
le paquet binaire au lieu de le recompiler complètement. Si «&nbsp;depmod 
-a&nbsp;» se plaint des modules de son qui auraient des symboles non référencés
lorsque vous utilisez cette méthode, vous devrez recompiler le paquet
alsa-driver à partir de ses sources.
</note>

<p>
Les modules ALSA devraient maintenant être installés sur votre système.
</p>

</body>
</section>

<section>
<title>Configuration d'ALSA</title>
<body>

<p>
Configurons maintenant ALSA pour qu'il fonctionne correctement.
Nous allons devoir éditer quelques fichiers pour mettre notre système au 
courant des modules ALSA fraîchement installés.
</p>

<p>
D'abord, installez <c>alsa-utils</c> sur votre système :
</p>

<pre caption="Installation d'alsa-utils">
# <i>emerge alsa-utils</i>
</pre>

<p>
Ensuite, nous devons éditer le fichier <path>/etc/modules.d/alsa</path>.
</p>

<warn>
N'éditez pas <path>/etc/modules.conf</path>. Éditez plutôt les fichiers dans
<path>/etc/modules.d/</path> et lancez <c>modules-update</c> pour générer le
<path>/etc/modules.conf</path> à partir des données à jour.
</warn>

<!-- supprimé du document original
<p>
Vérifiez la partie ALSA <e>au bas du fichier</e>.
En modifiant cette ligne, vous pouvez spécifier le nombre maximum de cartes son 
que vous avez (en général, juste une).
</p>

<pre caption="Au bas de /etc/modules.d/alsa">
<comment>Réglez le bon nombre de cartes son</comment>
options snd cards_limit=1
</pre>

<p>
Maintenant nous allons spécifier le(s) pilotes(s) que ALSA doit utiliser.
</p>
-->

<pre caption="Dans /etc/modules.d/alsa">
## and then run `update-modules' command.
## Read alsa-driver's INSTALL file in /usr/share/doc for more info.
##
##  ALSA portion
alias snd-card-0 snd-emu10k1
## alias snd-card-1 snd-intel8x0
## alias snd-card-2 snd-ens1370
##  OSS/Free portion
alias sound-slot-0 snd-card-0
## alias sound-slot-1 snd-card-1
## alias sound-slot-2 snd-card-2
##
</pre>

<note>
Si vous avez plus d'une carte son, ajoutez des alias <c>snd-card</c> et
<c>snd-slot</c> et réglez la valeur de <c>cards_limit</c> à la fin du fichier.
Vous pouvez trouver des exemples de configurations avec deux ou plusieurs
cartes son au <uri
link="http://www.alsa-project.org/alsa-doc/alsa-howto/c1660.htm">chapitre
6</uri> du <uri 
link="http://www.alsa-project.org/alsa-doc/alsa-howto/alsa-howto.html">ALSA 
HOWTO</uri>.
</note>

<p>
La dernière chose à faire dans ce fichier, tout à la fin, est de vérifier si ces
lignes sont présentes et décommentées&nbsp;:
</p>

<pre caption="Tout à la fin de /etc/modules.d/alsa">
alias /dev/mixer snd-mixer-oss
alias /dev/dsp snd-pcm-oss
alias /dev/midi snd-seq-oss
</pre>

<p>
Maintenant, vérifiez le fichier <path>/etc/modules.d/alsa</path> et quand vous
serez sûr que tout est correct, exécutez <c>modules-update</c>.
</p>

<pre caption="Exécution de modules-update">
# <i>modules-update</i>
</pre>

<note>
<c>modules-update</c> va insérer les données de
<path>/etc/modules.d/alsa</path> dans <path>/etc/modules.conf</path>.
</note>

<p>
Vous devriez aussi vérifier que <path>/etc/devfsd.conf</path> a les 
périphériques ALSA et les permissions enregistrées correctement.
</p>

<pre caption="/etc/devfsd.conf">
# ALSA/OSS stuff
# Comment/change these if you want to change the permissions on
# the audio devices
LOOKUP          snd          MODLOAD ACTION snd
LOOKUP          dsp          MODLOAD
LOOKUP          mixer        MODLOAD
LOOKUP          midi         MODLOAD
REGISTER        sound/.*     PERMISSIONS root.audio 660
REGISTER        snd/.*       PERMISSIONS root.audio 660
</pre>

<note>
Notez que <path>devfsd.conf</path> met les permissions de
<path>/dev/sound</path> à root.audio. C'est pourquoi, les utilisateurs non-root
qui veulent utiliser l'audio doivent faire partie du groupe audio.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Lancer ALSA</title>
<section>
<title>Ajouter alsasound à un niveau d'exécution</title>
<body>

<p>
Un script d'initialisation est fourni, il installera tous les pilotes
nécessaires à votre carte son (y compris les pilotes de compatibilité OSS si
vous êtes en USE=oss). La première chose à faire maintenant est de faire en
sorte que ALSA se lance au démarrage&nbsp;:
</p>

<pre caption="Ajouter ALSA aux scripts de démarrage">
# <i>rc-update add alsasound boot</i>
</pre>

<warn>
Notez que le script alsasound doit être ajouté au niveau d'exécution
«&nbsp;boot&nbsp;», et non pas au niveau d'exécution «&nbsp;default&nbsp;».
</warn>

</body>
</section>

<section>
<title>Lancement et activation du son</title>
<body>

<p>
Étant donné que nous sommes des utilisateurs de Linux, nous ne voulons pas
redémarrer notre machine. Nous allons donc lancer le script alsasound à la
main.
</p>

<pre caption="Démarrage d'ALSA">
# <i>/etc/init.d/alsasound start</i>
</pre>

<p>
Maintenant, ALSA tourne. Si tout est correct, vous devriez pouvoir voir les
modules ALSA chargés en lançant <c>lsmod</c>.  Cependant, le son ne marchera
pas encore, parce que tous les canaux sont muets.  Nous avons besoin de
<c>amixer</c> pour corriger cela.
</p>

<pre caption="Lancement de amixer">
# <i>amixer</i>
</pre>

<!-- alsasound s'en charge, à présent
<warn>
Vous ne devriez pas, mais <e>si</e> vous avez une erreur disant «&nbsp;amixer:
Mixer attach default error: No such file or directory&nbsp:», vous devrez faire
un modprobe de <c>snd-mixer-oss</c> et <c>snd-pcm-oss</c>. Après cela, lancez
amixer à nouveau.
</warn>

<pre caption="Uniquement si vous avez une erreur en lançant amixer">
# <i>modprobe snd-mixer-oss</i>
# <i>modprobe snd-pcm-oss</i>
# <i>amixer</i>
</pre>
-->

<p>
Si vous êtes arrivé jusqu'ici, activez les volumes pour les canaux Master et 
PCM. Certains matériels ont également besoin que vous activiez les canaux Center
ou même Surround.
</p>

<pre caption="Enlever la sourdine des canaux">
# <i>amixer set Master 100 unmute</i>
# <i>amixer set PCM 100 unmute</i>
<comment>Seulement si les commandes précédentes ne suffisent pas :</comment>
# <i>amixer set Center 100 unmute</i>
# <i>amixer set Surround 100 unmute</i>
<comment>Testez le son :</comment>
# <i>aplay $KDEDIR/share/sounds/pop.wav</i> <codenote>(pop.wav fait partie de KDE)</codenote>
</pre>

<p>
Nous vérifions si le son marche en utilisant la commande aplay (ALSA play). Si
vous entendez un pop, alors le son marche&nbsp;!  Puis, ajustez les réglages du
volume à votre convenance&nbsp;; le programme basé sur ncurses <c>alsamixer</c>
est un bon moyen de le faire.
</p>

<p>
Lorsque vous redémarrerez votre système, le script d'initialisation
<c>alsasound</c> se chargera de sauver et de mettre à jour vos réglages de
volumes.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Support MIDI</title>
<section>
<title>Synthétiseur matériel</title>
<body>

<p>
Certaines cartes son (SBLive!, Audigy et d'autres) possèdent un synthétiseur
MIDI intégré. Pour l'utiliser, vous devez d'abord installer le paquet
<c>awesfx</c>.
</p>

<pre caption="Installation du paquet awesfx">
# <i>emerge awesfx</i>
</pre>

<p>
Maintenant, vous devez mettre vos polices sonores dans
<path>/usr/share/sfbank</path>. Vous pourrez sûrement trouver ces polices sur le
CD fourni avec votre carte son contenant les pilotes pour Windows. Avec la
SBLive!, un des fichiers de polices sonores s'appelle <path>8MBGMSFX.SF2</path>.
</p>

<note>
Des CD plus récents fournis avec une carte SBLive! contiennent un fichier de
polices sonores nommé <path>CT4GMSFX.SF2</path>. Si vous avez un tel CD,
utilisez ce fichier au lieu du fichier mentionné ci-dessus.
</note>

<p>
Après avoir copié le fichier que vous voulez utiliser, vous devez le charger
avec <c>/usr/bin/sfxload</c>.
</p>

<pre caption="Chargement de la police sonore">
# <i>/usr/bin/sfxload /usr/share/sfbank/8MBGMSFX.SF2</i>
</pre>

<note>
Vous devriez placer cette commande dans votre
<path>/etc/conf.d/local.start</path> ou dans le script de démarrage de votre
carte son (/etc/alsa.d/emu10k1) pour être sûr qu'il sera chargé au démarrage.
</note>

<p>
Si vous ne trouvez pas de police sonore sur votre CD, vous pouvez en
télécharger depuis <uri>http://www.parabola.demon.co.uk/alsa/awe64.html</uri>.
</p>

</body>
</section>

<section>
<title>Le synthétiseur virtuel Timidity++</title>
<body>

<p>
Si votre carte son n'a pas de synthétiseur matériel (ou vous ne voulez pas
l'utiliser), vous pouvez utiliser le synthétiseur virtuel de <c>timidity++</c>.
Commençons par installer le paquet&nbsp;:
</p>

<pre caption="Installation de Timidity++">
# <i>emerge timidity++</i>
</pre>

<p>
Un exemple de fichier de configuration sera installé dans
<path>/usr/share/timidity/config/timidity.cfg</path>. Si vous n'avez pas déjà
de configuration pour timidity++, vous pouvez l'utiliser.
</p>

<pre caption="Utilisation du fichier de configuration de Timidity++ par défaut">
# <i>cp /usr/share/timidity/config/timidity.cfg /usr/share/timidity/</i>
</pre>

<p>
Enfin, vous devez activer le script d'initialisation pour qu'il se lance au
démarrage et le lancer dès maintenant&nbsp;:
</p>

<pre caption="Ajout de timidity au niveau d'exécution par défaut et lancement">
# <i>rc-update add timidity default</i>
# <i>/etc/init.d/timidity start</i>
</pre>

<p>
Notez qu'un fichier de configuration du script d'initialisation est
disponible&nbsp;: <path>/etc/conf.d/timidity</path> et que les valeurs par
défaut sont utilisables.
</p>

</body>
</section>

<section>
<title>Test du support MIDI</title>
<body>

<p>
Vous pouvez utiliser <c>pmidi</c> pour tester votre configuration MIDI. Pour
cela, vous devez d'abord installer ce paquet.
</p>

<pre caption="Installation de pmidi">
# <i>emerge pmidi</i>
</pre>

<p>
L'option en ligne de commande '-l' de pmidi liste tous les ports MIDI en sortie
détectés et '-p' peut être utilisé pour sélectionner un port particulier pour
la lecture. Regardez quels ports MIDI en sortie sont disponibles sur votre
système&nbsp;:
</p>

<pre caption="Liste des ports en utilisant un synthétiseur matériel">
# <i>pmidi -l</i>
 Port     Client name                       Port name	
 64:0     Rawmidi 0 - EMU10K1 MPU-401 (U    EMU10K1 MPU-401 (UART)	
 65:0     Emu10k1 WaveTable                 Emu10k1 Port 0	
 65:1     Emu10k1 WaveTable                 Emu10k1 Port 1	
 65:2     Emu10k1 WaveTable                 Emu10k1 Port 2	
 65:3     Emu10k1 WaveTable                 Emu10k1 Port 3	
</pre>

<pre caption="Liste des ports en utilisant Timidity++">
# <i>pmidi -l</i>
 Port     Client name                       Port name	
 64:0     Rawmidi 0 - ES1371                ES1371	
128:0     TiMidity                          TiMidity port 0	
128:1     TiMidity                          TiMidity port 1	
128:2     TiMidity                          TiMidity port 2	
128:3     TiMidity                          TiMidity port 3	
</pre>

<p>
Maintenant, essayons de jouer un fichier MIDI pour s'assurer que tout
fonctionne&nbsp;:
</p>

<pre caption="Jouer une chanson">
# <i>pmidi -p 65:0 Final\ Fantasy\ 7\ -\ Aerith\'s\ Theme.mid</i>
ou
# <i>pmidi -p 128:0 Final\ Fantasy\ 7\ -\ Aerith\'s\ Theme.mid</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Notes finales</title>
<section>
<title>Après une mise à jour du noyau...</title>
<body>

<p>
À chaque fois que vous recompilez votre noyau ou que vous passez à un autre 
noyau, vous devez recompiler les modules ALSA.
</p>

<p>
Cependant, si vous avez installé <c>alsa-driver</c>, <c>alsa-lib</c> et 
<c>alsa-utils</c>, seul le premier doit être ré-installé à nouveau, puisqu'il va
mettre les modules ALSA dans <path>/lib/modules/*/kernel/sound/pci/</path>.
</p>

<pre caption="Nécessaire après chaque compilation du noyau">
# <i>emerge alsa-driver</i>
</pre>

</body>
</section>

<section>
<title>alsa-tools et alsa-firmware</title>
<body>

<p>
Les paquets alsa-tools et alsa-firmware contiennent des outils utiles 
seulement pour les utilisateurs de certaines cartes son spécifiques. La plupart
des utilisateurs n'en auront pas besoin. Si vous avez besoin d'alsa-tools, vous
pouvez régler la variable d'environnement ALSA_TOOLS pour n'installer que les
outils nécessaires pour votre carte son&nbsp;:
</p>

<pre caption="Installation d'alsa-tools">
# <i>env ALSA_TOOLS='as10k1 ac3dec' emerge alsa-tools</i>
</pre>

</body>
</section>

<section>
<title>Mélanger des versions</title>
<body>

<p>
Dans la majorité des cas, des versions différentes de <c>alsa-driver</c>,
<c>alsa-lib</c>, <c>alsa-utils</c>, <c>alsa-tools</c> et <c>alsa-oss</c>
marcheront entre elles, mais il est recommandé que vous essayiez de garder les
versions synchronisées.
</p>

</body>
</section>

<section>
<title>/etc/modules.autoload</title>
<body>

<p>
Vous ne devez pas éditer ce fichier pour utiliser ALSA. Après avoir fait
<c>rc-update add alsasound boot</c>, les bons modules seront chargés au
démarrage.
</p>

<!--
<p>
Il n'est pas nécessaire d'ajouter <c>snd-pcm-oss</c> ou <c>snd-mixer-oss</c> 
dans ce fichier.
Allez voir <uri link="http://www.djcj.org/LAU/guide/alsbook/faq1.html">cette 
FAQ</uri> pour plus d'informations.
</p>
-->

</body>
</section>

<section>
<title>Bogues connus</title>
<body>

<note>
Ce guide est un peu en retard comparé au développement d'ALSA. Peut-être que
ces bogues seront déjà résolus lorsque vous lirez ces lignes.
</note>

<ul>
<li>
Si vous avez <b>beaucoup de bruit</b> lorsque vous utilisez l'émulation
<b>oss</b>, ajoutez <e>options snd-pcm-oss dsp_map=1</e> au fichier
<path>/etc/modules.d/alsa</path>.
</li>
</ul>

</body>
</section>

<section>
<title>Connecter une manette de jeu</title>
<body>

<p>
Si votre carte son est équipée d'une connexion pour une manette de jeu, vous
voudrez peut-être l'activer. Vérifiez d'abord si le pilote de votre carte a un
paramètre pour joystick. Vous pouvez utiliser <c>modinfo</c> avec votre
<path>snd-&lt;puce son&gt;</path>. Par exemple, pour une puce de type
<c>snd-via82xx</c>&nbsp;:
</p>

<pre caption="Exécuter modinfo">
# <i>modinfo snd-via82xx</i>
filename:    /lib/modules/2.4.22-ck2/snd-via82xx.o
description: "VIA VT82xx audio"
author:      "Jaroslav Kysela &lt;perex@suse.cz&gt;"
license:     "GPL"
parm:        index int array (min = 1, max = 8), description "Index value for VIA 82xx bridge."
parm:        id string array (min = 1, max = 8), description "ID string for VIA 82xx bridge."
parm:        enable int array (min = 1, max = 8), description "Enable audio part of VIA 82xx bridge."
parm:        mpu_port long array (min = 1, max = 8), description "MPU-401 port. (VT82C686x only)"
<i>parm:        joystick int array (min = 1, max = 8), description "Enable joystick. (VT82C686x only)"</i>
parm:        ac97_clock int array (min = 1, max = 8), description "AC'97 codec clock (default 48000Hz)."
parm:        dxs_support int array (min = 1, max = 8), description "Support for DXS channels 
             (0 = auto, 1 = enable, 2 = disable, 3 = 48k only, 4 = no VRA)"
</pre>

<p>
Si le pilote de votre carte a un paramètre pour <c>joystick</c>, vous devez
ajouter <c>joystick=1</c> sur la ligne <c>options</c> du fichier 
<path>/etc/modules.d/alsa</path>.
Par exemple, pour une <c>snd-via82xx</c>&nbsp;:
</p>

<pre caption="Ajouter le paramètre pour joystick">
alias snd-card-0 snd-via82xx
options snd-via82xx joystick=1
</pre>

</body>
</section>

<section>
<title>Quelques liens supplémentaires</title>
<body>

<p>
Vous pouvez allez voir ici pour plus d'informations&nbsp;:
</p>

<ul>
<li><uri link="http://www.gentoo.org/doc/fr/desktop.xml">Le Guide Gentoo de 
Configuration du Bureau</uri></li>
<li><uri link="http://www.alsa-project.org">Page du projet ALSA</uri></li>
<li><uri link="http://www.alsa-project.org/documentation.php3">Documentation 
Utilisateur du projet ALSA</uri></li>
<li><uri link="http://www.djcj.org">FAQ et HOWTO ALSA</uri></li>
<li><uri link="http://tldp.org/HOWTO/Sound-HOWTO/index.html">Sound-HOWTO pour 
Linux</uri></li>
<li><uri link="http://linux-sound.org/">Programmes Linux pour le son et le 
MIDI</uri></li>
</ul>

</body>
</section>
</chapter>
</guide>

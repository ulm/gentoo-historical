<?xml version='1.0' encoding="UTF-8"?>
<?xml-stylesheet href="/xsl/guide.xsl" type="text/xsl"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/gentoo-sparc-install.xml">
<title>Guide d'installation de Gentoo Linux sur Sparc/Sparc64</title>
<author title="Mainteneur"><mail link="murphy@gentoo.org">Maarten Thibaut</mail>
</author><author title="Editeur"><mail link="atom.stephens@ohiou.edu">Adam Stephens</mail></author>
<author title="Editeur"><mail link="manson@gentoo.org">Rodney Rees</mail></author>
<author title="Editeur"><mail link="zhware@gentoo.org">Stoyan Zhekov</mail></author>
<author title="Traducteur"><mail link="nissen.lutin@libertysurf.fr">Frederic Baujard</mail></author>

<abstract>Voici le guide d'installation de Gentoo Linux sur des machines basé sur Sparc. Si vous trouvez des erreurs ou des omissions envoyer un mail s'il vous plait au mainteneur ou à un des auteurs. </abstract>

<version>0.4.1</version>
<date>08 Décembre 2002 (traduction du 8 avril 2003)</date>
<chapter>
<title>Matériels supportés</title>
<section>
<body>
<p>
* Pour les machines Multiprocesseurs. Le support dépend en réalité du noyau, ces plateformes sont identiques à une machine
monoprocesseur pour notre but. Au démarrage, les images habituelles ont l'option SMP désactivée pour réduire la taille du noyau.</p>
<p>
Attention: La plupart de ces plateformes n'ont pas été testées. Le développement est fait par une poignée de personnes. Les rapports
de (non-)fonctionnement sont les bienvenues sur nos listes de diffusion.</p>
</body>
</section>
<section>
<title>Supportés par le projet 32-bit UltraLinux (sparc)</title>
<body>
<p>
<table>
<tr><th>* Architecture Sun4c (*):</th></tr>
<tr><ti>    o SPARCstation SLC (4/20)</ti></tr>
<tr><ti>    o SPARCstation ELC (4/25)</ti></tr>
<tr><ti>    o SPARCstation IPC (4/40)</ti></tr>
<tr><ti>    o SPARCstation IPX (4/50)</ti></tr>
<tr><ti>    o SPARCstation/server 1 (4/60)</ti></tr>
<tr><ti>    o SPARCstation/server 1+ (4/65)</ti></tr>
<tr><ti>    o SPARCstation/server 2 (4/75)</ti></tr>
<tr><th>* Architecture Sun4d :</th></tr>
<tr><ti>    o SparcCenter 2000</ti></tr>
<tr><th>* Architecture Sun4m :</th></tr>
<tr><ti>    o SPARCclassic</ti></tr>
<tr><ti>    o SPARCstation LC (4/15)</ti></tr>
<tr><ti>    o SPARCstation LX (4/30)</ti></tr>
<tr><ti>    o SPARCstation 4</ti></tr>
<tr><ti>    o SPARCstation/server 5 (70, 85, 110, and 170(**) Mhz)</ti></tr>
<tr><ti>    o SPARCstation/server 10 (avec pour la plupart des cartes processeurs MBUS)</ti></tr>
<tr><ti>    o SPARCstation/server 20 (avec pour la plupart des cartes processeurs MBUS)</ti></tr>
<tr><ti>    o JavaStation 1 (***)</ti></tr>
<tr><ti>    o JavaStation 10 (***)</ti></tr>
<tr><ti>    o JavaStation E (***)</ti></tr>
<tr><ti>    o JavaEngine 1 (***)</ti></tr>
</table>
</p>
<p>
(*)   Il y a certains noyaux qui ont des problèmes de gestion de mémoire relative avec les sun4c. C'est en train d'être corrigé.</p>
<p>
(**)  Le SPARC 5 170MHz (Aussi connu sous le nom de TurboSPARC) est seulement supporté dans la nouvelle version du noyau. Il n'y a pas
assez d'activité dans le développement, et UltraLinux sur ce processeur n'est pas très stable.</p>
<p>(***) Voir la question s'y rapportant plus loin dans cette section.</p>
<p>
<table>
<tr><th>* Les modules MBUS suivants sont connu pour être fonctionnels:</th></tr>
<tr><ti>    o Modèles SuperSPARC 20, 30, 40, 402, 41, 412, 51, 512, 514, 52, 54,61, 612, 71, 712, 81</ti></tr>
<tr><ti>    o Tous les modules HyperSPARC</ti></tr>
<tr><ti>    o Les modules Cypress</ti></tr>
</table>
</p>
</body>
</section>
<section>
<title>Supporté par le projet 64-bit UltraLinux (sparc64)</title>
<body>
<p>
<table>
<tr><th>* Architecture Sun4u:</th></tr>
<tr><ti>    o Les stations de travail basées sur UltraSPARC Sbus: Ultra1, Ultra2, Ultra1 Creator, Ultra2 Creator</ti></tr>
<tr><ti>    o Les serveurs basés sur UltraSPARC Sbus: Netra i, Enterprise 1, 2, 150</ti></tr>
<tr><ti>    o Les grands serveurs basés sur UltraSPARC Sbus: Enterprise 3000, 3500, 4000, 4500, 5000, 6000, 6500, 10000</ti></tr>
<tr><ti>    o Les ordinateurs embarqués basés sur UltraSPARC PCI: SPARCengine CP1400, CP1500 (*)</ti></tr>
<tr><ti>    o Les stations de travail basés sur UltraSPARC PCI: Ultra30, UltraAXe, UltraAXi, UltraAXmp, Ultra5, Ultra10, Ultra60,
Ultra80, SunBlade 100, SunBlade 1000</ti></tr>
<tr><ti>    o Les serveurs basés sur UltraSPARC PCI: Netra X1(**), Netra T séries(***), Enterprise 250, 450</ti></tr>
</table>
</p>
<p>(*) Ces embarqués sont connus pour fonctionner sans aucune modification, voir aussi (***)</p>
<p>(**) La plupart sont complètement supportés excepté pour les interfaces réseaux embarquées.</p>
<p>(***) Voir aussi le document sur le support de plateforme Eric Browser's Sun Microsystems CP1400/CP1500/Netra-T1 .</p>
</body>
</section>
<section>
<title>Périphériques</title>
<body>
<p>
<table>
<tr><th>* SCSI:</th></tr>
<tr><ti>    o Cartes Sun/PTI Qlogic SCSi</ti></tr>
<tr><ti>    o Cartes d'extensions SCSI/ether Sbus</ti></tr>
<tr><ti>    o Les périphériques de CD-ROM SCSI</ti></tr>
<tr><ti>    o Les périphériques à cassettes SCSI</ti></tr>
<tr><th>* Troisième partie parti SCSI(*):</th></tr>
<tr><ti>    o NCR53c8xx</ti></tr>
<tr><ti>    o Adaptec SCSI</ti></tr>
<tr><ti>    o Qlogic/ISP</ti></tr>
<tr><th>* Cartes Ethernet:</th></tr>
<tr><ti>    o Onboard SunLance</ti></tr>
<tr><ti>    o Sun QuadEthernet (**)</ti></tr>
<tr><ti>    o Sunswift Happy Meal SCSI/Ethernet</ti></tr>
<tr><ti>    o Myricom Gigabit Ethernet (Sbus)</ti></tr>
<tr><ti>    o Plusieurs Linux supportent les cartes ethernet basées sur PCI.</ti></tr>
<tr><th>* Framebuffers:</th></tr>
<tr><ti>    o MG1/MG2 - bwtwo (monochrome)</ti></tr>
<tr><ti>    o CG3 - cgthree (8-bit)</ti></tr>
<tr><ti>    o GX, GX+, TGX and TGX+ - cgsix (8-bit)</ti></tr>
<tr><ti>    o SX - cgfourteen (supportés pour 8-bit seulement)</ti></tr>
<tr><ti>    o TCX - SS4 and SS5 (resp. 8-bit and 24-bit, AFX bus)</ti></tr>
<tr><ti>    o LEO - ZX/TurboZX (24-bit)</ti></tr>
<tr><ti>    o FFB/FFB2 - Creator/Creator3D (24-bit)</ti></tr>
<tr><ti>    o PGX - ATI Rage Pro (8-bit)</ti></tr>
<tr><ti>    o PGX24 - ATI Mach64 (8 and 24-bit)</ti></tr>
<tr><ti>    o AFB - Elite3D (accélération seulement ***, 24-bit)</ti></tr>
<tr><ti>    o OEM framebuffers:</ti></tr>
<tr><ti>      + cgRDI (cgthree, 8-bit)</ti></tr>
<tr><ti>      + Raptor GFX (8-bit and 24-bit)</ti></tr>
<tr><th>* Stockage:</th></tr>
<tr><ti>    o Tous les lecteurs et chargeurs de cassettes</ti></tr>
<tr><ti>    o StorEdge T3 (****)</ti></tr>
<tr><th>* Divers:</th></tr>
<tr><ti>    o console série</ti></tr>
<tr><ti>    o l'audio basé sur CS4231</ti></tr>
<tr><th>*  Lecteur de disquettes(*****)</th></tr>
</table>
</p>
<p>
(*) Démarrer depuis ces cartes requiers OBP firmware.</p>
<p>(**) La plateforme sun4c a des problèmes avec ces cartes dus à des problèmes de firmware.</p>
<p>(***) Utilisez le serveur X Xsun24 avec l'option "-noFFB" pour désactiver l'accélération, ou si vous avez le pilote Solaris, voyez la
question s'y rapportant dans la section"Lancement".</p>
<p>(****) Regardez http://open-projects.linuxcare.com/t3 pour plus d'information sur les pilotes.</p>
<p>(*****) Démarrer depuis une disquette peut ne pas marcher sur certaines machines basées sur sparc64. De plus, le pilote de la
disquette a été désactivé sur l'image de démarrage fournis avec le CD.</p>
</body>
</section>
<section>
<title>Non supporté</title>
<body>
<p>* N'importe quels construction par les utilisateurs sur 64-bit. Le noyau compilé fonctionne bien. Vous aurez besoin du paquetage
egcs64-sparc, tapez: "emerge egcs64-sparc" une fois le "emerge system" terminé pour avoir le compilateur.</p>
<p>* Le système X-windows n'est pas pour l'instant supporté dans Gentoo Sparc.</p>
</body>
</section>
<section>
<title>Espaces Requis</title>
<body>
<p>Une installation typique de Gentoo sparc utilise environ 500-1000 MB. La Gentoo sparc seul utilise environ 450 MB pour un bootstrap
complet. Cela se réduit à environ150 après que la compilation soit complète. Vous ne devriez pas faire une partition root plus petite
que 1 Gigabyte si vous utilisez seulement une partition.</p>
</body>
</section>
<section>
<title>Noyau</title>
<body>
<p>Vous utiliserez toujours un noyau 64 bit sur une machine 64 bit. Cela inclus Ultra 1, 2, 5, 10 et 60, la série SunBlade,
E250/E450, E4*00, E6*00, E10K et les plateformes StarFire. Le résultat de <c>uname -m</c> de ces machines est "sparc64" ou "sun4u".
</p>
<p>Vous utiliserez toujours un noyau 32 bit sur une machine 32 bit (sun4c, sun4d ou sun4m).Cela inclus l' IPC/IPX, SparcStations,
etc. Le résultat de "uname -m" devrait être l'une des possibilités suivantes: "sparc", "sun4c", "sun4d" ou "sun4m".</p>
<p>Pour le moment nous utilisons la variable d'environnement ARCH spécifiée dans /etc/make.profile/make.defaults pour déterminer
l'architecture du noyau à construire. C'est sujet à changer. Ca sera probablement changer en une variable à rajouter à USE comme
avant <c>arch=sparc64</c>.</p>
<p>Le stage 1 construit qui sont fait sur des machines à base 64 bit devrait bien fonctionner sur des machines à base sparc32. C'est
la même chose pour le stage 2 je pense(pas testé). Je l'essayerais plutard.</p>
<note>Le support des Sparc32 est extrêmement limité et pas encore dans son entier à cet instant.</note>
<p>Certains noyaux ont des problèmes pour le démarrage avec de grande quantités de mémoires. Essayez d'en enlever, ça a marché pour
moi, ou essayez une nouvelleimage.</p>
</body>
</section>
</chapter>
<chapter>
<title>Partie 2: Démarrage</title>
<section>
<title>Méthodes de démarrage</title>
<body>
<p>
Il y a trois manières de démarrer:
</p>
<p>
<uri link="#doc_chap4_sect2">Démarrage à travers le réseau, ou démarrage réseau</uri>
<uri link="#doc_chap4_sect3">Démarrage à partir d'un chargeur de démarrage SILO existant</uri>
<uri link="#doc_chap4_sect4">Démarrage à partir du cdrom</uri></p>
<p>
En utilisant un système Linux existant sur le disque dur de la machine est la méthode la plus facile comme cela vous fournit un
environnement Unix complet ainsi qu'une connexion ethernet fonctionnant. Dans ce cas, démarrez comme d'habitude votre système Linux,
montez la partition de destination de Gentoo à <path>/mnt/gentoo</path> et passez à <uri link="#doc_chap5">l'étape 3</uri>.</p>
<p>
Si l'utilisation d'un système Linux installé n'est pas possible, utilisez alors <uri link="#doc_chap4_sect2">démarrage réseau</uri>.
</p>
</body>
</section>
<section>
<title>Démarrage réseau</title>
<body>
<p>
Au prompt du démarrage, tapez:
</p>
<pre>
ok <i>boot net</i>
</pre>
<note>Vous aurez besoin d'une autre machine sur le même réseau pour vous fournir RARP (pour autoriser le client à déterminer son
adresse IP) et le service TFTP (pour obtenir le noyau à travers le réseau).</note>
<p>
Vous pouvez trouver de bonnes pages de documentation sur Debian Sparc:
</p>
<p>
<uri>http://www.debian.org/releases/stable/sparc/install</uri>
</p>
<p>
Les SunBlades n'ont pas été supportés pendant très longtemps et vous pouvez avoir quelques problèmes à trouver de bonnes images de
démarrage. Vous pouvez trouver de bonnes images de démarrage réseau à:</p>
<p>
<uri>http://auric.debian.org/~bcollins/disks-sparc/current/</uri>
</p>
<p>
Une fois démarré, choisissez un disque pour installer et configurer le réseau. Quand la Debian Woody vous demande les disquettes
d'installation du noyau, descendez pour arriver à <c>Execute a shell</c>.</p>
<p>
Si votre installation du système Debian n'arrive pas à faire des requêtes DNS , vous avez probablement bouger le fichier
<path>/target/etc/resolv.conf</path>, vérifiez qu'il est bien la car c'est à cet endroit que le disque d'installation de Debian va
le chercher.</p>
<p>Vous pouvez également utiliser votre Linux déjà installé pour détarrer le contenu du stage 1 dans une partition et la monter au
prompt du démarrage avec la ligne de commande:</p>
<pre>
ok <i>boot net root=/dev/sda4</i>
</pre>
</body>
</section>
<section>
<title>SILO existant</title>
<body>
<p>Ou vous pouvez utiliser votre SILO pour démarrer l'installation (pressez la touche TAB une fois quand SILO: apparaît). Bien sûr
cela signifie que vous êtes incapable de charger les modules du noyau mais cela peut ne pas être un problème suivant la
configuration par défaut du noyau pour sparc car la plupart des pilotes pour matériels SPARCsont activés par défaut. Vous pouvez
utiliser votre Linux installé sur votre machine sparc pour compiler un noyau avec tous les pilotes compilés en statiques.</p>
<pre>
ok <i>boot</i>SILO: <codenote>Pressez la touche TAB ici.</codenote>
boot:linuxboot: <i>vmlinux root=/dev/hda4</i>
</pre>
<p>
où cela permettra le démarrage de la quatrième partition de votre premier disque:</p>
<pre>
boot: <i>4/vmlinux root=/dev/hda4</i>
</pre>
</body>
</section>
<section>
<title>CDROM</title>
<body>
<note>Démarrage depuis le CDROM est la méthode la plus facile et la préférée.</note>
<p>
S'il vous plait essayez d'utiliser un miroir pour le téléchargement si possible. Les images ISO sont extrêmement grande. Obtenez
les dernières images ISO de Gentoo depuis <uri>http://www.ibiblio.org/pub/Linux/distributions/gentoo/releases/1.1a/</uri> et
utilisez cdrecord pour les graver avec votre graveur. Démarrez avec le CD depuis le prompt et choisissez l'option ramdisk:</p>
<pre>
ok <i>boot cdrom</i>
SILO:...
boot: <i>ramdisk</i>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Partie 3: Installation de Gentoo</title>
<section>
<body>
<p>
Si vous utilisez l'installation par le réseau pour démarrer votre système et pour gérer votre disque alors la cible de
l'installation sera monté dans <path>/target</path>. Dans ce cas vous voudrez peut être faire un lien symbolique de
<path>/mnt/gentoo</path> vers <path>/target</path> car on suppose que vous avez <path>/mnt/gentoo</path>. Si ce n'est pas le cas,
vous devrez monter une partition comme <path>/mnt/gentoo</path> et de l'utilisez pour l'installation.</p>
<note>Si vous avez utilisé Debian pour démarrer votre système, alors partitionnez votre(vos) disque(s) dur, configurez le réseau et
et exécutez un shell.</note>
<note>
à propos de NFS

Vous pouvez aussi faire des montages NFS pour /usr/portage et /usr/distfiles si besoin. Quand vous utiliserez la partition NFS
montées pour /usr/distfiles, assurez vous qu'elle est en mode écriture et que le système le sache:# export DISTDIR=/usr/distfiles
</note>
<note>
La compilation de bootstrap utilise environ 500MB pour compiler et 150 MB une fois terminée. Si vous voulez un système complet qui
puisse compiler d'autres stage1 vousaurez besoin d'au moins un gigabyte. Cela inclus les distfiles.</note>
<note>
Vous pouvez utiliser wget pour télécharger le stage1 depuis le site de Gentoo. Attention, l'image d'installation par le réseau de
Debian n'ont pas le binaire de /usr/bin/bzip doncvous devrez récupérer un .tgz à la place (si disponible).</note>
<p>
Maintenant, revoyons rapidement le processus d'installation.  Nous allons créer les partitions, créer nos systèmes de fichiers, et
extraire soit l'archive stage 1, l'archivestage2 ou l'archive stage3. Si nous utilisons une archive de stage1 ou stage2, nous
passerons par les étapes appropriées pour amener notre système en stage3.  Une fois notre système en stage 3, nous pourrons le
configurer (fichiers de configuration, installer un chargeur de démarrage, etc ...) et le démarrer et pour finir avoir un système
complètement fonctionnel Gentoo Linux. Suivant le stage avec lequel vous avez commencé, voici ce qui est requis pour l'installation:
</p>
<table>
<tr><th>archive de stage</th>
<th>requis pour l'installation</th></tr>
<tr><ti>1</ti><ti>installation des partitions/systèmes de fichiers, emerge rsync, bootstrap, emerge system, emerge linux sources,
configuration finale</ti></tr>
<tr><ti>2</ti><ti>installation des partitions/systèmes de fichiers, emerge rsync, emerge system, emerge linux sources, configuration
 finale</ti></tr>
 <tr><ti>3</ti><ti>installation des partitions/systèmes de fichiers, emerge rsync (optionnel), configuration finale</ti></tr>
</table>
<p>Première étape est de charger tous les modules dont vous avez besoin. Vous n'aurez peut être pas besoin de le faire car la plupart
du matériels sparc standard est déjàdans le noyau. Pour voir une liste de tous les modules de cartes présents, tapez <c>ls
/lib/modules/*/kernel/drivers/net/*</c>. Pour charger un module particulier, tapez:</p>
<pre>
# <i>modprobe pcnet32</i>	<comment>(remplacez pcnet32 par le module désiré)</comment>
</pre>
<p>Maintenant, si vous voulez être capable d'accéder à tout type de matériels SCSI qui n'a pas été détecté durant le processus
d'autodétection PCI, vous aurez besoin de charger le module approprié depuis /liib/modules, en utilisant encore <c>modprobe</c>:
</p>
<pre>
# <i>modprobe aic7xxx</i>
# <i>modprobe sr_mod</i>
# <i>modprobe sd_mod</i>
</pre>
<p>Au-dessus, nous chargeons le pilote SCSI <c>aic7xxx</c> et puis nous vérifions que le support des CD-ROM SCSI (<c>sr_mod</c>) et
des disques (<c>sd_mod</c>)est chargé.</p>
<note><c>hdparm</c> est inclus dans l'Iso de la Gentoo. Si n'importe lequel de vos disques requière un partitionnement, il serait
bien de le faire maintenant. De manière raisonnable sur du matériels moderne, <c>hdparm -d 1 /dev/hdx</c> devrait s'effectuer sans
risques. Vous pouvez utiliser <c>hdparm -v /dev/hdx</c> pour vérifier les paramètres de votre disque, et <c>hdparm -t /dev/hdx</c>
pour vérifier les performances de votre disque.</note>
</body>
</section>
<section>
<title>Configuration de l'installation réseau</title>
<body>
<p>L'installation de Gentoo vous permet de configurer un réseau fonctionnel, vous autorisant l'utilisation <c>ssh</c>, <c>scp</c> ou
<c>wget</c> pour vos besoin avant de lancer le processus d'installation. Même si vous n'avez pas besoin de faire cela maintenant,
vous pouvez avancer et configurer votre réseau maintenant. Une fois installé,Portage sera en mesure d'utiliser votre réseau, à
partir du moment où vous serez dans l'environnement chrooté (requis pour installer Gentoo Linux).</p>
</body>
</section>
<section>
<title>Configuration manuelle de DHCP</title>
<body>
<p>
La configuration réseau est simple avec DHCP; Si votre fournisseur d'accès internet n'utilise pas DHCP, allez à la section sur la
configuration réseau statique plus bas.</p>
<pre caption="Configuration réseau avec DHCP">
# <i>dhcpcd eth0</i>
</pre>
<note>
Certains fournisseur d'accès internet vous demande de fournir un hostname. Pour faire cela, ajouter le paramètre <c>-h
myhostname</c> à la ligne de commande dhcpcd précédente.</note>
<p>Si vous recevez des alertes <i>dhcpConfig</i>, ne paniquez pas; les erreurs sont la pour faire jolies. Descendez plus bas pour
tester votre réseau.</p>
</body>
</section>
<section>
<title>Configuration manuelle statique</title>
<body>
<p>
Nous avons besoin juste de besoin de configurer le réseau pour nous permettre de télécharger les sources pour la construction du
système, avec aussi l'interface localhostrequis. Tapez les commandes suivantes, en remplaçant $IFACE par votre interface réseau
(généralement <c>eth0</c>), $IPNUM par votre adresse IP, $BCAST par votreadresse de broadcast, et $NMASK par votre masque réseau.
Pour la commande <c>route</c>, remplacez $GTWAY par votre passerelle par défaut.</p>
<pre>
# <i>/sbin/ifconfig $IFACE $IPNUM broadcast $BCAST netmask $NMASK</i>
# <i>/sbin/route add -net default gw $GTWAY netmask 0.0.0.0 metric 1</i>
</pre>
<p>Maintenant, il est temps de créer le fichier <path>/etc/resolv.conf</path> pour que la résolution des noms puisse fonctionner
(trouver un site Web/FTP par son nom, et non uniquement par son adresse IP).</p>
<note>A ce moment, le seul éditeur installé par défaut est <c>nano</c>, un petit et très facile à utiliser éditeur visuel. Utilisez
<c>nano</c>avec l'option <c>-w</c> pourdésactiver le retour à la ligne automatique.</note>
<p>Voici un exemple à suivre pour créer votre fichier /etc/resolv.conf:
</p>
<pre caption="exemple de /etc/resolv.conf">
domain mondomaine.com
nameserver 10.0.0.1
nameserver 10.0.0.2
</pre>
<p>Remplacez <c>10.0.0.1</c> et <c>10.0.0.2</c> par les adresses IP respectives de vos serveurs DNS primaire et secondaire.</p>
</body>
</section>
<section>
<title>Configuration du Proxy</title>
<body>
<p>Si vous êtes derrière un proxy, il est nécessaire de configurer votre proxy avant de continuer. Nous allons exporter quelques
variables pour configurer le proxy en conséquence. </p>
<pre>
# <i>export http_proxy="machine.company.com:1234" </i>
# <i>export ftp_proxy="$http_proxy" </i>
# <i>export RSYNC_PROXY="$http_proxy" </i>
</pre>
</body>
</section>
<section>
<title>Tester le réseau</title>
<body>
<p>Maintenant que le réseau a été configuré, la commande <c>/sbin/ifconfig -a</c> devrait montrer (avec un peu de chance!) que votre
carte réseau fonctionne (regardez pour <e>UP</e> et <e>RUNNING</e> sur l'affichage).</p>
<pre caption="/sbin/ifconfig pour une carte réseau fonctionnelle">
eth0      Link encap:Ethernet  HWaddr 00:50:BA:8F:61:7A
          inet addr:192.168.0.2  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::50:ba8f:617a/10 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1498792 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1284980 errors:0 dropped:0 overruns:0 carrier:0
          collisions:1984 txqueuelen:100
          RX bytes:485691215 (463.1 Mb)  TX bytes:123951388 (118.2 Mb)
          Interrupt:11
</pre>
</body>
</section>
<section>
<title>Le réseau fonctionne!</title>
<body>
<p>Le réseau devrait être maintenant configuré et utilisable. Vous devriez être capable d'utiliser ces commandes incluses
<c>ssh</c>, <c>scp</c> et <c>wget</c> pour se connecter aux autres machines de votre réseau ou d'internet.</p>
</body>
</section>
</chapter>
<chapter>
<title>Installer les partitions</title>
<section>
<body>
<p>Maintenant que le noyau peut voir notre carte réseau et nos contrôleurs de disques, il est temps de configurer les partition du
disque pour Gentoo Linux.</p>
<note>L'étape suivante est pour les personnes ayant réussi à démarrer à partir du CDROM. Si vous avez démarré à partir d'un autre
moyen, passez les trois prochainesinstructions.</note>
<p>
Puis montez le cdrom et chrooté la racine dans le bon répertoire pour votre plateforme:</p>
<pre>
# <i>mount -t iso9660 -o ro /dev/cdroms/cdrom0 /mnt</i>
# <i>chroot /mnt/root-\`uname -m\` bin/bash</i>
# <i>source /etc/profile</i>
</pre>
<p>Depuis ici vous avez un environnement de secours que vous pouvez utiliser pour arranger votre système. Vous pouvez donc
partitionner vos disques ici et les monter pour l'installation.</p>
<note>Quand vous utilisez le CD-ROM, faîtes (ceci est un exemple, ne faîtes pas seulement un copier/coller!)</note>
<pre>
# <i>fdisk /dev/hda</i>
# <i>mount -n /dev/hda2 /mnt/gentoo; cd /mnt/gentoo</i>
# <i>wget http://www.ibiblio.org/pub/Linux/distributions/gentoo/releases/1.4_rc2/sparc/sparc64/stage1-sparc64-1.4_rc2.tbz2</i>
# <i>bunzip2 -c ./stage1-sparc64-1.4_rc2.tbz2 | tar xvpf -</i>
# <i>cp /etc/resolv.conf etc/resolv.conf</i>
# <i>nano /etc/resolv.conf</i>
# <i>rm etc/make.profile</i>
</pre>

<note>La voie la plus simple pour créer un disque au label Sun est d'utiliser l'option <i>'s'</i> pour fdisk et ensuite de modifiez
les partitions pour la convertir à vosbesoins.</note>
<note>Apres le montage de / dans /mnt/gentoo continuez et montez toutes les partitions dont vous aurez besoin (i.e. /boot /usr/var)
</note>
<p>Maintenant éditez make.conf et décommentez n'importe quels définitions pour celles la:</p>
<pre>
<i>
CHOST="sparc-unknown-linux-gnu"
CFLAGS="-mcpu=v8 -mtune=v9 -O2 -pipe"
CXXFLAGS="-O3 -pipe"
</i>
</pre>
<note>
Pour /etc/make.conf changez :

SYNC="rsync://cvs.gentoo.org/gentoo-portage"

en

SYNC="rsync://rsync.gentoo.org/gentoo-portage"
</note>
<pre>
# <i>mount -o bind /proc proc</i>
# <i>chroot /mnt/gentoo bin/bash</i>
# <i>env-update</i>
# <i>source /etc/profile</i>
# <i>emerge rsync</i>
# <i>rm etc/make.profile</i>
</pre>
<p>
Sélectionnez la bonne plateforme, pour sparc64:
</p>
<pre>
# <i>uname -m</i>
sparc64
# <i>ln -s ../usr/portage/profiles/default-sparc64-1.4 etc/make.profile</i>
</pre>
<p>
Ou pour sparc:
</p>
<pre>
# <i>uname -m</i>
sparc
# <i>ln -s ../usr/portage/profiles/default-sparc-1.4 etc/make.profile</i>
</pre>
<p>
Si vous démarrez avec le stage 1, lancez:
</p>
<pre>
# <i>scripts/bootstrap.sh</i>
</pre>
<p>
Cela va prendre un moment. Vous avez maintenant une Gentoo en stage 2.
</p><p>
Puis:
</p>
<pre>
# <i>export CONFIG_PROTECT=""</i>
# <i>emerge system</i>
</pre>
<p>
Vous avez maintenant une Gentoo stage 3.
</p>
</body>
</section>
</chapter>
<chapter>
<title>Partie 4: construire un noyau</title>
<section>
<body>
<p>
Sur les plateformes sparc64 nous avons besoin d'un compilateur pour 64bit:
</p>
<pre>
# <i>emerge egcs64-sparc</i>
</pre>
<p>
Ensuite, récupérez les sources Linux. A ce moment le paquetage Gentoo sys-kernel/linux-sources semble contenir quelques patchs pour
des plateformes spécifiques qui pourrait faire échouer la compilation. Si vous trouvez ce qui en est la cause ou mieux si vous avez
une solution, s'il vous plait poster un rapport de bug sur notre bugzilla.</p>
<p>Donc prenez le noyau vanilla et faîtes le travail vous même. Attention, toutes déviation de ce qui suit donnera comme résultats
des erreurs de compilation du noyau.</p>
<pre>
# <i>cd /usr/src</i>
# <i>wget http://www.kernel.org/pub/linux/kernel/v2.4/linux-2.4.18.tar.bz2</i>
# <i>tar xvfj linux-2.4.18.tar.bz2</i>
# <i>mv linux linux-2.4.18</i>
# <i>ln -s linux-2.4.18 linux</i>
# <i>cd linux</i>
</pre>
<p>
Appliquer tous les patchs que vous voulez appliquer à ce moment. Ne faîtes pas l'application des patchs pour noyaux de la série -ac
sur des systèmes (ils rendent le système extrêmement instable). XFS (le système de fichier) n'est pas supporté pour les Sparc pour
l'instant.</p>
<note>A rajouter: nous pouvons avoir besoin de faire des arrangements additionnels pour les plateformes Sparc.</note>
<p>Maintenant obtenez un fichier .config, j'aime bien tmpfs (un système de fichier RAM dynamique, très pratique pour les machines
ayant un grand nombre de RAM) donc je copie le fichier et j'active le tmpfs comme cela. Bien, vous avez l'image.</p>
<pre>
# <i>sed -s 's/.*CONFIG_TMPFS.*/CONFIG_TMPFS=m/' \
	-s 's/.*CONFIG_DEVFS_FS.*/CONFIG_DEVFS_FS=y/' \
	-s 's/.*CONFIG_DEVFS_MOUNT.*/CONFIG_DEVFS_MOUNT=y/' \
	-s 's/.*CONFIG_EXT3_FS.*/CONFIG_EXT3_FS=y/' \
	arch/`uname -m`/defconfig \
	> .config</i>
</pre>
<p>
Ou copiez seulement le fichier:
</p>
<pre>
# <i>cp arch/`uname -m`/defconfig .config</i>
</pre>
<p>
L'étape "oldconfig" est requis pour établir des liens:
</p>
<pre>
# <i>make ARCH=sparc64 oldconfig dep clean vmlinux modules</i>
# <i>make modules_install</i>
</pre>
<p>
Le noyau doit être plus petit que 3.6 megabytes pour s'ajuster à l'espace mémoire de SILO, utilisez:</p>
<pre>
# <i>ls -al vmlinux</i>
-rwxr-xr-x    1 root     root      3503075 Apr 20 21:42 vmlinux
</pre>
<p>
Nous avons d'un sérieux GZIP pour SILO.
</p>
<pre>
# <i>gzip -9 vmlinux</i>
# <i>cp vmlinux.gz /boot/vmlinuz-2.4.18</i>
# <i>ln /boot/vmlinuz-2.4.18 /vmlinuz</i>
</pre>
<p>
Si vous n'avez pas installé SILO sur ce disque et que vous voulez démarrer depuis ce dernier:
</p>
<pre>
# <i>emerge silo</i>
# <i>nano /etc/silo.conf</i>
# <i>silo</i>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Configurations finales</title>
<section>
<title>Timezone</title>
<body>
<note>Il est extrêmement important que cette étape soit faite et terminée. La dérive de l'horloge majeur interne sera expérimentée
si vous n'installez pas correctement l'horloge locale.
</note>

<p>A ce point, vous devez avoir un système en stage3 qui est prêt pour la configuration finale. Nous allons commencer ce processus
en configurant la zone horaire. En configurant cette dernière avant de construire le noyau nous sommes sûr que les utilisateurs
auront un affichage raisonnable de <c>uname -a</c>.</p>
<p>Regardez pour votre zone horaire (ou GMT si vous utilisez Greenwich Mean Time) dans <path>/usr/share/zoneinfo</path>. Puis faîtes
un lien symbolique en tapant:</p>
<pre>
# <i>ln -sf /usr/share/zoneinfo/path/to/timezonefile /etc/localtime</i>
</pre>
<p>Vous devrez peut être vérifier <path>/etc/rc.conf</path> pour être sûr que la sélection de la zone horaire est correct. </p>
</body>
</section>
<section>
<title>Le Système de log et le démon Cron</title>
<body>
<p>Maintenant vous avez besoin de choisir un système de log que vous aimeriez installer. Nous vous proposans sysklogd, qui est un
démon traditionnel pour loguer. Nous avons aussi msyslog et syslog-ng ainsi que metalog. Les utilisateurs confirmés semblent se
détourner de sysklogd (qui n'a pas de bonnes performances) et se tournent vers les nouvelles alternatives. En cas de doute, vous
aimeriez essayer metalog, bien qu'il soit moins populaire. Pour installer le système de votre choix, tapez <e>une seule</e> des
quatres lignes suivantes:
</p>

<pre>
# <i>emerge app-admin/sysklogd</i>
# <i>rc-update add sysklogd default</i>
<comment>or</comment>
# <i>emerge app-admin/syslog-ng</i>
# <i>rc-update add syslog-ng default</i>
<comment>or</comment>
# <i>emerge app-admin/metalog</i>
# <i>rc-update add metalog default</i>
<comment>or</comment>
# <i>emerge app-admin/msyslog</i>
# <i>rc-update add msyslog default</i>
</pre>
<warn>
Dans le cas de syslog-ng, vous avez besoin de créer <path>/etc/syslog-ng/syslog-ng.conf</path>. Voyez <path>/etc/syslog-ng</path>
pour avoir un exemple de fichier de configuration.
</warn>
<impo>
Metalog nettoie la sortie du disque en blocs, donc les messages ne sont pas enregistrés immédiatement dans les logs systèmes. Si
vous êtes en train de débuguer un démon, cet environnement de performance est gênant. Quand votre système Gentoo Linux est en train
de tourner, vous pouvez envoyer un signal USR1 à metalog pour désactiver temporairement le stockage des messages dans les buffers
(cela signifie que <i>tail -f <path>/var/log/everything/current</path></i> fonctionnera maintenant en temps réel, comme prévu), et
un signal USR2 pour remettre le stockage des messages en buffers.
</impo>
<p>Maintenant, vous pouvez choisir un paquetage cron que vous aimeriez utiliser. Pour l'instant, vous avez le choix entre dcron,
fcron et vcron. Si vous ne savez pas lequel choisir, vous devriez prendre vcron. Ils peuvent être installer comme suivant:</p>
<pre>
# <i>emerge sys-apps/dcron</i>
# <i>crontab /etc/crontab</i>
<comment>ou</comment>
# <i>emerge sys-apps/fcron</i>
# <i>crontab /etc/crontab</i>
<comment>ou</comment>
# <i>emerge sys-apps/vcron</i>
<comment>N'oubliez pas d'ajouter votre *cron dans le bon init level. </comment>
# <i>rc-update add *cron default </i>
</pre>
<p>Pour plus d'informations sur le fonctionnement de cron sous Gentoo Linux, voyez <uri link="http://lists.gentoo.org/pipermail/gentoo-announce/2002-April/000151.html"> cette annonce</uri>.</p>
<p>Pour plus d'informations sur le lancement des programmes et sur le lancement des démons, voyez le <uri link="/doc/rc-scripts.html"> guide des rc-script</uri>. </p>
</body>
</section>
<section>
<title>/etc/fstab</title>
<body>
<p>Votre système Gentoo Linux est presque prêt à être utiliser. Tout ce que nous avons à faire est de configurer quelques fichiers
systèmes important et d'installer le chargeur de démarrage GRUB. Le premier fichier que nous avons à configurer est
<path>/etc/fstab</path>. Souvenez vous que vous devez utiliser l'option <c>notail</c> pour votre partition de démarrage si vous
avez choisi de la créer avec le système de fichiers ReiserFS. Spécifiez aussi le type approprié du système de fichiers <c>ext2</c>,
<c>ext3</c> ou <c>reiserfs</c>.</p>
<p>Utilisez le <path>/etc/fstab</path> vu plus bas, mais bien sûr soyez sûr de remplacer "BOOT","ROOT" et "SWAP" avec les
périphériques que vous êtes en train d'utiliser (comme par exemple <c>hda1</c>, etc...).</p>
<pre>
<comment>
# /etc/fstab: static file system information.
#
# noatime turns of atimes for increased performance (atimes normally aren't
# needed; notail increases performance of ReiserFS (at the expense of storage
# efficiency).  It's safe to drop the noatime options if you want and to
# switch between notail and tail freely.

# &lt;fs&gt;           &lt;mountpoint&gt;   &lt;type&gt;   &lt;opts&gt;
&lt;dump/pass&gt;
# NOTE: If your BOOT partition is ReiserFS, add the notail option to opts.
</comment>
/dev/BOOT           /boot       ext2	 noauto,noatime	 1 2
/dev/ROOT           /           ext3	 noatime         0 1
/dev/SWAP           none        swap	 sw              0 0
/dev/cdroms/cdrom0  /mnt/cdrom  iso9660	 noauto,ro       0 0
proc                /proc       proc	 defaults        0 0
</pre>

<warn>Notez s'il vous plait que <i>/boot</i> n'est PAS monté au moment du démarrage. C'est pour protéger les données de <i>/boot</i>
de la corruption de données. Si vous avez besoin d'accéder à <i>/boot</i>, monté le s'il vous plait!</warn>

</body>
</section>
<section>
<title>Mettre le mot de passe root</title>
<body>
<p>Avant d'oublier, mettez le mot de passe de root en tapant:</p>
<pre>
# <i>passwd</i>
</pre>
</body>
</section>
<section>
<title>/etc/hostname</title>
<body>
<p>Editez ce fichier pour qu'il contienne le nom complet de votre domaine sur une seul ligne, c'est à dire
<c>mamachine.mondomaine.com</c>.
<pre>
# <i>echo mamachine.mondomaine.com > /etc/hostname</i>
</pre>
</p>
</body>
</section>

<section>
<title>/etc/hosts</title>
<body>
<p>Ce fichier contient une liste d'adresse IP et leurs noms associés. C'est utilisé par le système pour résoudre les adresses IP des
nom d'hôte qui ne sont pas sur votre serveur de noms. Voici un exemple de ce fichier:</p>
<pre>
127.0.0.1      localhost
<comment># la prochaine ligne contient votre IP pour votre réseau local, et votre nom de machine associé</comment>
192.168.1.1    mamachine.mondomaine.com	mamachine
</pre>

<note>Si vous êtes sur un réseau DHCP, cela peut vous aider de mettre <i>localhost</i> à votre actuel hostname. Cela aidera GNOME
et plusieurs autres programmes dans la résolution des noms.</note>

</body>
</section>
<section>
<title>Configuration finale du réseau</title>
<body>
<p>
Ajoutez le nom de tous les modules qui sont nécessaire au bon fonctionnement de votre système dans <path>/etc/modules.autoload</path>
(vous pouvez aussi ajouter des options au besoin sur la même ligne). Quand Gentoo Linux démarre, ces modules seront automatiquement
chargés. Le module de votre carte réseau est d'une importance particulière, si vous l'avez compilé en tant que module:
</p>
<pre caption="/etc/modules.autoload">
3c59x
</pre>
<p>Editez le script <path>/etc/conf.d/net</path>pour obtenir votre réseau configuré dès votre premier démarrage:
</p>
<pre>
# <i>nano -w /etc/conf.d/net</i>
# <i>rc-update add net.eth0 default</i>
</pre>
<p>
Si vous avez plusieurs cartes réseaux vous avez besoin de créer d'autres scripts additionnels pour chacun comme <path>net.eth<comment>x</comment></path> (ou <comment>x</comment> = 1, 2, ...):</p>
<pre caption="Multiples interfaces réseaux">
# <i>cd /etc/init.d</i>
# <i>cp net.eth0 net.eth<comment>x</comment></i>
# <i>rc-update add net.eth<comment>x</comment> default</i>
</pre>

</body>
</section>
<section>
<title>Configuration des fichiers de base (incluant le paramétrage du keymap)</title>
<body>
<pre caption="Configuration de base">
# <i>nano -w /etc/rc.conf</i>
</pre>
<p>
Suivez les instructions dans le fichier pour configurer les paramètres de base. Tous les utilisateurs devront s'assurer que
<c>CLOCK</c> est bien le lien propre à l'utilisateur. Les utilisateurs de claviers internationales devront paramètrer la variable
<c>KEYMAP</c> (regardez dans <path>/usr/share/keymaps</path> pour voir les différentes possibilités).
</p>
</body>
</section>
<section>
<title>Paramétrage du disque dur (hdparm)</title>
<body>
<p>
Ajoutez vos paramètres <i>hdparm</i> à <path>/etc/conf.d/local.start</path>, pour qu'il soit initialisé à chaque démarrage.
</p>
<pre>
# <i>nano -w /etc/conf.d/local.start</i>
</pre>
<pre caption="ajout des paramètres hdparm à /etc/conf.d/local.start">
# This is a good place to load any misc.
# programs on startup ( 1>&amp;2 )

# turn on DMA on both harddrives
hdparm -d 1 /dev/hda
hdparm -d 1 /dev/hdb
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Grande Finale!</title>
<section>
<body>
<p>Félicitations! Vous venez juste de finir votre installation de Gentoo Linux sur votre Sparc. Nous accueillons tous commentaires
ou suggestions que vous pouvez avoir pour nous aider à améliorer notre portage sous Sparc. Inscrivez vous s'il vous plait sur
notre mailing liste gentoo-sparc et envoyez nous un commentaire. Merci d'avoir pris ce temps pour l'installation.</p>

<p>Vous êtes maintenant au point où vous pouvez faire plusieurs choses. Soit vous démontez toutes vos partitions et redémarrez
pour commencer l'installation des ebuilds ou vous pouvez commencer à les installer maintenant.</p></body>
</section>
</chapter>

</guide>

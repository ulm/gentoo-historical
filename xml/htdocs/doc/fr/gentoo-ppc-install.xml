<?xml version='1.0' encoding="UTF-8"?>

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/gentoo-ppc-install.xml">
<title>Guide d'installation de Gentoo Linux/PPC 1.4</title>

<author title="Leader Gentoo PPC">
   <mail link="pvdabeel@gentoo.org">Pieter Van den Abeele</mail>
</author>
<author title="Correcteur">
   <mail link="rajiv@gentoo.org">Rajiv Manglani</mail>
</author>
<author title="Correcteur">
   <mail link="pylon@gentoo.org">Lars Weiler</mail>
</author>
<author title="Correcteur">
   <!-- zhen@gentoo.org --> John P. Davis
</author>
<author title="Concepteur">
   <mail link="drobbins@gentoo.org">Daniel Robbins</mail>
</author>
<author title="Relecteur">
   <mail link="peitolm@gentoo.org">Colin Morey</mail>
</author>
<author title="Traducteur">
   <mail link="nissen.lutin@libertysurf.fr">Frédéric Baujard</mail>
</author>

<abstract>
Ces instructions vous guideront à travers le processus d'installation de Gentoo Linux/PPC 1.4. Le processus d'installation
de Gentoo Linux permet différentes approches qui peuvent aller de 20 minutes d'installation à la construction complète du système à partir de zéro.
</abstract>

<license/>

<version>1.6.6</version>
<date>7 février 2004</date>

<chapter>
<title>Obtenir le CD</title>
<section>
<body>

<p>Le CD de Gentoo/PPC 1.4 CD peut être trouvé dans le répertoire <path>releases</path> des différents miroirs de Gentoo ou à la <uri
link="http://store.gentoo.org">boutique Gentoo</uri>. Si vous préférez le télécharger, consultez la liste des miroirs Gentoo 
(<uri>http://www.gentoo.org/main/en/mirrors.xml</uri>) et sélectionnez le miroir le plus proche de chez vous. Pour les impatients, cliquez 
<uri link="http://gentoo.oregonstate.edu/releases/ppc/">ici</uri>.
</p>

<p>
Voyons les différentes approches possibles.
</p>

</body>
</section>
<section>
<title>Approche CD: GRP (2 disques)</title>
<body>

<p>
Un set de 2 disques est disponible pour les PPC génériques et les systèmes avec G3 et G4. (Une version avec 2 disques pour G5 est prévue prochainement). 
Le premier CD du set contient :
</p>

<ul>
<li>
Tous les fichiers requis pour la construction à partir de zéro du noyau, de xfree, le chargeur de démarrage, ...
</li>
<li>
Une image de l'arbre de Portage.
</li>
<li>
Un "stage1" générique pour PPC.
</li>
<li>
Des "stage2" et "stage3" optimisés pour les différents processeurs.
</li>
</ul>

<p>
Un "stage" est une archive de type Unix qui contient un système Linux
minimaliste qui a besoin d'être désarchivé dans une partition vide sur le
disque dur où vous voulez installer Gentoo. Les "stages" sont de différentes
tailles&nbsp;: un stage1 contient un système très minimaliste (seulement la structure
des répertoires et un compilateur générique), une archive stage2 est un peu
plus grande (le compilateur est déjà optimisé, ce qui vous permet de gagner du temps
durant l'installation) et un stage3 contient un système Linux de base (un
compilateur optimisé et les outils de base). Vous devrez choisir l'un de ces
stages plus tard dans ce document. Les stages sont disponibles séparément sur
tous les serveurs miroirs Gentoo, mais le CD 1 de GRP contient déjà le stage1
générique pour PPC et un stage2 et un stage3 optimisés pour les différents
processeurs.
</p>

<p>
Une image de l'arbre de Portage est une archive Unix qui contient la structure
des répertoires remplie avec les scripts d'installation (ebuilds). Les ebuilds
de l'arbre de Portage sont utilisés par la commande emerge pour installer et
désinstaller des applications. L'arbre de Portage peut être gardé à jour en
utilisant Internet. Une image est fournie pour permettre les installations sans
réseau.
</p>

<p>
Le répertoire <path>distfiles</path> sur le CD contient les archives sources utilisées pour compiler la base principale à partir de zéro. Normalement, les 
archives sources sont téléchargées utilisant une connexion réseau. Pour permettre l'installation sans réseau, les fichiers ("distfiles") 
requis ont été placés sur le CD. Notez que ces fichiers contiennent seulement les sources. Les paquets pré-construits sont placés sur le 
CD 2. Le CD 2 n'est pas démarrable.
</p>

<p>
Si vous voulez faire une installation rapide (20 minutes) sans réseau, GRP est
votre premier choix.
</p>

</body>
</section>

<section>
<title>Approche CD: sans stages (livecd)</title>
<body>

<p>
Le principe est le même que le précédent, mais le CD 1 ne contient pas de stages, ni fichiers sources, ni d'image de l'arbre de Portage. Le CD ne pèse que 70 Mo. Les stages peuvent
être téléchargés depuis les miroirs Gentoo quand on démarre avec le livecd.
Notez qu'une connexion réseau est requise si vous choisissez cette approche.
</p>

</body>
</section>

<section>
<title>Approche CD minimaliste</title>
<body>

<p>
Ce CD est uniquement présent pour des raisons historiques. Il ne pèse que 15 Mo (aucun support ppc ni airport).
</p>

</body>
</section>

<section>
<title>Approche CD: livecd kde/gnome</title>
<body>
<p>
Ce CD contient un environnement système live Gentoo complet avec les
environnements de bureau Gnome et KDE, un serveur web Apache, plusieurs
navigateurs web, des clients irc, des outils pare-feu/routeur, des outils
d'audits de réseaux, des outils en ligne de commande,...  Il peut être utilisé
pour réparer un système d'exploitation ou un système de fichiers. Le livecd
kde/gnome contient le comilateur gcc complet (les options distcc et ccache sont
activées); démarrez tous les macs sur votre réseau en utilisant ce CD et
expérimentez la distribution des compilations. Les autres livecd non-ppc ont
l'option distcc activée et la compilation croisée (utilisation de vos x86,
sparcs, etc pour construire des paquets pour ppc ou autres) sera disponible
prochainement. Ce CD peut être utilisé pour installer Gentoo, mais ne contient
pas GRP ni les fichiers sources ni une image de l'arbre de Portage ni les
stages. Une connexion réseau est requise pour l'installation.
</p>

</body>
</section>

<section>
<body>

<p>
Tous les CD de démarrage Gentoo Linux/PPC démarrent sur tous les macs "NewWorld".
Tous les CD 1.4 de démarrage peuvent être facilement utilisés sur les macs
"OldWorld" en téléchargeant BootX et en le démarrant (depuis une partition hfs)
avec les bons arguments. Sélectionnez <path>/boot/initrd.img.gz</path> comme
initrd, <path>/boot/vmlinux</path> comme noyau, mettez initrd-size à 11000,
mettez root à <path>/dev/ram</path> et mettez init à <path>/linuxrc</path>.
Plusieurs personnes ont installé Gentoo/PPC sur des machines "OldWorld", même
des machines ANS (<uri>http://www.apple.com/support</uri>) 
fonctionnent maintenant sous Gentoo/PPC. Partagez votre expérience avec les
développeurs PPC sur #gentoo-ppc sur irc.freenode.net. Les logiciels
irssi et bitchX sont disponibles sur tous les CD d'installation.
</p>

<p>
Pour installer depuis le CD, vous avez besoin d'un PowerPC 603 ou un
meilleur processeur sur un PowerPC basé sur un système PCI ou plus récent.
Cela devrait marcher avec moins de 128 Mo, mais le processus de construction peut être
très long dans ces conditions et pourrait ne plus fonctionner. Au moment de
la rédaction, les machines Nubus ne sont pas officiellement supportées, mais il
est à noter que des développeurs ont réussi l'installation de Gentoo sur des 
machines Nubus (en utilisant la compilation croisée et distcc).
</p>

<p>
Voyons rapidement le processus d'installation. Nous allons créer des
partitions, créer nos systèmes de fichiers et extraire une archive Stage1,
Stage2 ou Stage3. Si vous voulez utiliser une archive Stage1 ou Stage2, vous
devrez faire les étapes appropriées pour amener votre système au Stage3.  Une
fois le système en Stage3, nous pouvons modifier les fichiers de
configuration, installer un chargeur de démarrage et autres, et ensuite
démarrer la machine pour avoir un système Gentoo Linux complètement fonctionnel.
En fonction du stage que vous avez choisi pour le processus d'installation,
voici ce qui est requis pour l'installation :
</p>

<p>
<table>
<tr><th>Archive</th><th>Résumé de l'installation</th></tr>
<tr><ti>1</ti><ti>création des partitions/systèmes de fichiers, bootstrap, emerge system, emerge kernel, configuration finale</ti></tr>
<tr><ti>2</ti><ti>création des partitions/systèmes de fichiers, emerge system, emerge kernel, configuration finale</ti></tr>
<tr><ti>3</ti><ti>création des partitions/systèmes de fichiers, configuration finale</ti></tr>
</table>
</p>

</body>
</section>
</chapter>

<chapter>
<title>Démarrage</title>
<section>
<body>

<p>
Une fois que vous avez choisi le CD que vous voulez utiliser, continuez et
démarrez tout en maintenant la touche 'C' enfoncée au démarrage ou en lançant
le chargeur de démarrage pour "OldWorld" (bootX, quik). Vous serez accueilli
par un message de bienvenue et un prompt <c>boot:</c> en bas de l'écran. À ce
prompt, tapez entrée et un environnement complet de Gentoo Linux sera chargé à
partir du CD. Si vous avez des problèmes au démarrage, choisissez l'option
safe au démarrage. L'option safe donne les arguments suivant en plus au noyau :
append="video=ofonly nol3 init=/linuxrc".
</p>

<p>
Utilisez root comme nom d'utilisateur et laissez le mot de passe vierge pour vous logguer sur le livecd (un système de Gentoo/PPC "live"). Le login n'est 
pas nécessaire sur le cd minimaliste.
</p>

<p>
Si vous installez sur un système avec un clavier non-US, utilisez la commande
loadkeys pour définir la disposition de votre clavier. Elle se trouve dans
<path>/usr/share/keymaps</path>. Le cd minimaliste utilise un menu (système de
configuration) pour définir la disposition de votre clavier durant le
démarrage.
</p>

<p>
Un certain nombre de modules noyau sont disponibles et automatiquement chargés
si besoin est. Les livecds (pas le cd minimaliste) contiennent des parties multimédia
(ALSA, mplayer, ...) qui peuvent être utilisées pour jouer de la musique durant
l'installation. Notez que jouer un gros morceau va probablement ralentir un
peu l'installation.
</p>

<p>
La plupart des programmes sont disponibles sur le livecd (comme les clients
irc, navigateurs web, ssh, telnet, samba, talk ...) et peuvent être utilisés
simultanément durant l'installation en utilisant les consoles Linux. Vous devriez
avoir un prompt root sur la console en cours, mais vous pouvez aussi en ouvrir
d'autres en tapant ctrl+alt+f2, ctrl+alt+f3 (sur les powerbooks/ibooks,
c'est peut-être fn+ctrl+alt+f2).
</p>

</body>
</section>
</chapter>

<chapter>
<title>Chargement des modules du noyau</title>
<section>
<body>

<p>
Nous sommes presque prêts à commencer l'installation de Gentoo Linux et la
plupart des pilotes pour les périphériques standard sont inclus dans le noyau
du CD Gentoo PPC (Airport, ethernet 10/100/1000mbps), mais vous aurez peut-être
besoin d'autres pilotes que nous avons inclus. Pour voir la
liste de tous les modules inclus, regardez dans
<path>/lib/modules/*/kernel/drivers/*</path>. Pour charger un module en
particulier, tapez :
</p>

<pre caption = "Charger un module">
# <i>modprobe nomdumodule</i>
<comment>(remplacez nomdumodule par le nom du module désiré)</comment>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Configuration et installation du réseau</title>
<section>
<body>

<p>
Le nouveau CD de démarrage vous permet de configurer un réseau fonctionnel sur lequel
vous pouvez utiliser, entre autres, <c>ssh</c>, <c>scp</c> ou <c>wget</c>
si vous en avez besoin avant de commencer le processus d'installation. Si
vous commencez en utilisant GRP, il n'est pas nécessaire de mettre en place le
réseau maintenant. Il y a plusieurs façons d'activer le réseau.
La plus fréquente et la plus facile est sans doute DHCP :
</p>

</body>
</section>

<section>
<title>DHCP</title>
<body>

<p>
La configuration du réseau est simple avec DHCP; si votre FAI (Fournisseur
d'Accès Internet) n'utilise pas DHCP, passez directement à la section sur la
configuration statique plus bas.
</p>

<pre caption="Configuration réseau avec DHCP">
# <i>dhcpcd eth0</i>
</pre>

<note>
Quelques FAI vous demandent de fournir un hostname (nom de machine). Pour
cela, ajoutez l'option <c>-h monnomdemachine</c> à la ligne de commande de
dhcpcd vu plus haut.
</note>

<p>
Si vous recevez des avertissements <i>dhcpConfig</i>, ne paniquez pas; ces
erreurs sont purement informatives. Allez à la section de test du réseau plus
bas.
</p>

<p>
Veuillez noter que eth0 est l'adaptateur réseau interne par défaut sur la
plupart des livecds ppc. Si vous voulez installer Gentoo en utilisant airport,
exécutez :
</p>

<pre caption="Configuration réseau (airport) avec DHCP">
# <i>dhcpcd eth1</i>
</pre>

<p>
Si votre station de base airport est configurée pour crypter les connexions en
utilisant WEP, utilisez la commande iwconfig pour définir les bons paramètres.
</p>

</body>
</section>

<section>
<title>Configuration statique</title>
<body>

<p>
Nous devons installer un réseau minimum pour pouvoir télécharger les sources
pour construire le système, sans oublier l'interface localhost requise. Si vous
démarrez en utilisant le CD 1 GRP, toutes les sources nécessaires sont déjà sur
le CD dans le répertoire <path>/mnt/cdrom/distfiles</path>. Tapez les commandes
suivantes, en remplaçant $IFACE par votre interface réseau (normalement
<c>eth0</c>), $IPNUM par votre adresse IP, $BCAST par votre adresse de
broadcast et $NMASK par votre masque de sous-réseau. Pour la commande
<c>route</c>, remplacez $GTWAY par votre passerelle par défaut.
</p>

<pre caption = "Configuration statique du réseau">
# <i>/sbin/ifconfig $IFACE $IPNUM broadcast $BCAST netmask $NMASK</i>
# <i>/sbin/route add -net default gw $GTWAY netmask 0.0.0.0 metric 1</i>
</pre>

<p>
Maintenant, il est temps de créer le fichier <path>/etc/resolv.conf</path>
(seulement nécessaire si vous ne faites pas d'installation sans réseau) pour
que la résolution des noms (trouver les sites Web/FTP par nom plutôt que par
leur adresse IP) puisse fonctionner.
</p>

<note>
Pour des raisons historiques, Gentoo utilise un petit éditeur de texte appelé <c>nano</c> (un clone de <c>pico</c>) durant l'installation. Tous les CDs de 
Gentoo/PPC incluent aussi les plus populaires vim et emacs. D'autres éditeurs peuvent être ajoutés en faisant une simple requête au mainteneur du livecd
(<mail link="pvdabeel@gentoo.org">Pieter Van den abeele</mail>).
</note>

<p>
Voici exemple de création du fichier <path>/etc/resolv.conf</path> :
</p>

<pre caption="/etc/resolv.conf">
domain mondomaine.com
nameserver 10.0.0.1
nameserver 10.0.0.2
</pre>

<p>
Remplacez <c>10.0.0.1</c> et <c>10.0.0.2</c> par les adresses IP respectives de vos serveurs DNS primaire et secondaire.
</p>

</body>
</section>

<section>
<title>Test du réseau</title>
<body>

<p>
Maintenant que votre réseau a été configuré, la commande <c>/sbin/ifconfig -a</c> devrait vous montrer que votre carte réseau fonctionne
(regardez sur l'écran si <e>UP</e> et <e>RUNNING</e> apparaissent).
</p>

<pre caption="/sbin/ifconfig pour une carte réseau activée">
eth0      Link encap:Ethernet  HWaddr 00:50:BA:8F:61:7A
          inet addr:192.168.0.2  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::50:ba8f:617a/10 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1498792 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1284980 errors:0 dropped:0 overruns:0 carrier:0
          collisions:1984 txqueuelen:100
          RX bytes:485691215 (463.1 Mb)  TX bytes:123951388 (118.2 Mb)
          Interrupt:11
</pre>
<!--
<todo>
If you have a static ppp link, ...
If you have an ADSL pppoe link, ...
</todo>
-->

<note>
Utilisez <c>export http_proxy=http://monFAIproxy:port</c> ou <c>export http_proxy=monFAIproxy:port</c> si votre FAI vous impose l'utilisation d'un serveur de proximité (proxy).
</note>

<note>
Gentoo/PPC supporte aussi d'autres types de connexions (ADSL, ppp, ...).
Consultez le guide d'installation Gentoo/x86 si vous avez besoin de 
mettre en place une connexion sur une machine Gentoo/PPC.
</note>

</body>
</section>

<section>
<title>Le réseau fonctionne&nbsp;!</title>
<body>

<p>
Le réseau devrait maintenant être configuré et utilisable, si vous en avez
besoin bien sûr&nbsp;:-). Vous devriez être capable d'utiliser les commandes
telles que <c>ssh</c>, <c>scp</c>, <c>wget</c>, ... pour vous connecter à
d'autres machines de votre réseau ou sur Internet.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Création des partitions</title>
<section>
<body>

<p>
Maintenant que le noyau peut voir votre carte réseau et vos contrôleurs de disques, il est temps de créer les partitions sur le disque dur pour Gentoo Linux.
</p>

<p>
Voici un aperçu de l'organisation standard des partitions sous Gentoo Linux.
Nous allons créer au moins trois partitions&nbsp;: une partition de swap, une
partition racine qui contiendra la plus grande partie de Gentoo Linux, et une
partition spéciale pour le démarrage. La partition de démarrage est prévue pour
contenir les informations sur le chargeur de démarrage YABOOT. Pour les
utilisateurs de Mac "OldWorld", il n'est pas requis de créer cette partition de
démarrage puisque les machines seront initialisées sous MacOS et BootX servira
à initialiser le noyau Linux et les différents scripts de démarrage.
</p>

<p>
Passons maintenant aux différents types de systèmes de fichiers. Pour
l'instant, vous avez quatre options de systèmes de fichiers&nbsp;: XFS, ext2,
ext3 (journalisé) et ReiserFS. ext2 est le système de fichiers le plus testé et
le vrai système de fichiers de Linux mais il ne fait pas de journalisation de
méta-données. ext3 est la nouvelle version de ext2 avec une journalisation des
méta-données et une écriture des données ordonnées efficace. L'un ou l'autre
est recommandé pour l'utilisation de GentooPPC. ReiserFS et XFS sont tous les
deux des systèmes de fichiers très performants, mais ils sont encore au stade
expérimental sous PPC et ne sont pas recommandés. Vous pouvez expérimenter ces
systèmes de fichiers si votre machine n'est pas utilisée pour des fonctions
critiques.
</p>

<note>
Créez vos partitions en utilisant mac-fdisk, <c>mac-fdisk
/dev/hdx</c> (où x est la lettre de votre disque, a, b, c -
<path>/dev/sdx</path> pour les disques scsi). Vous avez besoin de créer au
minimum une partition de démarrage (l'option <c>b</c> dans mac-fdisk pour les
utilisateurs de Mac "NewWorld" uniquement), une partition de swap (généralement
une fois et demi votre ram, cependant je vous recommande au moins 512MB de
partition swap si vous prévoyez de compiler des logiciels volumineux), et une
partition racine. Utilisez <c>?</c> au prompt de mac-fdisk pour obtenir la
liste des options.
</note>

<p>
Une fois que vous avez créé vos partitions en utilisant <c>mac-fdisk</c>, vous
devez initialiser le ou les systèmes de fichiers qui seront utilisés pour
stocker vos données. Initialisez la partition swap comme suit&nbsp;:
</p>

<pre caption = "Création de la partition swap">
# <i>mkswap /dev/hda3</i>
</pre>

<p>
Vous pouvez utiliser la commande <c>mke2fs</c> pour créer le système de fichiers ext2:
</p>

<pre caption = "Formatage d'une partition ext2">
# <i>mke2fs /dev/hda4</i>
</pre>

<p>
Si vous préférez utiliser ext3, vous pouvez créer le système de fichiers ext3 en utilisant <c>mke2fs -j</c>:
</p>

<pre caption = "Formatage d'une partition ext3">
# <i>mke2fs -j /dev/hda4</i>
</pre>

<note>
Vous pouvez trouver d'autres détails sur ext3 sous Linux 2.4 à
<uri>http://www.zip.com.au/~akpm/linux/ext3/ext3-usage.html</uri>.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Montez vos partitions</title>
<section>
<body>

<p>
Maintenant, nous allons activer notre nouvelle partition de swap, car nous aurons peut-être besoin de cette mémoire virtuelle supplémentaire:
</p>

<pre caption = "Activation de la partition swap">
# <i>swapon /dev/hda3</i>
</pre>

<p>
Ensuite, nous allons créer le point de montage <path>/mnt/gentoo</path> et nous
allons y monter notre système de fichiers.
</p>

<pre caption = "Montage du système de fichiers">
# <i>mkdir /mnt/gentoo</i>
# <i>mount /dev/hda4 /mnt/gentoo</i>
</pre>

<p>
Si vous êtes en train d'installer Gentoo Linux avec une partition pour <path>/usr</path> ou <path>/var</path>, il faudra monter ces partitions 
respectivement à <path>/mnt/gentoo/usr</path> et <path>/mnt/gentoo/var</path>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Montez le CD-ROM</title>
<section>
<body>

<p>
Sur les livecds, le cdrom est automatiquement détecté et monté dans /mnt/cdrom.
</p>

<p>
Si vous avez démarré le cd minimaliste (notez que ce CD n'est pas activement
maintenu et est là pour des raisons historiques, il n'offre pas de support pour
le réseau sans fil, ppp...), le cdrom n'est pas monté automatiquement.  Nous avons besoin
de le monter pour avoir accès à l'image de l'archive
compressée contenue sur le CD-ROM. Pour monter le CD-ROM, il faut taper
habituellement:
</p>

<pre caption = "Montage du CD-ROM">
# <i>mount /dev/cdroms/cdrom0 /mnt/cdrom -o ro -t iso9660</i>
</pre>

<p>
Une fois le CD-ROM monté, vous devriez être capable de voir le(s) fichier(s)
<c>stage???.tbz2</c> en tapant <c>ls /mnt/cdrom/build</c>.
</p>

<note>
Si vous êtes incapable de monter votre cdrom, il est toutefois possible de
récupérer les stage1/2/3 depuis les sites miroirs en utilisant <c>lynx
gentoo.oregonstate.edu/releases/ppc/</c>.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Décompresser l'archive</title>
<section>
<body>

<p>
Avec le cdrom 1 GRP monté, vous devriez être capable de voir les archives
stage???.tbz2 dans le répertoire /mnt/cdrom/ppc-stages, /mnt/cdrom/g3-stages ou
/mnt/cdrom/g4-stages.
</p>

<p>
Si votre livecd ne contient pas les "stages" ou que vous voulez utiliser la dernière version, pointez lynx ou wget sur votre miroir
Gentoo et téléchargez l'une des dernières versions officielles des stages ppc depuis le répertoire <c>releases/1.4/stages/</c>. 
Pour des raisons historiques, les stages 1.2 sont toujours disponibles dans le répertoire releases/build, mais ils sont obsolètes et 
certains ne sont plus activement maintenus.
</p>

<impo>
Ne pas oublier d'utiliser l'option <c>p</c> avec <c>tar</c>. L'oublier risque
de provoquer des permissions incorrectes sur certains fichiers.
</impo>

<impo>
Si vous voulez construire entièrement le système optimisé pour votre processeur
à partir de rien, vous devez utiliser une image stage1, mais vous avez
aussi le choix entre une image stage2 ou stage3. Ces images vous permettent
de gagner du temps au détriment des possibilités de configuration (nous avons
choisi pour vous les optimisations du compilateur et les options USE par
défaut). Un stage3 est recommandé pour une installation GRP en 20 minutes.
</impo>

<pre caption = "Préparation de l'environnement">
# <i>cd /mnt/gentoo</i>
# <i>tar -xvjpf /mnt/cdrom/build/stage?-*.tbz2</i>
# <i>mount -o bind /proc /mnt/gentoo/proc</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</i>
</pre>

<p>
Si vous avez démarré à partir du CD 1 GRP, copiez les fichiers sources
('distfiles') et l'image de l'arbre de Portage au bon endroit :
</p>

<pre caption = "Préparation de l'environnement avec GRP">
# <i>cd /mnt/gentoo/usr</i>
# <i>tar -jxvf /mnt/cdrom/portage.tbz2</i>
# <i>cp -a /mnt/cdrom/distfiles/ /mnt/gentoo/usr/portage/distfiles/</i>
</pre>

<p>
Le nouveau système Gentoo est maintenant correctement installé, la seule chose
que nous devons faire est de dire au système Linux démarré depuis le livecd de
passer au nouveau Linux dans /mnt/gentoo :
</p>

<pre caption = "Chroot dans le nouvel environnement">
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i>
&gt;&gt;&gt; Regenerating /etc/ld.so.cache...
# <i>source /etc/profile</i>
</pre>

<p>
Après avoir exécuté ces commandes, vous serez à l'intérieur de votre nouvel
environnement Gentoo Linux.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Rsync</title>
<section>
<body>

<p>
Maintenant, vous avez besoin de lancer <c>emerge sync</c> qui vous connectera à
rsync.gentoo.org et téléchargera la dernière version de notre arbre de Portage.
Si vous faites une installation rapide sans réseau, cette étape n'est pas
nécessaire :
</p>

<pre caption = "Mise à jour de l'arbre de Portage">
# <i>emerge sync</i>
</pre>

<p>
L'arbre de Portage sera téléchargé; il a une taille d'environ 10 Mo.
</p>

<impo>
L'adresse pour le serveur rsync est en général
rsync://rsync.gentoo.org/gentoo-portage. Si vous avez des problèmes pour
accéder à Gentoo rsync, vérifiez que vous utilisez cette adresse en la mettant
comme variable SYNC dans votre <path>/etc/make.conf</path>. Si vous utilisez
l'image de l'arbre de Portage du CD, il n'est pas utile de faire un emerge
sync. Notez que emerge sync fait la mise à jour de l'image de l'arbre de
Portage, ce qui rend la plupart des ebuilds pré-compilés dépassés.
</impo>

<note>
La commande rsync peut être configurée pour utiliser un proxy HTTP si vous êtes
derrière un pare-feu. Pour configurer cette option, mettez
<i>RSYNC_PROXY="hostname:port"</i> dans <path>/etc/make.conf</path> ou
définissez-la comme variable d'environnement.
</note>

<note>
Regardez un peu les autres paramètres dans <path>/etc/make.conf</path> et
configurez-les selon vos besoins. Si vous utilisez la version GRP, vous devez
mettre ACCEPT_KEYWORDS à 'ppc' (la version stable). Plusieurs outils sont
disponibles pour sélectionner le meilleur miroir (<c>emerge mirrorselect
&amp;&amp; mirrorselect -a</c>) ou pour définir les options USE (<c>emerge ufed
&amp;&amp; ufed</c>).  Vérifiez que votre paramètre CFLAGS correspond au
processeur de la machine sur laquelle vous installez Gentoo.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Passage du stage1 au stage2</title>
<section>
<body>

<impo>
Si vous installez à partir de l'archive stage2 ou stage3, nous avons déjà fait
l'opération de bootstrap pour vous. Il n'y a pas de raison pour vous de
recommencer, à moins que vous ne décidiez de faire un <c>emerge sync</c> pour être
sûr d'avoir la toute dernière version du système Gentoo Linux. La plupart des
gens qui utilisent une archive de stage2 ou de stage3 ne veulent <i>pas</i>
recommencer l'opération de bootstrap puisque cette dernière peut prendre
jusqu'à une heure sur des machines très rapides.
</impo>

<p>
Maintenant, vous avez une copie fonctionnelle de l'arbre de Portage. Les
personnes qui utilisent l'archive de stage1 pour l'installation devront
effectuer un bootstrap de leur système Gentoo Linux comme ci-après. D'abord,
éditez le fichier <path>/etc/make.conf</path>. Dans ce fichier, vous devrez
définir les options <c>USE</c> qui spécifient les fonctionnalités
optionelles que vous voulez utiliser pour construire certains paquets.
Généralement, les valeurs par défaut (une variable USE <e>vide</e> ou non
définie) sont bonnes. Vous devez aussi définir les paramètres appropriés pour
<c>CHOST</c>, <c>CFLAGS</c> et <c>CXXFLAGS</c> pour l'ensemble du système que
vous êtes en train de créer (des exemples commentés peuvent être trouvés plus
bas dans le fichier). Si nécessaire, vous pouvez aussi définir les informations
sur les serveurs proximité ici, si vous êtes derrière un pare-feu.
</p>

<pre caption = "Modification de make.conf">
# <i>nano -w /etc/make.conf</i> <comment>(ajustez vos paramètres)</comment>
</pre>

<note>
Les personnes qui veulent optimiser le processus
de construction devraient jeter un oeil sur le fichier
<path>/etc/make.globals</path>. Ce fichier comprend les paramètres par défaut
de Gentoo et ne devrait jamais être modifié. Si les paramètres par défaut ne
suffisent pas, alors les nouveaux paramètres devront être définis dans
<path>/etc/make.conf</path>; les variables de <path>make.conf</path> sont
<comment>prioritaires</comment> par rapport aux variables de
<path>make.globals</path>. Si vous êtes intéressé par la configuration des
paramètres USE, lisez <path>/etc/make.profile/make.defaults</path>. Si vous
voulez désactiver les paramètres de la variable USE, ajoutez l'option
appropriée <c>USE="-foo"</c> dans <path>/etc/make.conf</path> (pour désactiver
le paramètre USE <c>foo</c>).
</note>

<p>
Maintenant, il est temps de commencer le processus "bootstrap". Ce dernier
devrait durer de 1 à 4 heures selon la rapidité de votre
machine. Durant ce temps, l'image de l'archive décompressée sera préparée pour
la compilation du reste du système. Le compilateur GNU sera construit ainsi que
la librairie GNU C. Ces opérations sont longues et constituent la plus grosse
partie de cette étape.
</p>

<pre caption = "Démarrage du processus de bootstrap">
# <i>cd /usr/portage</i>
# <i>scripts/bootstrap.sh</i>
</pre>

<p>
Le processus de "bootstrap" va maintenant commencer.
</p>

<note>
Par défaut, Portage utilise <path>/var/tmp</path> durant le processus de
construction des paquets. Cela peut souvent nécessiter plusieurs centaines de
mega-octets. Si vous voulez changer l'endroit où Portage stocke ses fichiers
temporaires, définissez le paramètre PORTAGE_TMPDIR <e>avant</e> de commencer
le processus de bootstrap, comme ceci&nbsp;:
</note>

<pre caption = "Configuration du répertoire temporaire">
# <i>export PORTAGE_TMPDIR="/ailleurs/tmp"</i>
</pre>

<p>
Le <c>bootstrap.sh</c> va construire <c>binutils</c>, <c>gcc</c>,
<c>gettext</c> et <c>glibc</c>, et ensuite reconstruire <c>binutils</c>,
<c>gcc</c> et <c>gettext</c> après la compilation de <c>glibc</c>. Il va sans
dire que ce processus prend un temps certain. Prenez un peu de repos. Une fois
le processus terminé, votre système sera dans un état "stage2".
</p>

</body>
</section>
</chapter>

<chapter>
<title>Passage du stage2 au stage3</title>
<section>
<body>

<note>
Si ce n'est pas déjà fait, éditez <path>/etc/make.conf</path> pour l'adapter à vos besoins.
</note>

<p>
Une fois que vous avez atteint le stage2 (encore une fois, si vous utilisez une
archive de stage3, ces étapes ne sont pas requises), il est temps de
construire le reste de la base du système comme ceci&nbsp;:
</p>

<pre caption = "Construction des paquets système">
# <i>export CONFIG_PROTECT=""</i>
# <i>emerge --pretend system</i>
<comment>[la liste des paquets qui vont être installés s'affiche]</comment>
# <i>emerge system</i>
</pre>

<note>
La ligne <c>export CONFIG_PROTECT=""</c> garantit que les nouveaux scripts
installés dans <path>/etc</path> écraseront les anciens scripts (stockés dans
<path>sys-apps/baselayout</path>), contournant ainsi la gestion des nouveaux fichiers
de configuration de Portage. Tapez <c>emerge --help config</c> pour plus de
détails.
</note>

<p>
La construction du système de base complet va prendre un moment. Votre
récompense est l'optimisation complète de votre système. L'inconvénient est que
vous devrez trouver un moyen de vous occuper tout ce temps. Quand <c>emerge
system</c> sera terminé, vous aurez un système Gentoo Linux en stage3.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Étapes finales: le fuseau horaire</title>
<section>
<body>

<note>
Si ce n'est pas déjà fait, éditez <path>/etc/make.conf</path> pour l'adapter à vos besoins.
</note>

<p>
Vous devriez maintenant avoir un système en stage3 prêt pour la
configuration finale. Nous allons démarrer ce processus par la définition du
fuseau horaire. En le configurant avant de construire le noyau, nous nous
assurons que les utilisateurs auront une sortie <c>uname -a</c> réaliste.
</p>

<p>Cherchez votre zone horaire (ou GMT si vous utilisez Greenwich Mean Time) dans <path>/usr/share/zoneinfo</path>. Puis, faites un lien symbolique, en tapant:
</p>

<pre caption = "Configuration de la zone horaire">
# <i>ln -sf /usr/share/zoneinfo/chemin/vers/fichierdezone /etc/localtime</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Noyau, journal système et cron</title>
<section>
<body>

<p>
Vous devez maintenant récupérer les sources du noyau ppc, cela peut se faire
avec <c>emerge sys-kernel/ppc-sources</c>.
</p>

<p>
Une fois que vous avez une arborescence des sources du noyau disponible, vous
pouvez compiler votre propre noyau :
</p>

<pre caption = "Compilation du noyau">
# <i>cd /usr/src/linux</i>
# <i>make menuconfig</i>
# <i>make dep &amp;&amp; make clean vmlinux modules modules_install</i>
# <i>cp vmlinux System.map /boot</i>
</pre>

<note>
Vous devez utiliser <e>uniquement</e> les noyaux Gentoo
(<c>sys-kernel/ppc-sources</c>) pour des machines basées sur PowerPC.
</note>

<warn>
Pour que votre noyau fonctionne correctement, plusieurs options doivent
être compilées en dur dans le noyau, ce qui signifie que les options
doivent <i>être activées et non compilées comme des modules</i>. Vous devez
activer l'option <i>"Code maturity level options --> Prompt for
development and/or incomplete code/drivers"</i> pour voir plusieurs de ces
sélections. Dans la section "File systems", activez <i>Device File System</i>
(notez que vous n'avez <e>pas</e> besoin d'activer l'option "/dev/pts file
system support"). Vous devez aussi activer le <i>Virtual Memory File
system</i>. Dans la section <i>Macintosh Device Drivers</i>, vérifiez que vous
avez désactivé l'option par défaut de <i>Support for ADB raw keycodes</i>.
Vérifiez aussi d'avoir <e>désactivé</e> l'option <i>Enhanced RTC</i> (dans
"Character devices"), car elle fonctionne mal sur PPC. <e>Activez</e>
<i>Support for /dev/rtc</i> dans "General setup". C'est toujours une bonne idée
de laisser le support pour ext2 que vous l'utilisiez ou pas. Les utilisateurs
de machines "OldWorld" doivent activer le support HFS pour pouvoir
copier le noyau compilé sur leur partition MacOS.
</warn>

<impo>
Si vous avez un graveur CD IDE et/ou DVD, vous devez activer
l'émulation SCSI dans le noyau. Activez-la dans "ATA/IDE/MFM/RLL support" --->
"IDE, ATA and ATAPI Block devices" ---> "SCSI emulation support" (je la compile
généralement en module), puis, dans "SCSI support", activez "SCSI support", "SCSI
CD-ROM support" et "SCSI generic support" (encore une fois, je les compile
généralement en modules). Si vous avez choisi de les utiliser en modules, alors
<c>echo -e "ide-scsi\nsg\nsr_mod" >> /etc/modules.autoload</c> les ajoutera
automatiquement au moment du démarrage. Vous devriez aussi ajouter cette ligne
à votre fichier <path>/etc/yaboot.conf</path>&nbsp;: <c>append="hdc=ide-scsi"</c>.
</impo>

<impo>
Si vous avez une machine "OldWorld", vous devrez monter votre partition
HFS (MacOS) et ensuite y copiez votre noyau pour que BootX puisse le charger
au démarrage. BootX trouvera automatiquement les noyaux dans le répertoire
<path>Linux Kernels</path> dans le répertoire Système.
</impo>

<p>
Votre nouveau noyau personnalisé (et ses modules) sont maintenant installés.
Choisissez le système de journalisation des messages que vous voulez installer.
Vous avez le choix entre sysklogd qui est le démon du système de log
traditionnel, metalog et syslog-ng. En cas de doute, vous devriez essayer
syslog-ng puisqu'il semble devenir plus populaire.  Pour installer le système
de votre choix, tapez <e>un</e> des trois groupes de lignes suivantes&nbsp;:
</p>

<pre caption = "Installation d'un système de log">
# <i>emerge app-admin/sysklogd</i>
# <i>rc-update add sysklogd default</i>
<comment>ou</comment>
# <i>emerge app-admin/metalog</i>
# <i>rc-update add metalog default</i>
<comment>ou</comment>
# <i>emerge app-admin/syslog-ng</i>
# <i>rc-update add syslog-ng default</i>
</pre>

<warn>
Si vous utilisez la version 1.2 de l'archive du stage3, vous n'avez pas besoin
d'installer un système de log.  stage3-ppc-1.2.tbz2 inclut sysklogd (bien que
l'ancienne et la nouvelle version ne le fassent pas). Si vous voulez utiliser
metalog à la place, vous devrez d'abord désinstaller sysklogd. Après
l'installation du stage3 terminée, empêchez sysklogd de se lancer au démarrage
avec <c>rc-update del sysklogd default</c>. Puis <c>emerge unmerge sysklogd</c>
pour le désinstaller. Vous devrez peut-être effacer manuellement les
fichiers de configuration de sysklogd dans <path>/etc</path> (cherchez
<c>cfgpro</c> dans la liste des fichiers durant la désinstallation). Pour
installer metalog, lancez <c>emerge metalog</c>, puis <c>rc-update add metalog
default</c>.
</warn>

<impo>
Metalog écrit ses messages sur le disque par blocs, donc les messages ne sont
pas immédiatement enregistrés dans les journaux système. Si vous essayez de
debugguer un démon, ce comportement ne va pas vous faciliter la tâche. Quand
votre système Gentoo Linux est en cours de fonctionnement, vous pouvez envoyer
un signal USR1 à metalog pour désactiver temporairement ce comportement, ce qui
veut dire que <i>tail -f <path>/var/log/everything/current</path></i> va alors
fonctionner en temps réel, comme voulu, et un signal USR2 pour revenir au
comportement original.
</impo>

<p>
Maintenant, vous pouvez choisir le package cron que vous voulez utiliser. Pour
l'instant, vous avez le choix entre dcron, fcron et vixie-cron. Si vous ne
savez pas lequel choisir, vous devriez installer vixie-cron. Ils peuvent être
installés comme ceci&nbsp;:
</p>

<pre caption = "Installation de cron">
# <i>emerge sys-apps/dcron</i>
# <i>crontab /etc/crontab</i>
<comment>ou</comment>
# <i>emerge sys-apps/fcron</i>
# <i>crontab /etc/crontab</i>
<comment>ou</comment>
# <i>emerge sys-apps/vixie-cron</i>
<comment>(Si vous installez avec GRP, utilisez "vcron" au lieu de "vixie-cron")</comment>
</pre>

<p>
N'oubliez pas d'ajouter cron au runlevel (niveau de lancement du système) par
défaut pour qu'il soit lancé au démarrage du système.
</p>

<pre caption="Ajout de cron au runlevel par défaut du système">
# <i>rc-update add &lt;name-of-/etc/init.d/cronscript&gt; default</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Installation de paquets supplémentaires</title>
<section>
<body>

<p>
Si vous utilisez une machine portable et que vous voulez utiliser vos
emplacements pcmcia dès le premier redémarrage, vous devriez vous assurer
d'avoir installé le package pcmcia-cs.
</p>

<pre caption = "Compilation de pcmcia-cs">
# <i>emerge sys-apps/pcmcia-cs</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Étapes finales: configuration du système</title>
<section>
<title>Étapes finales: /etc/fstab</title>
<body>

<p>
Votre système Gentoo Linux est presque prêt à l'utilisation. Il nous reste à
configurer des fichiers système importants et à installer le chargeur de
démarrage YABOOT. Le premier fichier que nous devons configurer est
<path>/etc/fstab</path>. Prenez garde de bien spécifier les types de système de
fichiers appropriés <c>ext2</c> ou <c>ext3</c>.
</p>

<p>
Prenez exemple sur le fichier <path>/etc/fstab</path> indiqué plus bas, mais
bien sûr remplacez "ROOT" et "SWAP" par les valeurs réelles des périphériques
que vous utilisez (comme par exemple <c>hda2</c>). Notez que les utilisateurs
de machines "NewWorld" <e>ne doivent pas</e> y ajouter leur partition de
démarrage.
</p>

<pre caption="/etc/fstab">
<comment>
# /etc/fstab: static file system information.
#
# noatime turns of atimes for increased performance (atimes normally aren't
# needed; notail increases performance of ReiserFS (at the expense of storage
# efficiency).  It's safe to drop the noatime options if you want and to
# switch between notail and tail freely.
# &lt;fs&gt;           &lt;mountpoint&gt;   &lt;type&gt;   &lt;opts&gt;          &lt;dump/pass&gt;
</comment>
/dev/ROOT           /           ext3	 noatime         0 1
/dev/SWAP           none        swap	 sw              0 0
/dev/cdroms/cdrom0  /mnt/cdrom  iso9660	 noauto,ro       0 0
proc                /proc       proc	 defaults        0 0
</pre>

</body>
</section>


<section>
<title>Étapes finales: définir le mot de passe root</title>
<body>

<p>
Avant d'oublier, définissez le mot de passe root en tapant:
</p>

<pre caption = "Mise en place du mot de passe root">
# <i>passwd</i>
</pre>

</body>
</section>
<section>
<title>Étapes finales: /etc/hostname</title>
<body>

<p>
Editez ce fichier pour qu'il contienne votre nom de machine avec son domaine en entier sur une seule ligne, par exemple <c>mamachine.mondomain.com</c>.
</p>

</body>
</section>

<section>
<title>Étapes finales: /etc/hosts</title>
<body>

<p>
Ce fichier contient une liste d'adresses IP avec leur hostname (nom de
machine) associé. Il est utilisé par le système pour trouver les adresses IP
des hostnames qui ne peuvent l'être par votre serveur de noms. Voici un exemple
pour ce fichier:
</p>

<pre caption="/etc/hosts">
127.0.0.1      localhost
<comment># la ligne suivante contient votre adresse IP pour votre réseau local et son nom de machine associé</comment>
192.168.1.1    mamachine.mondomaine.com 	mamachine
</pre>

</body>
</section>

<section>
<title>Configuration finale du réseau</title>
<body>

<p>
Ajoutez les noms de tous les modules qui peuvent être nécessaires au bon
fonctionnement de votre système dans le fichier
<path>/etc/modules.autoload</path> (vous pouvez aussi ajouter les différentes
options dont vous auriez besoin sur la même ligne).  Quand Gentoo Linux
démarre, ces modules sont chargés automatiquement. Cela est particulièrement
important pour votre carte réseau si vous avez compilé son pilote en tant que
module:
</p>

<pre caption="/etc/modules.autoload">
sungem
</pre>

<p>
Éditez le script <path>/etc/conf.d/net</path> pour avoir un réseau configuré au premier démarrage:
</p>

<pre caption = "Configuration du réseau">
# <i>nano -w /etc/conf.d/net</i>
# <i>rc-update add net.eth0 default</i>
</pre>

<p>
Si vous avez plusieurs cartes réseau, vous devez créer un script
<path>net.eth<comment>x</comment></path> (<comment>x</comment> = 1, 2, ...)
pour chaque carte&nbsp;:
</p>

<pre caption="Plusieurs interfaces réseau">
# <i>cd /etc/init.d</i>
# <i>cp net.eth0 net.eth<comment>x</comment></i>
# <i>rc-update add net.eth<comment>x</comment> default</i>
</pre>

<p>
Si vous avez installé une carte PCMCIA, vérifiez dans
<path>/etc/init.d/pcmcia</path> que les paramètres semblent corrects pour votre
installation, puis ajoutez le texte ci-dessous au début de votre fichier
<path>/etc/init.d/net.eth<comment>x</comment></path> pour que les pilotes
pcmcia soient chargés automatiquement avant le chargement des pilotes pour
votre réseau.
</p>

<pre caption = "Ajout des dépendances pcmcia">
depend() {
        need pcmcia
}
</pre>

</body>
</section>


<section>
<title>Étapes finales: configuration des paramètres de base (dont les paramètres du clavier)</title>
<body>

<pre caption="Configuration de base">
# <i>nano -w /etc/rc.conf</i>
</pre>

<p>
Suivez les instructions du fichier pour la configuration de base. Tous les
utilisateurs devront vérifier que <c>CLOCK</c> est à leur convenance. Les
utilisateurs de claviers internationaux devront définir la variable
<c>KEYMAP</c> (parcourez <path>/usr/share/keymaps</path> pour voir la liste
des possibilités).
</p>

</body>
</section>
</chapter>

<chapter>
<title>Configuration du chargeur de démarrage</title>
<section>
<body>

<p>
La principale différence que vous remarquerez par rapport à l'architecture Linux
x86 est le chargeur de démarrage. Les machines "NewWorld" utilisent YABOOT. Les
machines "OldWorld" utilisent BootX.
</p>

</body>
</section>

<section>
<title>YABOOT pour les machines "NewWorld" (installation automatique en utilisant yabootconfig)</title>
<body>

<p>
Vous pouvez utiliser le nouveau <c>yabootconfig</c> amélioré inclus dans
yaboot-1.3.8-r1 et suivant pour automatiser l'installation de YABOOT.
<c>yabootconfig</c> détectera automatiquement les partitions de votre machine
et installera un chargeur de démarrage avec une combinaison de Linux, Mac OS,
et Mac OS X.
</p>

<p>
Pour utiliser <c>yabootconfig</c>, votre disque doit avoir une partition
de démarrage et <path>/etc/fstab</path> doit être configuré avec vos partitions
Linux. Ces deux points ont été effectués dans les étapes précédentes. Pour
commencer, vérifiez que la dernière version de YABOOT est installée en lançant
<c>emerge -u yaboot</c>. Il est nécessaire d'installer la dernière version de
YABOOT via Portage, car il est possible que la version de l'archive que vous
avez décompressée doive être mise à jour.
</p>

<p>
Au prompt, lancez <c>yabootconfig</c>. Le programme va se lancer et confirmera
l'endroit où se trouve de la partition de démarrage.  Tapez <c>Y</c> si c'est
correct. Sinon, vérifiez <path>/etc/fstab</path>. <c>yabootconfig</c> scannera
ensuite votre système en entier, créera <path>/etc/yaboot.conf</path> et
lancera <c>mkofboot</c> pour vous. mkofboot est utilisé pour formater la
partition de démarrage et pour installer le fichier de configuration de YABOOT
dans celle-ci.
</p>

<p>
Vous voulez peut-être vérifier le contenu de <path>/etc/yaboot.conf</path>. Si
vous faites des changements dans <path>/etc/yaboot.conf</path> (comme mettre un
OS par défaut au démarrage), n'oubliez pas de relancer <c>ybin -v</c> pour
appliquer les changements à la partition de démarrage.
</p>

</body>
</section>

<section>
<title>YABOOT pour les machines "NewWorld" (installation manuelle de yaboot.conf)</title>
<body>

<p>
Si, pour certaines raisons, vous ne voulez pas lancer <c>yabootconfig</c> pour
une installation automatique du fichier <path>/etc/yaboot.conf</path>, vous
pouvez modifier le fichier d'exemple déjà installé sur votre système. Voici un
exemple de fichier complet de yaboot.conf:
</p>

<pre caption="/etc/yaboot.conf">
## /etc/yaboot.conf
##
## run: "man yaboot.conf" for details. Do not make changes until you have!!
## see also: /usr/share/doc/yaboot/examples for example configurations.
##
## For a dual-boot menu, add one or more of:
## bsd=/dev/hdaX, macos=/dev/hdaY, macosx=/dev/hdaZ

## our bootstrap partition:
boot=/dev/hda9

##hd: is open firmware speak for hda
device=hd:
partition=11

root=/dev/hda11
delay=5
defaultos=macosx
timeout=30
install=/usr/lib/yaboot/yaboot
magicboot=/usr/lib/yaboot/ofboot

#################
## This section can be duplicated if you have more than one kernel or set of
## boot options
#################
image=/boot/vmlinux
	label=Linux
	sysmap=/boot/System.map
	read-only
##################

macos=/dev/hda13
macosx=/dev/hda12
enablecdboot
enableofboot
</pre>

<p>
Une fois <path>yaboot.conf</path> paramétré selon vos besoins, lancez
<c>mkofboot -v</c> pour installer les paramètres dans la partition de
démarrage. N'oubliez pas cela&nbsp;! Si tout va bien et que vous avez les mêmes
options que dans l'exemple précédent, votre prochain démarrage vous donnera un
simple menu avec cinq choix. Si plus tard vous mettez à jour votre
configuration YABOOT, vous n'aurez qu'à relancer <c>ybin -v</c> pour mettre à
jour la partition de démarrage. Mkofboot n'est utilisé que pour l'installation
initiale.
</p>

<note>
Yaboot a plusieurs fonctionnalités pour les paramètres de configuration au
démarrage, consultez <uri>http://penguinppc.org/projects/yaboot</uri> pour plus
d'informations.
</note>

</body>
</section>

<section>
<title>BootX pour les machines "OldWorld"</title>
<body>

<impo>
Redémarrez votre machine et suivez ces étapes&nbsp;:
</impo>

<p>
Démarrez votre machine sous MacOS et ouvrez le panneau de contrôle de BootX.
Sélectionnez <c>Options</c> et désactivez <c>Used specified RAM disk</c>. À
votre retour sur l'écran principal de BootX, vous trouvez une option pour
spécifier le disque et la partition racine de votre machine. Remplissez les
champs par les valeurs appropriées. De plus, vous devez passer le
paramètre suivant à votre noyau.
</p>

<pre caption="Passer le paramètre à votre noyau">
video=ofonly pane:rw init=/linuxrc initrd=/boot/initrd.img.gz
</pre>

<p>
BootX peut être configuré pour démarrer Linux au démarrage. Si vous faites
cela, vous verrez d'abord le démarrage de MacOS, puis durant le démarrage,
BootX chargera et lancera Linux. Consultez la <uri
link="http://penguinppc.org/projects/bootx/">page principale de BootX</uri>
pour plus d'informations.
</p>

</body>
</section>

</chapter>

<chapter>
<title>Installation terminée&nbsp;!</title>
<section>
<body>

<p>
Gentoo Linux est maintenant installé. La dernière étape à effectuer est de
quitter l'environnement chroot, de démonter proprement vos partitions et de
redémarrer le système:
</p>

<pre caption = "Sortie de l'environnement chroot">
# <i>exit</i>  <codenote>Cela quitte l'environnement chrooté; vous pouvez aussi tapez <c>^D</c></codenote>
# <i>cd / </i>
# <i>umount /mnt/gentoo/proc</i>
# <i>umount /mnt/gentoo</i>
# <i>reboot</i>
</pre>

<note>
Après le redémarrage, c'est une bonne idée de lancer la commande
<c>update-modules</c> pour créer le fichier <path>/etc/modules.conf</path>.
Plutôt que de modifier directement ce fichier, vous devriez effectuer vos
modifications dans les fichiers du répertoire <path>/etc/modules.d</path>.
Quand la machine a redémarré, mettez le CD 2 GRP et faites cp -a /mnt/cdrom
vers /usr/portage/packages.  Cela vous permettra d'installer KDE/Gnome et
d'autres gros paquets en quelques minutes.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Extras</title>

<section>
<title>Émulation de plusieurs boutons de souris</title>
<body>

<p>
Vous voulez peut-être ajouter ces lignes à <path>/etc/sysctl.conf</path> pour
activer l'émulation de plusieurs boutons sur votre souris à chaque démarrage.
La valeur des touches peut être obtenue par l'utilitaire en ligne de commande
<c>showkey</c>. Voici un exemple utilisant les touches F11 et F12.
</p>

<pre caption = "Exemple de configuration pour sysctl.conf">
# Active l'émulation des boutons souris
dev.mac_hid.mouse_button_emulation = 1
# Met le 2ème bouton à 87 - F11
dev.mac_hid.mouse_button2_keycode = 87
# Met le 3ème bouton à 88 - F12
dev.mac_hid.mouse_button3_keycode = 88
</pre>

</body>
</section>

<section>
<title>Gentoo-Stats</title>
<body>

<p>
L'usage du programme de statistiques de Gentoo Linux a commencé comme une
tentative pour donner aux développeurs un aperçu de l'usage de cette
distribution. Le programme collecte des informations sur l'usage de Gentoo
Linux pour les aider à mettre des priorités dans leurs développements.
L'installation est totalement facultative et serait très appréciée si vous
décidiez de l'utiliser. Les statistiques récupérées peuvent être vues à
<uri>http://stats.gentoo.org/</uri>.
</p>

<p>
Le serveur gentoo-stats assignera un ID unique à votre système. Cet ID est
utilisé pour être sûr que chaque système soit compté une seule fois. L'ID ne
sera pas utilisé pour une identification individuelle de votre système, aucune
adresse IP ni aucune information personnelle ne seront récupérées. Toutes les
précautions ont été prises pour assurer le respect votre vie privée dans le
développement de ce système. Les informations que notre programme
"gentoo-stats" collecte et nous envoie sont&nbsp;:
</p>

<ul>
<li>Paquets installés et leurs versions respectives.</li>
<li>Information sur le CPU: vitesse (MHz), nom du vendeur, modèle, paramètres du CPU (comme "altivec").</li>
<li>Information sur la mémoire (RAM physique, total de l'espace swap).</li>
<li>Chipset des cartes PCI et des contrôleurs réseau.</li>
<li>Le profil utilisé de la Gentoo Linux (c'est-à-dire où pointe le lien de <path>/etc/make.profile</path>).</li>
</ul>

<p>
Nous sommes conscients que la divulgation d'informations sensibles représente un
danger pour la plupart des utilisateurs de Gentoo Linux (tout comme pour les
développeurs).
</p>

<ul>
<li>A moins que vous ne modifiez le programme gentoo-stats, il ne transférera jamais d'informations sensibles telles que vos mots de
passe, vos données de configuration, vos films favoris, etc.</li>
<li>La transmission de votre adresse e-mail est facultative et est désactivée par défaut.</li>
<li>L'adresse IP utilisée lors des envois de données n'est jamais stockée de façon à pouvoir vous identifier. Il n'y a pas de paires "adresse IP/ID système".</li>
</ul>

<p>
L'installation est facile - il suffit de lancer les commandes suivantes:
</p>

<pre caption="Installation de gentoo-stats">
# <i>emerge gentoo-stats</i>   <comment>(Installer gentoo-stats)</comment>
# <i>gentoo-stats --new</i>    <comment>(Obtenir nouvel ID système)</comment>
</pre>

<p>
La seconde commande ci-dessus va demander un nouvel ID système et va le sauver
automatiquement dans le fichier
<path>/etc/gentoo-stats/gentoo-stats.conf</path>. Vous pouvez visualiser ce
fichier pour voir les options supplémentaires.
</p>

<p>
Après ça, le programme devrait être lancé régulièrement (gentoo-stats n'a pas
besoin d'être lancé en tant que root). Ajoutez cette ligne à votre
<path>crontab</path>&nbsp;:
</p>

<pre caption="Mise à jour de gentoo-stats par cron">
0 0 * * 0,4 /usr/sbin/gentoo-stats --update > /dev/null
</pre>

<p>
Le programme <c>gentoo-stats</c> est un simple script perl qui peut être
visualisé dans votre éditeur préféré, il se nomme
<path>/usr/sbin/gentoo-stats</path>.
</p>

</body>

</section>

<section>
<title>Que faire à partir de maintenant ?</title>
<body>

<p>
D'autres documents sont disponibles dans la section docs du site principal de
Gentoo. Certains sont valables pour toutes les architectures disponibles.
L'utilisation du prelinking est conseillée, mais pas nécessaire, si vous voulez
de meilleures performances (le temps de démarrage de KDE peut être amélioré
d'au moins 50%). Alsa (advanced linux sound architecture) est indiqué pour
certaines machines ppc (particulièrement sur les powerbooks récents). Si vous
voulez un système audio hautement configurable, consultez la documentation
ALSA.  Les applications que vous voulez absolument installer sur une machine
mac sont pmud (advanced power management) ou pbbuttons (si vous utilisez un
powerbook). L'installation de Xfree sur des machines PPC est très facile;
<c>emerge Xeasyconf &amp;&amp; Xeasyconf</c> devrait suffire.
</p>

<p>
Si vous avez des questions ou si vous voulez participer au développement de
Gentoo Linux, pensez à vous inscrire sur nos deux listes de diffusion
gentooppc-user et gentooppc-dev (suivez le lien "click to subscribe" sur <uri
link="http://www.gentoo.org/">la page principale</uri>).  De plus, le <uri
link="desktop.xml">guide de configuration du bureau</uri> vous aidera à
configurer votre nouveau système Gentoo Linux et le <uri
link="portage-user.xml">guide de Portage</uri> vous aidera à vous
familiariser avec les bases de Portage. Bienvenue à Gentoo Linux&nbsp;!
</p>

<p>
La <uri link="gentoo-ppc-faq.xml">FAQ pour Gentoo Linux/PowerPC</uri>
répond à la plupart des questions usuelles à propos de Gentoo Linux/PPC. La
<uri link="faq.xml">FAQ Gentoo Linux</uri> peut aussi vous aider bien
qu'elle soit plutôt destinée aux installations x86. <uri
link="http://forums.gentoo.org/viewforum.php?f=24">Gentoo sur PPC</uri> (sur
forums.gentoo.org) est un forum de discussion en anglais pour toutes les
questions concernant les PowerPC. Vous pouvez aussi discuter en direct sur IRC.
Rejoignez-nous sur <i>#gentoo-ppc</i> sur <i>irc.freenode.net</i>.
</p>

<p>
Merci et bonne continuation avec Gentoo&nbsp;!
</p>

</body>
</section>

</chapter>

</guide>

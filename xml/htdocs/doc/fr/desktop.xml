<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/desktop.xml,v 1.23 2004/05/03 09:17:19 neysx Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/desktop.xml" lang="fr">
<title>Guide de configuration du bureau Gentoo Linux</title>
<author title="Auteur">
  <!--zhen@gentoo.org-->John P. Davis
</author>
<author title="Auteur">
  <mail link="g2boojum@gentoo.org">Grant Goodyear</mail>
</author>
<author title="Auteur">
  <mail link="lu_zero@gentoo.org">Luca Barbato</mail>
</author>
<author title="Correcteur">
  <mail link="peesh@gentoo.org">Jorge Paulo</mail>
</author>
<author title="Correcteur">
  <mail link="blubber@gentoo.org">Tiemo Kieft</mail>
</author>
<author title="Correcteur">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Correcteur">
  <mail link="klasikahl@gentoo.org">Zack Gilburd</mail>
</author>
<author title="Correcteur">
  <mail link="bennyc@gentoo.org">Benny Chuang</mail>
</author>
<author title="Correcteur">
  <mail link="erwin@gentoo.org">Erwin</mail>
</author>
<author title="Traducteur">
  <mail link="frlinux@frlinux.net">FRLinux</mail>
</author>
<author title="Traducteur">
  <mail link="neysx@gentoo.org">Xavier Neys</mail>
</author>

<abstract>
Ce guide vous explique comment configurer votre bureau sous Gentoo Linux.  Nous
étudierons plus particulièrement la configuration de X, KDE, GNOME, ALSA (le
son), postfix (courrier électronique) et Samba (interopérabilité UNIX/windows).
</abstract>

<license/>

<version>1.4.23</version>
<date>1er mai 2004</date>

<chapter>
<title>Préliminaires</title>
<section>

<body>

<p>
Il va sans dire que vous devez avoir <uri link="/doc/fr/handbook/">installé
Gentoo</uri>
(<uri>http://www.gentoo.org/doc/fr/handbook/handbook-x86.xml?part=1</uri>).
Ensuite, vous devez télécharger la dernière version de <e>Portage</e>.  Nous
vous conseillons d'ailleurs la lecture du chapitre du manuel sur <uri
link="/doc/fr/handbook/handbook-x86.xml?part=2&amp;chap=2">Portage et les
logiciels</uri>, mais les impatients se contenteront de taper&nbsp;:
</p>

<pre caption="Mise à jour de l'arbre de Portage">
# <i>emerge sync</i>
</pre>

<p>
Il me semble important d'expliquer mon choix concernant les paquets qui sont
abordés dans ce guide. Gentoo Linux contient en effet une liste très
impressionnante de gestionnaires de fenêtres, serveurs de courrier électronique
et autres logiciels.  Les paquets choisis ici ne reflètent pas la préférence
des utilisateurs Gentoo mais plus mon propre choix en tant qu'utilisateur
capable de les paramétrer correctement. En d'autres mots, ce sont les paquets
qui sont utilisés sur mon bureau.
</p>

<impo>
Il est conseillé de déselectionner les gestionnaires que vous ne voulez pas
utiliser en éditant <path>/etc/make.conf</path>. Dans la section <c>USE</c>,
ajoutez <e>-gnome -gtk</e> si vous utilisez KDE, ou bien <e>-kde -qt</e> si
vous comptez utiliser GNOME.
</impo>

<warn>
Si vous rencontrez un bogue avec un de ces paquets, informez-nous en via
<uri>http://bugs.gentoo.org/</uri>. Ne les envoyez <e>pas</e> aux mainteneurs
de ces paquets (ex&nbsp;: KDE), les développeurs Gentoo s'en chargeront le cas
échéant.
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Installer XFree86</title>
<section>
<title>Installation</title>

<body>

<p>
Le processus d'installation de X prendra un certain temps, même sur un
système rapide. Ce système est relativement imposant, choisissez un bon livre
ou faites une petite sieste.
</p>

<p>
Pour installer XFree86, tapez&nbsp;:
</p>

<pre caption="Installer XFree86">
# <i>emerge xfree</i>
# <i>env-update &amp;&amp; source /etc/profile</i>
</pre>

<p>
Une fois cette longue procédure terminée, la configuration peut commencer.
</p>

</body>
</section>

<section>
<title>Configurer X</title>

<body>

<p>
J'aime bien utiliser l'outil de configuration en mode texte <c>xf86config</c>
pour configurer X, bien qu'il génère un fichier <path>/etc/X11/XF86Config</path>
qui ne soit pas très élégant.  Avant de commencer, il vous faudra
consulter le manuel de votre moniteur et noter les fréquences de
rafraîchissement horizontales et verticales (mon Viewsonic G773 possède les
caractéristiques suivantes&nbsp;: horizontalement&nbsp;:&nbsp;30-69 KHz,
verticalement&nbsp;:&nbsp;55-90 KHz), le type et la quantité de mémoire (en Ko)
de votre carte vidéo (une carte Geforce avec 32768 Ko dans mon cas), ainsi que
le type de souris (le mienne est une Intellimouse connectée sur le port PS/2
vu sur <path>/dev/psaux</path>).
</p>

<pre caption="Exécuter xf86config">
# <i>/usr/X11R6/bin/xf86config</i>
</pre>

<p>
Je choisis de ne pas émuler les 3 boutons puisque ma souris a 3 boutons.
N'oubliez pas d'ajouter le support XKB si vous possédez un clavier international ou si vous avez besoin d'un support pour plusieurs langues. Il vous faudra ensuite décider d'une résolution et du nombre de couleurs. J'aime utiliser
1280x1024 en 24bpp car mon Viewsonic ne peut pas mieux. Si vous n'avez jamais fait ceci, ne
soyez pas étonné de devoir exécuter <c>xf86config</c> plusieurs fois.
</p>

<note>
Si vous ne connaissez pas les fréquences de rafraîchissement de votre moniteur,
essayez de faire une recherche sur Google par exemple
<uri>http://www.google.fr</uri>, en précisant le modèle et le fabriquant de
votre moniteur. Ces données sont généralement documentées dans les
spécifications.
</note>

<p>
Vous pouvez aussi configurer XFree86 avec la commande <c>XFree86
-configure</c>. Celle-ci créera un fichier de configuration
<path>XF86Config</path> dans le répertoire de l'utilisateur
root&nbsp;(<path>/root</path>).  Ce fichier devrait permettre à XFree86 de
fonctionner, mais vous pouvez le modifier pour l'adapter à vos besoins. Si tout
vous semble correct, copiez-le dans <path>/etc/X11/XF86Config</path>.
</p>

<p>
Ce <uri 
link="http://www-106.ibm.com/developerworks/edu/os-dw-linuxxwin-i.html">tutoriel</uri>
décrit la configuration de X plus en détails.
</p>

<note>
Si vous ne connaissez pas les fréquences de rafraîchissement de votre moniteur,
essayez une recherche sur <uri>http://www.google.com/</uri> avec le numéro de
modèle et la marque de votre moniteur. Les fréquences sont généralement
indiquées dans les spécifications.
</note>

<note>
Si vous utilisez un clavier international qui a besoin des touches diacritiques
(telles que &#232;, &#233;, &#234;, &#235;, &#242;, &#243;), vous devez
déclarer votre variable de définition de votre localisation avant de démarrer
X. Pour cela, créez un fichier <path>/etc/env.d/02locale</path> et ajoutez
<c>LC_CTYPE=«&nbsp;xx_YY&nbsp;»</c> où <c>xx</c> est votre langue (p.ex. «&nbsp;<c>fr</c>&nbsp;») et
<c>YY</c> votre pays (p.ex. «&nbsp;<c>BE</c>&nbsp;»). Si vous voulez utiliser le symbole
euro, vous devez ajouter «&nbsp;<c>@euro</c>&nbsp;» à votre variable (p.ex.
<c>LC_CTYPE="fr_BE@euro"</c>). N'oubliez pas de faire ensuite <c>env-update
&amp;&amp; source /etc/profile</c> pour prendre vos modifications en compte.
</note>

<p>
Les utilisateurs qui ont de l'expérience avec la configuration X sont sans
doute habitués à faire un lien symbolique du fichier matériel de la souris vers
<path>/dev/mouse</path>. Ces liens symboliques étaient problématiques avec
devfs car ils avaient tendance à disparaître après un redémarrage. Gentoo Linux
gère maintenant correctement les liens symboliques dans le répertoire
<path>/dev</path>. Vous pouvez donc créer le lien symbolique
<path>/dev/mouse</path> en utilisant <c>ln -s</c> et il <e>sera</e> préservé
après un redémarrage.
</p>

<p>
Si vous utilisez XFS (le serveur de polices de X), suivez les instructions
ci-dessous. L'utilisation de XFS est hautement recommandée car elle facilite
<e> grandement</e> la configuration des polices. Consultez cet article du site
de <uri
link="http://www.redhat.com/docs/manuals/linux/RHL-7.3-Manual/ref-guide/s1-x-fonts.html">RedHat</uri>
pour en savoir plus sur XFS.
</p>

<pre caption="Tester votre configuration">
# <i>rc-update add xfs default</i>
# <i>/etc/init.d/xfs start</i>
# <i>startx</i>
</pre>

<p>
Si vous avez correctement configuré X, la commande <c>startx</c> devrait
démarrer un gestionnaire de fenêtres X particulièrement laid (twm, si vous
tenez à le savoir). Si X démarre, vous pouvez continuer. Appuyez sur
<c>&lt;Ctrl&gt;&lt;Alt&gt;&lt;Retour arrière&gt;</c> pour arrêter le serveur.
</p>

<p>
<c>xf86config</c> crée uniquement un jeu d'options par défaut. Les utilisateurs
de cartes NVIDIA, souris USB ou autres devront les paramétrer manuellement. Je
vais tenter de répondre à la plupart de ces questions un peu plus bas, mais je
vous recommande de lire le fichier <c>XF86Config</c> afin de voir ce que vous
pouvez modifier vous-même. Il n'est pas si difficile à comprendre. Si vous
recherchez des informations pour optimiser ce fichier, consultez le <uri link=
"http://www.tldp.org/HOWTO/mini/FDU/">Guide des belles polices</uri>.
</p>

</body>
</section>

<section>
<title>Configurer une souris PS/2</title>

<body>

<p>
Si vous avez une souris PS/2 avec molette, modifiez le fichier <c>XF86Config</c> comme ceci&nbsp;:
</p>

<pre caption="Modifier XF86Config">
# <i>cp /etc/X11/XF86Config /etc/X11/XF86Config.working</i>
# <i>nano -w /etc/X11/XF86Config</i>
</pre>

<pre caption="Section du périphérique de pointage dans XF86Config">
Section "InputDevice"

#Identifier and driver

Identifier	"Mouse1"
Driver	"mouse"
<i>Option "Protocol"    "IMPS/2" </i>
Option "Device"      "/dev/psaux"
<i>Option "ZAxisMapping"	"4 5"</i>
</pre>

<p>
Les utilisateurs de souris de type Intellimouse remplaceront le 
«&nbsp;Protocol&nbsp;» «&nbsp;PS/2&nbsp;» par «&nbsp;IMPS/2&nbsp;». Pour 
activer la molette, il suffit de rajouter la ligne «&nbsp;Option "ZAxisMapping" 
"4 5"&nbsp;» où «&nbsp;4&nbsp;» et «&nbsp;5&nbsp;» correspondent aux mouvements 
vers le haut et vers le bas.
</p>

<p>
Si vous possédez une souris à molette et que <c>PS/2</c> ne fonctionne pas,
essayez <c>IMPS/2</c> même si votre souris n'est pas de type Intellimouse.
Certaines souris Logitech fonctionnent si vous faites cela.
</p>

<note>
Netscape 4.x ne gérant pas la molette par défaut, vous devrez créer un fichier .Xdefaults.
Consultez <uri link="http://www-sop.inria.fr/koala/colas/mouse-wheel-scroll/">cette page</uri>
pour savoir comment procéder. Utilisez plutôt <c>Konqueror</c>, <c>Opera</c>,
<c>Mozilla</c>, <c>Galeon</c> ou n'importe quel autre vrai navigateur.
</note>

<p>
Lancez <c>startx</c> pour vérifier que X démarre toujours correctement.
</p>

</body>
</section>

<section>
<title>Configurer une souris USB</title>

<body>

<p>
Une souris USB est très utile sur un écran haute résolution, car le noyau
optimise ses mouvements, ce qui vous évite de déplacer la souris 5 fois sur le
tapis pour lui faire traverser l'écran.
</p>

<note>
Lorsque vous configurez le support de base de votre souris, assurez-vous de
bien préciser la résolution d'écran qui sera utilisée sous XFree86. Cela
devrait rendre son utilisation facile et agréable.
</note>

<p>
Déconnectez votre souris, patientez quelques secondes, puis reconnectez-la.
Votre noyau devrait alors indiquer quelque chose comme ceci dans les journaux
des événements («&nbsp;log&nbsp;») ou dmesg&nbsp;:
</p>

<pre caption="Message du noyau">
hub.c: USB new device connect on bus1/1, assigned device number 2
input0,hiddev0: USB HID v1.00 Mouse [Microsoft Microsoft IntelliMouse Optical] on usb1:2.0
</pre>

<p>
Maintenant que nous savons que la souris est détectée, vérifiez que
<path>/dev/input</path> contient un périphérique&nbsp;:
</p>

<pre caption="Vérifier l'existence de votre souris USB">
# <i>cd /dev/input</i>
# <i>cat mice</i>
<comment>Déplacez votre souris après avoir tapé la commande <i>cat</i>.
Vous devriez voir des caractères apparaître à l'écran.
Faites <i>control-C</i> pour arrêter le test.</comment>
</pre>

<p>
Maintenant que la souris est correctement installée, il faut indiquer à X de
l'utiliser. Il vous suffit pour cela de changer une section de votre fichier de
configuration.
</p>

<pre caption="Éditer XF86Config">
# <i>cp /etc/X11/XF86Config /etc/X11/XF86Config.working</i>
# <i>nano -w /etc/X11/XF86Config</i>
</pre>

<pre caption="Section du périphérique de pointage dans le fichier XF86Config">
Section "InputDevice"

# Identifier and driver

Identifier	"Mouse1"
Driver	"mouse"
<i>Option "Protocol"    "IMPS/2" </i>
Option "Device"      "/dev/input/mice"
<i>Option "ZAxisMapping"	"4 5"</i>
</pre>

<p>
Redémarrez X et votre souris devrait fonctionner&nbsp;!
</p>

</body>
</section>

<section>
<title>Configurer une carte NVIDIA</title>

<body>
<p>
Si vous possédez une carte  NVIDIA, c'est le moment d'installer les pilotes pour 
l'accélération matérielle.</p>

<note>
Si vous recompilez votre noyau, vous devez aussi recompiler le paquet
<c>nvidia-kernel</c>.  Cela est nécessaire car le nouveau noyau effacera le
module nividia lorsqu'il installera ses propres modules.
</note>

<pre caption="Pour possesseurs de cartes NVIDIA uniquement">
# <i>emerge nvidia-glx</i>
# <i>emerge nvidia-kernel</i>
# <i>nano -w /etc/X11/XF86Config</i>
<comment>(Changez "nv" en "nvidia" dans la section Device</comment>
# <i>modprobe nvidia</i>
</pre>

<note>
Si vous utilisez une version du noyau différente de 2.4, remplacez 2.4 par la
version que vous utilisez.
</note>

<pre caption="/etc/modules.autoload.d/kernel-2.4 (uniquement pour les cartes NVIDIA)">
# <i>nano -w /etc/modules.autoload.d/kernel-2.4</i>
<comment>(Ajoutez la ligne suivante.)</comment>
nvidia
</pre>

<pre caption="Activer le support GLX dans le fichier /etc/X11/XF86Config">
Section "Module"

# This loads the GLX module
#    Load       "glx" <comment>(Décommentez cette ligne.)</comment>
</pre>

<pre caption="Configurer le fichier /etc/X11/XF86Config pour utiliser le pilote NVIDIA">
Section "Device"
Identifier  "NVIDIA GeForce"
#Driver      "nv"
Driver      "nvidia"
#VideoRam    32768
# Insert Clocks lines here if appropriate
EndSection
</pre>

<pre caption="Activer l'accélération 3D">
# <i>opengl-update nvidia</i>
</pre>

<p>
Faites un <c>startx</c> pour vous assurer que X démarre encore. (L'écran
d'accueil avec le logo NVIDIA devrait apparaître si vous avez correctement
installé les pilotes.)
</p>

<note>
Si vous rencontrez des problèmes, veuillez consulter la documentation sur glx
dans le fichier <path>/usr/share/doc/nvidia-glx-1.0.XXXX/README.gz</path>. De
nombreuses variables de configuration peuvent influencer les performances de
votre système.
</note>

</body>
</section>
<section>
<title>Configurer une carte ATI</title>
<body>

<p>
Si vous possédez une carte ATI, vous devriez penser à installer les pilotes ATI
plus rapides.
</p>

<p>
Pratiquement toutes les cartes graphiques ATI sont supportées par <uri
link="http://www.xfree86.org">Xfree86</uri>, du moins en ce qui concerne
l'utilisation en 2D.  Le support de la 3D est fourni soit par le <uri
link="http://dri.sf.net">projet DRI</uri> qui est déjà inclus dans XFree86,
soit par des pilotes propriétaires <uri
link="http://mirror.ati.com/support/drivers/linux/radeon-linux.html"> fournis
par ATI</uri>.
</p>

<table>
<tr>
  <th>Processeur graphique</th>
  <th>Nom habituel</th>
  <th>Support</th>
</tr>
<tr>
  <ti>rage128</ti>
  <ti>Rage128</ti>
  <ti>xfree DRI</ti>
</tr>
<tr>
  <ti>r100</ti>
  <ti>Radeon7xxx, Radeon64</ti>
  <ti>xfree DRI</ti>
</tr>

<tr>
  <ti>r200, r250</ti>
  <ti>Radeon8500, Radeon9000</ti>
  <ti>xfree DRI, ATI DRI</ti>
</tr>
<tr>
  <ti>r300 et plus récent</ti>
  <ti>Radeon9500, Radeon9800</ti>
  <ti>xfree 2D, ATI DRI</ti>
</tr>
</table>

<p>
<b>Ma carte est une All-In-Wonder/Vivo. Ses capacités multimédias sont-elles supportées&nbsp;?</b>
</p>

<p>
En fait, les fonctionnalités multimédias sont supportées par le
<uri 
link="http://gatos.sf.net">projet GATOS</uri>.
</p>

<warn>
Ati-gatos est actuellement dépassé.  Il est prévu d'inclure le support gatos
directement dans xfree.
</warn>

<p>
<b>Je n'utilise pas l'architecture x86. Que puis-je faire&nbsp;?</b>
</p>

<p>
Un support pratiquement identique existe sur les plates-formes alpha et ppc,
mais vous ne pourrez pas utiliser les pilotes propriétaires d'ATI. Cela
signifie que vous ne pourrez pas utiliser la 3D avec des cartes r300. Si vous
possédez une telle carte et que vous voulez l'utilisez avec xfree, vous devriez
contacter <uri link="http://www.ati.com">ATI</uri> pour leur demander de
libérer les spécifications.
</p>

<p>
<b>J'ai un portable.  Ma carte «&nbsp;ATI mobility&nbsp;» est-elle supportée&nbsp;</b>
</p>

<p>
Elle devrait l'être, mais vous pourriez rencontrer des problèmes de
configuration à cause des codes OEM de ces cartes. Dans la plupart des cas,
vous devez créer vous-même votre fichier <c>xf86config</c>.
</p>

<p>
<b>Installer les paquets</b>
</p>

<p>
L'ebuild <c>xfree</c> fournit XFree86, <c>xfree-drm</c> contient les modules du
noyau nécessaires pour installer DRI et <c>ati-drivers</c> permet d'installer
les pilotes et les modules du noyau propriétaires d'ATI.
</p>

<impo>
Votre noyau doit avoir été compilé avec le support agpgart et sans avoir
sélectioné de module DRM.
</impo>

<pre caption="Installer les pilotes">
<codenote>Pour n'installer que les pilotes Rage128 et les modules installés avec xfree.</codenote>
# <i>VIDEO_CARDS="rage128" emerge xfree-drm</i>
<codenote>Pour n'installer que le support Radeon</codenote>
<codenote>(r100, r200, r250, mais pas r300).</codenote>
# <i>VIDEO_CARDS="radeon" emerge xfree-drm</i>
<codenote>Pour installer les pilotes ATI propriétaires</codenote>
<codenote>(Uniquement r200, r250 et r300).</codenote>
# <i>emerge ati-drivers</i>
<codenote>Pour n'installer que XFree86 sans module particulier</codenote>
# <i>emerge xfree</i>
</pre>

<p>
<b>Configuration</b>
</p>

<p>
Il est conseillé d'utiliser <c>xf86cfg</c>, <c>xf86config</c> ou l'option de
configuration automatique de XFree86&nbsp;:
</p>

<pre caption="Configuration automatique de X">
# <i>X -configure</i>
</pre>

<p>
Pour de plus amples informations sur le fichier de configuration
<c>XF86Config</c>, veuillez consulter la section <uri
link="#doc_chap2_sect2">Configurer X</uri>.
</p>

<note>
Si vous utilisez les pilotes ATI, vous pouvez aussi utiliser
<c>fglrxconfig</c>.
</note>

<impo>
Sur des machines PPC, vous devriez utiliser l'outil de configuration
<c>Xeasyconf</c>. Un ebuild est disponible dans Portage.
</impo>

</body>
</section>
</chapter>

<chapter>
<title>Gestionnaires de fenêtres</title>

<section>
<title>Introduction</title>
<body>

<p>
Généralement, après avoir configuré X, on installe un joli gestionnaire de fenêtres.
Vous pouvez évidemment utiliser twm si vous appréciez sa laideur fonctionnelle.
</p>

<p>
Un grand nombre de gestionnaires sont disponibles. KDE,
GNOME, Fluxbox, Blackbox, d'autres *box,  Windowmaker et Sawfish en sont quelques exemples.
Comme vous pouvez le voir, l'éventail des choix est particulièrement large.
</p>

</body>
</section>

<section>
<title>KDE</title>
<body>

<p>
Si vous lisez cette section, je vais supposer que vous avez choisi KDE. Il
est désormais complètement supporté dans Gentoo Linux, mais je vous conseille
de lire ce qui suit avant de faire un emerge de KDE&nbsp;:
</p>

<ul>
<li>
  Assurez-vous d'avoir «&nbsp;qt&nbsp;» et «&nbsp;kde&nbsp;» dans votre variable USE dans le fichier
  <path>make.conf</path>.
</li>
<li>
  Assurez-vous aussi d'avoir mis (facultatif) «&nbsp;-gnome&nbsp;» et «&nbsp;-gtk&nbsp;» dans le
  fichier <path>make.conf</path>.
</li>
</ul>

<p>
Vous pouvez réaliser ces deux étapes en modifiant le fichier
<path>/etc/make.conf</path> comme suit&nbsp;:
</p>

<pre caption="Modifier make.conf">
# <i>nano -w /etc/make.conf</i>
<comment>(dans le fichier make.conf)</comment>
USE="qt kde -gnome -gtk"
</pre>

<p>
Pour en savoir plus sur les options de la variable USE, veuillez consulter le
chapitre du manuel consacré à la <uri
link="/doc/fr/handbook/handbook-x86.xml?part=2&amp;chap=1">Variable USE</uri>.
</p>

<p>
Je vous conseille également l'utilisation de l'option <c>--pretend</c> avant de faire un
<c>emerge</c> afin de voir quels paquets vont être installés. Dans le cas de KDE,
il y en a beaucoup.
</p>

<pre caption="Vérifier les paquets requis par KDE">
# <i>emerge --pretend kde</i>
# <i>emerge kde</i>
# <i>env-update &amp;&amp; source /etc/profile</i>
</pre>

<p>
Jetez un œil au fichier <path>/etc/X11/Sessions/</path>
et voyez quelles sessions KDE sont disponibles
(par exemple <path>kde-3.1.2</path>).
Ensuite, ouvrez le fichier <path>/etc/rc.conf</path> et
indiquez ceci&nbsp;:
</p>

<pre caption="Définir la variable XSESSION">
XSESSION="kde-3.1.2"
</pre>

<p>
Si vous ne voulez pas installer KDE avec tous ses paquets (ce que ferait
<c>emerge kde</c>), vous pouvez installer séparément les paquets que vous
<e>voulez</e> vraiment. Le tableau ci-dessous contient une sélection de
paquets disponibles. Installez ceux que vous souhaitez en faisant
<c>emerge nom_du_paquet</c>.
</p>

<table>
<tr>
  <th>Paquet</th>
  <th>Description</th>
</tr>
<tr>
  <ti>kdeaccessibility</ti>
  <ti>Programmes liés à l'accessibilité</ti>
</tr>
<tr>
  <ti>kdebase</ti>
  <ti>Base de KDE, nécessaire</ti>
</tr>
<tr>
  <ti>kdeaddons</ti>
  <ti>Divers outils KDE obsolètes</ti>
</tr>
<tr>
  <ti>kdeadmin</ti>
  <ti>Outils d'administration</ti>
</tr>
<tr>
  <ti>kdeartwork</ti>
  <ti>Jolis thèmes pour KDE</ti>
</tr>
<tr>
  <ti>kdeedu</ti>
  <ti>Outils éducatifs</ti>
</tr>
<tr>
  <ti>kdegames</ti>
  <ti>Jeux KDE</ti>
</tr>
<tr>
  <ti>kdegraphics</ti>
  <ti>Outils graphiques</ti>
</tr>
<tr>
  <ti>kdemultimedia</ti>
  <ti>Lecteurs et outils multimedia</ti>
</tr>
<tr>
  <ti>kdenetwork</ti>
  <ti>Outils réseau</ti>
</tr>
<tr>
  <ti>kdepim</ti>
  <ti>Gestionnaires d'informations personnelles (PIM), calendriers, aide-mémoire, etc.</ti>
</tr>
<tr>
  <ti>kdesdk</ti>
  <ti>Outils pour développeurs</ti>
</tr>
<tr>
  <ti>kdetoys</ti>
  <ti>Gadgets KDE</ti>
</tr>
<tr>
  <ti>kdeutils</ti>
  <ti>Outils système</ti>
</tr>
<tr>
  <ti>kde-i18n</ti>
  <ti>Fichiers de traductions i18n - cf. note ci-dessous</ti>
</tr>
</table>

<note>
Si vous pensez utiliser CUPS pour imprimer, vous devriez ajouter 
«&nbsp;cups&nbsp;» dans vos options USE dans le fichier 
<path>/etc/make.conf</path> avant d'installer KDE. Vous pouvez aussi le faire 
sur la ligne de commande en tapant <c>USE="cups" emerge kde</c>. Consultez le 
<uri link="printing-howto.xml">Guide de l'impression</uri> avec 
Gentoo pour connaître les détails de l'installation de CUPS.
</note>

<note>
Le paquet kde-i18n utilise la variable d'environnement LINGUAS pour déterminer
quelles langues il doit installer.  Par exemple, <c>LINGUAS="fr it"</c> permet
l'installation des traductions française et italienne.
</note>

<p>
Bonne sieste&nbsp;!
</p>

<note>
Si vous avez un CD Gentoo avec des paquets binaires, vous pouvez installer ces 
paquets directement comme ceci&nbsp;:
</note>

<pre caption="Installer les paquets binaires depuis le CD">
# <i>export PKGDIR=/mnt/cdrom/gentoo/packages</i>
<comment>(Portage s'attend à trouver les paquets dans /usr/portage/packages)</comment>
# <i>emerge --usepkg /mnt/cdrom/gentoo/packages/All/kdebase-x.y.z.tbz2</i>
<comment>(L'option <i>--usepkg</i> permet l'utilisation des paquets binaires pour les dépendances quand ils sont disponibles.)</comment>
# <i>env-update &amp;&amp; source /etc/profile</i>
</pre>

</body>
</section>

<section>
<title>Configurer KDM</title>
<body>

<p>
Après avoir installé KDE, vous pouvez utiliser son gestionnaire
d'identification, c-à-d. KDM.  Il fait partie des paquets KDE et s'exécute
simplement en faisant&nbsp;:
</p>

<pre caption="Démarrer KDM">
# <i>kdm</i>
</pre>

<p>
Vous devriez pouvoir démarrer KDE et vous assurer que tout fonctionne. Le son
ne fonctionne pas encore, mais nous allons arranger cela sous peu. Essayez
<c>ls /usr/bin</c> dans konsole (ou n'importe quelle autre commande qui affiche
beaucoup de texte) et vérifiez que la molette fait défiler le contenu de la
fenêtre. Ça devrait marcher&nbsp;!
</p>

<p>
Il ne vous reste plus qu'à paramétrer Gentoo pour exécuter X à chaque
démarrage. Editez <path>/etc/rc.conf</path> et indiquez
<e>DISPLAYMANAGER="kdm"</e>.
</p>

<pre caption="Éditer /etc/rc.conf">
# <i>nano -w /etc/rc.conf</i>
</pre>

<pre caption="/etc/rc.conf - Définir DISPLAYMANAGER">
# What display manager do you use ?  [ xdm | gdm | kdm ]
DISPLAYMANAGER=kdm
</pre>

<p>
Il ne reste qu'à ajouter <e>xdm</e> aux scripts d'initialisation.
</p>

<pre caption="Ajout de XDM aux scripts d'initialisation par défaut">
# <i>rc-update add xdm default</i>
</pre>

<p>
Redémarrez et X/KDE devrait apparaître.
</p>

<impo>
La commande <c>rc-update</c> est une version améliorée de la vénérable
<c>chkconfig</c> qui gère les scripts d'initialisation. Tapez <c>rc-update</c> pour
lister ses options.
</impo>

</body>
</section>
</chapter>

<chapter>
<title>GNOME</title>

<section>
<title>Installation</title>
<body>

<p>
Avant de commencer à installer les paquets GNOME, vous devriez modifier la
variable USE pour activer le support de GNOME quand vous compilerez des
applications.
</p>

<ul>
<li>
  Vérifiez que «&nbsp;gtk&nbsp;» et «&nbsp;gnome&nbsp;» sont définis dans la variable USE dans votre
  fichier <path>make.conf</path>.
</li>
<li>
  Vérifiez éventuellement que «&nbsp;-kde&nbsp;» et «&nbsp;-qt&nbsp;» sont définis dans la variable USE
  dans <path>make.conf</path>.
</li>
</ul>

<p>
Modifiez le fichier <path>/etc/make.conf</path> comme ceci&nbsp;:
</p>

<pre caption="Éditer make.conf">
# <i>nano -w /etc/make.conf</i>
<comment>(Dans le fichier make.conf)</comment>

USE="gnome gtk -kde -qt"
</pre>

<p>
Pour en savoir plus sur les options de la variable USE, veuillez consulter le
<uri link="/doc/fr/handbook/handbook-x86.xml?part=2&amp;chap=1">guide USE</uri>.
</p>

<p>
Installez maintenant les paquets de GNOME.
</p>

<pre caption="Installer les paquets de GNOME">
# <i>emerge --pretend gnome</i>
# <i>emerge gnome</i>
# <i>emerge xscreensaver</i>
# <i>env-update &amp;&amp; source /etc/profile</i>
</pre>

<p>
Cela va durer un certain temps, passez le temps avec un bon film. L'auteur
recommande Pulp Fiction.
</p>

<p>
Modifiez le fichier <path>/etc/rc.conf</path> pour que la variable
XSESSION indique Gnome.
</p>

<pre caption="Modifier XSESSION dans /etc/rc.conf">
XSESSION="Gnome"
</pre>

<p>
À partir d'ici, la configuration de GNOME est sensiblement la même que celle de
KDE. Il n'y a aucun fichier spécifique à paramétrer pour GNOME, mais il faut
paramétrer GDM, le gestionnaire d'identification.
</p>

</body>
</section>

<section>
<title>Configurer GDM</title>
<body>

<p>
Après avoir installé GNOME, vous pouvez utiliser son gestionnaire
d'identification, c-à-d. GDM. Il fait partie du paquet GDE et s'exécute
simplement en faisant&nbsp;:
</p>

<pre caption="Exécuter GDM">
# <i>gdm</i>
</pre>

<p>
Vous devriez pouvoir démarrer GNOME et vous assurer que tout fonctionne. Le son
ne fonctionne pas encore, mais nous allons arranger cela sous peu. Essayez
<c>ls /usr/bin</c> dans une console (ou n'importe quelle autre commande qui affiche
beaucoup de texte) et vérifiez que la molette fait défiler le contenu de la
fenêtre. Ça devrait marcher&nbsp;!
</p>

<p>
Il ne reste plus qu'à paramétrer Gentoo pour lancer X à chaque démarrage.
Éditez <path>/etc/rc.conf</path> et indiquez <e>DISPLAYMANAGER="gdm"</e>.
</p>

<pre caption="Éditer /etc/rc.conf">
# <i>nano -w /etc/rc.conf</i>
</pre>

<pre caption="/etc/rc.conf - Définir DISPLAYMANAGER">
# What display manager do you use ?  [ xdm | gdm | kdm ]
DISPLAYMANAGER=gdm
</pre>

<p>
Ajoutons <e>xdm</e> aux scripts d'initialisation.
</p>

<pre caption="Ajout de XDM aux scripts d'initialisation">
# <i>rc-update add xdm default</i>
</pre>

<p>
Redémarrez et X/GNOME devrait apparaître.
</p>

<impo>
La commande <c>rc-update</c> est une version améliorée de la vénérable
<c>chkconfig</c> qui gère les scripts d'initialisation. Tapez <c>rc-update</c> pour
lister ses options.
</impo>

</body>
</section>
</chapter>

<chapter>
<title>Configuration du son</title>
<section>
<title>Alsa</title>
<body>

<p>
Veuillez consulter le <uri link="/doc/fr/alsa-guide.xml">Guide d'installation
de ALSA</uri>.
</p>

</body>
</section>

<section>
<title>KDE et le son</title>
<body>

<p>
KDE offre quelques utilitaires pratiques dont la console de mixage 
(«&nbsp;mixer&nbsp;») <c>kmix</c>.
</p>

<note>
Si kmix ne trouve pas le programme de mixage, il considérera que vous n'avez 
pas installé le support du son. Quittez votre session X, supprimez 
<path>~/.kde/share/config/kmixrc</path> et <path>~/.kde/share/config/kmix:*</path> 
et relancez X. KDE devrait maintenant trouver le programme de mixage.
</note>

</body>
</section>

<section>
<title>GNOME et le son</title>
<body>

<p>
Vous devriez essayer <c>gnome-alsamixer</c> pour modifier les niveaux sonores.
Il fait partie du paquet <path>media-sound/gnome-alsamixer</path>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Courrier électronique</title>
<section>
<title>Postfix, installation et configuration</title>
<body>

<p>
J'aime <c>postfix</c> car il simule <c>sendmail</c> sans imposer le cauchemard
qu'est sa configuration. Nous installerons aussi <c>mutt</c>, un lecteur de
courrier électronique, pour tester notre configuration de <c>postfix</c>.
</p>

<pre caption="Installer postfix et mutt">
# <i>emerge postfix mutt</i>
</pre>

<p>
Si vous comptez utiliser Postfix uniquement pour envoyer du courrier
électronique, il est déjà configuré. Sinon, vous devez modifier
<path>/etc/postfix/main.cf</path>. Ce fichier est relativement bien documenté
et les valeurs par défaut sont acceptables pour une machine seule. Si votre
ordinateur est connecté directement à Internet (c-à-d. avec une adresse IP
publique et un nom DNS), il vous suffit de modifier ce fichier pour activer la
réception de courriels.
</p>

<pre caption="Activer la réception de courriels dans le fichier main.cf">
# RECEIVING MAIL

# The inet_interfaces parameter specifies the network interface
# addresses that this mail system receives mail on.  By default,
# the software claims all active interfaces on the machine. The
# parameter also controls delivery of mail to user@[ip.address].
#
#inet_interfaces = all
#inet_interfaces = $myhostname
#inet_interfaces = $myhostname, localhost
<i>inet_interfaces = $myhostname, localhost</i>
<i>mydestination = $myhostname, localhost.$mydomain</i>
</pre>


</body>
</section>

<section>
<title>Tester Postfix avec Mutt</title>
<body>

<p>
Voyons si ça marche.
</p>

<pre caption="Tester Postfix">
# <i>postfix check</i>
# <i>newaliases</i>
# <i>postfix start</i>
postfix-script: starting the Postfix mail system
# <i>mutt -x root</i>
/root/.maildir does not exist. Create it? ([y]/n): <comment>[Répondez «&nbsp;y&nbsp;»]</comment>
To:  &lt;root&gt;
Subject: test
(End message with a . on a line by itself)
test
.

# <i>mutt</i>
<comment>[Vous devriez voir votre message.]</comment>
</pre>

<p>
En utilisant <c>postfix check</c>, nous nous assurons que le fichier
<path>main.cf</path> est lu correctement et que les répertoires importants sont
créés. La commande <c>newaliases</c> configure les alias système et la
commande <c>postfix start</c> démarre le serveur de courrier. J'ai ensuite
utilisé <c>mutt</c> (façon <c>mailx</c> ou encore en mode <c>mail</c>) pour
m'envoyer un courriel localement. <c>mutt</c> crée aussi le répertoire de stockage
du courrier (pour root dans notre exemple) dans <path>~/.maildir</path>. Lancé
en mode interactif, <c>mutt</c> affiche votre message&nbsp;; nous savons donc que
l'envoi et la réception de messages internes fonctionne. J'ai ensuite envoyé un
courrier à une adresse externe (absent dans l'exemple) pour vérifier que les
courriers électroniques sont correctement envoyés.
</p>

<warn>
Si vous envoyez un courriel en utilisant la configuration par défaut du fichier
<path>main.cf</path> depuis une machine sur un réseau privé, il y a de fortes
chances qu'il n'arrive jamais à sa destination. Beaucoup de serveurs de courrier
refusent les courriers électroniques qui proviennent d'une source
non-vérifiable par une résolution DNS inverse.
</warn>

<p>
Je suppose que tout fonctionne. Il est temps d'ajouter postfix au démarrage du
système.
</p>

<pre caption="Lancer Postfix à chaque démarrage de la machine">
# <i>postfix stop</i>
postfix-script: starting the Postfix mail system
# <i>rc-update add postfix default</i>
 * postfix added to runlevel default...
 * Caching service dependencies...          [ ok ]
 * rc-update complete.
# <i>/etc/init.d/postfix start</i>
Starting postfix......     [  ok  ]
</pre>

<impo>
Les vétérans de <c>sendmail</c> ou les aficionados de <c>postfix</c> sont
peut-être habitués à stocker leur courrier dans <path>/var/spool/mail</path> au lieu
des répertoires utilisateurs. De plus, les courriels y sont stockés au format <e>mbox</e>
plutôt que <e>maildir</e>. Il n'est pas difficile de reconfigurer
<c>postfix</c> pour que <c>postfix</c> et <c>mutt</c> utilisent le format
standard de boîte (<e>mbox</e>). Éditez <path>/etc/postfix/main.cf</path>,
commentez <c>home_mailbox</c> et décommentez <c>mail_spool_directory =
/var/spool/mail</c>.  Créez le répertoire contenant les courriels en faisant
<c>mkdir -p /var/spool/mail</c> et redémarrez <c>postfix</c>.  Ensuite, pour la
partie client, et particulièrement <c>mutt</c>, il vous suffit d'éditer
<path>/etc/mutt/Muttrc</path> et d'ajouter <c>set mbox_type = mbox</c> et le
répertoire <path>/var/spool/mail</path> avec <c>set
spoolfile=/var/spool/mail/$USER</c>.
</impo>

<p>
Si vous préférez un client graphique, nous installerons l'interface Web
Squirrelmail un peu plus loin. D'ailleurs, Daniel Robbins recommande vivement
la combinaison d'IMAP (que nous installerons pour Squirrelmail) et le client
mail de KDE <c>kmail</c> qui fait partie du paquet
<path>kde-base/kdenetwork</path>.
</p>

<p>
Nous verrons aussi comment installer <e>Evolution</e> comme logiciel de gestion
d'informations personnelles (PIM) avec le support pour Palm Pilot.
<e>Evolution</e> est aussi un excellent client de courrier électronique.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Samba</title>

<section>
<title>Installer et configurer Samba</title>
<body>

<p>
Samba est un superbe paquet qui permet aux machines Linux de partager des
fichiers et des imprimantes avec des machines MS Windows. Pour plus
d'informations, consultez l'article écrit par Daniel Robbins sur
<uri>http://www.ibm.com/developerworks?ca=dgr-Gentoo-dWhp</uri>.
</p>

<pre caption="Installer Samba">
# <i>emerge samba</i>
# <i>rc-update add samba default</i>
# <i>cd /etc/samba</i>
# <i>cp smb.conf.example smb.conf</i>
# <i>nano -w smb.conf</i>
</pre>

<pre caption="smb.conf - Le groupe de travail">
# workgroup = NT-Domain-Name or Workgroup-Name, eg: REDHAT4
workgroup = MYGROUP <comment>[Indiquez le groupe de travail ou domaine.]</comment>
</pre>

<pre caption="smb.conf - Imprimer avec CUPS">
# It should not be necessary to specify the print system type unless
# it is non-standard. Currently supported print systems include:
# bsd, sysv, plp, lprng, aix, hpux, qnx
;   printing = bsd
printing = cups
</pre>

<p>
Il faut également activer l'impression en mode brut pour que CUPS puisse
imprimer correctement des documents qui viennent de machines Windows.
</p>

<p>
Ouvrez le fichier <path>/etc/cups/mime.convs</path> et décommentez les lignes
comme décrit ci-dessous.  Les modifications apportées à mime.convs et
mime.types sont indispensables pour que CUPS puisse imprimer des documents
Microsoft Office.
</p>

<pre caption="/etc/cups/mime.convs">
<comment>(La ligne suivante se trouve vers la fin du fichier. Décommentez-la.)</comment>
application/octet-stream        application/vnd.cups-raw        0       
</pre>

<p>
Modifiez le fichier <path>/etc/cups/mime.convs</path> comme suit&nbsp;:
</p>

<pre caption="/etc/cups/mime.types">
<comment>(La ligne suivante se trouve vers la fin du fichier. Décommentez-la.)</comment>
application/octet-stream 
</pre>

<pre caption="smb.conf - Cryptage">
# You may wish to use password encryption. Please read
# ENCRYPTION.txt, Win95.txt and WinNT.txt in the Samba documentation.
# Do not enable this option unless you have read those documents
encrypt passwords = yes
</pre>

<p>
J'attends peu de choses de Samba. Je veux juste partager mes fichiers entre des
machines Linux et Windows, et utiliser ma machine Linux comme serveur
d'impression avec <c>cups</c>. Après l'installation, il faut juste faire
quelques petites modifications dans votre fichier
<path>/etc/samba/smb.conf</path>. Assurez-vous notamment que la variable
<e>workgroup</e> correspond bien à votre groupe de travail (ou domaine) Windows
(j'utilise généralement «&nbsp;OLYMPUS&nbsp;», mais «&nbsp;WORKGROUP&nbsp;» est 
la valeur par défaut, si ma mémoire est bonne), que <e>printing</e> indique 
<e>cups</e> au lieu de <e>bsd</e>, et que la ligne <e>encrypt passwords = yes</e> 
est décommentée. Les machines Windows utilisent des mots de passe cryptés par 
défaut, cette dernière instruction est donc cruciale, à moins que vous ne 
vouliez modifier directement la base de registres des machines Windows 
<e>[pas recommandé du tout]</e>. Malheureusement, Windows utilise 
une méthode de cryptage différente de Linux, il vous faudra donc un fichier de 
mots de passe différent pour samba.
</p>

<pre caption="Ajout d'utilisateurs dans samba">
# <i>smbpasswd -a jules</i> <comment>[Remplacez «&nbsp;jules&nbsp;» par le nom de l'utilisateur.]</comment>
New SMB password:
Retype new SMB password:
Added user jules.
</pre>

<note>
Avant d'ajouter un utilisateur au fichier de mots de passe samba, il doit
exister dans le fichier <path>/etc/passwd</path>.
</note>

<p>
Pour chaque utilisateur qui doit être autorisé à utiliser les partages, lancez
la commande <c>smbpasswd</c>. Samba enregistre les mots de passe dans le
fichier <path>/etc/samba/private/smbpasswd</path> qui sera créé la première
fois que vous lancerez la commande <c>smbpasswd</c>.
</p>

<pre caption="Démarrer Samba">
# <i>/etc/init.d/samba start</i>
Starting samba...        [  ok  ]
</pre>

<p>
Démarrez samba et vous devriez pouvoir vous connecter sur votre Gentoo Linux
depuis n'importe quelle machine Windows et accéder à votre répertoire $HOME
ainsi qu'aux imprimantes partagées. Si vous ne pouvez pas vous connecter,
consultez
<path>/usr/share/doc/samba-2.2.5-r1/full_docs/textdocs/DIAGNOSIS.txt.gz</path>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Apache et l'interface Web Squirrelmail</title>
<section>
<title>Apache avec support SSL et PHP</title>
<body>

<p>
Si vous avez une adresse IP fixe (ou que vous utilisez les services de dyndns,
par exemple, pour lier votre adresse dynamique à un nom), vous voulez sans
doute avoir la possibilité de vérifier votre courrier à distance. Ma solution
utilise Squirrelmail. Ce dernier peut être utilisé avec n'importe quel navigateur.
</p>

<p>
Commençons par installer un serveur Web. Vu que la plupart du monde utilise
Apache, nous allons également l'utiliser. Nous allons aussi installer mod_php
(le support PHP pour apache) puisque Squirrelmail a été écrit en PHP.
</p>

<pre caption="Installer et configurer Apache">
# <i>emerge apache php mod_php</i>
</pre>

<p>
Vous devriez également consulter le fichier
<path>/etc/apache2/conf/apache2.conf</path> parce que Apache est hautement
configurable. Par défaut, la racine des documents du serveur Apache se trouve
dans <path>/var/www/localhost/htdocs</path> (Apache y trouve les fichiers html qu'il
envoie quand vous vous connectez à http://www.monserveur.foo ou
http://localhost). Vous pouvez bien sûr le déplacer.
</p>

<pre caption="/etc/apache2/conf/apache2.conf">
# Do NOT add a slash at the end of the directory path.
# Attention: pas de / à la fin du chemin.
#
DocumentRoot "/var/www/localhost/htdocs" <comment>(Indiquez un autre emplacement si vous voulez.)</comment>
</pre>

<pre caption="Lancer Apache au démarrage de la machine">
# <i>rc-update add apache default</i>
 * apache added to runlevel default...
 * Caching service dependencies...               [ ok ]
 * rc-update complete.
# <i>nano -w /etc/conf.d/apache2</i>
</pre>

<p>
Utilisez <c>rc-update</c> pour ajouter Apache au niveau d'exécution par défaut 
et éditez ensuite <path>/etc/conf.d/apache2</path> pour ajouter les options 
suivantes pour qu'Apache charge automatiquement les modules SSL et PHP au 
démarrage.
</p>

<pre caption="/etc/conf.d/apache2">
APACHE2_OPTS="-D SSL -D PHP4"
</pre>

<pre caption="Redémarrer Apache">
# <i>/etc/init.d/apache2 start</i>
 * Starting Apache...                            [ OK ]
# <i>links localhost</i>
</pre>

<p>
Pour vérifier si votre serveur Web fonctionne, connectez-vous avec n'importe
quel navigateur sur l'adresse localhost. Pour vous assurer que le support SSL
est activé, connectez-vous sur <uri>https://localhost</uri>.
Le préfixe <c>https</c> indique au navigateur qu'il doit utiliser une connexion
<e>sécurisée</e> par SSL. Les navigateurs graphiques affichent généralement un
cadenas quelque part pour indiquer qu'une connexion sécurisée est en cours.
</p>

<note>
Lorsque vous établirez une connexion sécurisée vers votre serveur, vous
recevrez sans doute un avertissement indiquant que le certificat du site n'est
pas reconnu. Le module ssl installe un certificat auto-signé qui devrait
uniquement servir de test. Un certificat auto-signé est amplement suffisant
pour une utilisation personnelle.
</note>

<p>
Vérifions que PHP fonctionne. Le plus simple est de sauver un fichier PHP à la
racine des documents de votre serveur Apache.
</p>

<pre caption="Tester PHP">
# <i>nano -w /var/www/localhost/htdocs/test.php</i>
&lt;?php phpinfo(); ?&gt;
# <i>links http://localhost/test.php</i>
</pre>

<pre caption="Une configuration Apache + PHP qui fonctionne">
phpinfo() (p1 of 26)
PHP Logo

PHP Version 4.0.6

System Linux my.server.edu 2.4.10 #1 Tue Oct 9 16:33:50 Local
time zone must be set--see zic manuali686 i686 unknown
Build Date Oct 16 2001
</pre>

<p>
Si vous voyez une page dont le début ressemble au texte ci-dessus, cela veut
dire qu'Apache a correctement interprété le code PHP.
</p>

<warn>
Si vous lisez l'ensemble du texte affiché par <path>test.php</path>, vous remarquerez qu'il
donne <e>énormément</e> d'informations sur votre système. Vous devriez vous en débarasser
une fois que vous avez vérifié que PHP fonctionne. (Ou alors le renommer avec&nbsp;: <c>mv 
test.php test.phps</c>. De cette façon, Apache affichera le code source de <path>test.phps</path> au lieu d'éxécuter le script.)
</warn>

</body>
</section>

<section>
<title>«&nbsp;Courier-IMAP&nbsp;»</title>
<body>

<p>
Squirrelmail est une application PHP qui utilise un serveur IMAP pour faire le
lien entre le serveur Web et votre courrier électronique. Etant donné que 
Gentoo Linux utilise le format Maildir par défaut, 
«&nbsp;Courier-IMAP&nbsp;» est un bon 
choix.
</p>

<pre caption="Installer et tester Courier-IMAP">
# <i>emerge courier-imap</i>
# <i>rc-update add courier-imapd default</i>
 * courier-imapd added to runlevel default...
 * Caching service dependencies...                        [ ok ]
 * rc-update complete.
# <i>nano -w /etc/courier-imap/authdaemonrc</i>
# <i>/etc/init.d/courier-imapd start</i>
# <i>telnet localhost 143</i>
Trying 127.0.0.1...
Connected to localhost.localdomain.
Escape character is '^]'.
 * OK Courier-IMAP ready. Copyright 1998-2001 Double Precision, Inc.
See COPYING for distribution information.
1 LOGIN grant passwd <comment>(&lt;-- Remplacez «&nbsp;grant&nbsp;» par votre nom d'utilisateur
et «&nbsp;passwd&nbsp;» par votre mot de passe.)</comment>
1 OK LOGIN OK
<comment>(Tapez &lt;Ctrl&gt;+] et «&nbsp;quit&nbsp;» pour quitter.)</comment>
</pre>

<pre caption="Autorisation valide dans le fichier /etc/courier-imap/authdaemonrc">
##NAME: authmodulelist:0
#
# The authentication modules that are linked into authdaemond.  The
# default list is installed.  You may selectively disable modules simply
# by removing them from the following list.  The available modules you
# can use are: authcustom authcram authuserdb authpam

#authmodulelist="authcustom authcram authuserdb authpam"
authmodulelist="authpam"
</pre>

<impo>
«&nbsp;Courier-IMAP&nbsp;» sauve généralement le nom du Maildir utilisé en dur dans son
script de démarrage <path>/usr/lib/courier-imap/imapd.rc</path> comme ceci&nbsp;: 
<path>$HOME/Maildir</path>. Cependant, comme Gentoo linux utilise plutôt
$HOME/.maildir. ebuild modifie le script <path>imapd.rc</path> pour qu'il
utilise <e>$MAILDIR</e>, qui est défini dans le script d'initialisation
<path>/etc/init.d/courier-imap</path>. Si vous choisissez d'utiliser une boîte
différente de <path>.maildir</path>, vous devez modifier la ligne
<e>MAILDIR=.maildir</e> dans le script d'initialisation de courier-imap.
</impo>

<p>
Si vous voulez que «&nbsp;Courier-IMAP&nbsp;» supporte SSL, il vous suffit de créer un 
certificat SSL pour IMAP, d'indiquer à «&nbsp;Courier-IMAP&nbsp;» où le trouver,
</p>

<pre caption="Créer un certificat SSL pour IMAP">
# <i>/usr/sbin/mkimapdcert</i>
</pre>

<p>
et de démarrer IMAP SSL.
</p>

<pre caption="Ajouter Courier-IMAP aux scripts d'initialisation">
# <i>rc-update add courier-imapd-ssl default</i>
# <i>/etc/init.d/courier-imapd-ssl start</i>
</pre>

<p>
Vous pouvez vérifier que votre serveur fonctionne
avec un client qui utilise IMAP et SSL tel que netscape, kmail ou mutt.
</p>

<pre caption="Tester votre serveur IMAP">
# <i>mutt -f imap://localhost</i>
</pre>

<pre caption="Tester votre serveur IMAP avec SSL">
# <i>mutt -f imaps://localhost</i>
</pre>
</body>
</section>

<section>
<title>Squirrelmail</title>
<body>

<p>
L'installation et la configuration de Squirrelmail sont un jeu d'enfant une
fois que vous avez installé tous les composants nécessaires.
</p>

<pre caption="Installer Squirrelmail">
# <i>emerge squirrelmail</i>
# <i>cd /var/www/localhost/htdocs</i>
# <i>cd squirrelmail</i>
# <i>./configure</i>
</pre>

<note>
Si votre variable Apache DocumentRoot n'est pas
<path>/var/www/localhost/htdocs</path>, vous devez modifier l'ebuild
<path>net-mail/squirrelmail</path> pour indiquer le répertoire que vous
utilisez.
</note>

<p>
Squirrelmail impose que tous les fichiers appartiennent à l'utilisateur sous
lequel tourne le démon Apache (l'ebuild de squirrelmail définit «&nbsp;apache&nbsp;» comme
utilisateur par défaut). Utilisez <c>./configure</c> et sélectionnez l'option
<e>2</e>.
</p>

<pre caption="Configuration de Squirrelmail - Les paramètres du serveur">
SquirrelMail Configuration : Read: config.php
---------------------------------------------------------
Server Settings
1.  Domain               : my.server.edu
2.  IMAP Server          : localhost
3.  IMAP Port            : 143
4.  Use Sendmail/SMTP    : SMTP
6.    SMTP Server        : localhost
7.    SMTP Port          : 25
8.    Authenticated SMTP : false
9.  Server               : courier
10. Invert Time          : false
11. Delimiter            : detect

R   Return to Main Menu
C.  Turn color off
S   Save data
Q   Quit

Command >>
</pre>

<p>
Assurez-vous que la directive <e>9.  Server</e> indique <e>courier</e>.
Retournez ensuite au menu principal et sélectionnez <e>4</e>, options générales.
</p>

<pre caption="Configuration Squirrelmail - Les options générales">
SquirrelMail Configuration : Read: config.php
---------------------------------------------------------
General Options
1.  Default Charset        : iso-8859-1
2.  Data Directory         : ../data/
3.  Attachment Directory   : /tmp/
4.  Default Left Size      : 150
5.  Usernames in Lowercase : false

R   Return to Main Menu
C.  Turn color off
S   Save data
Q   Quit

Command >>
</pre>

<p>
J'utilise le répertoire de données par défaut bien qu'il soit
plus sûr d'utiliser un répertoire en dehors d'apache. J'utilise également
<path>/tmp</path> comme répertoire pour stocker les pièces jointes.
</p>

<p>
Redémarrez Apache et vous êtes prêt&nbsp;!
</p>

<pre caption="Redémarrer Apache">
# <i>/etc/init.d/apache2 restart</i>
</pre>

<p>
Avec votre navigateur, ouvrez la page d'accueil
<uri>https://localhost/squirrelmail/src/login.php</uri>.
</p>

<pre caption="Tester Squirrelmail">
# <i>links https://localhost/squirrelmail/</i>
</pre>

<pre caption="Page d'accueil de Squirrelmail">
SquirrelMail - Login
[sm_logo.jpg]

SquirrelMail version 1.2.0 [rc2]
By the SquirrelMail Development Team

SquirrelMail Login

Name: ____________________
Password: ____________________

Login
</pre>

<p>
Je ne vous conseille pas d'utiliser links pour vous connecter à Squirrelmail
mais rien ne vous en empêche&nbsp;!
</p>

</body>
</section>
</chapter>

<chapter>
<title>Gestionnaire d'informations personnelles (PIM)</title>

<section>
<title>Evolution avec support pour Palm</title>
<body>

<p>
Evolution est un merveilleux outil de gestion d'informations personnelles
qui peut se synchroniser avec votre Palm Pilot. Commencez par installer
Evolution. Si vous comptez utiliser un assistant personnel Palm Pilot, ajoutez
«&nbsp;pda&nbsp;» dans les options de la variable USE dans le fichier
<path>/etc/make.conf</path> avant de l'installer.
</p>

<pre caption="Installer Evolution">
# <i>emerge --pretend evolution</i>
# <i>emerge evolution</i>
</pre>

<p>
Evolution est malheureusement long à compiler (notez qu'il dépend de
<c>mozilla</c>)&nbsp;; vous pouvez abuser de café ou de thé en attendant la fin de la
compilation.
</p>

<p>
La compilation d'<c>Evolution</c> devrait installer les outils nécessaires pour
votre assistant.  Pour vous assurer qu'un utilisateur normal peut synchroniser
son Palm Pilot, vous devez modifier quelques permissions sur le port série. Je
suppose que votre Palm se connecte sur le premier port série (/dev/ttyS0 ou
/dev/tts/0 avec «&nbsp;devfs&nbsp;»).
</p>

<pre caption="Ajout d'un périphérique série">
# <i>groupadd serial</i>
# <i>chown root:serial /dev/tts/0</i>
# <i>chmod g+rw /dev/tts/0</i>
# <i>ls -l /dev/tts/0</i>
crw-rw----    1 root     serial     4,  64 Dec 31  1969 /dev/tts/0
# <i>ln -s /dev/tts/0 /dev/pilot</i>
# <i>nano -w /etc/group</i> <comment>(Ajoutez les utilisateurs nécessaires au groupe serial.)</comment>
</pre>

<p>
Nous venons d'ajouter un groupe «&nbsp;serial&nbsp;» au système et vous pouvez y ajouter
tous les utilisateurs qui ont besoin du port série. Nous avons attribué les
permissions «&nbsp;rw&nbsp;» (lecture et écriture) au groupe serial sur le périphérique
<path>/dev/tts/0</path> et créé un lien symbolique <path>/dev/pilot</path> qui
pointe vers <path>/dev/tts/0</path>. Comme mentionné précédemment, grâce aux
récents changements de devfs, ce lien symbolique reste en place après un
redémarrage.
</p>

<note>
Les utilisateurs de la version pre-rc6-r13 peuvent soit mettre à jour
<path>sys-apps/baselayout</path> et <path>sys-apps/devfsd</path> (et ensuite
accepter les modifications apportées aux fichiers «&nbsp;._cfg*&nbsp;» dans le répertoire
<path>/etc</path>), soit changer les permissions et le lien symbolique dans le
fichier <path>/etc/devfsd.conf</path>.
</note>

<p>
Les utilisateurs peuvent sélectionner <path>tools/Pilot settings</path> dans les
options d'Evolution pour paramétrer le pilote Gnome pour Palm Pilot.
N'oubliez pas de paramétrer «&nbsp;Pilot Conduits&nbsp;» en plus de «&nbsp;Pilot
Link&nbsp;» dans le panneau de configuration de Gnome.
</p>

</body>
</section>
</chapter>
</guide>

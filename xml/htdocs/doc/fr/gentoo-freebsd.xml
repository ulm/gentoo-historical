<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/gentoo-freebsd.xml,v 1.9 2006/04/28 21:01:04 cam Exp $ -->

<guide link="/doc/fr/gentoo-freebsd.xml" lang="fr">
<title>Petit guide de Gentoo/FreeBSD</title>

<author title="Auteur">
  <mail link="ignacio.arquelatour@gmail.com">Ignacio Arque-Latour</mail>
</author>
<author title="Auteur">
  <mail link="citizen428@gentoo.org">Michael Kohl</mail>
</author>
<author title="Auteur">
  <mail link="angusyoung@gentoo.org">Otavio R. Piske</mail>
</author>
<author title="Auteur">
  <mail link="ka0ttic@gentoo.org">Aaron Walker</mail>
</author>
<author title="Traducteur">
  <mail link="cam@gentoo.org">Camille Huot</mail>
</author>

<abstract>
Ce guide donne des informations générales à propos de FreeBSD et des
instructions concernant l'installation de Gentoo/FreeBSD. Des références sont
également incluses pour les personnes qui voudraient soutenir son développement.
</abstract>

<!-- Le contenu de ce document est sous licence CC-BY-SA. -->
<!-- Voir http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://createivecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>2.3</version>
<date>2006-03-24</date>

<chapter>
<title>Introduction à FreeBSD</title>
<section>
<title>Qu'est-ce que FreeBSD ?</title>
<body>

<p>
<uri link="http://www.freebsd.org/">FreeBSD</uri> est un système d'exploitation
libre (voir la <uri
link="http://www.freebsd.org/copyright/freebsd-license.html">licence</uri>) basé
sur UNIX. Lorsque le développement du système <uri
link="http://www.386bsd.org/">386BSD</uri> s'est arrêté, en 1993, deux projets
en sont nés&nbsp;: <uri link="http://www.netbsd.org/">NetBSD</uri>, très connu
pour sa faculté de pouvoir fonctionner sur un nombre impressionnant
d'architectures, et FreeBSD, qui supporte les architectures x86, amd64, ia64,
sparc64 et alpha. FreeBSD est réputé pour sa stabilité, ses performances et sa
sécurité, ce qui en fait un système utilisé dans de petites comme de très
grandes entreprises de par le monde. La version de production actuelle de
FreeBSD est la 6.0, qui est la fondation du projet Gentoo/FreeBSD. La branche
5.x est toujours supportée par le projet FreeBSD mais plus par les développeurs
Gentoo/FreeBSD.
</p>

</body>
</section>
<section>
<title>Qu'est-ce que Gentoo/FreeBSD&nbsp;?</title>
<body>

<p>
Gentoo/FreeBSD est le résultat d'une volonté de fournir un système
d'exploitation FreeBSD complètement fonctionnel qui bénéficierait des outils
Gentoo. Le but à long terme du projet Gentoo/BSD est de permettre à
l'utilisateur de choisir entre n'importe quelle combinaison de noyaux *BSD ou
Linux, de libc *BSD ou GNU et d'outils systèmes *BSD ou GNU.
</p>

</body>
</section>
<section>
<title>FreeBSD et Linux</title>
<body>

<p>
Les utilisateurs qui migrent de Linux à FreeBSD considèrent en général que les
deux systèmes d'exploitation sont «&nbsp;pratiquement les mêmes&nbsp;». En
réalité, FreeBSD possède un bon nombre de similitudes avec les distributions
Linux en général. Néanmoins, certaines différences essentielles sont à
souligner&nbsp;:
</p>

<ul>
  <li>
    À la différence de Linux, qui n'est en réalité qu'un noyau, FreeBSD est un
    système d'exploitation complet, constitué d'une bibliothèque C, d'outils
    systèmes et bien plus. Cette approche du développement rend le système dans
    son ensemble bien plus cohérent.
  </li>
  <li>
    Au contraire du noyau Linux, le développement de FreeBSD n'est pas dirigé
    par une seule personne, mais plutôt par un petit groupe appelé la <uri
    link="http://www.freebsd.org/doc/fr/articles/contributors/staff-core.html">Core
    Team</uri>.
  </li>
</ul>

<p>
Au delà de ça, FreeBSD possède également des différences techniques qui le
rendent vraiment à part de Linux. Il est très important d'en connaître
certaines, même si vous ne comptez pas rejoindre l'équipe de développement
Gentoo/FreeBSD&nbsp;:
</p>

<ul>
  <li>
    Pour utiliser des fonctions de liaison dynamique lors de l'exécution comme
    <c>dlopen()</c>, les programmes n'ont pas besoin d'être liés à libdl comme
    sous GNU/Linux. Il sont lié à libc à la place.
  </li>
  <li>
    FreeBSD n'a pas d'outil officiel pour la compilation du noyau. Vous devrez
    donc résoudre les problèmes de dépendances entre les fonctionnalités
    vous-même.
  </li>
  <li>
    FreeBSD utilise le système de fichiers UFS/UFS-2 et ne supporte pas les
    systèmes de fichiers tels que ReiserFS ou XFS. Cependant, il existe des
    projets qui permettent de les supporter en lecture seule. L'accès aux
    partitions ext2/ext3 est d'ores et déjà possible, mais vous ne pourrez pas y
    installer votre système.
  </li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Installer Gentoo/FreeBSD</title>
<section>
<title>Instructions d'installation</title>
<body>

<p>
Après cette courte introduction, il est enfin l'heure d'installer
Gentoo/FreeBSD. Malheureusement, nous n'avons pas actuellement de media
d'installation, vous devez donc choisir entre deux méthodes alternatives
d'installation. La première serait d'utiliser une installation existante de
FreeBSD pour partitionner votre disque et l'utiliser comme base afin d'y
installer Gentoo/FreeBSD. La seconde serait d'utiliser l'excellent <uri
link="http://www.freesbie.org/">LiveCD FreeSBIE</uri> comme un media
d'installation pour Gentoo/FreeBSD.
</p>

<note>
Si vous comptez utiliser FreeSBIE pour installer Gentoo/FreeBSD, vous devez
impérativement avoir une version de FreeSBIE basée sur FreeBSD 6.0&nbsp;! Les
versions expérimentales se trouvent sur le <uri
link="http://torrent.freesbie.org/">tracker Bittorrent de FreeSBIE</uri>&nbsp;;
la version 20060118 a été testée avec ce document.
</note>

<p>
Avant de pouvoir commencer l'installation, vous devez configurer un disque dur
qui sera utilisé par Gentoo/FreeBSD. Vous pouvez utiliser <c>sysinstall</c>
(disponible dans l'installation de base de FreeBSD ainsi que dans un système
FreeSBIE) ou utiliser les commandes <c>fdisk</c>, <c>disklabel</c> et
<c>newfs</c> à la main. Si vous n'avez jamais mis en place de système FreeBSD
auparavant, nous vous conseillons d'utiliser <c>sysinstall</c>. Dans ce cas,
n'utilisez pas le sysinstall lancé par l'installation de FreeBSD ou FreeSBIE,
mais utilisez plutôt la commande suivante&nbsp;:
</p>

<pre caption="Partitionner avec sysinstall">
# <i>sysinstall diskPartitionEditor diskPartitionWrite diskLabelEditor diskLabelCommit</i>
</pre>

<p>
Si vous éprouvez des difficultés lors du partitionnement ou du formattage de
votre disque dur, jetez un œil à l'excellent <uri
link="http://www.freebsd.org/doc/fr/books/handbook/">Manuel FreeBSD</uri> ou
connectez-vous au canal IRC <c>#gentoo-bsd</c> du serveur Freenode.
</p>

<p>
Une fois que votre disque est prêt, vous devez créer les points de montage de
votre installation Gentoo/FreeBSD et monter les partitions concernées.
</p>

<pre caption="Créer un point de montage et monter une partition">
# <i>mkdir /mnt/gentoo</i>
<comment>(Remplacez les X avec les bonnes valeurs correspondant à votre disque.)</comment>
# <i>mount /dev/adXsXa /mnt/gentoo</i>
</pre>

<p>
Si vous utilisez le LiveCD FreeSBIE et si votre disque dur possède déjà une
partition UFS, celle-ci a été montée en lecture seule sur
<path>/mnt/ufs.1</path>. Si vous avez besoin d'écrire dans cette partition
pendant l'installation, vous devez la remonter en écriture&nbsp;:
</p>

<pre caption="Remonter une partition en écriture">
# <i>mount -u -o rw /mnt/ufs.1</i>
</pre>

<p>
Maintenant que la partition est montée, on peut récupérer et décompresser
l'archive stage3.
</p>

<pre caption="Obtenir et extraire l'archive stage3">
# <i>cd /mnt/gentoo/</i>
<comment>(N'importe quel miroir Gentoo qui contient le répertoire experimental/ fera l'affaire.)</comment>
# <i>wget http://gentoo.osuosl.org/experimental/x86/freebsd/stages/gentoo-freebsd-6.0-stage-20060221.tar.bz2</i>
# <i>tar -jxvpf gentoo-freebsd-6.0-stage-20060221.tar.bz2</i>
<comment>(Vous pouvez éventuellement effacer l'archive avec la commande suivante.)</comment>
# <i>rm gentoo-freebsd-6.0-stage-20060221.tar.bz2</i>
</pre>

<p>
Avant de nous chrooter à l'intérieur du stage que nous venons d'extraire, il
faut que vous récupériez une copie à jour de la surcouche Gentoo/FreeBSD. La
méthode la plus facile est de décompresser notre dernier instantané directement
dans <path>/mnt/gentoo/usr/local/portage</path>.
</p>

<pre caption="Récupérer la surcouche de Portage pour Gentoo/FreeBSD">
# <i>cd /mnt/gentoo/usr/local/portage</i>
# <i>wget http://gentoo.osuosl.org/experimental/snapshots/portage-alt-overlay-latest.tar.bz2</i>
# <i>tar -xjf portage-alt-overlay-latest.tar.bz2</i>
# <i>rm portage-alt-overlay-latest.tar.bz2</i>
</pre>

<p>
Une autre méthode serait d'utiliser Subversion pour récupérer la version
actuelle de la surcouche. Si cette possibilité vous intéresse, veuillez vous
diriger vers la documentation de <uri
link="/proj/en/gentoo-alt/contribute/index.xml?part=1&amp;chap=3">Gentoo/Alt</uri>.
</p>

<p>
Afin que votre nouveau système puisse fonctionner, vous devez monter
<path>/dev</path> à partir de celui du système actuel vers le point de montage
du Gentoo/FreeBSD avant de lancer le chroot.
</p>

<pre caption="Monter /dev et chrooter">
# <i>mount -t devfs none /mnt/gentoo/dev/</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/etc</i>
# <i>chroot /mnt/gentoo/ /bin/bash</i>
# <i>source /etc/profile</i>
</pre>

<p>
Une fois la surcouche Gentoo/FreeBSD à sa place, il est maintenant temps de lier
<path>/etc/make.profile</path> au bon profil et préparer
<path>/etc/make.conf</path> à fonctionner avec Gentoo/FreeBSD.
</p>

<pre caption="Mettre en place le profil et make.conf">
# <i>ln -sf /usr/local/portage/portage-alt-overlay/profiles/default-bsd/fbsd/6.0/x86/ /etc/make.profile</i>
<comment>(L'éditeur standard de FreeBSD est ee, que nous utilisons pour modifier /etc/make.conf.)</comment>
# <i>ee /etc/make.conf</i>
<comment>(Ajoutez au moins les lignes suivantes :)</comment>
CHOST="i686-gentoo-freebsd6.0"
ACCEPT_KEYWORDS="~x86-fbsd ~x86"
FEATURES="-sandbox collision-protect"
PORTDIR_OVERLAY="/usr/local/portage/portage-alt-overlay"
</pre>

<p>
Afin de pouvoir démarrer correctement, vous devez créer le répertoire
<path>/proc</path>.
</p>

<pre caption="Créer le répertoire /proc">
# <i>mkdir /proc</i>
</pre>

<p>
Maintenant, il faut télécharger une copie de l'arbre principal de Portage. Cela
peut prendre un bon moment selon votre connexion.
</p>

<pre caption="Télécharger l'arbre de Portage">
# <i>emerge --sync</i>
<comment>(Il est également possible de récupérer l'arbre de Portage d'une autre façon :)</comment>
# <i>cd /</i>
# <i>wget http://gentoo.osuosl.org/snapshots/portage-latest.tar.bz2</i>
# <i>tar -xjf portage-latest.tar.bz2 -C /usr/</i>
# <i>emerge --metadata</i>
</pre>

<p>
Si vous le voulez, vous pouvez maintenant reconstruire les paquets systèmes.
</p>

<pre caption="Reconstruire les paquets systèmes de FreeBSD (facultatif)">
# <i>emerge -e system</i>
</pre>

<p>
Quand vous faites <c>emerge -e system</c>, les sources du noyau de FreeBSD sont
installées dans le répertoire <path>/usr/src/sys</path>. Si vous avez sauté
cette étape, vous pouvez tout de même obtenir les sources de cette façon&nbsp;:
</p>

<pre caption="Obtenir les sources du noyau de FreeBSD">
# <i>emerge freebsd-sources</i>
</pre>

<p>
La configuration et la compilation d'un noyau personnalisé se passent vraiment
différemment d'avec Linux. Si vous n'êtes pas familier avec cette procédure,
nous vous recommandons de jeter un œil au <uri
link="http://www.freebsd.org/doc/fr/books/handbook/kernelconfig.html">chapitre 8
du manuel FreeBSD</uri>.
</p>

<p>
Veuillez noter qu'actuellement seule la manière «&nbsp;traditionnelle&nbsp;» de
compiler le noyau est supportée dans Gentoo/FreeBSD. Notez aussi qu'un <c>make
install</c> vous demandera certainement un fichier
<path>/boot/device.hints</path>. Vous trouverez une version par défaut de ce
fichier dans le sous-répertoire <path>conf</path> de la configuration
<c>GENERIC</c> sous le nom de <path>GENERIC.hints</path>.
</p>

<note>
Lors de la compilation du noyau, vous devez utiliser la commande «&nbsp;make
WERROR=NO_WERROR&nbsp;» car les développeurs Gentoo/FreeBSD n'ont pas encore pu
corriger tous les avertissements -Werror and la version de GCC n'acceptent pas
les extensions à la fonction printf() de FreeBSD.
</note>

<p>
Nous pouvons maintenant procéder à quelques configurations et réglages de base
du système. Premièrement, nous allons définir les points de montage des systèmes
de fichiers dans le fichier <path>/etc/fstab</path>.
</p>

<pre caption="Éditer le système de fichiers dans /etc/fstab">
# <i>ee /etc/fstab</i>
<comment>(Dans cet exemple, remplacez X et Y par les chiffres correspondants à ceux de
votre disque dur.)</comment>
#Device         Mountpoint      Fstype          Options         Dump    Pass
/dev/adXsYb     none            swap            sw              0       0
/dev/adXsYa     /               ufs             rw              1       1
/dev/adXsYe     /usr/home       ufs             rw              2       2
/dev/adXsYd     /tmp            ufs             rw              2       2
/dev/acdX       /cdrom          cd9660          ro,noauto       0       0
</pre>

<p>
Nous pouvons maintenant passer à la configuration du réseau avant le redémarrage
final.
</p>

<pre caption="Configurer le réseau">
# <i>ee /etc/conf.d/net</i>
<comment>(Veuillez adapter cet exemple à votre réseau.)</comment>
ifconfig_rl0=("192.168.0.10 netmask 255.255.255.0 broadcast 192.168.0.255")
routes_rl0=("-net 0.0.0.0 -host 192.168.0.1")
</pre>

<p>
Pour que le réseau soit activé au démarrage, il faut l'ajouter au niveau
d'exécution par défaut&nbsp;:
</p>

<pre caption="Ajouter le réseau au niveau d'exécution par défaut">
# <i>rc-update add net.rl0 default</i>
</pre>

<p>
Pour changer votre nom de machine, vous devez éditer le fichier
<path>/etc/hostname</path>.
</p>

<pre caption="Modifier le nom de la machine">
# <i>echo "LE_NOM_DE_LA_MACHINE" > /etc/hostname</i>
</pre>

<p>
Au cas où vous devriez utiliser une autre configuration de clavier que celle par
défaut pour votre langue, vous devez mettre la bonne valeur dans le fichier
<path>/etc/conf.d/syscons</path>. L'exemple suivant installe la disposition de
touches utilisée généralement en France, adaptez si vous utiliser une autre
disposition de touches.
</p>

<pre caption="Changer la disposition de touches du clavier (facultatif)">
# <i>ee /etc/conf.d/syscons</i>
KEYMAP="fr.iso.acc"
<comment>(Les fichiers de dispositions se trouvent dans /usr/share/syscons/keymaps/.)</comment>
</pre>

<impo>
Veuillez vous assurer parfaitement que votre nouveau système Gentoo/FreeBSD fait
partie de la configuration de votre chargeur de démarrage, car sinon vous ne
pourrez pas le démarrer&nbsp;! Si vous n'avez pas d'autre chargeur de démarrage
installé, vous devrez utiliser <c>boot0</c> car c'est le seul actuellement
supporté par FreeBSD. Dans ce cas, n'oubliez pas de configurer vos autres
systèmes d'exploitation pour pouvoir passer le relai à <c>boot0</c>.
</impo>

<pre caption="Installer et paramétrer boot0">
# <i>emerge boot0</i>
<comment>(Quittez l'environnement chroot.)</comment>
# <i>exit</i>
<comment>(À lancer à l'extérieur du chroot.)</comment>
# <i>fdisk -B -b /mnt/gentoo/boot/boot0 /dev/adX</i>
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>disklabel -B adXsY</i>
</pre>

<p>
Si vous avez besoin de plus d'informations pour mettre en place <c>boot0</c>,
veuillez consulter le <uri
link="http://www.freebsd.org/doc/fr/books/handbook/boot.html">chapitre 12</uri>
du Manuel FreeBSD.
</p>

<p>
Nous pouvons maintenant mettre un mot de passe pour l'utilisateur <c>root</c> et
créer un compte normal pour votre travail quotidien.
</p>

<pre caption="Changer le mot de passe root et créer un nouvel utilisateur">
# <i>passwd</i>
<comment>(Si vous avez besoin d'aide pour ajouter un nouvel utilisateur, veuillez
consulter le manuel de FreeBSD.)</comment>
# <i>adduser</i>
</pre>

<p>
Félicitations, vous venez de finir votre installation de Gentoo/FreeBSD que vous
pourrez commencer à apprécier juste après le redémarrage final. Amusez-vous
bien&nbsp;!
</p>

<pre caption="Redémarrer le système">
# <i>exit</i>
# <i>reboot</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Développer Gentoo/FreeBSD</title>
<section>
<title>Comment nous aider</title>
<body>

<p>
Selon vos capacités et votre temps libre, vous pourrez nous aider sur de
nombreux points.
</p>

<ul>
  <li>
    Contribuer aux ebuilds&nbsp;: c'est-à-dire travailler de manière rapprochée
    avec les autres développeurs pour que nos modifications et nos correctifs
    soient acceptés dans l'arbre officiel.
  </li>
  <li>
    Sécurité&nbsp;: Si vous faites dans la sécurité, nous avons besoin de
    vous&nbsp;! Bien que les annonces de sécurité du projet FreeBSD soient
    suivies et résolues, nous pouvons toujours utiliser des ressources dans
    ce domaine.
  </li>
  <li>
    Contacts&nbsp;: Nous cherchons des personnes qui seraient en relation avec
    les développeurs FreeBSD pour maintenir des contacts entre le projet
    original et nous, pour échanger nos correctifs et pour discuter à propos de
    problèmes divers et de leurs solutions.
  </li>
  <li>
    Tester&nbsp;: Plus il y a de personnes qui utilisent Gentoo/FreeBSD, plus on
    pourra découvrir des bogues et les résoudre. Si vous êtes doué pour décrire
    les bogues ou les problèmes, nous voulons absolument vous entendre.
  </li>
  <li>
    Les autres domaines où nous cherchons de l'aide sont notamment&nbsp;: les
    ebuils systèmes, le baselayout, la création de CD-ROM d'installation, la
    documentation et la programmation du noyau.
  </li>
</ul>

</body>
</section>
<section>
<title>Problèmes connus</title>
<body>

<p>
À l'heure actuelle, de nombreux problèmes sont connus. Voici les
principaux&nbsp;:
</p>

<ul>
  <li>
    Certains scripts d'initialisation dépendent du service clock que nous ne
    fournissons pas à l'heure actuelle. Vous pouvez simplement le retirer des
    dépendances du script et le reporter sur notre <uri
    link="http://bugs.gentoo.org/">bugzilla</uri>. N'oubliez pas de choisir le
    produit «&nbsp;Gentoo BSD&nbsp;» pour soumettre le bogue.
  </li>
  <li>
    La glib et GNOME en général ont besoin d'un grand nombre de corrections
    avoir de pouvoir fonctionner.
  </li>
  <li>
    Le système d'init actuellement présent dans le paquet baselayout de
    Gentoo/FreeBSD n'est pas à jour par rapport à la version utilisée par
    Gentoo Linux&nbsp;; il lui manque certaines de ses fonctionnalités. Nous
    travaillons pour que les versions récentes fonctionnent.
  </li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Contacts</title>
<section>
<body>

<p>
La liste des développeurs Gentoo/FreeBSD se trouve sur la <uri
link="/proj/en/gentoo-alt/bsd/fbsd/">page du projet</uri>. Vous pouvez
également les contacter sur le canal IRC <c>#gentoo-bsd</c> sur le réseau
Freenode ainsi que par mail sur la liste de diffusion <uri
link="/main/en/lists.xml">gentoo-bsd</uri>.
</p>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<?xml-stylesheet href="/xsl/guide.xsl" type="text/xsl"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/new-upgrade-to-gentoo-1.4.xml">

<title>Guide de mise à jour Gentoo 1.4</title>

	<author title = "Auteur">
<mail link = "rac@gentoo.org">Robert Coie</mail>
</author>

	<author title = "Editeur">
<mail link = "avenj@gentoo.org">Jon Portnoy</mail>
</author>

	<author title = "Traducteur">
<mail link = "ksi@tuxfamily.org">ksi</mail>
</author>

	<version>0.1</version>
	<date>3 Mars 2003</date>

	<abstract>Une méthode pour mettre à jour les anciennes installations de Gentoo à la Gentoo 1.4</abstract>

	<chapter>
		<title>Avant de commencer</title>
		<section>
			<title>Préparez-vous</title>
			<body>
				<p>Comme avec n'importe quelle mise à jour principale 
				du système, il y a toujours le risque que des problèmes 
				imprévus surviennent. Il est donc plus prudent de faire 
				une sauvegarde de toutes les données importantes que vous
				avez avant de commencer. Si possible, essayez de trouver 
				un maximum de temps pour faire cette mise jour puisque 
				d'une part vous ne serez pas précipité mais aussi parce que 
				tous les programmes de votre système vont devoir être 
				recompiler.</p>
			</body>
		</section>
		<section>
			<title>Autre option</title>
			<body>
				<p>Il existe d'autres alternatives pour mettre à jour votre 
				gentoo. Vous pouvez installer un nouveau système 1.4 sur 
				une partition à part puis réutiliser votre configuration à la
				place. La méthode que Robert Coie vous propose a l'avantage 
				de pouvoir revenir à l'ancien système en cas de problème. 
				Vous pouvez aussi tout simplement décider de ne pas mettre 
				à jour votre système.</p>
			</body>
		</section>
		<section>
			<title>Notes générales</title>
			<body>
				<p>À chaque fois que vous allez utiliser la commande 	
				<c>emerge</c>, il est préférable de l'essayer 
				avant avec l' option <c>-p</c> ou <c>--pretend</c> pour 
				être sûr que la commande correspond à ce que vous désirez 
				faire.</p>
			</body>
		</section>
	</chapter>
	<chapter>
		<title>Mise à jour</title>
		<section>
			<title>Obtenez la dernière version de Portage</title>
			<body>
				<p>Certaines syntaxes des ebuilds courants sont illisibles par les anciennes versions de Portage. Si vous n'avez pas la dernière version, mettez là à jour via ces commandes.</p>
				<pre>
# <i>emerge sync</i>
# <i>emerge -u portage</i>
</pre>
				<note>Si votre version de Portage est vraiment ancienne
				vous aurez probablement un message d'erreur contenant 
				« unscriptable object ». Lisez et suivez les instructions dans 
				<path>/usr/portage/sys-apps/portage/files/README.RESCUE</path>.
				</note>
</body></section>

		<section>
			<title>Préparation de GCC pour la cohabitation</title>
			<body>
				<p>Vous allez installer une nouvelle version de GCC durant cette 
				mise à jour. Les versions inférieures à 2.95.3-r8 ne sont pas conçues 
				pour avoir des versions multiples de GCC installées. Ceci aura pour effet 
				bénéfique d'installer le paquet <c>gcc-config</c> sur votre système, 
				qui peut être employé pour commuter des versions installées diverses 
				de GCC.
				</p>

				<pre>
# <i>emerge -u gcc</i>
</pre>

				<p>Vous pouvez maintenant vérifier si gcc-config marche normalement :</p>
				<pre>
# <c>gcc-config --get-current-profile</c>
</pre>
				<p>Ceci devrait retourner i686-pc-linux-gnu-2.95.3 sur la plupart des systèmes x86. Des systèmes plus anciens peuvent retourner i586-pc-linux-gnu-2.95.3.</p>
			</body>
		</section>
		<section>
			<title>Installation de GCC3</title>
			<body>
				<p>Maintenant vous allez pouvoir installer une nouvelle version de GCC
				sans endommager votre compilateur actuel. Regardez dans 
				<path>/usr/portage/sys-devel/gcc</path> pour prendre la dernière 
				version disponible stable. À l'ecriture de ce document, il s'agit de gcc 3.2.2. 
				Pour l'installer, faites :</p>
<pre>
# <i>emerge /usr/portage/sys-devel/gcc/gcc-3.2.2.ebuild</i>
</pre>
			</body>
		</section>
		<section>
			<title>Changement de profils</title>
			<body>
				<p>Il est désormais nécessaire de modifier deux profils, celui de Portage puis de gcc-config :</p>
				<pre>
# <i>cd /etc</i>
# <i>rm make.profile</i>
# <i>ln -s ../usr/portage/profiles/default-x86-1.4 make.profile</i> <codenote>Remplacez "x86" par votre architecture</codenote>
</pre>

				<pre>
# <i>gcc-config --list-profiles</i> <codenote>Notez la version exacte de votre GCC</codenote>
# <i>gcc-config i686-pc-linux-gnu-3.2.2</i> <codenote>Remplacez par la version que vous venez de noter</codenote>
</pre>
			</body>
		</section>
		<section>
			<title>Recompiler la chaîne d'outils</title>
			<body>
				<p>Maintenant vous devez recompiler les principaux outils 
				avec votre nouveau compilateur. Si vous souhaitez continuer 
				dans le même shell, faites <c>source /etc/profile</c> quand 
				gcc-config vous le demande. Ensuite, emerger glibc et binutils :</p>
<pre>
# <i>emerge glibc binutils</i>
</pre>
				<warn>Il est tout à fait probable que vous devrez mettre à jour
				votre version de glibc 2.2 ou plus ancienne à la version 2.3. Ne 
				télécharger pas glibc après. N'importe quel logiciel que vous avez 
				compilé autrement qu'avec glibc 2.3 cessera de fonctionner, et ceci peut 
				rendre votre système inutilisable.</warn>
			</body>
		</section>
		<section>
			<title>Recompilation totale du système</title>
			<body><p>Vous pouvez maintenant recompiler tout votre sytème avec votre nouveau gcc :</p>
<pre>
# <i>emerge -e world</i>
</pre>
				<note>Si cette commande s'arrête à un moment ou à un autre, vous pouvez
				utiliser <c>emerge --resume</c> pour continuer tranquilement là où vous vous êtes 
				arrêté. Ceci exige une version de Portage supérieure ou égale à la 2.0.47.</note>
			</body>
		</section>
	</chapter>
</guide>




<?xml version="1.0" encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/gentoo-x86-install.xml,v 1.23 2003/11/29 10:35:24 neysx Exp $ -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/gentoo-x86-install.xml">
<title>Guide d'installation de Gentoo Linux 1.4</title>
<author title="Concepteur">
     <mail link="drobbins@gentoo.org">Daniel Robbins</mail>
</author>
<author title="Auteur">Chris Houser</author>
<author title="Auteur">Jerry Alexandratos</author>
<author title="Relecteur">
     <mail link="g2boojum@gentoo.org">Grant Goodyear</mail>
</author>
<author title="Correcteur">
     <!--<mail link="zhen@gentoo.org">John P. Davis</mail>-->
     John P. Davis
</author>
<author title="Correcteur">
     <mail link="Pierre-Henri.Jondot@wanadoo.fr">Pierre-Henri Jondot</mail>
</author>
<author title="Correcteur">
     <mail link="stocke2@gentoo.org">Eric Stockbridge</mail>
</author>
<author title="Correcteur">
     <mail link="rajiv@gentoo.org">Rajiv Manglani</mail>
</author>
<author title="Correcteur">
     <mail link="seo@gentoo.org">Jungmin Seo</mail>
</author>
<author title="Correcteur">
     <mail link="zhware@gentoo.org">Stoyan Zhekov</mail>
</author>
<author title="Correcteur">
     <mail link="jhhudso@gentoo.org">Jared Hudson</mail>
</author>
<author title="Correcteur">
     <mail link="">Colin Morey</mail>
</author>
<author title="Correcteur">
     <mail link="peesh@gentoo.org">Jorge Paulo</mail>
</author>
<author title="Correcteur">
     <mail link="carl@gentoo.org">Carl Anderson</mail>
</author>
<author title="Correcteur, relecteur">
     <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Correcteur">
     <mail link="avenj@gentoo.org">Jon Portnoy</mail>
</author>
<author title="Correcteur">
     <mail link="erwin@gentoo.org@gentoo.org">Erwin</mail>
</author>
<author title="Correcteur">
     <mail link="klasikahl@gentoo.org@gentoo.org">Zack Gilburd</mail>
</author>
<author title="relecteur">
     <mail link="gerrynjr@gentoo.org">Gerald J. Normandin Jr.</mail>
</author>
<author title="relecteur">
     <mail link="spyderous@gentoo.org">Donnie Berkholz</mail>
</author>
<author title="relecteur">
     <mail link="antifa@gentoo.org">Ken Nowack</mail>
</author>
<author title="Traducteur">
     <mail link="frlinux@frlinux.net">FRLinux</mail>
</author>
<author title="Traducteur">
     <mail link="neysx@gentoo.org">Xavier Neys</mail>
</author>
<abstract>
Ces instructions ont pour but de vous aider à installer Gentoo Linux 1.4 (à ne pas
confondre avec les versions _rc).
Le processus d'installation supporte plusieurs approches, selon vos besoins et
selon le niveau de customisation que vous désirez.
</abstract>

<license/>

<version>2.6.27</version>
 <date>29 novembre 2003</date>
<chapter>
<title>À propos de l'installation</title>
<section>
<title>Introduction</title>
<body>
<p>Si vous êtes un nouveau venu dans le monde de Gentoo Linux, nous
vous souhaitons la bienvenue ! Gentoo Linux peut être installé de plusieurs façons.
Ceux qui cherchent à faire une installation rapide peuvent utiliser les paquets
pré-compilés, alors que ceux qui recherchent une optimisation complète peuvent compiler
Gentoo Linux à partir de zéro. Le choix de la méthode vous appartient.</p>

<p>Un des changements fondamentaux de cette version 1.4 officielle concerne l'apparition
d'un second CD d'installation que vous pouvez d'ailleurs commander auprès du
<uri link="http://store.gentoo.org">Gentoo Linux Store</uri> si vous ne désirez pas
le télécharger depuis un de nos <uri link="http://www.gentoo.org/main/en/mirrors.xml">
miroirs</uri>. Nous avons actuellement des packs d'installation
de 2 CD pour x86 (486 et supérieur), i686 (Pentium Pro, Pentium II, Athlon/Duron et
supérieur), Pentium III, Pentium 4 et Athlon XP. Afin de déterminer quel pack d'installation
vous correspond, vous pouvez consulter la description détaillée de ceux-ci à cette
<uri link="http://store.gentoo.org">adresse</uri>. Les descriptions contiennent des
informations relativement complètes sur la compatibilité des processeurs.</p>

</body>
 </section>
 <section>
 <title>Les CD-ROM d'installation</title>
 <body>
<p>
Voici donc ce que chacun des CD comprend. Le premier CD ("CD 1") se nomme "Live CD
installation" et est amorçable, vous pouvez donc l'insérer dans votre machine et
démarrer Gentoo Linux depuis celui-ci. Vous pouvez donc utiliser la version de Gentoo
Linux installée sur le CD pour procéder à votre installation. En plus, chaque
CD 1 contient tout ce dont vous avez besoin pour faire une installation rapide de Gentoo
Linux, et ceci même sans connexion à internet. Le CD 1 contient également plusieurs
paquets pré-compilés, comme XFree86, un paquet essentiel. Si vous avez
une image ISO de ce CD, son nom devrait se terminer par "-cd1.iso".</p>

<p>Le second CD ("CD 2") n'est pas amorçable, mais contient bien plus de paquets
pré-compilés pour votre système. Vous trouverez sur ce CD des versions optimisées de
KDE, GNOME, OpenOffice, Mozilla, Evolution et bien plus. Ce second CD est bien entendu
<i>optionnel</i> et devrait servir à ceux désirant installer Gentoo Linux rapidement.
Les paquets inclus sur le CD 2 prennent en moyenne 36 heures à compiler sur un système
uni-processeur moderne. Si vous avez une image ISO de ce second CD, son nom devrait se
terminer par "-cd2.iso".</p>

<note>Un pack complet de 2 CD de Gentoo Linux réprésente la plate-forme de référence, qui
se définit par un système Gentoo Linux entièrement pré-compilé incluant KDE, GNOME,
Mozilla et OpenOffice. La plate-forme de référence Gentoo ("GRP" en anglais) a été créée
pour vous permettre de faire des installations rapides de Gentoo Linux. La fonctionnalité
de "compilation à partir des sources" qui représente la pierre angulaire de Gentoo Linux
sera bien sûr supportée complètement. L'objectif du GRP est de rendre Gentoo Linux
accessible à certains utilisateurs, sans pour autant occulter le processus d'installation
très puissant que représente la compilation à partir des sources.</note>

<p>En plus de ce pack de 2 CD, nous avons également un Live CD de petite taille très
"rudimentaire" que vous pouvez utiliser pour démarrer votre système. Une fois votre
système démarré, vous pouvez configurer une connexion internet et installer Gentoo
à partir du réseau. L'avantage de ce CD "rudimentaire" tient dans sa taille très
réduite, ce qui fait que vous pouvez le télécharger très rapidement. Si vous
êtes un utilisateur expérimenté qui désire installer la dernière version de
Gentoo Linux disponible et que vous possédez une connexion internet rapide, vous serez sans
doute tenté par cette option. Si vous avez une image ISO de ce Live CD rudimentaire
(appellé "basic" en anglais), son nom devrait se terminer par "-basic.iso".</p>

</body>
 </section>
 <section>
 <title>Prérequis</title>
 <body>
<p>Pour installer Gentoo Linux à partir du CD, vous aurez besoin au minimum d'un
processeur 486 avec 64Mo de RAM. Gentoo Linux a été compilé avec succès sur une machine
possédant 64Mo de RAM + 64Mo de swap (fichier d'échange) bien que la compilation soit
horriblement longue dans ces conditions.</p>

</body>
 </section>
 <section>
 <title>Choix de la méthode d'installation</title>
 <body>
<p>Une fois que vous démarrez à partir d'un des Live CD, vous avez encore plus
d'options pour installer Gentoo Linux. Vous pouvez en effet choisir l'étape 1, 2
ou 3. Chacune de ces étapes est contenue dans un fichier compressé sur le CD vous
permettant ainsi de choisir où commencer. Plus vous avancez dans les étapes et moins
vous avez de programmes à compiler. La première étape (<e>stage1</e>) compile le système
à partir de zéro. La deuxième (<e>stage2</e>) sert à compiler le système dans un état
intermédiaire semi-compilé (la base rudimentaire du CD est compilée). La troisième
étape (<e>stage3</e>) contient le système de base pré-compilé et donc ne requiert presque plus
aucune compilation. Si vous désirez faire une installation "GRP", il vous faudra utiliser
le fichier stage3.</p>

<p><b>Si vous n'utilisez pas une installation GRP, devriez-vous commencer depuis
la 1ère, 2ème ou 3ème étape ?</b></p>

<p>Voici quelques précisions qui devraient vous
aider à prendre une décision.</p>

<p>Le fait de démarrer depuis la 1ère étape vous permet d'avoir un contrôle total sur
les paramètres et les optimisations de compilation qui sont disponibles sur votre
système. Cette étape d'installation est donc avant tout destinée aux utilisateurs
expérimentés qui savent ce qu'ils font. Mais elle peut aussi permettre à un débutant
de mieux comprendre le fonctionnement interne de Gentoo Linux.</p>

<p>La 2ème étape (stage2) vous permet de passer la partie d'installation de base, ce
qui ne devrait pas vous poser de cas de conscience si vous êtes statisfait des optimisations
que nous avons choisies pour vous (qui pour être honnête sont de bonnes optimisations
censées accélerer le système sans perte de stabilité). Etant donné que toutes les
versions majeures de Gentoo Linux ont une archive compressée de la troisième étape
(stage3) optimisée pour la plupart des processeurs disponibles, le fait d'utiliser cette
archive peut représenter la meilleure solution pour avoir une installation rapide et
un système bien optimisé.</p>

<b>Si vous installez Gentoo Linux pour la première fois, vous devriez envisager d'utiliser la troisième
étape ou bien GRP.</b>

<note><b>Pour les utilisateurs expérimentés : </b> Si vous démarrez à partir de la
troisième étape, ne modifiez pas la variable
CHOST dans votre fichier <path>/etc/make.conf</path>. 
Si vous devez modifier la variable CHOST, alors vous devez commencer à l'étape 1 et
construire votre système avec la valeur désirée. La variable CHOST contient
une valeur qui ressemble à <i>i686-pc-linux-gnu</i>.
</note>

<impo>Si vous rencontrez un problème à n'importe quel moment de l'installation
et désirez le signaler, utilisez pour ceci <uri>http://bugs.gentoo.org</uri>.
Si le bug doit être envoyé aux développeurs maintenant le programme (p.ex. l'équipe de KDE),
les <e>développeurs Gentoo Linux</e> le feront pour vous.</impo>

<note>Un autre point : les instructions d'installation présentes sur le Live CD peuvent ne
pas être à jour comparées à celles présentes sur notre site internet à cette adresse :
<uri>http://www.gentoo.org/doc/fr/gentoo-x86-install.xml</uri>. Consultez celle disponible sur
le site internet afin d'avoir la version la plus à jour.
</note>

</body>
 </section>
 <section>
 <title>La procédure d'installation</title>
 <body>
<p>Parcourons à présent le processus d'installation. Nous commençons donc par télécharger,
graver un (ou plusieurs) CD et démarrer sur un Live CD. Après avoir obtenu le prompt
super-utilisateur, nous créerons des partitions, les systèmes de fichiers et décompacterons
l'archive de l'étape sélectionnée. Selon l'étape, il sera nécessaire de faire
quelques manipulations en plus ou en moins. Une fois que le système est passé à l'étape 3, nous
pouvons alors finir la configuration (paramétrisation des fichiers de configuration, installation
du programme de démarrage,...), le démarrer et obtenir un système Gentoo Linux complètement
fonctionnel. Après avoir fini cette étape, il vous sera possible d'utiliser le "CD 2" et
installer tous les paquets que vous voulez comprenant KDE, GNOME, OpenOffice, Mozilla et bien d'autres.
</p>

<p>Selon l'étape sélectionnée, voici ce qui est nécessaire à l'installation : </p>
<table>
<tr>
<th>Archive de l'étape (stage)</th>
<th>Accès internet nécessaire</th>
<th>CD nécessaire</th>
<th>Etapes</th>
</tr>
<tr>
<ti>1</ti>
<ti>Oui</ti>
<ti>"basic" ou "CD 1"</ti>
<ti>configuration des partitions/systèmes de fichiers, emerge sync, bootstrap, emerge
system, configuration finale</ti>
</tr>
<tr>
<ti>2</ti>
<ti>Oui</ti>
<ti>"basic" ou "CD 1"</ti>
<ti>configuration des partitions/systèmes de fichiers, emerge sync, emerge
system, configuration finale</ti>
</tr>
<tr>
<ti>3</ti>
<ti>Oui sauf si on utilise le "CD 1"</ti>
<ti>"basic" or "CD 1"</ti>
<ti>configuration des partitions/systèmes de fichiers, emerge sync (pas nécessaire
si vous utilisez le "CD 1"), configuration finale</ti>
</tr>
<tr>
<ti>3+GRP</ti>
<ti>Non</ti>
<ti>"CD 1", "CD 2" en option</ti>
<ti>configuration des partitions/systèmes de fichiers, configuration finale,
installation des paquets pré-compilés du CD 1 (optionnel), reboot,
installation des paquets tels que KDE ou GNOME (si vous utilisez le "CD 2").</ti>
</tr>
</table>
 <note>Les possesseurs de cartes ATA RAID sont encouragés à consulter la documentation
 concernant le RAID ATA à la fin de ce document avant de poursuivre.
</note>
</body>
</section>
</chapter>
<chapter>
<title>Démarrage</title>
<section>
<body>
<warn>Lisez bien cette section avant de continuer, et tout particulièrement les
options de démarrage. Le fait d'ignorer ce qui suit risquerait d'entraîner un
paramétrage erroné de votre clavier, des problèmes de démarrage du service
PCMCIA, etc.
</warn>
<p>Commencez par démarrer depuis un liveCD. Vous devriez voir apparaître un bel
écran de démarrage avec le logo Gentoo Linux. Vous pouvez alors taper [Entrée]
pour débuter le processus de démarrage ou spécifier un noyau ainsi que des options
de démarrage si nécessaire. Vous pouvez par exemple utiliser <c>gentoo nousb nohotplug</c>.
Si vous installez un système avec plus d'un processeur, vous devez taper <c>smp</c> au lieu
de <c>gentoo</c>. Cela permettra alors au Live CD de voir tous les processeurs de votre
système et pas seulement le premier.</p>

<p>La table ci-dessous contient une liste partielle des noyaux et des options de démarrage disponibles.
Vous pouvez aussi presser les touches F2 et F3 pour voir les écrans d'aide.</p>

<table>
<tr>
<th>Noyaux disponibles</th>
<th>Description</th>
</tr>

<tr><ti>gentoo</ti><ti>noyau Gentoo standard (défaut)</ti></tr>
<tr><ti>nofb</ti><ti>mode framebuffer désactivé</ti></tr>
<tr><ti>smp</ti><ti>charge un noyau multi-processeurs sans framebuffer</ti></tr>
<tr><ti>acpi</ti><ti>active acpi=on et charge les modules acpi pendant la phase init</ti></tr>
<tr><ti>memtest</ti><ti>démarre le programme de test de la mémoire</ti></tr>

</table>

<p>
<table>
<tr>
<th>Options de démarrage disponibles</th>
<th>Description</th>
</tr>

<tr><ti>doataraid</ti>
<ti>Charge les modules raid IDE dans l'initrd</ti></tr>

<tr><ti>dofirewire</ti>
<ti>Charge les modules firewire dans l'initrd (pour les CD-ROM firewire, etc)</ti></tr>

<tr><ti>dokeymap</ti>
<ti>Active la sélection des mappings pour les claviers non US</ti></tr>

<tr><ti>dopcmcia</ti>
<ti>Démarre le service PCMCIA</ti></tr>

<tr><ti>doscsi</ti>
<ti>Recherche les périphériques SCSI (peut provoquer un conflit avec certaines cartes réseau)</ti></tr>

<tr><ti>noapm</ti>
<ti>Désactive le chargement du module APM</ti></tr>

<tr><ti>nodetect</ti>
<ti>Désactive le démarrage de hwsetup/kudzu et hotplug</ti></tr>

<tr><ti>nodhcp</ti>
<ti>Désactive le chargement de DHCP si une carte réseau est trouvée</ti></tr>

<tr><ti>nohotplug</ti>
<ti>Désactive le service hotplug</ti></tr>

<tr><ti>noraid</ti>
<ti>Désactive le chargement des modules evms</ti></tr>

<tr><ti>nousb</ti>
<ti>Désactive les modules usb du chargement initrd et hotplug</ti></tr>

<tr><ti>ide=nodma</ti>
<ti>Force la désactivation du dma pour les périphériques IDE défectueux</ti></tr>

<tr><ti>cdcache</ti>
<ti>Garde toute la partie nécessaire fonctionnement de Gentoo en mémoire, ce qui utilise 40Mo, mais vous
permet alors d'éjecter le CD de démarrage et d'en utiliser un autre.</ti></tr>

</table></p>

<p>Après avoir appuyé sur Entrée, vous serez accueilli pas un très bel écran de
démarrage avec une barre de progression.</p>

<warn>
Si vous ne voyez qu'un écran noir au lieu de notre bel écran de démarrage,
essayez de démarrer avec le noyau <e>nofb</e>. Il est probable que le noyau
présent sur le CD est incompatible avec votre carte graphique en mode framebuffer
(mode graphique sans le serveur X).
</warn>

<p>Une fois le processus de démarrage terminé, vous serez automatiquement connecté en tant
que super-utilisateur &quot;<c>root</c>&quot;. Vous devriez alors voir un prompt
root (&quot;<c>#</c>&quot;) sur votre console et vous pouvez changer de console en appuyant
sur Alt-F2, Alt-F3 et Alt-F4. Pour revenir à votre console, pressez Alt-F1.</p>
<!--

<figure link="/images/install/livecd-1.4-con.png" caption="The Gentoo
Linux Live CD console" />
-->

<note><b>Utilisateurs expérimentés :</b> Lorsque le Live CD démarre, le mot de
passe root est alors généré aléatoirement afin de
maximiser la sécurité de votre installation. Si vous pensez utiliser <c>sshd</c>
pour vous connecter à distance sur votre Live CD, vous devriez changer ce mot de
passe en faisant <c>passwd</c>. Il vous sera dans le cas contraire impossible de
vous connecter à votre Live CD à travers le réseau.</note>

<p>Vous aurez probablement remarqué qu'au dessus du prompt <c>#</c> se trouve
une quantité substantielle de texte qui vous aide à configurer votre réseau et vous
indique où trouver les archives qui contiennent les étapes sur le CD.
</p>
</body>
</section>
</chapter>
<chapter>
<title>Configuration matérielle optionnelle</title>
<section>
<body>
<p>Lorsque le Live CD démarre, il tente de détecter tous vos périphériques et
charge alors les modules nécessaires. Dans la plupart des cas, il fait un très bon
travail concernant la détection. Il y a néanmoins des cas particuliers qui feront que
certains modules ne se chargeront pas. Si la détection PCI n'a pas reconnu une partie
de votre matériel, vous pouvez toujours charger manuellement les modules nécessaire.
Pour voir une liste complète des modules de cartes réseau
disponibles, tapez <c>ls /lib/modules/`uname -r`/kernel/drivers/net/*</c>. Pour charger
un module particulier, tapez :</p>
<pre caption="Configuration des modules PCI">
# <c>modprobe pcnet32</c>
<comment>(remplacez pcnet32 par le module de votre carte réseau)</comment>
</pre>
<p>De même, si vous avez besoin d'accéder à du matériel SCSI non
détecté, il vous suffit de charger les bons modules depuis <path>/lib/modules</path> en
utilisant <c>modprobe</c>:
</p>
<pre caption="Charger les modules SCSI">
# <c>modprobe aic7xxx</c>
<comment>(remplacez aic7xxx avec le module de votre carte SCSI)</comment>
# <c>modprobe sd_mod</c>
<comment>(sd_mod est le module supportant les disques durs SCSI)</comment>
</pre>
<note>
Le support des CD-ROM SCSI et des disques est intégré au noyau.
</note>

<p>Le liveCD Gentoo devrait avoir activé le DMA sur vos disques
pour des accès plus rapides, mais s'il ne l'a pas fait,
vous pouvez utiliser <c>hdparm</c>.</p>
<pre caption="Activer le DMA">
<comment>Remplacez hdX par vos disques.</comment>
# hdparm -d 1 /dev/hdX <comment>Active le DMA </comment>
# hdparm -d1 -A1 -m16 -u1 -a64 /dev/hdX
<comment>(Active le DMA ainsi que d'autres options sans danger)</comment>
# hdparm -X66 /dev/hdX
<comment>(Active l'Ultra-DMA -- dangereux -- peut causer des erreurs)</comment>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Configuration optionnelle du réseau</title>
<section>
<title>Votre réseau est-il déjà fonctionnel ?</title>
<body>
<p>Si votre machine est connectée à un réseau ethernet, il y a de grandes chances
que le réseau soit déjà paramétré. Si tel est le cas, vous devriez pouvoir vous
servir des commandes réseau telles que <c>ssh</c>, <c>scp</c>, <c>ping</c>, <c>irssi</c>, <c>wget</c> et <c>links</c>
(liste non exhaustive.)</p>

<p>Si le réseau est correctement paramétré, la commande <c>/sbin/ifconfig</c> devrait
lister les interfaces réseau disponibles en plus de <c>lo</c>, telle que <c>eth0</c>:
</p>
<pre caption="/sbin/ifconfig d'une carte réseau correctement paramétrée">
eth0Link encap:EthernetHWaddr 00:50:BA:8F:61:7A
inet addr:192.168.0.2Bcast:192.168.0.255Mask:255.255.255.0
inet6 addr: fe80::50:ba8f:617a/10 Scope:Link
UP BROADCAST RUNNING MULTICASTMTU:1500Metric:1
RX packets:1498792 errors:0 dropped:0 overruns:0 frame:0
TX packets:1284980 errors:0 dropped:0 overruns:0 carrier:0
collisions:1984 txqueuelen:100
RX bytes:485691215 (463.1 Mb)TX bytes:123951388 (118.2 Mb)
Interrupt:11
</pre>
<p>Vous devriez également essayer de faire un ping du serveur DNS de votre
fournisseur d'accès (indiqué dans votre <path>/etc/resolv.conf</path>),
ainsi qu'un serveur internet de votre choix, juste pour vous assurer que vos
paquets atteignent l'internet et que la résolution des noms fonctionne correctement.
</p>
<pre caption="Test de réseau avancé">
# <c>ping -c 3 www.yahoo.fr </c>
</pre>
<p>Pouvez-vous utiliser correctement votre réseau ? Si oui, vous pouvez passer
à la section suivante.</p>
</body>
</section>
<section>
<title> Configuration de PPPoE</title>
<body>
<p>Si vous avez besoin de PPPoE (ADSL) pour accéder à internet, le liveCD (quelle que
soit sa version) devrait vous faciliter la tâche car il inclut <c>rp-pppoe</c>. Il
vous suffit alors d'utiliser le script <c>adsl-setup</c> inclus pour configurer
votre connexion. Il vous demandera alors quelle carte ethernet est connectée à votre
modem ADSL, votre nom d'utilisateur et votre mot de passe, les adresses IP de
vos serveurs DNS et si vous désirez un pare-feu de base.</p>
<pre caption="Configuration de PPPoE">
# <c> adsl-setup </c>
# <c> adsl-start </c>
</pre>
<p>Si quelque chose se passe mal, vérifiez que vous avez correctement entré votre
nom d'utilisateur et votre mot de passe en regardant <path>/etc/ppp/pap-secrets</path> ou
bien <path>/etc/ppp/chap-secrets</path>, et assurez-vous également que vous
utilisez le bon périphérique ethernet.</p>
</body>
</section>
<section>
<title> Configuration automatique du réseau </title>
<body>
 <p>La méthode la plus simple pour paramétrer le réseau s'il n'a pas été automatiquement pris en compte est de démarrer le script <c>net-setup</c>.</p>
<pre caption="Le script net-setup">
# <c>net-setup eth0</c>
</pre>
<p>Vous pouvez bien évidemment paramétrer votre réseau manuellement si vous
le préférez comme le montre la section suivante.</p>
</body>
</section>
<section>
<title>Configuration DHCP manuelle</title>
<body>
<p>La configuration réseau est simple grâce à DHCP ; si votre fournisseur d'accès
n'utilise pas DHCP, passez à la configuration statique détaillée plus bas.</p>
<pre caption="Configuration réseau avec DHCP">
# <c>dhcpcd eth0</c>
</pre>
<note>
Certains fournisseurs d'accès demandent un nom de machine, pour ce faire,
ajoutez l'option : <c>-h myhostname</c> à la ligne dhcpcd plus haut.
</note>
<p>Si vous voyez des messages d'avertissement <i>dhcpConfig</i>, ne vous inquiétez pas,
les erreurs sont purements informatives. Vous pouvez passer au test du réseau
plus bas.</p>
</body>
</section>
<section>
<title>Configuration manuelle statique</title>
<body>
<p>Nous avons besoin de l'interface localhost et d'une configuration réseau minimum
afin de pouvoir télécharger les sources du système à compiler. Les explications
nécessaires se trouvent dans le tableau ci-dessous.</p>

<table>
<tr><th>Information</th><th>Description</th><th>Exemple</th></tr>
<tr><ti>Adresse IP</ti><ti>L'adresse IP que vous désirez attribuer à votre carte réseau</ti><ti>192.168.1.2</ti></tr>
<tr><ti>Adresse de diffusion</ti><ti>L'adresse IP qui diffuse les paquets vers tous les hôtes du réseau</ti><ti>192.168.1.255</ti></tr>
<tr><ti>Masque de réseau</ti><ti>Le masque qui définit quelle partie d'une adresse IP identifie le
 réseau et quelle partie identife l'hôte</ti><ti>255.255.255.0</ti></tr>
<tr><ti>Passerelle</ti><ti>L'adresse IP de l'ordinateur chargé de faire passer les paquets qui ne sont pas
destinés au réseau local (la plupart du temps il s'agit de la machine qui partage l'accès internet)</ti><ti>192.168.1.1</ti></tr>
</table>

<p>
Tapez les commandes suivantes, en remplaçant $IFACE par votre
interface réseau (généralement <c>eth0</c>), $IPNUM par votre adresse IP,
$BCAST avec votre adresse de diffusion et $NMASK par votre masque de réseau.
Pour la commande <c>route</c>, remplacez $GTWAY par l'adresse IP de votre passerelle par défaut.
</p>

<pre caption="Configuration d'IP statique">
# <c>ifconfig $IFACE $IPNUM broadcast $BCAST netmask $NMASK</c>
# <c>route add -net default gw $GTWAY netmask 0.0.0.0 metric 1</c>
</pre>
<p>Il faut maintenant créer le fichier <path>/etc/resolv.conf</path>
afin que la résolution de noms de domaines (pour trouver les sites Web/FTP par leur
nom plutôt que par leur adresse IP) fonctionne. Vous pouvez utiliser 
<c>nano -w /etc/resolv.conf</c> pour créer <path>/etc/resolv.conf</path>.
<c>nano</c> est un petit éditeur facile à utiliser.</p>
<p>Voici un exemple pour créer votre fichier /etc/resolv.conf : </p>
<pre caption="Exemple /etc/resolv.conf">
domain modomaine.com
nameserver 10.0.0.1
nameserver 10.0.0.2
</pre>
<p>Remplacez <c>10.0.0.1</c> et <c>10.0.0.2</c> respectivement par les adresses IP de
vos DNS primaires et secondaires.</p>
</body>
</section>
<section>
<title>Configuration d'un serveur de proximité (proxy)</title>
<body>
<p>Si vous vous trouvez derrière un serveur de proximité, vous devez le
déclarer sur votre machine avant de continuer. Les lignes suivantes définissent
les paramètres nécessaires :
</p>
<pre caption="Configurer un serveur de proximité">
<comment>Si votre proxy limite le trafic HTTP :</comment>
# <c>export http_proxy=&quot;http://machine.company.com:1234&quot; </c>
<comment>Si votre proxy limite le trafic FTP :</comment>
# <c>export ftp_proxy=&quot;http://machine.company.com:1234&quot; </c>
<comment>Si votre proxy limite le trafic RSYNC :</comment>
# <c>export RSYNC_PROXY=&quot;rsync://machine.company.com:1234&quot; </c>
</pre>
<note>
Si le serveur de proximité que vous utilisez exige que vous vous identifiiez,
tapez alors <c>http://username:password@machine.company.com</c>. Notez l'ajout
de &quot;username:password@&quot;.
</note>
</body>
</section>
<section>
<title>Le réseau est prêt !</title>
<body>
<p>Le réseau devrait à présent être correctement paramétré et utilisable. Vous
devriez donc pouvoir utiliser les commandes <c>ssh</c>, <c>scp</c>, <c>links</c>, <c>irssi</c> et <c>wget</c> pour vous connecter à d'autres machines sur votre réseau ou internet.</p>
</body>
</section>
</chapter>
<chapter>
<title>Paramétrer la date et l'heure de votre système</title>
<section>
<body>
<p>Vous devez à présent paramétrer la date et l'heure de votre système. Vous pouvez le faire
manuellement en invoquant la commande <c>date</c>.</p>
<pre caption="Paramétrer votre date système">
# <c>date</c>
Jeu Fev 27 09:04:42 CST 2003
<comment>(Si la date est incorrecte, utilisez la commande suivante pour la corriger)</comment>
# <c>date 022709042003</c>
<comment>(date MMJJhhmmAAAA)</comment>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Systèmes de fichiers, partitions et périphériques de stockage</title>
<section>
<title>Introduction aux périphériques de stockage</title>
<body>
<p>
Dans cette section, nous allons voir de façon approfondie les aspects disques qui
concernent Gentoo Linux et Linux en général, y compris les systèmes de fichiers,
les partitions et les périphériques de stockage. Lorsque vous vous serez bien familiarisé avec les
disques et les systèmes de fichiers, vous serez guidé pour paramétrer vos partitions et
les systèmes de fichiers concernant l'installation de votre Gentoo Linux.
</p>
<p>
Commençons par aborder la notion de périphériques de stockage. Le périphérique de stockage le plus
important est sans aucun doute le premier disque dur IDE dans un système Linux :
</p>
<pre caption="/dev/hda, est le périphérique représentant votre premier disque dur dans
votre machine">
/dev/hda
</pre>

<p>
Si votre système utilise des disques SCSI, votre premier disque dur sera alors :
</p>

<pre caption="/dev/sda, le périphérique de stockage représentant le premier disque logique SCSI dans votre système">
/dev/sda
</pre>

<p>Les périphériques de stockage ci-dessus représentent une interface <i>abstraite</i>.
Les programmes peuvent utiliser ces périphériques de bloc pour interagir avec le
système sans avoir à s'inquiéter si vos pilotes sont IDE, SCSI ou autre. Le
programme peut simplement inscrire les données sur le disque en utilisant des blocs
continus, accessibles directement et d'une taille de 512 octets chacun.</p>
</body>
</section>
<section>
<title>Partitions et fdisk</title>
<body>
<p> Sous Linux, nous créons un système de fichiers avec une commande spéciale
nommée <c>mkfs</c> (ou <c>mke2fs</c>, <c>mkreiserfs</c>, etc) en spécifiant le nom du périphérique
de stockage sur la ligne de commande.</p>

<p>Bien qu'il soit théoriquement possible d'utiliser le périphérique en entier 
comme <c>/dev/hda</c> ou
<c>/dev/sda</c> pour y abriter un système de fichiers, ce n'est normalement jamais utilisé.
On préfère répartir l'espace de stockage global du disque en sections
plus petites, donc plus faciles à gérer, que l'on appelle "partitions". Les partitions
sont créées en faisant appel à un utilitaire nommé <c>fdisk</c>, utilisé pour
créer et éditer la table de partitions qui est inscrite sur chacun des disques. Cette
table décrit exactement comment est réparti l'espace de stockage du disque.
 </p>

<p>Nous pouvons examiner une table de partitions avec <c>fdisk</c>
en spécifiant le nom du périphérique sur la ligne de commande : </p>

<note>Des alternatives existent pour consulter les tables de partitions telles
que <c>cfdisk</c>, <c>parted</c> et <c>partimage</c>. Nous recommandons
<c>fdisk</c> parce qu'il a plus de possibilités et qu'il est le plus répandu
dans le monde Unix/Linux.</note>

<pre caption="Exécuter fdisk">
# fdisk /dev/hda
</pre>
<p>
ou
</p>
<pre caption="Exécuter fdisk avec un disque dur SCSI : /dev/sda">
# fdisk /dev/sda
</pre>

<impo>
<b>Vous ne devez <i>pas</i> apporter de modifications sur une table de partitions d'un
disque contenant des données importantes ou en cours d'utilisation. Cela entraîne généralement
la perte des données.</b>
</impo>

<p>
Lorsque vous êtes dans fdisk, vous devriez voir un prompt de ce type :
</p>

<pre caption="Le prompt fdisk">
Command (m for help):
</pre>


<p>
Appuyez sur <c>p</c> pour afficher la table de partitions : </p>

<pre caption="Un exemple de table de partitions :">
Command (m for help): p

Disk /dev/hda: 240 heads, 63 sectors, 2184 cylinders
Units = cylinders of 15120 * 512 bytes

Device Boot    Start       End    Blocks   Id  System
/dev/hda1             1        14    105808+  83  Linux
/dev/hda2            15        49    264600   82  Linux swap
/dev/hda3            50        70    158760   83  Linux
/dev/hda4            71      2184  15981840    5  Extended
/dev/hda5            71       209   1050808+  83  Linux
/dev/hda6           210       348   1050808+  83  Linux
/dev/hda7           349       626   2101648+  83  Linux
/dev/hda8           627       904   2101648+  83  Linux
/dev/hda9           905      2184   9676768+  83  Linux

Command (m for help):
</pre>

<p> Ce disque est paramétré pour contenir 7 systèmes de fichiers Linux
(chacun correspondant à une partition listée comme "Linux") ainsi qu'une
partition d'échange (listée comme "Linux swap").</p>

<p>
Remarquez le nom des blocs de partitions dans la colonne de gauche, commençant avec
<c>/dev/hda1</c> et finissant par <c>/dev/hda9</c>. Au début de l'ère des PCs,
les logiciels de partitionnement n'autorisaient que 4 partitions (appelées
"partitions primaires"). Cela a vite limité les possibilités, on a donc trouvé
une solution pour avoir des <i>partitions étendues</i>). Une partition étendue est
très similaire à une partition primaire et compte pour 1 parmi les 4 partitions
primaires. La différence se situe dans le fait qu'elle peut contenir des
<i>partitions logiques</i>, permettant ainsi de contourner le problème de limite
des 4 partitions.</p>

<p>
Toutes les partitions au dessus de <c>hda4</c> sont des partitions logiques. Les chiffres
1 à 4 sont réservés pour des partitions primaires ou étendues.</p>

<p>Dans notre exemple, <c>hda1</c> à <c>hda3</c> sont des partitions primaires.
<c>hda4</c> est une partition étendue qui contient des partitions logiques numérotées de
<c>hda5</c> à <c>hda9</c>. Vous <i>n'utiliserez</i> donc jamais <c>/dev/hda4</c> pour
stocker des systèmes de fichiers directement -- elle sert juste d'enveloppe pour les
partitions de <c>hda5</c> à <c>hda9</c>.</p>

<p>Notez également que chaque partition contient un "Id", que l'on appelle aussi
"type de partition". Lorsque vous en créez une nouvelle, assurez-vous de définir
correctement le type. '83' est le type correct pour une partition de système de fichiers
Linux et '82' indique une partition d'échange (swap). Vous pouvez utiliser la lettre <c>t</c>
dans <c>fdisk</c> pour les paramétrer. Le noyau de linux utilise les types de partitions
afin de détecter automatiquement les systèmes de fichiers et les fichiers d'échange sur le
disque à chaque démarrage.
</p>
</body>
</section>
<section>
<title>Utilisation de fdisk pour paramétrer des partitions</title>
<body>

<p>Maintenant que vous avez vu la méthode pour créer des partitions sous Linux, il
est temps de voir comment créer vos partitions sous Gentoo Linux. Une fois que nous
aurons terminé, votre configuration de partitions devrait ressembler à çà :</p>

<pre caption="La configuration des partitions terminée">
Disk /dev/hda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

 Device   Boot  Start    End    Blocks    Id    System
/dev/hda1  *        1     14    105808+   83    Linux
/dev/hda2          15     81    506520    82    Linux swap
/dev/hda3          82   3876  28690200    83    Linux

Command (m for help):
</pre>

<p>Dans notre configuration de partitions pour débutant, nous avons trois
partitions. La première (<c>/dev/hda1</c>), de petite taille, est au début du disque
et est appelée partition d'amorçage (boot). Cette partition a pour but de
contenir toutes les données importantes au démarrage comme par exemple les informations
de GRUB (ou bien LILO selon ce que vous utilisez) ainsi que vos noyaux Linux. La
partition de démarrage vous donne une place sécurisée pour contenir tout ce qui
concerne le démarrage de Linux. Lors de l'utilisation journalière
de votre Gentoo Linux, votre partition de d'amorçage (boot) devrait rester
<e>démontée</e> pour plus de sécurité. Si vous avez un système qui utilise des disques
SCSI, votre partition d'amorçage devrait sans doute être <c>/dev/sda1</c>.</p>

<p>Il est recommandé d'avoir des partitions de démarrage (contenant tout le nécessaire
pour permettre au gestionnaire de démarrage de fonctionner) au début du disque dur.
Bien que cela ne soit plus vraiment le cas, c'est une tradition utile qui remonte au
temps où LILO ne pouvait pas charger des noyaux placés au-delà des premiers
1024 cylindres d'un disque.</p>

<p>La seconde partition (<c>/dev/hda2</c>) est utilisée comme partition d'échange (swap).
Le noyau utilise un fichier d'échange lorsqu'il n'a plus assez de RAM disponible. Cette
partition n'est généralement pas très grande, aux alentours de 512 Mo. Si vous utilisez
un système à base de SCSI, cette partition s'appellera sans doute <c>/dev/sda2</c>.</p>

<p>La troisième partition (<c>/dev/hda3</c>) est relativement conséquente et occupe le
reste du disque dur. Cette partition, appelée partition "racine" (root) est utilisée pour
stocker votre distribution Gentoo. Sur un système SCSI, cette partition
s'appellerait <c>/dev/sda3</c>.</p>


<p>Avant de partitionner du disque dur, voici un aperçu
des partitions et des systèmes de fichiers conseillés lorsque vous installez Gentoo Linux :</p>

<table>
<tr>
<th>Partition</th>
<th>Taille</th>
<th>Type</th>
<th>Exemple</th>
</tr>
<tr>
<ti>partition boot, contenant les informations relatives au noyau</ti>
<ti>32 Mo</ti>
<ti>ext2/3 de préférence (plus facile); si vous utilisez ReiserFS, à monter avec
 l'option <c>-o notail</c>. Si vous utilisez ext3 ou ReiserFS, nous recommandons une taille de 64Mo</ti>
<ti>/dev/hda1</ti>
</tr>
<tr>
<ti>partition swap (limitation de 2Go contrairement à 128Mo précédemment)</ti>
<ti>Entre une et deux fois la quantité de mémoire physique de la machine</ti>
<ti>Linux swap</ti>
<ti>/dev/hda2</ti>
</tr>
<tr>
<ti>partition root, contenant le système principal (/usr, /home, etc)</ti>
<ti>&gt;=1.5 Go</ti>
<ti>ReiserFS ou ext3 recommendés; ext2 ok</ti>
<ti>/dev/hda3</ti>
</tr>
</table>

<p>Il nous faut à présent créer les partitions selon les exemples donnés ci-dessus.
Tout d'abord, démarrez fdisk en faisant <c>fdisk /dev/hda</c> ou <c>fdisk /dev/sda</c>
selon que vous utilisez un disque IDE ou SCSI. Tapez ensuite <c>p</c> afin de voir la configuration
actuelle des partitions. Y a-t-il une quelconque information sur ce disque que vous
devez conserver ? Si oui, <b>arrêtez de suite</b>. Si vous continuez, <b>toutes les données
existantes sur votre disque dur seront effacées.</b></p>

<impo>L'application de ces instructions résultera dans <b>l'effacement complet</b> des
données de votre disque dur. Si votre disque contient des données,
assurez-vous que ce ne soit pas quelque chose d'important. Assurez-vous également
d'avoir <b>sélectionné le bon disque dur</b> afin de ne pas effacer les données du
mauvais disque dur.</impo>

<p>Effaçons à présent les données des partitions existantes. Pour ce faire, appuyez
sur <c>d</c> et entrée. Vous devrez alors spécifier la partition que vous désirez
effacer. Pour effacer par exemple <c>/dev/hda1</c>, tapez :</p>

<pre caption="Effacer une partition">
Command (m for help): d
Partition number (1-4): 1
</pre>

<p>Cette partition est donc programmée pour être effacée. elle ne sera plus visible
si vous tapez sur <c>p</c>, mais ne sera pas effacée avant que vous ne sauvegardiez
vos changements. Si vous faites une erreur, vous pouvez quitter <c>fdisk</c> et annuler vos
modifications en tapant sur <c>q</c> et entrée. Vos modifications ne
seront pas enregistrées sur le disque.</p>
<p>Si vous désirez effacer toutes les partitions de votre disque dur, appuyez plusieurs
fois sur <c>p</c> pour afficher la liste des partitions puis appuyez sur <c>d</c> suivi
du numéro de la partition à effacer. Vous vous retrouverez alors
avec une table de partitions vide : </p>

<pre caption="Une table de partitions vide">
Disk /dev/hda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

 Device Boot	Start	   End	    Blocks   Id    System

Command (m for help):
</pre>

<p>Maintenant que la table de partitions en mémoire vive est vide (rappellez vous qu'aucune
modification n'est encore sauvée sur le disque dur), vous devez créer une partition
de démarrage (boot). Pour ce faire, appuyez sur <c>n</c> pour créer une nouvelle
partition, puis appuyez sur <c>p</c> pour lui indiquer que vous désirez créer une partition
primaire. Tapez ensuite <c>1</c> (car il s'agit de la première partition que nous
créons sur le disque dur). Lorsque vous verrez apparaître la demande du cylindre
de démarrage, appuyez sur entrée. Pour le dernier cylindre, tapez <c>+32M</c>.
Voici le résultat : </p>

<note>
Les systèmes de fichiers journalisés nécessitent plus de place pour leur journal. Les
paramètres par défaut demandent environ 33 Mo d'espace libre. Si vous utilisez un
système de fichiers journalisé pour <path>/boot</path>, vous devriez taper <c>+64M</c>
lorsque fdisk vous demande le dernier cylindre.
</note>

<pre caption="Etapes pour créer notre partition de démarrage (boot)">
Command (m for help): n
Command action
 e extended
 p primary partition (1-4)
p
Partition number (1-4): 1
First cylinder (1-3876, default 1):
Using default value 1
Last cylinder or +size or +sizeM or +sizeK (1-3876, default 3876): +32M
</pre>

<p>Si vous tapez <c>p</c>, vous devriez donc à présent voir apparaître :</p>

<pre caption="Notre première parition a été créée">
Command (m for help): p

Disk /dev/hda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

 Device    Boot	Start 	End	Blocks 	  Id	System
/dev/hda1 	    1	 14	105808+	  83	Linux
</pre>

<p>Créons ensuite la partition d'échange (swap). Pour ce faire, appuyez sur
<c>n</c> pour créer une nouvelle partition puis <c>p</c> pour dire à fdisk que cela
sera la deuxième partition primaire. Appuyez ensuite sur <c>2</c>, ce qui correspondra à
<c>/dev/hda2</c> dans notre cas.
Pour le premier cylindre, appuyez sur entrée. Pour le dernier cylindre, tapez sur
<c>+512M</c> pour créer une partition d'une taille de 512Mo. Lorsque vous avez terminé,
appuyez sur <c>t</c> pour changer le type de partition, <c>2</c> pour sélectionner la
partition que vous venez de créer puis <c>82</c>
pour changer le type de partition en "Linux Swap". Lorsque vous aurez terminé, <c>p</c>
devrait vous afficher une table de partitions ressemblant à ceci : </p>

<pre caption="Notre partition d'échange (swap) a été créée">
Command (m for help): p

Disk /dev/hda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

 Device    Boot	 Start   End	Blocks   Id   System
/dev/hda1 	     1	  14	105808+  83   Linux
/dev/hda2	    15	  81	506520   82   Linux swap
</pre>

<p>Créons enfin la partition racine (root). Pour ce faire, appuyez une fois de
plus sur <c>n</c> pour créer une nouvelle partition et <c>p</c> pour indiquer que vous
voulez une partition primaire. Ensuite sur <c>3</c> pour créer une troisième partition
primaire qui sera donc <c>/dev/hda3</c> dans notre cas. Appuyez sur entrée pour le
premier cylindre puis à nouveau pour le cylindre de fin pour prendre tout l'espace
disponible restant sur votre disque dur. Après avoir effectué ces étapes, le résultat
de la commande <c>p</c> devrait ressembler à ça : </p>

<pre caption="Notre partition root a été créée">
Command (m for help): p

Disk /dev/hda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes

 Device    Boot	 Start   End	Blocks   Id   System
/dev/hda1 	     1	  14	105808+  83   Linux
/dev/hda2	    15	  81	506520   82   Linux swap
/dev/hda3	    82	3876  28690200   83   Linux
</pre>

<p>
Il faut à présent activer l'option "amorçable" (bootable) sur la partition de démarrage
et inscrire les changements sur le disque. Pour rendre <c>/dev/hda1</c> amorçable, tapez
<c>a</c> puis <c>1</c> pour indiquer la partition. Si vous tapez <c>p</c> à présent,
vous devriez voir que <c>/dev/hda1</c> affiche un <c>*</c> dans la section "Boot".
Pour inscrire les changements sur le disque dur, appuyez sur <c>w</c> puis entrée. Les
partitions sont maintenant prêtes pour une installation de Gentoo Linux.</p>

<note>Si vous recevez un avertissement de <c>fdisk</c> ou de <c>cfdisk</c> à propos d'un
redémarrage pour prendre en compte les changements de partitions, faites-le.</note>
</body>
</section>
<section>
<title>Créer des systèmes de fichiers</title>
<body>
<p>Maintenant que nous avons créé les partitions, il faut les formater avec un
système de fichiers pour pouvoir les utiliser pour stocker des données.
Nous allons également configurer la partition d'échange.
</p>

<p>Gentoo Linux supporte une variété de types de systèmes de fichiers ; chacun possédant
ses points forts et ses faiblesses ainsi que des performances différentes. Nous supportons
actuellement la création de systèmes de fichiers tels que : ext2, ext3, XFS, JFS et
ReiserFS.</p>

<p>ext2 est de loin le système de fichiers le plus éprouvé et celui qui est lié à
Linux depuis longtemps mais il ne contient pas la journalisation des meta-données, ce qui
veut dire que la vérification des systèmes de fichiers ext2 au démarrage peut
prendre un certain temps. Vous pouvez donc opter pour un système de fichiers de type
<i>journalisé</i> qui vérifie les inconsistences rapidement. Les systèmes de
fichiers journalisés permettent de raccourcir les délais de démarrage si vous
avez des erreurs sur ces systèmes de fichiers.</p>

<p>ext3 est la version journalisée d'ext2. Elle fournit le support de la
journalisation de méta-données, accélère la réparation rapide et offre des options
avancées de modes de journalisation tels que la journalisation de données complètes
et de données ordonnées. ext3 est très bon et fiable. Il offre des performances décentes
selon les conditions. Etant donné qu'il utilise peu les
"hiérarchies" dans son design interne, il n'est pas très recommandé pour des systèmes
de fichiers de grande taille car il aura du mal à s'adapter si vous avez des gros fichiers
ou beaucoup de fichiers au sein d'un seul répertoire. En dehors
de ces cas, c'est un excellent système de fichiers.</p>

<p>ReiserFS est un système de fichiers basé sur les B*-trees qui permet une performance
générale de bonne qualité et dépasse de loin les performances d'ext2 et ext3 sur la
manipulation de fichiers de petite taille (inférieure à 4k) en offrant un gain
de performance de près de 10x à 15x. ReiserFS s'adapte parfaitement et possède également
des fonctions de journalisation. Depuis le kernel 2.4.18, ReiserFS est à présent un
système de fichiers considéré comme robuste et recommandé pour des systèmes
de fichiers standards ou des systèmes de fichiers extrêmes tels que : grande taille,
beaucoup de fichiers, très gros fichiers et des répertoires contenant
des dizaines de milliers de fichiers. Nous recommandons ReiserFS pour toutes les
partitions sauf pour /boot.</p>

<p>XFS est un système de fichiers avec des capacités de journalisation de méta-données
qui est complètement supporté par le kernel <path>xfs-sources</path> de Gentoo Linux.
Il est livré avec beaucoup de fonctionnalités et est optimisé pour les gros systèmes. Nous
le recommandons sur des systèmes ayant des controleurs SCSI de haut niveau ou des
stockages en fibre optique avec une alimentation continue. Du fait que XFS utilise un cache de façon agressive pour les données en transit dans la RAM, les programmes qui ne sont pas
écrits correctement (ceux qui ne prennent pas certaines précautions pour écrire des fichiers sur le
disque, et il en existe quelques uns) peuvent perdre une bonne quantité de données si le
système s'arrête de façon inattendue.</p>

<p>JFS est le système haute performance de journalisation de fichiers propre à IBM. Il a été
récemment déclaré comme valide à l'utilisation en production. Il est encore trop jeune
pour pouvoir commenter positivement ou négativement à propos de sa stabilité.</p>

<p>Si vous cherchez le système de fichiers le plus robuste et éprouvé, utilisez ext3.
Si vous voulez utiliser un système de fichiers de haute performance avec support de
journalisation, optez pour ReiserFS ; ext3 et ReiserFS sont matures, évolués et
recommandés pour une utilisation quotidienne.</p>

<p>En se basant sur notre exemple ci-dessus, nous allons utiliser des commandes
pour initialiser toutes les partitions : </p>

<pre caption="Initialisation des partitions (exemple)">
# mke2fs /dev/hda1
# mkswap /dev/hda2
# mkreiserfs /dev/hda3
</pre>

<p>Nous avons choisi ext2 pour la partition de boot <c>/dev/hda1</c> car c'est un
système de fichiers robuste supporté par tous les chargeurs de démarrage
(bootloaders). Nous avons ensuite utilisé <c>mkswap</c> pour <c>/dev/hda2 </c> qui est
une partition d'échange de données (swap) (le choix est relativement évident). Enfin,
pour notre partition principale (root) <c>/dev/hda3</c>, nous avons opté pour ReiserFS car
c'est un système de fichiers journalisé solide qui offre d'excellentes performances.
Il est a présent temps d'initialiser vos partitions.</p>

<p>Pour référence, voici les commandes disponibles <c>mkfs</c> lors de
l'installation :</p>

<p><c>mkswap</c> initialise une partition d'échange:</p>
<pre caption="Initialise le swap">
# <c>mkswap /dev/hda2</c>
</pre>
<p>Vous pouvez utiliser la commande <c>mke2fs</c> pour créer des systèmes de fichiers
ext2 :</p>
<pre caption="Créer un système de fichiers ext2">
# <i>mke2fs /dev/hda1</i>
</pre>
<p>Pour utiliser ext3, vous pouvez créer des systèmes de fichiers ext3 par la commande :
<c>mke2fs -j</c>:</p>
<pre caption="Créer un système de fichiers ext3">
# <c>mke2fs -j /dev/hda3</c>
</pre>
<note>Pour en savoir plus à propos d'ext3 sous Linux 2.4, consultez
<uri>http://www.zip.com.au/~akpm/linux/ext3/ext3-usage.html</uri>.</note>
<p>Pour créer un système de fichiers ReiserFS, utilisez la commande <c>mkreiserfs</c> :</p>
<pre caption="Créer un système de fichiers ReiserFS">
# <c>mkreiserfs /dev/hda3</c>
</pre>
<p>Pour créer un système de fichiers XFS, utilisez la commande <c>mkfs.xfs</c> :</p>
<pre caption="Créer un système de fichiers XFS">
# <c>mkfs.xfs /dev/hda3</c>
</pre>
<note>Il se peut que vous vouliez ajouter quelques options à la commande
<c>mkfs.xfs</c> <c>-d agcount=3 -l size=32m</c>.
L'option <c>-d agcount=3</c> permet de réduire le nombre de groupes d'allocation.
XFS insistera pour utiliser au moins un group d'allocation par 4 Go disponibles sur
votre partition, donc par exemple, si vous avez 20 Go disponibles, vous aurez besoin
d'un mininum de 5 agcount. L'option <c>-l size=32m</c> augmente la taille du journal
à 32 Mo, améliorant ainsi ses performances.</note>

<p>Pour créer un système de fichiers JFS, utilisez la commande <c>mkfs.jfs</c> :</p>
<pre caption="Créer un système de fichiers JFS">
# <c>mkfs.jfs /dev/hda3</c>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Montage des partitions</title>
<section>
<body>
<p>Nous allons à présent activer notre nouvelle partition d'échange (swap) étant donné que
nous aurons sans doute besoin de cet apport de mémoire virtuelle plus tard :
</p>
<pre caption="Activation du swap">
# <c>swapon /dev/hda2</c>
</pre>

<p>Nous créons ensuite le point de montage <path>/mnt/gentoo/boot</path> et nous
allons monter nos systèmes de fichiers.
Une fois que nos systèmes de fichiers boot et root seront montés, tous les fichiers
que nous allons copier ou créer dans <path>/mnt/gentoo</path> seront mis sur
ce système de fichiers. Il va de soi que si vous avez créé des partitions
supplémentaires telles que <path>/usr</path> ou <path>/var</path>, vous devez
les monter sous <path>/mnt/gentoo/usr</path> et <path>/mnt/gentoo/var</path>. </p>

<impo>Si votre partition de <e>boot</e> est en ReiserFS, prenez soin de
la monter avec l'option <c>-o notail</c> afin que GRUB puisse s'installer
correctement. Assurez-vous que <c>notail</c> soit présent à la fin de la ligne relative à
<e>boot</e> dans votre <path>/etc/fstab</path>.
Nous en reparlerons un peu plus tard dans cette page. Si vous comptez utiliser
LILO avec ReiserFS, vous n'avez alors pas besoin de <c>-o notail</c>. Il est
néanmoins conseillé de préciser cette option si vous nous savez pas ce que
vous devez mettre pour ReiserFS.
</impo>

<pre caption="Création des points de montage">
# <c>mount /dev/hda3 /mnt/gentoo</c>
# <c>mkdir /mnt/gentoo/boot</c>
# <c>mount /dev/hda1 /mnt/gentoo/boot</c>
</pre>

<impo>Si vous rencontrez des problèmes au montage de votre partition
boot en ext2, essayez ceci :
 <c>mount /dev/hXX /mnt/gentoo/boot -t ext2 </c> </impo>
</body>
</section>
</chapter>
<chapter>
<title>Les différentes étapes et chroot</title>
<section>
<title>Choisir la bonne étape de départ</title>
<body>

<p>
Vous devez à présent décider quel tarball vous voulez utiliser comme base pour votre
installation. Les étapes disponibles sont dans <path>/mnt/cdrom/stages/</path>
sur votre Live CD. Entrez <c>ls /mnt/cdrom/stages/</c> pour en afficher la liste.</p>

<p><b>Les utilisateurs de GRP</b> devraient utiliser l'archive compressée <path>stage3-xx-yy.tar.bz2</path>.</p>

<!-- OLD STUFF

<p>Si vous désirez faire une installation &quot;à partir de zéro en compilant tout&quot;,
vous devez utiliser l'image <path>stage1-x86-1.4_rc4.tar.bz2</path>. Si vous utilisez
l'un des plus gros CDs tel que l'ISO "3stages", vous aurez également le choix avec
stage2 et stage3. Ces images vous permettront d'économiser du temps mais en perdant
des options de configuration (nous avons déjà défini des optimisations de compilation
ainsi que les variables USE pour vous). Les étapes se trouvent à l'endroit suivant
sur le CD : <path>/mnt/cdrom/stages</path>, et vous pouvez taper <c>ls /mnt/cdrom/stages</c>
pour voir ce qui s'y trouve.</p>

OLD STUFF -->

<p>Si vous désirez faire une installation avec l'archive d'une étape qui ne se trouve <i>pas</i>
sur le CD (c'est le cas si vous utilisez un LiveCD "allégé"), c'est possible, 
mais vous devrez la télécharger séparément en suivant les
instructions ci-dessous. Si vous avez déjà l'archive de l'étape que vous voulez
utiliser (ce qui est le cas de nombreux utilisateurs), passez à la section "Extraction
de l'archive sélectionnée".</p>

<pre caption="Téléchargement des étapes nécessaires">
# <c>cd /mnt/gentoo</c>
<comment>Utilisez links pour obtenir une URL pour votre tarball:</comment>
# <c>links http://gentoo.oregonstate.edu/releases/x86/1.4/</c>
<comment>Utilisez flèche <c>haut</c> et <c>bas</c> (ou bien la touche <c>TAB</c>) afin
d'aller dans le bon répertoire puis mettez en surbrillance l'étape que vous voulez
télécharger. Appuyez sur <c>d</c> afin de commencer le téléchargement puis sauvez le
fichier et quittez le navigateur.

<b>OU</b> utilisez directement wget depuis la ligne de commande :</comment>
# <c>wget <comment>insérez ici l'URL complète vers le tarball.</comment></c>
</pre>
</body>
</section>
<section>
<title>Extraction de l'archive sélectionnée</title>
<body>

<p>Il est temps d'extraire l'archive compressée du stage qui vous convient vers
<path>/mnt/gentoo/</path>. Attention, vous ne devez en extraire qu'une <b>seule</b> (soit
le stage1, stage2 ou stage3). Si vous désirez donc n'utiliser que le stage3, procédez
comme ceci : </p>

<impo>Utilisez bien l'option <c>p</c> avec <c>tar</c>.Si vous ne le faites pas,
certains fichiers auront des permissions incorrectes.</impo>

<pre caption="Décompresser les étapes">
# <c>cd /mnt/gentoo</c>
<comment>Changez "stage3" par "stage2" ou "stage1" selon celui que vous avez choisi.
</comment>
<comment>Si vous avez téléchargé une archive, remplacez le chemin ci-dessous par
"/mnt/gentoo/" au lieu de "/mnt/cdrom/gentoo/".</comment>
# <c>tar -xvjpf /mnt/cdrom/stages/stage3-*.tar.bz2</c>
</pre>

<p>Si vous avez téléchargé une archive dans <path>/mnt/gentoo</path>, vous pouvez à présent
l'effacer avec la commande <c>rm /mnt/gentoo/stage*.tar.bz2</c>.</p>
</body>
</section>
<section>
<title>Etapes pour les paquets/snapshots GRP</title>
<body>
<impo>Cette section ne concerne que ceux qui font une installation GRP.
Si vous n'utilisez pas GRP, passez à la section "Choix d'un miroir".</impo>
<p><b>Les utilisateurs de GRP</b> seront heureux d'apprendre qu'il y a un snapshot de
portage sur le Live CD. Ce snapshot vous permet d'éviter de faire un <c>emerge sync</c>
comme écrit plus tard dans cette documentation, étant donné qu'<c>emerge sync</c> requiert une
connexion réseau. Décompactez le snapshot comme suit :</p>
<pre caption="Utilisation du snapshot de Portage">
<comment>Remplacez AAAAMMJJ avec la date du fichier.</comment>
# <c>tar -xvjf /mnt/cdrom/snapshots/portage-AAAAMMJJ.tar.bz2 -C /mnt/gentoo/usr</c>
</pre>
<p>Cela va extraire le snapshot de l'arborescence de Portage dans votre
installation Gentoo toute fraîche. Avec cette manipulation, vous n'avez
plus besoin de vous connecter au réseau. Il vous faut à présent copier les
distfiles et les paquets depuis le Live CD comme ceci :</p>

<pre caption="Copier les fichiers GRP">
# <c>cp -R /mnt/cdrom/distfiles /mnt/gentoo/usr/portage/distfiles</c>
# <c>cp -a /mnt/cdrom/packages /mnt/gentoo/usr/portage/packages</c>
</pre>

<p>Tous les fichiers sont à présent à la bonne place.
Vous devriez avoir à présent tout ce qu'il vous faut pour poursuivre votre installation de
Gentoo Linux sans connexion réseau.</p>

</body>
</section>

<section>
<title>Selection d'un miroir (facultatif)</title>
<body>

<p>
<c>mirrorselect</c> est un outil destiné à sélectionner automatiquement le
miroir le plus rapide en fonction de votre localisation géographique. Vous
pouvez aussi choisir manuellement un miroir parmi la liste proposée. Cependant,
<c>mirrorselect</c>  ne fonctionne pas toujours très bien quand il est utilisé
derrière certains routeurs.</p>

<pre caption="Utilisation de mirrorselect">
<comment>Pour sélectionner un miroir automatiquement :</comment>
# <i>mirrorselect -a -s4 -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
<comment>Pour sélectionner un miroir interactivement :</comment>
# <i>mirrorselect -i -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<p>
Si <c>mirrorselect</c> ne fonctionne pas chez vous, poursuivez simplement la lecture de ce guide. Une des raisons pour lesquelles <c>mirrorselect</c> peut échouer est
simplement qu'il n'est pas encore installé. En effet, il n'est pas disponible sur tous les supports d'installation.
</p>

</body>
</section>

<section>
<title>Entrer dans le chroot</title>
<body>
<p>
Nous allons à présent faire un <c>chroot</c> vers l'installation de Gentoo Linux
afin de se placer &quot;dedans&quot;.
</p>

<note>
Vous pouvez ignorer les éventuels messages d'avertissement suite à <c>env-update</c> vous disant que 
<path>/etc/make.profile/make.defaults</path> n'est pas disponible. 
Le problème se résoudra quand nous ferons <c>emerge sync</c> un peu plus loin.
</note>

<pre caption="Préparer et entrer en chroot">
# <c>mount -t proc proc /mnt/gentoo/proc</c>
# <c>cp /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</c>
# <c>chroot /mnt/gentoo /bin/bash</c>
# <c>env-update</c>
Regenerating /etc/ld.so.cache...
# <c>source /etc/profile</c>
<comment>(La commande ci-dessus met à jour votre environnement et le chemin vers des binaires plus à jour.)</comment>
</pre>
<p>Après avoir exécuté ces commandes, vous serez à &quot;l'intérieur&quot; de
votre environnement Gentoo Linux dans <path>/mnt/gentoo</path>. Nous allons
continuer l'installation dans ce chroot.
</p>
</body>
</section>
</chapter>
<chapter>
<title>Obtenir la dernière version de Portage par le biais de sync</title>
<section>
<body>

<impo>Si vous faites une installation GRP, vous pouvez ignorer la section qui suit sur
<c>emerge sync</c>.</impo>

<p>Vous devez à présent faire un <c>emerge sync</c>. Cette commande demande à Portage
de télécharger la version la plus à jour de l'arborescence Portage de Gentoo Linux.
Si vous aviez extrait l'arborescence Portage de Gentoo Linux du <e>CD 1</e> plus tôt,
vous pouvez passer à l'étape suivante.  
Portage contient tous les scripts (appelés ebuilds) utilisés pour construire tous
les paquets sous Gentoo Linux. Nous avons actuellement des scripts pour
près de 4000 paquets. Une fois que vous avez terminé l'<c>emerge sync</c>,
l'arborescence complète de Portage se trouve dans <path>/usr/portage</path>.</p>


<pre caption="Mettre à jour en utilisant sync">
# <c>emerge sync</c>
</pre>

<p>
Si un avertissement vous affiche qu'une nouvelle version de Portage est disponible et
que vous devriez le mettre à jour, ignorez-le. Votre système n'est pas encore prêt
et Portage sera mis à jour automatiquement un peu plus tard. 
</p>

</body>
</section>
</chapter>
<chapter>
<title>Définir les optimisations Gentoo (make.conf)</title>
<section>
<body>

<p>Maintenant que vous possédez une bonne version de Portage, vous pouvez
passer à l'optimisation des paramètres de compilation sur votre système
Gentoo Linux. Portage utilisera ces paramètres lorsqu'il compilera
n'importe quel programme. Pour ce faire, éditez le fichier
<path>/etc/make.conf</path>. C'est ici que vous pouvez définir des options
pour <c>USE</c>. <c>USE</c> est une variable qui définit les fonctionnalités que vous désirez
activer lors de la compilation des sources ; vous pouvez bien entendu
la laisser par défaut (c-à-d. soit <e>vide</e> ou soit indéfinie) ce
qui ne devrait pas poser de problème. Pour plus d'informations sur <c>USE</c> et
son utilisation, consultez le <uri
link="http://www.gentoo.org/doc/fr/use-howto.xml">guide des paramètres de la
variable USE</uri>. Vous trouverez une liste complète des options de USE dans
le <uri link="http://www.gentoo.org/dyn/use-index.xml">tableau des paramètres
de USE</uri>.</p>

<p>Si vous partez de la première étape, vous devriez renseigner les variables <c>CHOST</c>,
<c>CFLAGS</c> et <c>CXXFLAGS</c> en fonction du type de système sur lequel vous
compilez (des exemples commentés se trouvent un peu plus bas dans le fichier).
</p>

<warn>
Si vous partez de la 2ème ou de la 3ème étape, ces variables sont déjà
renseignées et ne nécessitent aucune modification de votre part.  Dans ce cas,
la variable CHOST <e>ne doit pas</e> être modifiée, car cela rendrait votre
système inutilisable.
</warn>

<warn>
<b>Pour les utilisateurs expérimentés :</b> si vous comptez utiliser l'option
ACCEPT_KEYWORDS="~x86", attendez la fin de la première étape (stage1) avant de l'activer.
</warn>

<impo><b>Pour les utilisateurs expérimentés :</b> les variables <c>CFLAGS</c> et <c>CXXFLAGS</c>
sont utilisées pour indiquer au compilateur C et C++ comment optimiser le code qui est compilé sur votre
système. Il est courant de voir des utilisateurs d'Athlon XP spécifier "-march=athlon-xp"
comme valeur dans les variables CFLAGS et CXXFLAGS afin que tous les paquets soient optimisés pour
leur processeur. Le fichier <path>/etc/make.conf</path> contient un guide général avec les
valeurs pour les variables CFLAGS et CXXFLAGS.
</impo>

<p>Si vous êtes derrière un serveur de proximité (proxy), c'est également ici que vous le renseignez. Utilisez
la commande suivante pour éditer <path>/etc/make.conf</path> avec <c>nano</c>.
<c>nano</c> est un simple éditeur de texte.
</p>
<pre caption="Paramétrer les options du make.conf">
# <c>nano -w /etc/make.conf</c>
</pre>

<note>Pour les utilisateurs expérimentés :
les personnes qui désirent personnaliser quelque peu le processus de
compilation devraient consulter le fichier <path>/etc/make.globals</path>. Il intègre les options
par défaut de Gentoo Linux et ne doit pas être modifié. Si ces options ne vous
suffisent pas, vous devriez modifier <path>/etc/make.conf</path> dont les options
ont la <comment>priorité</comment> sur celles de
<path>make.globals</path>. Si vous désirez customiser les paramètres USE,
consultez <path>/etc/make.profile/make.defaults</path>. Si vous voulez être
sûr que USE n'utilise pas une des options, il vous suffit d'ajouter un
<c>USE=&quot;-foo&quot;</c> dans votre <path>/etc/make.conf</path> afin de
désactiver une <c>option</c> qui pourrait être activée par défaut dans votre
<path>/etc/make.globals</path> ou <path>/etc/make.profile/make.defaults</path>.
</note>
<warn>Assurez-vous de ne pas ajouter '<c>static</c>' à votre variable <c>USE</c> et ce
jusqu'à la fin de la première étape.</warn>
</body>
</section>
</chapter>
<chapter>
<title>Démarrage à partir de la première étape (stage 1)</title>
<section>
<body>
<note>Si vous ne commencez pas à partir de la première étape (stage1), passez au chapitre suivant.</note>
<p>
L'archive stage1 sert à optimiser complètement votre système. Si c'est celle
que vous avez séléctionnée, vous devriez alors posséder un système hyper-optimisé
et très à jour. Amusez-vous bien car l'optimisation est ce qui fait tout le
charme de Gentoo Linux ! Ce type d'installation prend néanmoins beaucoup de temps,
mais le résultat est un système optimisé dès le départ.
</p>
<p>Nous allons commencer par le &quot;bootstrap&quot;. Ce processus peut prendre
près de 2 heures sur un AMD Athlon 1200. Pendant ce temps, la bibliothèque C de GNU,
les outils de compilation ainsi que d'autres programmes essentiels du système seront
construits. Pour commencer le bootstrap, faites ce qui suit :</p>
<pre caption="Faire le bootstrap">
# <c>cd /usr/portage</c>
# <c>scripts/bootstrap.sh</c>
</pre>
<p>Le &quot;bootstrap&quot; va alors démarrer.
</p>
<note><c>bootstrap.sh</c> supporte à présent le paramètre <c>--fetchonly</c>.
Les utilisateurs qui ont une connexion rtc (modem) apprécieront. Il se chargera de télécharger tous
les fichiers nécessaires au bootstrap en une fois avant de procéder à la compilation.
Tapez <c>bootstrap.sh -h</c> pour plus d'informations.</note>

<note>
Portage utilise <c>/var/tmp</c> par défaut pendant ses compilations et il utilise
pour cela plusieurs centaines de méga-octets d'espace temporaire. Si vous
voulez changer l'endroit où portage mettra ses fichiers temporaires,
renseignez un nouveau PORTAGE_TMPDIR <e>avant</e> de commencer le processus de
bootstrap, comme ceci :
</note>
<pre caption="Changer le chemin vers le fichiers temporaires de Portage">
# <c>export PORTAGE_TMPDIR=&quot;/otherdir/tmp&quot;</c>
</pre>
<p><c>bootstrap.sh</c> va compiler <c>binutils</c>, <c>gcc</c>, <c>gettext</c>,
et <c>glibc</c> et recompiler <c>gettext</c>
après <c>glibc</c>. Nul besoin de dire que cela prend du temps.
Une fois ce processus terminé, votre système sera l'équivalent d'un
&quot;stage2&quot;, ce qui signifie que vous êtes prêt à passer à la deuxième étape (stage 2).
</p>
</body>
</section>
</chapter>
<chapter>
<title>Commencer à la deuxième étape et continuer la première</title>
<section>
<body>

<note>
Cette section concerne ceux qui viennent de terminer le stage1 ou qui commencent au stage2.
Si cela ne vous concerne pas (ex: vous utilisez le stage3), passez au chapitre
suivant.
</note>
<warn>
Si vous démarrez à partir de la deuxième étape, ne modifiez pas la variable
CHOST dans votre fichier <path>/etc/make.conf</path>. Cela pourrait provoquer
des résultats étranges et des erreurs de compilation incompréhensibles.
</warn>

<p>La seconde archive (stage 2) contient déjà le bootstrap complet pour vous éviter la peine
de le compiler vous-même. Il ne vous reste alors plus qu'à installer le reste du système.
</p>
<note>
Si vous démarrez depuis un stage2 pré-compilé et voulez vous assurer que vous
avez un set d'outils de compilation complètement à jour, ajoutez <c>-u</c>
aux commandes qui suivent. Si vous ne voyez pas l'intérêt (ne comprenez pas
ce qui suit), vous pouvez ignorer cette suggestion.
</note>

<pre caption="Installer le reste du système">
# <c>emerge -p system</c>
<comment>(liste les paquets qui restent à installer)</comment>
# <c>emerge system</c>
</pre>
 <p>
Ce processus va bien sûr prendre du temps vu qu'il installe la base
entière du système. Votre récompense sera un système complètement optimisé.
Le problème est qu'il va falloir trouver comment vous
occuper. L'auteur suggère &quot;StarWars - Super Bombad Racing&quot; pour PS2.
</p>
<p>
La compilation est maintenant terminée. Vous pouvez continuer et passez à la
section "Configuration de votre fuseau horaire".
</p>
</body>
</section>
</chapter>
<chapter>
<title>Démarrage à partir de la troisième étape (stage 3)</title>
<section>
<body>
<note>
Cette section est destinée aux personnes qui <b>commencent</b> avec le stage3, mais 
celles qui ont commencé avec un stage1 ou stage2 doivent ignorer ce chapitre.
Les utilisateurs de GRP devraient passer au chapitre suivant.
</note>

<warn>
Si vous démarrez à partir de la troisième étape, ne modifiez pas la variable
CHOST dans votre fichier <path>/etc/make.conf</path>. Cela pourrait provoquer
des erreurs de compilation.
</warn>

 <p>
Le tarball stage3 fournit un système Gentoo de base complètement fonctionnel.
Il n'y a donc rien à construire.
</p>
<note><b>Utilisateurs expérimentés :</b> votre système n'est sans doute pas le plus à jour possible.
 Si cela vous pose problème, vous pouvez le
mettre à jour en tapant ce qui suit : <br/>
<c>CONFIG_PROTECT="-* /etc/make.conf" emerge -u system</c>
(vous aurez bien sûr besoin d'une connexion réseau). Notez que cela peut prendre
un certain temps si le stage3 que vous avez est ancien. Dans le cas contraire, la mise
à jour devrait être rapide. Vous pouvez bien sûr passer cette section si vous n'en
voyez pas l'intérêt.
</note>
</body>
</section>
</chapter>
<chapter>
<title>Configuration de votre fuseau horaire</title>
<section>
<body>
<p>Il est maintenant temps de configurer votre fuseau horaire.</p>
<p>Regardez quel est votre fuseau horaire (ou GMT)
dans <path>/usr/share/zoneinfo</path> et créez ensuite un lien symbolique vers
/etc/localtime en tapant :</p>
<pre caption="Créer un lien symbolique pour votre fuseau horaire">
# <c>ln -sf /usr/share/zoneinfo/chemin/vers/fichiertimezone /etc/localtime</c>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Modifier /etc/fstab pour votre machine</title>
<section>
<impo>
Rappel : pour modifier un fichier, utilisez <c>nano -w "filename"</c>.
</impo>

<body>
<p>Votre système Gentoo Linux est quasiment prêt à fonctionner. Il ne vous reste plus
qu'à configurer quelques fichiers système importants et à installer le gestionnaire de
démarrage. Le premier fichier que vous aurez besoin de modifier est
<path>/etc/fstab</path>. Rappellez-vous bien d'utiliser l'option <c>notail</c>
pour votre partition de démarrage si vous utilisez ReiserFS. Notez également que
vous devez spécifier <c>ext2</c>, <c>ext3</c> ou <c>reiserfs</c>
selon le type de système de fichiers que vous avez créé plus tôt.
</p>
<warn>Vous pouvez vous inspirer de l'exemple de <path>/etc/fstab</path> ci-dessous, en
vous assurant de remplacer &quot;BOOT&quot;, &quot;ROOT&quot; et &quot;SWAP&quot;
par vos propres partitions (telles que <c>hda1</c>, etc.) et en indiquant les
systèmes de fichiers adéquats comme &quot;ext2&quot; ou &quot;ext3&quot;
</warn>

<pre caption="Editer fstab">
<comment># /etc/fstab: information des systèmes de fichiers.
#
# noatime désactive atimes afin d'améliorer les performances (atimes n'est généralement
# pas nécessaire ; notail améliore les performances de ReiserFS (avec une légère perte
# d'efficacité de stockage). Vous pouvez supprimer l'option noatime si vous voulez et
# utiliser notail ou tail sans contraintes.

# &lt;fs&gt;           &lt;mount point&gt;   &lt;type&gt;   &lt;opts&gt;          &lt;dump/pass&gt;

# NOTE: Si votre partition BOOT est en ReiserFS, ajoutez l'option notail à opts.
</comment>
/dev/BOOT           /boot       ext2	     noauto,noatime	   1 2
/dev/ROOT           /           reiserfs	 noatime           0 1
/dev/SWAP           none        swap	     sw                0 0
/dev/cdroms/cdrom0  /mnt/cdrom  iso9660	   noauto,ro,user    0 0
none                /proc       proc	     defaults          0 0
</pre>

<warn>Notez que <i>/boot</i> n'est pas monté au démarrage afin de protéger
les données qui s'y trouvent contre une éventuelle corruption. Si vous avez besoin d'y
accéder, montez la partition.
</warn>
</body>
</section>
</chapter>

<chapter>
<title>Installer le noyau et système de logs</title>
<section>
<title>Sélection du noyau</title>
<body>

<p>Il y a deux options pour installer un noyau. Vous pouvez soit installer le vôtre, soit utiliser la
commande <c>genkernel</c> pour configurer et compiler votre noyau de façon automatique.</p>

<p>Que vous configuriez votre noyau manuellement ou bien en utilisant <c>genkernel</c>, il
vous faudra faire un <c>emerge</c> du noyau linux que vous allez utiliser. Gentoo fournit
plusieurs types de sources de noyaux dont une liste est disponible dans le
<uri link="/doc/fr/gentoo-kernel.xml">guide du noyau</uri>. Si vous avez un doute, nous vous conseillons
alors d'utiliser <c>gentoo-sources</c>.
<!--or <c>vanilla-sources</c>.(2.4.21-vanilla has sound issues)-->
Si vous voulez le support XFS, vous devez alors prendre
<c>xfs-sources</c> ou <c>gs-sources</c>. Le Live CD Gentoo utilise
<c>gs-sources</c> et <c>xfs-sources</c>. Il y a également un noyau
<c>gaming-sources</c> qui est optimisé pour les joueurs qui ont besoin
d'une machine ayant du répondant, il vous faudra cependant activer l'option
"Preemptible kernel".
</p>

<p>Choisissez un kernel puis mergez-le de cette façon :</p>
<pre caption="Emerger le noyau gentoo-sources">
# <c>emerge -k sys-kernel/gentoo-sources</c>
</pre>

<p>Notez que <path>/usr/src/linux</path> est un lien symbolique vers votre
nouveau noyau automatiquement créé par Portage à la première installation d'un noyau.
Si vous avez plusieurs noyaux sur votre machine, il est important de vérifier que le lien symbolique
vers <path>/usr/src/linux</path> pointe vers le bon.
</p>
</body>
</section>
<section>
<title>Utilisation de genkernel pour compiler votre noyau</title>
<body>

<p>Maintenant que vous disposez des sources du noyau, vous pouvez le compiler. Il
y a deux façons de faire. La première consiste à utiliser <c>genkernel</c> qui
se chargera de construire automatiquement un noyau qui ressemblera trait pour trait
à celui du noyau du Live CD. Cela signifie donc que lorsque vous démarrerez votre
système avec ce nouveau noyau, il détectera tout le matériel présent sur le système.
Du fait que genkernel ne requiert pas d'intervention manuelle, il représente la
parfaite solution pour les utilisateurs qui sont ne sont pas à l'aise à l'idée de
compiler leur propre noyau.</p>

<p>Voyons à présent comment utiliser genkernel. Vous devez d'abord émerger l'ebuild : </p>

<pre caption="Emerger genkernel">
# <c>emerge -k genkernel</c>
</pre>

<p>Compilez à présent vos sources en lançant <c>genkernel</c>:</p>

<note><b>Utilisateurs expérimentés :</b> vous pouvez taper <c>genkernel --config</c>
pour paramétrer votre configuration de noyau avant que la compilation
ne démarre.</note>

<pre caption="Lancer genkernel">
<comment>Si vous utilisez genkernel 1.2 (inclus dans le set GRP 1.4-20030803), lancez :</comment>
# <i>genkernel gentoo-sources</i>
<comment>Si vous utilisez genkernel 1.4 ou plus récent, vous n'avez plus
besoin de spécifier de noyau, lancez alors :</comment>
# <i>genkernel</i>
Gentoo Linux genkernel, version 1.4
 Copyright 2003 Gentoo Technologies, Inc., Bob Johnson, Daniel Robbins
 Distributed under the GNU General Public License version 2
Settings:
compile optimization: 1 processor(s)
source tree: /usr/src/linux-2.4.20-gaming-r3
config: gentoo (customized)
config loc: /etc/kernels/config-2.4.20-gaming-r3
initrd config: (default) /etc/kernels/settings

* Running "make oldconfig"...                                                                     [ ok ]
* Logging to /var/log/genkernel.log...                                                            [ ok ]
* Starting 2.4.20-gaming-r3 build...                                                              [ ok ]
* Running "make dep"...                                                                           [ ok ]
* Running "make bzImage"...                                                                       [ ok ]
* Running "make modules"...                                                                       [ ok ]
* Running "make modules_install"...                                                               [ ok ]
* Moving bzImage to /boot/kernel-2.4.20-gaming-r3...                                              [ ok ]
* Building busybox...                                                                             [ ok ]
* Creating initrd...                                                                              [ ok ]

* Build completed successfully!

* Please specify /boot/kernel-2.4.20-gaming-r3 and /boot/initrd-2.4.20-gaming-r3
* when customizing your boot loader configuration files.
</pre>

<p>Un fois que <c>genkernel</c> a terminé, un noyau complet avec ses modules et
<i>le disque racine initial</i> (initrd) sont créés. Nous utiliserons ce noyau et son
initrd pendant la configuration du programme de démarrage. L'initrd sera lancé dès le
démarrage de la machine pour faire une auto-détection matérielle (tout comme le Live CD)
juste avant que votre système ne démarre.</p>

<p>Afin de terminer notre configuration qui ressemble comme deux goutes d'eau au Live CD,
émergeons hotplug. Alors qu'initrd détecte le matériel présent dans votre machine, hotplug se
charge de la détection du reste. Pour l'émerger et l'activer, tapez : </p>

<pre caption="Emerger et activer hotplug">
# <c>emerge -k hotplug</c>
# <c>rc-update add hotplug default</c>
</pre>

<p>Maintenant que vous avez généré et configuré votre noyau, vous pouvez ignorer la section
"Configuration manuelle du noyau" ci-dessous.</p>

<p>Les paquets nvidia-kernel, ati-drivers and xfree-drm nécessitent une configuration
supplémentaire. Tous les autres ebuilds devraient être détectés
automatiquement par le paquet hotplug au démarrage.</p>

<p>Etant donné que vous avez utilisé genkernel, vous pouvez passer la section
de "configuration manuelle du noyau" ci-dessous.</p>
</body>
</section>
<section>
<title>Configuration manuelle du noyau</title>
<body>

<p>Si vous avez décidé de ne pas utiliser genkernel pour compiler votre noyau, cette
section vous aide à paramétrer et à compiler un noyau manuellement. Veuillez noter
que <path>/usr/src/linux</path> est un lien symbolique vers votre noyau source qui a été généré
automatiquement par Portage lors de l'emerge. Si vous avez plusieurs sources de noyaux, il
vous faudra alors définir manuellement le lien symbolique vers <path>/usr/src/linux</path>.</p>

<warn>
Si vous configurez votre propre noyau, faites attention à l'option <i>grsecurity</i>. Trop d'agressivité
dans le paramétrage de la sécurtié risque d'empêcher certains programmes de fonctionner (tel que X).
Si vous avez un doute, ne l'utilisez pas.
</warn>

<note>
Si vous voulez la même configuration que le noyau du Live CD ou désirez baser votre configuration
sur celui-ci, vous devriez exécuter
<c>cd /usr/src/linux &amp;&amp; cat /proc/config > .config &amp;&amp; make oldconfig</c>.
Si vous n'utilisez pas <c>xfs-sources</c>, il vous posera quelques questions concernant les
différences entre votre noyau et les <c>xfs-sources</c>.
</note>

<pre caption="Compiler le noyau Linux">
# <c>cd /usr/src/linux</c>
# <c>make menuconfig</c>
</pre>
<warn>Si vous voulez que votre kernel fonctionne correctement, il y a quelques
options que vous devez obligatoirement intégrer, c'est-à-dire placer en dur dans
le kernel et pas en <i>modules</i>. Assurez-vous également d'avoir activé
&quot;ReiserFS&quot; si vous avez opté pour des partitions de ce type, le même conseil
s'applique si vous avez installé &quot;Ext3&quot;. Si vous utilisez XFS, activez cette
ligne : &quot;SGI XFS filesystem support&quot;. C'est toujours une bonne idée de laisser
ext2 activé que vous l'utilisiez ou pas. Voici quelques options que vous devez activer :
</warn>
<pre caption="options make menuconfig">
Code maturity level options ---&gt;
[*] Prompt for development and/or incomplete code/drivers&quot;
<comment>(Les options ci-dessous demandent celle-ci.)</comment>
 ...

File systems ---&gt;
&lt;*&gt; Reiserfs support
<comment>(Pour les utilisateurs de partitions reiserfs.)</comment>
 ...
&lt;*&gt; Ext3 journalling file system support
<comment>(Si vous avez des partitions ext3.)</comment>
 ...
[*] Virtual memory file system support (former shm fs)
<comment>(Nécessaire pour Gentoo Linux.)</comment>
 ...
&lt;*&gt; JFS filesystem support
<comment>(Pour les utilisateurs de JFS.)</comment>
 ...
[*] /proc file system support
<comment>(Nécessaire pour Gentoo Linux.)</comment>
[*] /dev file system support (EXPERIMENTAL)
[*] Automatically mount at boot
<comment>(Nécessaire pour Gentoo Linux.)</comment>
[ ] /dev/pts file system for Unix98 PTYs
<comment>(Désactivez cette option, vous n'en avez pas besoin sauf si vous utilisez un noyau 2.6)</comment>
 ...
&lt;*&gt; Second extended fs support
<comment>(Utile pour ceux qui utilisent ext2.)</comment>
 ...
&lt;*&gt; XFS filesystem support
<comment>(Pour les utilisateurs de XFS.)</comment>
</pre>
<p>Si vous utilisez PPPoE pour vous connecter à internet, vous aurez également
besoin des options suivantes (en dur dans le kernel ou de préférence en modules) :
&quot;PPP (point-to-point protocol) support&quot;, &quot;PPP support for async
serial ports&quot;, &quot;PPP support for sync tty ports&quot;.
Le fait de définir les deux compressions ne devrait pas poser de problèmes bien
que non nécessaires, et il en va de même pour l'option
&quot;PPP over Ethernet&quot; qui ne peut être utilisée que par <i>rp-pppoe</i>
lorsque vous le configurez pour faire du mode kernel PPPoE.
</p>
<p>Les possesseurs de graveur IDE auront besoin d'activer l'émulation SCSI dans le
kernel. Activez donc &quot;ATA/IDE/MFM/RLL support&quot; ---&gt; &quot;IDE, ATA et
ATAPI Block
devices&quot; ---&gt; &quot;SCSI emulation support&quot; (de préférence en
module), puis sous &quot;SCSI support&quot;, activez
&quot;SCSI support&quot;, &quot;SCSI CD-ROM
 support&quot; et &quot;SCSI generic support&quot; (ici encore, je préfère les
 modules). Si vous avez choisi les modules, faites ceci
<c>echo -e &quot;ide-scsi\nsg\nsr_mod&quot;&gt;&gt; /etc/modules.autoload.d/kernel-2.4</c>
pour que ce soit pris en compte au chargement de votre kernel.
</p>
<p>Si vous en avez besoin, n'oubliez pas d'ajouter le support pour votre
carte réseau dans le noyau.</p>
<note>
Pour les aventureux, il est également possible d'utiliser un noyau 2.2, mais
avec des conséquences : vous allez perdre beaucoup des nouvelles fonctionnalités
présentes dans les 2.4 (support XFS, tmpfs, iptables et plus encore),encore
que vous pouvez patcher un 2.2 avec le support ReiserFS et devfs.
Le script de démarrage de Gentoo Linux a besoin de tmpfs ou bien d'un support
de ramdisk en dur (pas en module). Il est <comment>vital</comment> d'ajouter
<e>gentoo=notmpfs</e> à la ligne du kernel dans
<path>/boot/grub/grub.conf</path> ou bien dans <path>/etc/lilo.conf</path>
pour les kernels 2.2 afin qu'un ramdisk soit monté pour les scripts de démarrage
à la place de tmpfs. Si vous n'utilisez pas devfs, vous devriez placer l'option
suivante : <e>gentoo=notmpfs,nodevfs</e>.
</note>
<pre caption = "Compilation et installation du noyau">
# <c>make dep &amp;&amp; make clean bzImage modules modules_install</c>
# <c>cp /usr/src/linux/arch/i386/boot/bzImage /boot</c>
</pre>
</body>
</section>
<section>
<title>Installer des modules pour du matériel spécifique</title>
<body>

<p>
Enfin, vous devez installer les ebuilds pour le matériel présent dans
votre machine. Voici une liste de modules du noyau dont vous pourriez avoir besoin :
</p>
<table>
<tcolumn width="1in"/>
<tcolumn width="4in"/>
<tcolumn width="2in"/>
<tr>
<th>Ebuild</th>
<th>Action</th>
<th>Commande</th>
</tr>
<tr>
<ti>nvidia-kernel</ti>
<ti>pilote NVIDIA accéléré pour XFree86</ti>
<ti><c>emerge -k nvidia-kernel</c></ti>
</tr>
<tr>
<ti>nforce-net</ti>
<ti>pilote pour les cartes réseau intégrées sur les cartes mères NVIDIA NForce(2)</ti>
<ti><c>emerge nforce-net</c></ti>
</tr>
<tr>
<ti>nforce-audio</ti>
<ti>pilote pour les cartes son intégrées aux cartes mères NVIDIA NForce(2)</ti>
<ti><c>emerge nforce-audio</c></ti>
</tr>
<tr>
<ti>e100</ti>
<ti>carte réseau Intel e100</ti>
<ti><c>emerge e100</c></ti>
</tr>
<tr>
<ti>e1000</ti>
<ti>carte réseau Intel e1000 Gigabit</ti>
<ti><c>emerge e1000</c></ti>
</tr>
<tr>
<ti>emu10k1</ti>
<ti>pilote son pour Creative Sound Blaster Live!/Audigy</ti>
<ti><c>emerge emu10k1</c></ti>
</tr>
<tr>
<ti>ati-drivers</ti>
<ti>pilote accéléré ATI Radeon 8500+/FireGL pour XFree86</ti>
<ti><c>emerge ati-drivers</c></ti>
</tr>
<tr>
<ti>xfree-drm</ti>
<ti>pilote accéléré ATI Radeon jusqu'à la 9200, Rage128,
Matrox, Voodoo et autres cartes pour XFree86</ti>
<ti><c>VIDEO_CARDS="votre_carte" emerge xfree-drm</c></ti>
</tr>
</table>
<p>
Les paquets <c>nvidia-kernel</c>, <c>ati-drivers</c> et <c>xfree-drm</c>
auront besoin d'être configurés. Les autres paquets listés ci-dessus devraient
être détectés automatiquement au démarrage par le module <c>hotplug</c>.
Si vous n'utilisez pas hotplug, vous devez ajouter les noms des modules
dans <path>/etc/modules.autoload.d/kernel-2.4</path>.
</p>

<p>
Vous trouverez plus d'information sur <c>xfree-drm</c> dans notre <uri
link="/doc/en/dri-howto.xml">Direct Rendering Guide</uri>.
</p>
</body>
</section>

<section>
<title>Installation d'un système de log</title>
<body>

<p>Votre noyau optimisé et ses modules sont à présent installés. Vous devez 
maintenant choisir un système de logs. Nous vous offrons la possibilité de choisir
entre sysklogd, généralement utilisé dans les autres distributions,
msyslog, syslog-ng et metalog.
En cas de doute, nous vous conseillons syslog-ng pour sa flexibilité et ses nombreuses
possibilités. Pour installer le système de logs de votre choix,
tapez <e>un</e> de ces quatre jeux de commandes :
</p>
<pre caption="Emerger votre système de logs">
# <c>emerge -k app-admin/sysklogd</c>
# <c>rc-update add sysklogd default</c>
<comment>ou</comment>
# <c>emerge -k app-admin/syslog-ng</c>
# <c>rc-update add syslog-ng default</c>
<comment>ou</comment>
# <c>emerge -k app-admin/metalog</c>
# <c>rc-update add metalog default</c>
<comment>ou</comment>
# <c>emerge -k app-admin/msyslog</c>
# <c>rc-update add msyslog default</c>
</pre>

<!--Renvoyer vers la FAQ quand elle sera à jour
<impo>
If you chose <c>metalogd</c>, please read <uri link="faq.xml#doc_chap6_sect3">the FAQ</uri> about metalogd's buffering.
</impo>
-->

<impo>
Metalog inscrit les résultats en blocs sur le disque, ce qui fait que les messages
ne sont pas directement inscrits dans le fichier de logs. Si vous voulez utiliser
l'inscription en direct des logs, vous pouvez envoyer à metalog un signal USR1
afin de désactiver temporairement son inscription retardée (afin que
<i>tail -f <path>/var/log/everything/current</path></i> inscrive en temps réel
comme vous l'espérez), et un signal USR2 afin de revenir en mode buffer. Si vous
voulez complètement le désactiver, vous pouvez changer cette option :
 METALOG_OPTS="-B" to METALOG_OPTS="-B -s" dans le fichier
 <path>/etc/conf.d/metalog</path>.
</impo>

<p>Vous devez à présent choisir un planificateur de tâches pour votre système. Nous vous
 offrons actuellement le choix entre dcron, fcron et vcron. Si vous ne savez pas lequel
 choisir vous pouvez vous tourner vers vcron. Voici comment en installer un :
</p>
<pre caption="Choisir un démon CRON">
# <c>emerge -k sys-apps/dcron</c>
# <c>rc-update add dcron default</c>
# <c>crontab /etc/crontab</c>
<comment>ou</comment>
# <c>emerge -k sys-apps/fcron</c>
# <c>rc-update add fcron default</c>
# <c>crontab /etc/crontab</c>
<comment>ou</comment>
# <c>emerge -k sys-apps/vcron</c>
# <c>rc-update add vcron default</c>
<comment>Pas besoin de mettre à jour <c>crontab /etc/crontab</c> si vous avez choisi vcron.</comment>
</pre>
 <p>Pour en savoir plus sur le démarrage des programmes et démons,
 consultez le <uri link="/doc/fr/rc-scripts.xml">guide sur les scripts d'initialisation</uri>.
</p>
</body>
</section>
</chapter>
<chapter>
<title>Installation de paquets divers nécessaires</title>
<section>
<body>
<p>Les utilisateurs de rp-pppoe doivent installer ce paquet car il n'a pas
encore été mis en place sur votre machine.</p>
<pre caption="Installer rp-pppoe">
# <c>USE="-X" emerge -k rp-pppoe</c>
<comment>Les utilisateurs de GRP doivent plutôt faire :</comment>
# <c>USE="-X" emerge -K rp-pppoe</c>
</pre>

<note>L'option <i>USE="-X"</i> évite à pppoe d'installer ses options pour X, ce qui
est une bonne chose, étant donné que X devrait alors être installé et nous ne l'avons
pas encore fait. Vous pouvez toujours recompiler <i>rp-pppoe</i> afin d'ajouter le
support pour X plus tard. La version GRP a été compilée avec le support pour X.
Si vous n'utilisez pas GRP, utilisez la première commande.
</note>
<note>Notez également que rp-pppoe est installé mais pas configuré. Il vous faudra en effet
taper <c>adsl-setup</c> lors du premier redémarrage pour le reconfigurer.
</note>
<p>Selon le système de fichiers utilisé, vous aurez sans doute besoin de quelques
paquets supplémentaires tels que XFS, ReiserFS ou LVM. Si vous utilisez XFS, vous
devriez émerger le paquet <c>xfsprogs</c> :
</p>
<pre caption="Emerger les outils pour systèmes de fichiers">
# <c>emerge -k xfsprogs</c>
<comment>Si vous utilisez ReiserFS, vous devriez émerger les outils ReiserFS : </comment>
# <c>emerge -k reiserfsprogs</c>
<comment>Si vous utilisez JFS, il vous faudra les outils JFS : </comment>
# <c>emerge -k jfsutils</c>
<comment>Si vous utilisez LVM, vous devriez émerger <c>lvm-user</c> : </comment>
# <c>emerge -k lvm-user</c>
</pre>
<p>Les utilisateurs de portables qui veulent utiliser leurs ports PCMCIA après le
premier démarrage devraient émerger le paquet <i>pcmcia-cs</i>.
</p>
<pre caption="Emerger PCMCIA-cs">
# <c>emerge -k sys-apps/pcmcia-cs</c>
</pre>
</body>
</section>

</chapter>
<chapter>
<title>Paramétrage des utilisateurs</title>
<section>
<title>Définir le mot de passe pour le super-utilisateur root</title>
<body>
<p>Avant que vous ne l'oubliiez, tapez un mot de passe pour le super-utilisateur
root en faisant : </p>
<pre caption="Paramétrage du mot de passe pour le super-utilisateur root">
# <c>passwd</c>
</pre>
</body>
</section>
<section>
<title>Ajouter un utilisateur pour une utilisation quotidienne</title>
<body>
<p>Travailler en tant que super-utilisateur sur un système Unix/Linux est
<e>dangereux</e> et devrait être évité autant que possible. Il est donc
<e>fortement</e> recommandé d'ajouter un utilisateur pour un usage
quotidien.</p>
<pre caption = "Ajouter un utilisateur">
# <i>useradd votre_utilisateur -m -G users,wheel,audio -s /bin/bash</i>
# <i>passwd votre_utilisateur</i></pre>
<p>Remplacez bien sûr <c>votre_utilisateur</c> par le nom que vous avez choisi.</p>
<p>Quand vous devrez accomplir une tâche qui ne peut être réalisée qu'en tant
que root, utilisez la commande <c>su -</c> afin de changer vos privilèges en
privilèges super-utilisateur, ou bien examinez le paquet <c>sudo</c>.</p>
</body>
</section>
</chapter>
<chapter>
<title>Paramétrage du nom de machine</title>
<section>
<body>
<p>Editez le fichier <path>/etc/hostname</path> pour qu'il contienne votre nom complet
de domaine sur une ligne, p.ex. <c>mamachine</c>.
</p>
<pre caption="Configurer votre nom de machine">
# <c>echo mamachine &gt; /etc/hostname</c>
</pre>

<p>
Ensuite, éditez le fichier <path>/etc/dnsdomainname</path> pour y indiquer votre nom de domaine,
p.ex. <c>mondomaine.com</c>.
</p>

<pre caption="Configurer votre nom de domaine">
# <i>echo mondomaine.com &gt; /etc/dnsdomainname</i>
</pre>

<p>
Si vous utilisez un domaine NIS, vous devez le spécifier dans <path>/etc/nisdomainname</path>.
</p>

<pre caption="Configurer votre domaine NIS">
# <i>echo nis.mondomain.com &gt; /etc/nisdomainname</i>
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Modification de votre /etc/hosts</title>
<section>
<body>
<p>Ce fichier contient une liste d'adresses IP associées à leur nom de machine.
Il est utilisé pour trouver les noms des machines qui ne se trouvent pas dans les DNS.
Voici un modèle :
</p>
<pre caption="Modèle pour /etc/hosts">
127.0.0.1   localhost
<comment># la ligne suivante devrait contenir votre adresse IP et son nom associé</comment>
192.168.1.1   mamachine.mondomaine.com   mamachine
</pre>
<note>Si vous utilisez DHCP, n'oubliez pas d'ajouter le nom de votre machine
après <i>localhost</i>. Cela aidera Gnome et d'autres programmes à faire une
résolution de noms qui soit correcte.
</note>
</body>
</section>
</chapter>
<chapter>
<title>Configuration finale du réseau</title>
<section>
<title>Charger les modules du noyau</title>
<body>
<p>Ajoutez les noms de tous les modules qui sont nécessaires au bon fonctionnement de
votre système dans le fichier <path>/etc/modules.autoload.d/kernel-2.4</path> (vous pouvez bien
évidemment spécifier les options nécessaires sur la même ligne). 
Ces modules seront automatiquement chargés au démarrage de votre machine. Dans la liste de
vos modules devrait se trouver celui de votre carte réseau, si vous l'avez compilé
en tant que module :
</p>
<pre caption="/etc/modules.autoload.d/kernel-2.4"><comment>Par exemple pour une carte 3com :
Vérifiez <path>/lib/modules/`uname -r`/kernel/drivers/net</path> pour trouver le module
de votre carte. </comment>
3c59x
</pre>
</body>
</section>
<section>
<title>Configurer votre interface réseau</title>
<body>
<p>Editez le fichier <path>/etc/conf.d/net</path> pour configurer correctement votre
carte au premier démarrage : </p>
<pre caption="Configuration de réseau au démarrage">
# <c>nano -w /etc/conf.d/net</c>
</pre>
<p>
Si vous voulez que votre première interface réseau, eth0, reçoive son adresse via DHCP,
indiquez <e>dhcp</e> pour l'option <c>iface_eth0</c>. Sinon, indiquez votre adresse IP, l'adresse 
de diffusion et le masque de réseau. Si vous avez plusieurs cartes réseau, faites de même pour
<c>eth1</c>, <c>eth2</c>,...</p>
<p>
Ajoutez maintenant le script d'initialisation <c>net.eth0</c> à votre runlevel par défaut ("default")
<e>si</e> ce n'est pas une carte PCMCIA.
</p>
<pre caption="Activer le réseau automatiquement au démarrage">
# <c>rc-update add net.eth0 default</c>
</pre>

<p>Si vous avez plusieurs cartes réseau, créez des scripts du type
<path>net.eth<comment>x</comment></path> pour chacune d'entre elles.
(<comment>x</comment> = 1, 2, ...): </p>

<pre caption="Plusieurs cartes réseau">
# <i>cd /etc/init.d</i>
# <i>ln -s net.eth0 net.eth<comment>x</comment></i>
# <i>rc-update add net.eth<comment>x</comment> default</i>
</pre>

<p>
Ajoutez maintenant chaque script d'initialisation <c>net.eth<comment>x</comment></c>
à votre runlevel par défaut ("default") <e>si</e> ce n'est pas une carte PCMCIA.
</p>
<pre caption="Activer les cartes réseau net.ethx automatiquement au démarrage">
# <c>rc-update add net.eth<comment>x</comment> default</c>
</pre>
</body>
</section>

<section>
<title>uniquement pour les utilisateurs de cartes PCMCIA</title>
<body>
<p>Si vous avez des cartes PCMCIA installées, regardez rapidement dans
<path>/etc/init.d/pcmcia</path> pour vérifier qu'il correspond à votre configuration
et entrez ensuite la commande suivante :
</p>
<pre caption="Activer les services PCMCIA au démarrage">
# <i>rc-update add pcmcia boot</i>
</pre>

<p>
Cela chargera les services PCMCIA chaque fois que les services réseau seront activés.
Le script <path>/etc/init.d/net.eth*</path> adéquat sera automatiquement exécuté.
</p>
</body>
</section>

</chapter>
<chapter>
<title>Etapes finales : édition de la configuration de base (en commençant par le paramétrage du clavier)</title>
<section>
<body>
<pre caption="Configuration de base">
# <c>nano -w /etc/rc.conf</c>
</pre>
<p>Suivez les indications dans le fichier pour savoir comment définir les options disponibles.
Tous les utisateurs devraient s'assurer que <c>CLOCK</c> est correctement paramétré.
Les utilisateurs de claviers internationaux doivent modifier la variable
<c>KEYMAP</c> (parcourez <path>/usr/share/keymaps</path> pour voir les options
disponibles).
</p>
</body>
</section>
</chapter>
<chapter>
<title>Configuration d'un gestionnaire de démarrage</title>
<section>
<title>Notes</title>
<body>
<p>
Conformément à l'esprit Gentoo, vous pouvez choisir parmi plusieurs gestionnaires
de démarrage. Choisissez donc entre GRUB ou LILO.
</p>
<p>Il est bien entendu inutile d'installer les deux gestionnaires sur le même système,
vous devrez donc choisir celui que vous allez utiliser.
</p>

<!-- This does not show up in the EN doc 
<impo>Si vous installez Gentoo Linux sur un système qui contient une NVIDIA nForce ou
nForce2 utilisant la carte graphique intégrée de type GeForce, vous devriez utiliser
LILO et éviter GRUB. Le fait d'utiliser la carte graphique intégrée utilise la mémoire
basse de votre RAM. Etant donné que GRUB en prends également, vous pourriez expérimenter
une erreur de type "out of memory" (plus de mémoire). Donc les possesseurs de cartes
vidéo intégrées devraient se tourner vers LILO.</impo>
-->

<p>
De plus, vous devrez configurer le gestionnaire de démarrage différemment selon que
vous utilisez <c>genkernel</c> (avec noyau et initrd) ou un noyau compilé manuellement.
Soyez attentif aux différences.
</p>

</body>
</section>
<section>
<title>Configuration de GRUB</title>
<body>
<p>La partie la plus importante dans GRUB est de le comprendre afin de se
sentir en confiance pour effectuer son installation sur son disque dur. Votre
partition Linux <path>/dev/hda1</path> s'appelle <path>(hd0,0)</path> sous
GRUB. Notez bien les parenthèses nécessaires autour du hd0,0. Les
disques durs commencent à 0 plutôt qu'à &quot;a&quot; et les partitions
également à 0 plutôt qu'à un. Notez également que seuls les disques durs sont
pris en compte et pas les périphériques atapi IDE de type lecteur CDROM ou
graveurs. Les disques SCSI comptent aussi, ils ont
généralement des chiffres plus élevés que ceux des disques durs IDE sauf
lorsque le BIOS est paramétré pour démarrer d'abord depuis des périphériques SCSI. En
considérant que vous avez un disque dur sur /dev/hda, un lecteur CDROM sur
/dev/hdb, un graveur sur /dev/hdc, un second disque dur sur /dev/hdd et aucun
lecteur SCSI, <path>/dev/hdd7</path> devient alors <path>(hd1,6)</path>.
Cela peut sembler complexe, ce qui est le cas, mais comme vous le verrez plus tard, GRUB offre
un mécanisme d'aide à la saise très utile pour ceux qui possèdent plusieurs
disques durs et encore plus de partitions et qui se perdent quelque peu dans la méthode de
numérotation. Vous êtes à présent prêt à installer GRUB.
</p>
<p>La façon la plus simple pour installer GRUB est de taper <c>grub</c> dans votre shell
en chroot : </p>
<pre caption="Installation de GRUB">
# <c>emerge -k grub</c>
# <c>grub</c>
</pre>
<p>Vous devriez alors vous retrouver en face du prompt <c>grub&gt;</c>. Il vous faut maintenant
taper les bonnes commandes pour installer le secteur de démarrage de GRUB. Dans notre exemple
de configuration, nous installons GRUB sur le MBR (premier secteur du disque dur) pour
que ce soit la première chose que l'ordinateur détecte au démarrage. Dans ce cas, les
commandes à taper sont :
</p>

<pre caption="GRUB sur le MBR">
grub&gt; <c>root (hd0,0)</c> <codenote>Votre partition boot</codenote>
grub&gt; <c>setup (hd0)</c> <codenote>Indique où installer le boot record, ici, dans le MBR</codenote>
</pre>

<pre caption="GRUB en dehors du MBR">
<comment>Si vous voulez installer GRUB ailleurs que sur le MBR</comment>
grub&gt; <c>root (hd0,0)</c> <codenote>Votre partition boot</codenote>
grub&gt; <c>setup (hd0,4)</c> <codenote>Indique où installer le boot record, ici sur /dev/hda5</codenote>
grub&gt; <c>quit</c>
</pre>

<p>Voici comment fonctionnent ces deux commandes. La première commande <c>root ( )</c>
indique à GRUB l'endroit où se trouve la partition de boot (dans notre exemple
<path>/dev/hda1</path> ou <path>(hd0,0)</path> en terminologie GRUB. La seconde commande
<c>setup ( )</c> indique à GRUB où installer le secteur de démarrage qui sera alors configuré
pour chercher ses fichiers de démarrage dans l'endroit <c>root ( )</c> que vous avez
spécifié. Dans mon cas, je veux le secteur de démarrage sur le MBR du disque dur, il me suffit donc
d'indiquer <path>/dev/hda</path> (également appellé <path>(hd0)</path>).
Si j'utilise un autre gestionnaire de démarrage et que je veux installer GRUB en tant que gestionnaire de
démarrage secondaire, je peux installer GRUB sur le secteur de démarrage d'une partition. Dans ce
cas, je spécifie une partition donnée plutôt que le disque dur entier. Une fois que le secteur de
démarrage de GRUB est installé, il ne reste qu'à taper <c>quit</c> pour sortir de GRUB.
</p>

<note>La complétion automatique (aide à la saisie) de GRUB peut être utilisée à l'intérieur même de
GRUB si vous l'avez paramétré en inscrivant <c> root (</c>, le fait d'appuyer sur TAB
devrait vous donner une liste des périphériques disponibles (et pas seulement les disques
durs). Si vous appuyez sur TAB après avoir inscrit <c> root (hd</c>, grub vous listera
alors les partitions accessibles sur le premier disque dur. Cette fonctionnalité devrait
vous aider à faire les bons choix sous GRUB et à paramétrer la bonne partition.
</note>

<p>
Gentoo Linux est à présent installé, mais nous devons maintenant créer un fichier
<path>/boot/grub/grub.conf</path> pour que GRUB puisse nous afficher un joli menu lors du prochain démarrage.</p>

<impo>Afin d'assurer une compatibilité avec les versions précédentes de GRUB, créez un lien
de <i>grub.conf</i> vers <i>menu.lst</i>. Vous pouvez le faire grâce à la commande
<c>ln -s /boot/grub/grub.conf /boot/grub/menu.lst </c>. </impo>

<p>Créez à présent le fichier grub.conf (<c>nano -w /boot/grub/grub.conf</c>) et ajoutez
ce qui suit :
</p>
<pre caption="grub.conf pour GRUB">
default 0
timeout 30
splashimage=(hd0,0)/boot/grub/splash.xpm.gz

<comment># si vous avez compilé votre propre noyau :</comment>
title=Mon exemple de Gentoo Linux
root (hd0,0)
kernel (hd0,0)/boot/bzImage root=/dev/hda3

<comment># si vous utilisez genkernel, utilisez ceci :</comment>
title=Mon exemple Gentoo Linux (genkernel)
root (hd0,0)
kernel (hd0,0)/boot/kernel-KV root=/dev/hda3
initrd (hd0,0)/boot/initrd-KV

<comment># Pour ceux possédant un dual-boot</comment>
title=Windows XP
root (hd0,5)
chainloader (hd0,5)+1
</pre>

<warn>
Remplacez <c>KV</c> par la version du noyau que vous avez installé.
</warn>

<note>
(hd0,0) s'écrit sans aucun espace entre les parenthèses.
</note>

<impo>
Si vous avez sélectionné l'émulation SCSI pour votre graveur IDE, vous devez ajouter l'option
&quot;hdx=ide-scsi&quot; sur la ligne <c>kernel</c> de grub.conf (où &quot;hdx&quot;
représente le périphérique servant à graver).
</impo>

<p>Après avoir sauvé ce fichier, votre installation Gentoo Linux est vraiment terminée.
En redémarrant, la sélection de la première option devrait amorcer votre Gentoo sans souci.
La seconde partie du fichier grub.conf est optionnelle et montre comment ajouter une ligne
pour démarrer un système dual-boot avec Windows.
</p>
<note>Dans l'exemple ci-dessus, <path>(hd0,0)</path> devrait pointer vers votre partition
&quot;boot&quot; (<path>/dev/hda1</path> dans notre exemple) et <path>/dev/hda3</path>
devrait pointer vers la partition root. <path>(hd0,5)</path> contient le secteur de démarrage
de NT.</note>
<note>
Le chemin vers l'image du noyau est relatif à la partition de démarrage. Si dans votre
cas vous avez séparé la partition de démarrage boot <path>(hd0,0)</path> et la partition
root <path>(hd0,1)</path>, tous les chemins dans le fichier grub.conf pointerons vers
<path>/bzImage</path>.
</note>
<p>Si vous avez besoin d'ajouter quelque option que ce soit à votre kernel, ajoutez-les
simplement à la fin de la commande <c>kernel</c>. Nous avons déjà ajouté une option
(<c>root=/dev/hda3</c>), mais vous pouvez en rajouter autant que vous voulez.
Si vous désirez par exemple désactiver devfs (pas recommandé à moins de savoir ce que
vous faites), ajoutez alors <c>gentoo=nodevfs</c> à la fin de la ligne <c>kernel</c>.
</p>
<note>Vous n'avez plus besoin d'ajouter l'option <c>devfs=mount</c> (comme c'était le cas
dans les versions précédentes de Gentoo) à la fin de votre ligne de <c>kernel</c>.
C'est maintenant fait automatiquement.
</note>
</body>
</section>
<section>
<title>Configuration de LILO</title>
<body>
<p>Bien que GRUB soit une meilleure solution pour la plupart des personnes, ce n'est pas toujours
le cas. LILO était utilisé bien avant GRUB et peut régler certains problèmes.
Voici comment installer LILO :
</p>
<p>La première étape : émerger LILO
</p>
<pre caption="Emerger LILO">
# <c>emerge -k lilo</c>
</pre>

<p>Ensuite, on le configure. Voici un fichier d'exemple de configuration
<path>/etc/lilo.conf</path>
</p>
<pre caption="Exemple de lilo.conf">
boot=/dev/hda
map=/boot/map
install=/boot/boot.b
prompt
timeout=50
lba32
default=linux

<comment># Si vous avez compilé votre propre noyau :</comment>
image=/boot/bzImage
label=linux
read-only
root=/dev/hda3

<comment># OU BIEN Si vous avez utilisé genkernel :</comment>
image=/boot/kernel-KV
label=gk_linux
root=/dev/hda3
initrd=/boot/initrd-KV
append="root=/dev/ram0 init=/linuxrc"

<comment># Pour les systèmes avec un dual boot</comment>
other=/dev/hda1
label=dos
</pre>

<warn>
Remplacez <c>KV</c> par la version du noyau que vous avez installé.
</warn>

<ul>
<li><i>boot=/dev/hda</i> indique à LILO de s'enregistrer sur le premier secteur d'amorçage IDE. </li>
<li><i>map=/boot/map</i> indique où trouver le fichier map. Il n'est généralement pas nécessaire de le modifier.</li>
<li><i>install=/boot/boot.b</i> indique à LILO d'installer ce fichier comme secteur de démarrage. Il n'est généralement pas nécessaire de le modifier, LILO utilisera <path>/boot/boot.b</path> par défaut.</li>
<li>Le paramètre <i>prompt</i> indique à LILO d'afficher <i>lilo:</i> au démarrage.  Il n'est pas recommandé de l'enlever, mais vous pouvez toujours l'obtenir en appuyant sur [Shift] quand votre machine démarre si vous l'avez supprimé.</li>
<li><i>timeout=50</i> indique au bout de combien de temps LILO sélectionne l'image par défaut. Cette valeur s'exprime en dixièmes de secondes, 50 étant la valeur par défaut.</li>
<li><i>lba32</i> indique la géométrie du disque à LILO. L'autre possibilité est linear. Ne la changez pas à moins de savoir ce que vous faites. Cela pourrait empêcher votre système de démarrer.</li>
<li><i>default=linux</i> indique le label du système qui sera utilisé par défaut.</li>
<li><i>image=/boot/bzImage</i> indique l'image utilisée par le boot.</li>
<li><i>label=linux</i> nomme le système d'exploitation sur l'écran lilo. Dans cet exemple précis, c'est également le nom de la ligne par défaut.</li>
<li><i>read-only</i> indique que la partition root (voir la ligne root ci-dessous) est en lecture seule et ne devrait en aucun cas être modifiée durant le démarrage.</li>
<li><i>root=/dev/hda3</i> indique à LILO quelle est la partition root (racine). </li>
</ul>

<p>Après avoir édité le fichier <i>lilo.conf</i>, il ne vous reste plus qu'à inscrire les
informations de LILO sur le MBR :
</p>
<pre caption="Exécuter LILO">
# <c>/sbin/lilo</c>
</pre>
<p>LILO est à présent configuré et votre système Gentoo Linux est prêt !
</p>
</body>
</section>
<section>
<title>Utilisation du framebuffer</title>
<body>
<p>
Les personnes qui veulent utiliser le framebuffer dans leur noyau doivent ajouter <c>vga=xxx</c>
dans leur fichier de configuration de démarrage. Remplacez <c>xxx</c> par une des valeurs ci-dessous :
</p>
<table>
<tr><ti></ti><th>640x480</th><th>800x600</th><th>1024x768</th><th>1280x1024</th></tr>
<tr><th>8 bpp</th><ti>769</ti><ti>771</ti><ti>773</ti><ti>775</ti></tr>
<tr><th>16 bpp</th><ti>785</ti><ti>788</ti><ti>791</ti><ti>794</ti></tr>
<tr><th>32 bpp</th><ti>786</ti><ti>789</ti><ti>792</ti><ti>795</ti></tr>
</table>
<p>
Les utilisateurs de LILO devront ajouter <c>vga=xxx</c> au début de leur fichier de configuration.
</p>
<p>
Les utilisateurs de GRUB devront ajouter <c>vga=xxx</c> à leur ligne <c>kernel
(hd0,0)...</c>.
</p>
</body>
</section>
</chapter>
<chapter>
<title>Création d'une disquette de démarrage</title>
<section>
<title>Disquette de démarrage GRUB</title>
<body>
<impo>
N'oubliez pas d'insérer une disquette dans votre lecteur avant de poursuivre.
</impo>
<p>C'est toujours une bonne idée de créer une disquette de démarrage la première fois que vous installez
une distribution Linux. Si vous utilisez du matériel qui
ne vous permet pas d'installer le gestionnaire de démarrage depuis l'environnement chroot,
vous <e>devez</e> créer une disquette de démarrage pour GRUB. Si c'est le cas,
lors du premier démarrage avec GRUB, vous installerez GRUB sur votre machine.
</p>
<pre caption="Création de la disquette de démarrage de GRUB">
# <i>cd /usr/share/grub/i386-pc/</i>
# <i>cat stage1 stage2 > /dev/fd0</i>
</pre>

<p>Redémarrez avec la disquette. Lors du prompt <c>grub&gt;</c>, vous pourrez
alors exécuter les commandes <c>root</c> et <c>setup</c>.</p>
</body>
</section>
<section>
<title>Disquette de démarrage LILO</title>
<body>
<impo>
N'oubliez pas d'insérer une disquette dans votre lecteur avant de poursuivre.
</impo>

<p>Si vous utilisez LILO, vous devriez aussi faire une disquette de démarrage :
</p>
<pre caption="Création d'une disquette de démarrage">
# <c>dd if=/boot/votre_noyau of=/dev/fd0 </c>
<comment>Ne marchera que si votre kernel fait moins que 1,4 Mo</comment>
</pre>
</body>
</section>
</chapter>
<chapter>
<title>Utilisation de GRP</title>
<section>
 <body>

<p>Les utilisateurs de GRP peuvent à présent installer des paquets binaires :</p>

<pre caption="Installation depuis GRP">
# <c>emerge -k xfree</c>
</pre>

 <p>Le CD 1 contient assez d'applications pour installer un système complètement fonctionnel
 avec XFree86. Le second CD GRP contient d'autres applications comme KDE, GNOME, Mozilla
 et autres. Pour installer ces paquets, vous aurez besoin de redémarrer votre nouvelle Gentoo
 (consultez le chapitre "Installation terminée !" ci-dessous.) Après avoir
 redémarré sur le disque dur, vous pouvez insérer le second CD et copier les fichiers :</p>

 <pre caption="Chargement des paquets binaires depuis le CD2">
# <c>mount /dev/cdrom /mnt/cdrom</c>
# <c>cp -a /mnt/cdrom/packages/* /usr/portage/packages/</c>
</pre>

 <p>Un grand nombre d'applications peuvent être installées de la même façon :</p>

 <pre caption="Installer KDE depuis le GRP">
# <c>emerge -k kde</c>
</pre>

 </body>
</section>
</chapter>
<chapter>
<title>Installation terminée !</title>
<section>
<body>
<p>Gentoo Linux est à présent installé. La dernière chose à faire est de mettre à jour les
fichiers de configuration et de sortir du shell chroot, démonter les partitions et redémarrer
le système.
</p>
<warn>
<c>etc-update</c> liste les fichiers de configuration qui sont plus récents que ceux actuellement
installés sur le système. Vérifiez qu'aucun de ces fichiers n'a un gros impact sur votre système
(comme <path>/etc/fstab</path>, <path>/etc/make.conf</path>, <path>/etc/rc.conf</path>, etc).
Mergez les fichiers qui sont secondaires,
effacez les mises à jour ou bien faites un diff et mettez les à jour manuellement.
</warn>

<pre caption="Redémarrage du système">
# <c>etc-update</c>
# <c>exit</c>
<comment>(Quitte le shell chroot; marche aussi avec <c>^D</c>)</comment>
# <c>cd / </c>
# <c>umount /mnt/gentoo/boot</c>
# <c>umount /mnt/gentoo/proc</c>
# <c>umount /mnt/gentoo</c>
# <c>reboot</c>
<comment>(N'oubliez pas d'enlever le CD amorçable)</comment>
</pre>
<note>
Après avoir redémarré, il est conseillé de faire un <c>modules-update</c> pour créer le
fichier <path>/etc/modules.conf</path>. Pensez à modifier les fichiers se trouvant dans
<path>/etc/modules.d</path> plutôt que de modifier directement <path>/etc/modules.conf</path>.
</note>

<p>Si vous avez des questions ou que vous désirez être actif dans le développement de Gentoo
Linux, vous pouvez vous inscrire sur les listes de diffusion gentoo-user et gentoo-dev (pour plus d'informations,
consultez la <uri link="http://www.gentoo.org/main/en/lists.xml">description des listes de diffusion</uri>). Nous avons
également rédigé un <uri link="http://www.gentoo.org/doc/fr/desktop.xml">guide de
configuration du bureau</uri> qui devrait vous aider à peaufiner votre nouvelle distribution
Gentoo Linux, ainsi qu'un <uri link="http://www.gentoo.org/doc/fr/portage-user.xml">guide
utilisateur de Portage</uri> afin de vous aider à vous familiariser avec les bases de Portage.
Vous pouvez trouver l'ensemble de la documentation
<uri link="http://www.gentoo.org/main/fr/docs.xml">sur notre index</uri>. Si vous avez d'autres questions,
pensez à consulter la <uri link="http://www.gentoo.org/doc/en/faq.xml">FAQ</uri>. 
Amusez-vous bien et bienvenue dans Gentoo Linux !
</p>
</body>
</section>
</chapter>
<!--
            Gentoo Stats is down currently. Commenting out for the
            time being. I've also changed double-dash to dash-space-dash
            because otherwise commenting fails.
	    
<chapter>
<title>Gentoo-Stats</title>
<section>
<body>
<p>Ce programme permet de donner aux développeurs une idée des statistiques d'utilisation
de Gentoo. Il collecte des informations sur Gentoo Linux afin de nous aider à placer des
priorités dans le développement. Son installation est complètement optionnelle mais nous
apprécions le geste si vous décidez de l'utiliser. Les statistiques sont consultables sur
<uri>http://stats.gentoo.org/</uri>.
</p>
<p>Le serveur gentoo-stats vous attribuera alors un numéro ID unique. Cette ID sera utilisée
pour assurer que chaque système n'est référencé qu'une seule fois. Elle ne sera en aucun cas
utilisée pour identifier individuellement votre système ou recenser une adresse IP ou toute
autre information personnelle. Voici ce que nous récupérons comme informations : </p>
<ul>
<li>Paquets installés et versions</li>
<li>Informations processeur : vitesse (MHz), revendeur , type, options (tel &quot;mmx&quot;
ou &quot;3dnow&quot;)</li>
<li>Informations Mémoire (total disponible de RAM et de swap)</li>
<li>Cartes PCI et cartes réseau</li>
<li>Le profil Gentoo utilisé par votre machine (l'endroit où pointe votre
/etc/make.profile).</li>
</ul>
<p>Nous sommes sensible au fait que ces informations sont importantes et ne doivent être divulguées
(ce qui reflète la pensée des développeurs).
</p>
<ul>
<li>A moins que vous ne modifiez le programme gentoo-stats, il ne transmettra jamais
d'informations sensibles telles que vos mots de passe, vos données, votre taille de
chaussures ...</li>
<li>La transmission de votre adresse email est optionnelle et désactivée par défaut.</li>
<li>Votre adresse IP ne sera jamais divulguée de façon à vous identifier. Nous n'enregistrons
pas de corrélation entre &quot;Adresse IP/ID système&quot;.</li>
</ul>
<p>L'installation est simple, comme suit :
</p>
<pre caption="Installation de gentoo-stats">
# <c>emerge gentoo-stats</c> <codenote>Installe gentoo-stats</codenote>
# <c>gentoo-stats - -new</c><codenote>Obtient une nouvelle ID système</codenote>
</pre>
<p>La seconde commande demande une ID qu'elle place ensuite dans
<path>/etc/gentoo-stats/gentoo-stats.conf</path> automatiquement. Vous pouvez ensuite
éditer ce fichier pour consulter les autres options disponibles.
</p>
<p>Configurez ensuite ce programme pour tourner à intervalle régulière (sans
avoir besoin d'être root) en éditant votre <path>crontab</path>:
</p>
<pre caption="Mettre à jour gentoo-stats avec cron">
<c>0 0 * * 0,4 /usr/sbin/gentoo-stats - -update &gt; /dev/null</c>
</pre>
<p>Le programme <c>gentoo-stats</c> est un simple script perl qui peut être édité avec
votre programme favori en ouvrant : <path>/usr/sbin/gentoo-stats</path>.</p>
</body>
</section>
</chapter>

-->

<chapter>
<title>Gentoo sur du matériel moins répandu</title>
<section>
 <title>Matériel RAID ATA</title>
 <body>
 <p>
 Les utilisateurs qui veulent installer Gentoo sur des machines équipées
 de cartes RAID ATA devront prendre en compte les étapes suivantes
 afin de réussir leur paramétrage :
 </p>
 <ul>
 <li>Démarrez le LiveCD avec l'option de noyau <c>doataraid</c>.</li>
 <li>Si vous avez oublié de sélectionner l'option <c>doataraid</c> lors de l'amorçage,
 ou bien si les modules ont mystérieusement oublié de se charger, chargez les comme
 ceci :
 <pre caption = "Chargement des modules RAID">
# <i>modprobe ataraid</i>
<comment>Pour les cartes Promise : </comment>
# <i>modprobe pdcraid</i>
<comment>Pour les cartes Highpoint :</comment>
# <i>modprobe hptraid</i>
 </pre>
 </li>
 <li>Certains controleurs RAID ATA nécessitent un redémarrage après avoir fini
 le partitionnement ; le formatage de pourra se faire sans cette étape.</li>
 <li>Avant de faire un chroot, montez l'arborescence dans le nouvel environnement
 comme ceci :
 <pre caption = "Montage de /dev dans /mnt/gentoo/dev">
# <i>mount -o bind /dev /mnt/gentoo/dev</i>
 </pre>
 </li>
 <li>Lors de la configuration du noyau, selectionnez les bonnes options RAID :
 <pre caption = "Paramétrage du RAID dans la configuration du noyau">
<comment>Pour les controleurs RAID Highpoint :</comment>
ATA/IDE/MFM/RLL support---&gt;
[*] HPT36X/37X chipset support
[*] Support for IDE Raid controllers
[*] Highpoint 370 software RAID
<comment>Pour les controleurs RAID Promise :</comment>
ATA/IDE/MFM/RLL support---&gt;
[*] PROMISE PDC202{46|62|65|67} support
<comment>et / ou</comment>
[*] PROMISE PDC202{68|69|70|71|75|76|77} support
[*] Support for IDE Raid controllers
[*] Support Promise software RAID (Fasttrak(tm))
 </pre></li>
 <li>Lors de l'installation de GRUB, ajoutez <c>--stage2=/boot/grub/stage2</c>
 à l'exécution de la commande <c>setup</c> :
 <pre caption = "Installation de GRUB sur des systèmes équipés de controleurs RAID">
grub&gt; <i>root (hd0,0)</i>
grub&gt; <i>setup --stage2=/boot/grub/stage2 (hd0)</i>
grub&gt; <i>quit</i>
 </pre>
Toujours dans la configuration de GRUB, assurez-vous d'indiquer le bon
périphérique RAID sur la ligne <c>root</c> :
 <pre caption = "grub.conf sur RAID">
title=Ma Gentoo Linux sur RAID
root (hd0,0)
kernel (hd0,0)/boot/bzImage root=/dev/ataraid/dXpY
 </pre></li>
 <li>Les utilisateurs de LILO devraient aussi s'assurer que <c>root</c> soit bien
 paramétré :
 <pre caption = "lilo.conf sur RAID">
image=/boot/bzImage
label=linux
read-only
root=/dev/ataraid/dXpY
 </pre></li>
 </ul>
 <p>Si vous avez des problèmes pour installer Gentoo Linux sur votre machine équipée
 de RAID, veuillez le signaler <uri link="http://bugs.gentoo.org">ici</uri>.</p>

 <p>Nous vous remercions d'utiliser Gentoo et vous souhaitons beaucoup de plaisir avec votre
 nouvelle installation !</p>
 </body>
 </section>
</chapter>
</guide>

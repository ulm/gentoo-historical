<?xml version="1.0" encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/gentoolkit.xml,v 1.4 2005/01/14 11:26:48 neysx Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/fr/gentoolkit.xml" lang="fr">
<title>Gentoolkit</title>

<author title="Auteur">
  <mail link="mbutcher@aleph-null.tv">Matt Butcher</mail>
</author>
<author title="Correcteur">
  <!-- zhen@gentoo.org -->John P. Davis
</author>
<author title="Correcteur">
  <mail link="erwin@gentoo.org">Erwin</mail>
</author>
<author title="Correcteur">
  <mail link="fox2mike@gmail.com">Shyam Mani</mail>
</author>
<author title="Correcteur">
  <mail link="neysx@gentoo.org">Xavier Neys</mail>
</author>
<author title="Traducteur">
  <mail link="ribosome@gentoo.org">Olivier Fisette</mail>
</author>

<!-- Licensed under GFDL -->

<abstract>
Gentoolkit est un ensemble d'outils qui facilitent l'administration d'un
système Gentoo. La lecture de ce document vous fournira les bases nécessaires
à l'utilisation de quelques-uns de ces outils.
</abstract>

<version>1.5</version>
<date>2004-12-27</date>

<chapter>
<title>Introduction</title>
<section>
<title>Qu'est Gentoolkit&nbsp;?</title>
<body>

<p>
Gentoo est une distribution Linux tout à fait unique&nbsp;; cela engendre des
complexités qu'on ne rencontre pas avec les autres distributions. Lorsque les
développeurs et contributeurs Gentoo ont découvert ces complexités, ils ont
écrit des outils permettant de les contourner. Plusieurs de ces outils ont été
intégrés au projet Gentoo et font partie du paquet
<c>app-portage/gentoolkit</c>.
</p>

<note>
Il existe à l'heure actuelle deux versions de gentoolkit&nbsp;:
<c>app-portage/gentoolkit</c> et <c>app-portage/gentoolkit-dev</c>. La première
contient des scripts servant à l'administration système alors que la seconde
rassemble des scripts facilitant le développement de Gentoo. Le présent
document ne discutera que de gentoolkit.
</note>

<p>
Gentoolkit contient un bon nombre d'outils qui vous aideront à gérer vos
paquets et à garder la trace de ce qui se passe sur votre système. La plupart
des utilisateurs (et plus particulièrement ceux qui mettent à jour leur système
fréquemment) trouveront gentoolkit utile.
</p>

</body>
</section>
<section>
<title>Installation</title>
<body>

<p>
Comme pour n'importe quel paquet Gentoo, l'installation ne nécessite qu'une
commande&nbsp;:
</p>

<pre caption="Installer gentoolkit">
# <i>emerge gentoolkit</i>
</pre>

<note>
Plusieurs outils de gentoolkit révèlent des informations importantes sur votre
système ou requièrent les privilèges du super-utilisateur (root). Pour ces
raisons, certains de ces programmes ne peuvent être exécutés que par un
utilisateur disposant des permissions root alors que d'autres ne fonctionneront
correctement que s'ils sont exécutés par un utilisateur disposant de ces
permissions.
</note>

</body>
</section>
<section>
<title>Trouver la documentation</title>
<body>

<p>
Toute documentation relative à un programme gentoolkit (à part les pages man)
se trouve dans <path>/usr/doc/gentoolkit-[version]/[nom-du-programme]/</path>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>equery</title>
<section>
<title>Introduction</title>
<body>

<p>
L'outil <c>equery</c> offre plusieurs des fonctionnalités fournies par
<c>epm</c> (et par l'outil <c>qpkg</c> maintenant obsolète) tout en ajoutant
ses propres fonctions qui le rendent particulièrement utile. <c>equery
--help</c> vous donnera la liste complète des options. À terme, <c>equery</c>
remplacera complètement <c>etcat</c>.
</p>

<note>
Les fonctionnalités listées par <c>equery --help</c> ne sont pas toutes
implémentées pour l'instant. Celles qui ne le sont pas sont clairement
indiquées comme telles.
</note>

</body>
</section>
<section>
<title>Obtenir la taille d'un paquet</title>
<body>

<p>
Vous êtes-vous déjà demandé quel espace disque occupe un de vos paquets&nbsp;?
Puisqu'un paquet peut installer des fichiers dans plus d'un répertoire, la
commande habituelle <c>du -hc</c> ne vous renseignera pas correctement. Pas
d'inquiétude, <c>equery</c> est là pour vous aider&nbsp;!
</p>

<pre caption="Obtenir la taille d'un paquet">
# <i>equery size openoffice-bin</i>
* app-office/openoffice-bin-1.1.2
	   Total Files : 2908
	   Total Size  : 223353.31 KiB
</pre>

<p>
Comme vous pouvez le voir, <c>equery</c> donne à la fois l'espace disque total
occupé en kilo octets et le nombre de fichiers du paquet.
</p>

</body>
</section>
<section>
<title>Liste des options USE d'un paquet</title>
<body>

<p>
<c>equery</c> peut être utilisé pour obtenir de l'information sur les options
USE utilisées par un paquet donné. Il vous indiquera les options USE utilisées
lors de l'installation du paquet, et aussi toutes les options USE disponibles
pour ce paquet.
</p>

<pre caption="Paramétrer les options USE">
# <i>equery uses ethereal</i>
[ Colour Code : set unset ]
[ Legend    : (U) Col 1 - Current USE flags        ]
[           : (I) Col 2 - Installed With USE flags ]

 U I [ Found these USE variables in : net-analyzer/ethereal-0.10.6 ]
 - - adns  : Adds support for the adns DNS client library
 + + gtk   : Adds support for x11-libs/gtk+ (The GIMP Toolkit)
 - - ipv6  : Adds support for IP version 6
 - - snmp  : Adds support for the Simple Network Management Protocol if available
 + + ssl   : Adds support for Secure Socket Layer connections
 + + gtk2  : Use gtk+-2.0.0 over gtk+-1.2 in cases where a program supports both.
 - - debug : Tells configure and the makefiles to build for debugging. Effects vary across packages,
             but generally it will at least add -g to CFLAGS. Remember to set FEATURES=nostrip too
</pre>

<p>
On constate dans l'exemple précédent que seules les options USE gtk, ssl et
gtk2 étaient actives lorsque j'ai installé ethereal, mais que d'autres options
USE sont utilisées par ce paquet (adns, ipv6, snmp et debug). Pour en savoir
plus sur les options USE, consultez le chapitre <uri
link="/doc/fr/handbook/handbook-x86.xml?part=2&amp;chap=2">La variable
USE</uri> du <uri link="/doc/fr/handbook/">Manuel Gentoo</uri>.
</p>

</body>
</section>
<section>
<title>Où se trouve cet ebuild&nbsp;?</title>
<body>

<p>
<c>equery</c> peut également être utilisé pour trouver l'ebuild associé à un
paquet donné. Pour ce faire, utilisez la commande <c>equery which</c> qui donne
le chemin d'accès complet de l'ebuild en question.
</p>

<pre caption="Afficher le chemin d'accès d'un ebuild">
# <i>equery which cdrtools</i>
/usr/portage/app-cdr/cdrtools/cdrtools-2.01_alpha37.ebuild
</pre>

</body>
</section>
<section>
<title>Graphe des dépendances</title>
<body>

<p>
Grâce à <c>equery</c>, vous pouvez afficher un graphe des dépendances d'un
paquet. Ce graphe contient tous les paquets qui sont des dépendances directes
ou indirectes du paquet donné.
</p>

<pre caption="Graphe des dépendances de cdrtools">
# <i>equery depgraph cdrtools</i>
Displaying dependencies for app-cdr/cdrtools-2.01_alpha37
`-- app-cdr/cdrtools-2.01_alpha37
 `-- sys-libs/glibc-2.3.4.20040808 (virtual/libc)
  `-- sys-kernel/linux-headers-2.4.22 (virtual/os-headers)
   `-- sys-apps/baselayout-1.10.4
    `-- sys-apps/sysvinit-2.85-r1
     `-- sys-apps/gawk-3.1.3-r1
      `-- sys-apps/util-linux-2.12-r4
          `-- sys-apps/sed-4.0.9
	      `-- sys-libs/ncurses-5.4-r4
	          `-- sys-apps/pam-login-3.14
	          `-- sys-libs/pam-0.77-r1
                 `-- sys-libs/cracklib-2.7-r10
               `-- sys-apps/miscfiles-1.3-r1
              `-- app-arch/gzip-1.3.5-r1
              `-- sys-apps/portage-2.0.50-r10
</pre>

<p>
Dans l'exemple précédent, on voit que glic est une dépendance directe de
cdrtools alors que linux-headers est une dépendance indirecte.
</p>

</body>
</section>
</chapter>

<chapter>
<title>euse</title>
<section>
<title>Introduction</title>
<body>

<p>
L'outil <c>euse</c> sert à consulter la variable USE et à ajouter et retirer
des options à cette variable, et ce à différents endroits sur votre système.
Pour plus d'informations sur les options USE, consultez le chapitre <uri
link="/doc/fr/handbook/handbook-x86.xml?part=2&amp;chap=2">La variable
USE</uri> du <uri link="/doc/fr/handbook/">Manuel Gentoo</uri>. <c>euse -i</c>
donne une liste de toutes les options USE.
</p>

</body>
</section>
<section>
<title>Consulter, ajouter et retirer des paramètres USE</title>
<body>

<p>
La commande <c>euse --conf</c> lit la configuration actuelle des options USE
qui sont activées ou désactivées dans le fichier make.conf.
</p>

<pre caption="Consulter les options paramétrées dans make.conf">
# <i> euse --conf</i>
USE setting in make.conf:
alsa acpi apache2 cups cdr crypt cscope -doc ethereal fbcon gif gimpprint gnome
gpm gstreamer gtk2 gtkhtml imlib imlib2 innodb -java javascript jpeg libg++ libwww
mad md5sum mikmod mmx motif mozilla mpeg mpeg4 mysql ncurses oggvorbis odbc
offensive opengl pam pdflib perl png python quicktime readline sdl spell sse ssl
svga tcltk tiff truetype usb vanilla X xml2 xmms xosd xv xvid x86 zlib
</pre>

<p>
Activer une option USE se fait avec la commande <c>euse --enable</c> qui doit
obligatoirement être suivie du nom d'une option. Si cette option n'est pas déjà
activée, <c>euse</c> l'ajoute à la fin de la variable USE dans les paramètres
courants. Si l'option est invalide, un avertissement est affiché.  Retirer une
option se fait avec <c>euse --disable</c>. Si l'option choisie est invalide,
l'utilisateur est averti. Si l'option était active, elle est explicitement
désactivée avec la syntaxe -option dans make.conf.
</p>

<pre caption="Exemple d'activation de l'option USE 3dfx">
# <i>euse --enable 3dfx</i>
USE setting in make.conf after enabling:
alsa acpi apache2 cups cdr crypt cscope -doc ethereal fbcon gif gimpprint gnome
gpm gstreamer gtk2 gtkhtml imlib imlib2 innodb -java javascript jpeg libg++ libwww
mad md5sum mikmod mmx motif mozilla mpeg mpeg4 mysql ncurses oggvorbis odbc
offensive opengl pam pdflib perl png python quicktime readline sdl spell sse ssl
svga tcltk tiff truetype usb vanilla X xml2 xmms xosd xv xvid x86 zlib 3dfx
</pre>

<pre caption="Exemple de désactivation de l'option USE 3dfx">
# <i>euse --disable 3dfx</i>
USE setting in make.conf after disabling:
alsa acpi apache2 cups cdr crypt cscope -doc ethereal fbcon gif gimpprint gnome
gpm gstreamer gtk2 gtkhtml imlib imlib2 innodb -java javascript jpeg libg++ libwww
mad md5sum mikmod mmx motif mozilla mpeg mpeg4 mysql ncurses oggvorbis odbc
offensive opengl pam pdflib perl png python quicktime readline sdl spell sse ssl
svga tcltk tiff truetype usb vanilla X xml2 xmms xosd xv xvid x86 zlib -3dfx
</pre>

<note>
<c>euse</c> ne supprime pas réellement les options de make.conf&nbsp;; il les
préfixe simplement avec - (moins) afin de les désactiver. Vous souhaiterez
peut-être nettoyer manuellement votre make.conf pour retirer les options non
désirées.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Autres outils</title>
<section>
<title>revdep-rebuild</title>
<body>

<p>
Cet outil est le «&nbsp;reconstructeur des dépendances inverses&nbsp;» de
Gentoo. Il examine les ebuilds installés sur votre système pour trouver ceux
qui ne fonctionnent plus à cause de la mise à jour de paquets dont ils
dépendent. Il peut aussi installer ces paquets manquants pour vous, mais
lorsqu'un paquet ne fonctionne plus avec les versions des dépendances déjà
installées, il est conseillé de mettre à jour ce paquet vers une version
récente. Si vous spécifiez des options, revdep-rebuild les passera à la
commande emerge, ce qui vous permet d'utiliser l'option <c>--pretend</c> pour
consulter la liste des paquets qui seront installés avant de procéder.
</p>

<pre caption="Exécuter revdep-rebuild en mode « pretend »">
# <i>revdep-rebuild -p</i>

Checking reverse dependencies...
Packages containing binaries and libraries broken by any package update,
will be recompiled.

Collecting system binaries and libraries... done.
  (/root/.revdep-rebuild.1_files)

Collecting complete LD_LIBRARY_PATH... done.
  (/root/.revdep-rebuild.2_ldpath)

Checking dynamic linking consistency...
  broken /usr/lib/ao/plugins-2/libarts.so (requires libartsc.so.0)
  broken /usr/lib/kde3/libkpresenterpart.so (requires libartskde.so.1 libqtmcop.so.1
         libsoundserver_idl.so.1 libkmedia2_idl.so.1 libartsflow.so.1 libartsflow_idl.so.1 libmcop.so.1)
  broken /usr/lib/ruby/site_ruby/1.8/i686-linux/fox.so (requires libFOX-1.0.so.0)
  broken /usr/lib/xine/plugins/1.0.0/xineplug_ao_out_arts.so (requires libartsc.so.0)
  broken /usr/lib/perl5/vendor_perl/5.8.0/i686-linux/auto/SDL_perl/SDL_perl.so (requires libSDL_gfx.so.0)
  broken /usr/lib/libloudmouth-1.so.0.0.0 (requires libgnutls.so.10)
  broken /usr/bin/k3b (requires libartskde.so.1 libqtmcop.so.1 libsoundserver_idl.so.1 libkmedia2_idl.so.1
         libartsflow.so.1 libartsflow_idl.so.1 libmcop.so.1)
  broken /usr/bin/lua (requires libhistory.so.4)
  broken /usr/bin/lyx (requires libAiksaurus-1.0.so.0)
  broken /usr/bin/luac (requires libhistory.so.4)
  broken /usr/bin/avidemux2 (requires libartsc.so.0)
  broken /usr/bin/pptout (requires libxml++-0.1.so.11)
  broken /usr/bin/xml2ps (requires libxml++-0.1.so.11)
 done.
  (/root/.revdep-rebuild.3_rebuild)

Assigning files to ebuilds... done.
  (/root/.revdep-rebuild.4_ebuilds)

Evaluating package order... done.
  (/root/.revdep-rebuild.5_order)

All prepared. Starting rebuild...
emerge --oneshot --nodeps -p =app-cdr/k3b-0.11.14 =app-office/koffice-1.3.2 =app-office/lyx-1.3.4 \
       =app-office/passepartout-0.2 =dev-lang/lua-5.0.2 =dev-ruby/fxruby-1.0.29 =media-libs/libao-0.8.5 \
       =media-libs/xine-lib-1_rc5-r3 =media-video/avidemux-2.0.26 =net-libs/loudmouth-0.16

These are the packages that I would merge, in order:

Calculating dependencies ...done!
[ebuild   R   ] app-cdr/k3b-0.11.14
[ebuild   R   ] app-office/koffice-1.3.2
[ebuild   R   ] app-office/lyx-1.3.4
[ebuild   R   ] app-office/passepartout-0.2
[ebuild   R   ] dev-lang/lua-5.0.2
[ebuild   R   ] dev-ruby/fxruby-1.0.29
[ebuild   R   ] media-libs/libao-0.8.5
[ebuild   R   ] media-libs/xine-lib-1_rc5-r3
[ebuild   R   ] media-video/avidemux-2.0.26
[ebuild   R   ] net-libs/loudmouth-0.16

Now you can remove -p (or --pretend) from arguments and re-run revdep-rebuild.
</pre>

<p>
Si vous devez reconstruire certains paquets, vous pouvez exécuter
<c>revdep-rebuild</c> sans l'option <c>-p</c>. Tous les paquets listés seront
réinstallés.
</p>

</body>
</section>

<section>
<title>glsa-check</title>
<body>

<p>
<c>glsa-check</c> sert essentiellement à garder un œil sur les GLSA (les
Recommandations Gentoo Linux sur la sécurité, en anglais «&nbsp;Gentoo Linux
Security Advisories&nbsp;»). Les fonctions de <c>glsa-check</c> seront
incorporées à <c>emerge</c> et <c>equery</c> plus tard. Pour plus
d'informations, visitez la page <uri
link="/proj/en/portage/glsa-integration.xml">Portage GLSA Integration</uri> (en
anglais).
</p>

</body>
</section>
</chapter>

</guide>

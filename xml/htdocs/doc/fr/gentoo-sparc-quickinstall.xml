<?xml version="1.0" encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fr/Attic/gentoo-sparc-quickinstall.xml,v 1.1 2005/02/12 20:57:51 cam Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="gentoo-sparc-quickinstall.xml">
<title>Référence pour l'installation rapide de Gentoo Linux sur architecture
SPARC</title>

<author title="Auteur">
  <mail link="ciaranm@gentoo.org">Ciaran McCreesh</mail>
</author>
<author title="Traducteur">
  <mail link="clement@varaldi.org">Clément Varaldi</mail>
</author>

<abstract>
Ce guide d'installation rapide donne tous les détails concernant le processus
d'installation sur architecture SPARC, sans rentrer trop dans les détails.
Les utilisateurs devraient avoir eu une expérience préliminaire d'installation
de Gentoo Linux pour pouvoir suivre correctement ce guide.
</abstract>

<license/>

<version>1.6</version>
<date>2004-11-08</date>

<chapter>
<title>Guide d'installation rapide pour SPARC</title>
<section>
<body>

<p>
Ce guide est fait pour les personnes ayant déjà eu une expérience d'installation
de Gentoo Linux. Pour avoir des instructions plus détaillées, consultez le
<uri link="http://www.gentoo.org/doc/fr/handbook">Manuel Gentoo</uri>.
</p>

<p>
Les images ISO et réseau pour l'installation sont disponibles sur les
<uri link="http://www.gentoo.org/main/en/mirrors.xml">miroirs Gentoo</uri>.
On peut démarrer à partir des CD-ROM «&nbsp;minimal&nbsp;» et
«&nbsp;universal&nbsp;», qui contiennent les outils nécessaires à l'installation
de Gentoo. Le CD-ROM «&nbsp;universal&nbsp;» contient, de plus, les archives
stages ainsi que quelques archives sources. Le CD-ROM «&nbsp;package&nbsp;»
contient des paquets précompilés supplémentaires pour les installations GRP. Les
images netboot ne contiennent aucun stage, mais contiennent un certain nombre
d'outils standards (remarquez que vous devrez utiliser <c>vi</c> au lieu de
<c>nano</c> si vous utilisez le démarrage avec une image netboot).
</p>

<p>
Utilisez <c>Stop+A</c> (au clavier) ou envoyez un signal «&nbsp;break&nbsp;»
(console série) lors du démarrage pour entrer dans l'OBP. Démarrez sur le CD-ROM
de Gentoo «&nbsp;universal&nbsp;» ou «&nbsp;minimal&nbsp;» en utilisant la
commande <c>boot cdrom</c> ou, depuis les images netboot, en utilisant <c>boot
net</c>. Appuyez sur «&nbsp;Entrée&nbsp;» pour utiliser le noyau par défaut ou
sur «&nbsp;Tabulation&nbsp;» pour voir la liste des noyaux disponibles.
</p>

<note>
Pour plus d'informations sur l'OBP, vous pouvez consulter la
<uri link="gentoo-sparc-obpreference.xml">référence sur l'OpenBoot PROM</uri> ou
encore le guide de Sun «&nbsp;OpenBoot 3.x Command Reference&nbsp;» (P/N
802-3242).
</note>

<pre caption="Commencer les configurations">
  (Assurez-vous que vos date et heure sont correctes. Si ce n'est pas le cas,
   utilisez <i>date MMDDhhmmCCYY</i> :)
# <i>date</i>
  (Facultatif : Chargez les modules nécessaires :)
# <i>modprobe module_name</i>
  (Configurez le réseau :)
# <i>ifconfig eth0 a.b.c.d netmask e.f.g.h broadcast i.j.k.l</i>
  (Configurez la passerelle par défaut :)
# <i>route add -net default gw a.b.c.d netmask 0.0.0.0 metric 1 eth0</i>
  (Mettez en place le DNS :)
# <i>echo "nameserver a.b.c.d" &gt; /etc/resolv.conf</i>
  (Partitionnez votre disque dur :)
# <i>fdisk /dev/sda</i>
</pre>

<p>
Un label de disque Sun est nécessaire pour les machines SPARC. On peut le créer
en utilisant «&nbsp;s&nbsp;» lors de l'utilisation de fdisk.
</p>

<p>
Avoir /boot sur une partition séparée n'est pas recommandé sur SPARC. La
partition racine doit être présente dans le premier gigaoctet du disque dur pour
toutes les machines SPARC. Le système de fichiers ext3 est fortement conseillé.
Au moins 512&nbsp;Mo de mémoire vive en plus de la partition d'échange sont
nécessaires pour le bootstrap et pour les grosses compilations.
</p>

<p>
Formattez vos partitions en utilisant <c>mke2fs</c> (Ext2), <c>mke2fs -j</c>
(Ext3) et <c>mkswap</c> (partition d'échange). Par exemple, vous pouvez
faire&nbsp;: <c>mke2fs -j /dev/sda1</c>.
</p>

<p>
Continuez en montant les partitions et en extrayant le stage approprié.
</p>

<pre caption="Préparer l'installation">
  (Activez la partition d'échange :)
# <i>swapon /dev/sdax</i>
  (Montez la partition racine :)
# <i>mount /dev/sdax /mnt/gentoo</i>
  (Allez sur le point de montage :)
# <i>cd /mnt/gentoo</i>
  (Extraire une archive stage...)
# <i>tar xvjpf /mnt/cdrom/stages/stage?-*.tar.bz2</i>
  (<comment>ou</comment> téléchargez la dernière archive stage...)
# <i>links http://www.gentoo.org/main/en/mirrors.xml</i>
  (... et désarchivez les données :)
# <i>tar xvjpf stage*</i>
  (Facultatif : Désarchivez un arbre de Portage)
# <i>tar xvjf /mnt/cdrom/snapshots/portage-*.tar.bz2 -C /mnt/gentoo/usr</i>
  (Facultatif : Copiez des archives de programmes)
# <i>cp -R /mnt/cdrom/distfiles /mnt/gentoo/usr/portage/distfiles</i>
  (Choisissez un miroir :)
# <i>mirrorselect -a -s4 -o | grep 'GENTOO_MIRRORS=' &gt;&gt; /mnt/gentoo/etc/make.conf</i>
  (Copiez les informations de vos serveurs DNS :)
# <i>cp /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</i>
  (Montez le système de fichiers proc :)
# <i>mount -t proc none /mnt/gentoo/proc</i>
  (Entrez en chroot dans le nouvel environnement :)
# <i>chroot /mnt/gentoo /bin/bash</i>
  (Chargez les variables nécessaires :)
# <i>env-update; source /etc/profile</i>
  (Si vous disposez du réseau, non-GRP : Mettez à jour Portage)
# <i>emerge --sync</i>
</pre>

<p>
Maintenant, nous pouvons installer Gentoo&nbsp;:
</p>

<pre caption="Installer Gentoo">
(Stage1 seulement :)
  (Changez les paramètres USE, CFLAGS et CXXFLAGS. Ne changez pas CHOST :)
# <i>nano -w /etc/make.conf</i>
  (Construisez le bootstrap :)
# <i>cd /usr/portage; scripts/bootstrap.sh</i>

(Stage1 et Stage2 seulement :)
  (Installez le système de base :)
# <i>emerge system</i>
</pre>

<note>
De bons paramètres CFLAGS pour les systèmes SPARC sont&nbsp;:
<c>-mcpu=votre_cpu -O2 -pipe</c>, où <c>votre_cpu</c> est au choix
<c>ultrasparc3</c>, <c>ultrasparc</c>, <c>v9</c> (systèmes 64&nbsp;bits) ou
<c>hypersparc</c>, <c>supersparc</c>, <c>v8</c> ou <c>v7</c> (systèmes
32&nbsp;bits).
Le paramètre <c>-frename-registers</c> peut également vous être utile.
Remarquez que, contrairement aux systèmes x86, <c>-fomit-frame-pointer</c> n'est
pas recommandé.
</note>

<p>
Ensuite, nous configurons les informations nécessaires&nbsp;:
</p>

<pre caption="Configurez le système">
  (Configurez les informations de fuseau horaire :)
# <i>ln -sf /usr/share/zoneinfo/<comment>&lt;répertoireVersLeFichierDeZoneHoraire&gt;</comment> \
   /etc/localtime</i>
  (Éditez le fichier fstab :)
# <i>nano -w /etc/fstab</i>
</pre>

<p>
Utilisez l'exemple suivant comme <e>modèle</e> (ne le copiez pas tel quel) pour
<path>/etc/fstab</path>&nbsp;:
</p>

<pre caption="/etc/fstab">
# &lt;SF&gt;                  &lt;pointDeMontage&gt;    &lt;type&gt;          &lt;opts&gt;                  &lt;dump/pass&gt;
/dev/sdax               none            swap            sw                      0 0
/dev/sdax               /               ext3            noatime                 0 1
/dev/cdroms/cdrom0      /mnt/cdrom      auto            noauto,user             0 0
none                    /proc           proc            defaults                0 0
none                    /dev/shm        tmpfs           nodev,nosuid,noexec     0 0
</pre>

<p>
Continuez en installant le noyau Linux. Les paquets pour le noyau sont
disponibles pour les systèmes SPARC sous les noms de <c>sparc-sources</c> (2.4)
et <c>development-sources</c> (2.6). Le paramètre USE <c>ultra1</c> doit être
utilisé pour les modèles Ultra 1 et Netra i 1 «&nbsp;Enterprise&nbsp;» et
«&nbsp;Creator&nbsp;» pour un bon support du contrôleur Ethernet HME intégré à
la carte mère.
</p>

<pre caption="Installer le noyau">
  (Installez les sources du noyau :)
# <i>emerge <comment>&lt;paquet-du-noyau&gt;</comment></i>
# <i>cd /usr/src/linux; make menuconfig</i>
(   (2) Inclure shmfs, procfs et devfs si vous n'utilisez pas udev)
(   (3) Compiler votre noyau)
(       - noyaux 2.4 sur sparc32)
# <i>make dep &amp;&amp; make clean vmlinux modules modules_install</i>
(       - noyaux 2.4 sur sparc64)
# <i>make dep &amp;&amp; make clean vmlinux image modules modules_install</i>
(       - noyaux 2.6 sur sparc32)
# <i>make &amp;&amp; make modules_install</i>
(       - noyaux 2.6 sur sparc64)
# <i>make &amp;&amp; make image modules_install</i>
(   (4) Copiez le noyau)
(       - noyaux 2.4 sur sparc32)
# <i>cp vmlinux /boot/image</i>
(       - noyaux 2.4 sur sparc64)
# <i>cp arch/sparc64/boot/image /boot</i>
(       - noyaux 2.6 sur sparc32)
# <i>cp arch/sparc/boot/image /boot</i>
(       - noyaux 2.6 sur sparc64)
# <i>cp arch/sparc64/boot/image /boot</i>
# <i>cp System.map /boot</i>
</pre>

<p>
Maintenant, installez les autres outils que vous souhaitez&nbsp;:
</p>

<pre caption="Installer les outils systèmes importants">
  (Installez le système de journalisation, au choix sysklogd, metalog, msyslog, syslog-ng)
# <i>emerge syslog-ng </i>
  (Activez la journalisation automatique au démarrage)
# <i>rc-update add syslog-ng default</i>
  (Installez un démon cron au choix vixie-cron, dcron, fcron)
# <i>emerge vixie-cron</i>
  (Activez le démarrage automatique du démon cron au démarrage du système)
# <i>rc-update add vixie-cron default</i>
  (Script de démarrage du nom de domaine)
# <i>rc-update add domainname default</i>
  (Pour les noyaux 2.6.x seulement : udev peut être utilisé à la place de devfs)
# <i>emerge udev</i>
</pre>

<note>
Pour plus d'informations sur comment configurer udev, lisez le
<uri link="udev-guide.xml">Guide udev Gentoo</uri>. Remarquez que
l'option <c>RC_DEVICE_TARBALL="no"</c> est préférable pour les systèmes SPARC.
</note>

<p>
Finissez la mise en place de votre système Gentoo&nbsp;:
</p>

<pre caption="Finir la mise en place de la configuration">
  (Configurez le mot de passe root :)
# <i>passwd</i>
  (Créez un utilisateur :)
# <i>useradd your_user -m -G users,wheel,audio -s /bin/bash</i>
  (Assignez-lui un mot de passe :)
# <i>passwd your_user</i>
  (Configurez le nom de la machine :)
# <i>echo mamachine &gt; /etc/hostname</i>
  (Configurez le nom de domaine de la machine :)
# <i>echo mydomain.com &gt; /etc/dnsdomainname</i>
  (Configurez le fichier hostsfile, ex : « 127.0.0.1 localhost mamachine »)
# <i>nano -w /etc/hosts</i>
  (Configurez les informations de base du système : Suivez les commentaires.)
# <i>nano -w /etc/rc.conf</i>
</pre>

<pre caption="Configurer le réseau">
  (Configurez le réseau ; les utilisateurs de DHCP doivent mettre iface_eth0="dhcp")
# <i>nano -w /etc/conf.d/net</i>
  (Listez les motules à charger au démarrage :)
# <i>nano -w /etc/modules.autoload.d/kernel-<comment>&lt;version&gt;</comment></i>
  (Activation automatique du réseau au démarrage :)
# <i>rc-update add net.eth0 default</i>
  (Seulement si vous disposez de plusieurs interfaces réseau :)
     (1) Créez les scripts init pour chaque interface)
# <i>ln -s /etc/init.d/net.eth0 /etc/init.d/net.ethx</i>
     (2) Activation automatique au démarrage)
# <i>rc-update add net.ethx default</i>
</pre>

<p>
Maintenant, installez le gestionnaire de démarrage.
</p>

<pre caption="Installer SILO">
# <i>emerge silo</i>
# <i>nano -w /etc/silo.conf</i>
partition = 1
root = /dev/sda1
timeout = 150

image = /boot/image
    label = Gentoo
# <i>silo</i>
</pre>

<p>
Maintenant, démontez toutes les partitions et redémarrez sous votre nouveau
système&nbsp;:
</p>

<pre caption="Finalisation et installation du serveur X">
  (Quitter le chroot :)
# <i>exit; cd /</i>
  (Démontez les partitions :)
# <i>umount /mnt/gentoo/proc /mnt/gentoo</i>
  (Redémarrez ; Enlevez le CD d'installation du lecteur :)
# <i>reboot</i>
  (Après le démarrage :)
  (Utilisateurs de GRP seulement :)
  (  (1) Montez le CD2)
# <i>mount /dev/cdroms/cdrom0 /mnt/cdrom</i>
  (  (2) Copiez les paquets)
# <i>cp -a /mnt/cdrom/packages/* /usr/portage/packages/</i>
  (  (3) Installez les logiciels supplémentaires)
# <i>USE="bindist" emerge -k xfree gnome kde mozilla</i>
  (  (4) Configurez votre serveur X)
# <i>$EDITOR /etc/X11/XF86Config</i>
</pre>

<p>
Vous pouvez obtenir plus d'informations en lisant la
<uri link="index.xml">Documentation Gentoo</uri>.
</p>

</body>
</section>
</chapter>
</guide>

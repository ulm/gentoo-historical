<?xml version='1.0' encoding="UTF-8"?>
<!-- *$Localization:
target-language: Russian
target-version: 1.1.7
target-date: 2005-07-23
source-cvs-revision: 1.14
translated-by: Dmitry Shkolnikov <dish@newmail.ru>
edited-by: Sergey Kuleshov <svyatogor@gentoo.org>

notes:
-->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="fluxbox-config.xml" lang="ru">
<title>Руководство по настройке Fluxbox</title>
<author title="Автор">
<mail link="smith.jonathan@gmail.com">Jonathan Smith</mail>
</author>
<author title="Редактор">
<mail link="alin@gentoo.org">Alin Dobre</mail>
</author>
<author title="Переводчик">
<mail link="dish@newmail.ru">Дмитрий Школьников</mail>
</author>

<abstract>
В этом руководстве описывается настройка Fluxbox &mdash; оконного менеджера X11.
</abstract>
<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.0 -->
<license/>

<version>1.1.7</version>
<date>2005-07-23</date>
<chapter>
<title>Введение</title>
<section>
<title>Введение в оконный менеджер Fluxbox</title>
<body>

<p>
Для тех, кто не знаком с моделью рабочей станции в Linux, оконный менеджер
&mdash; это приложение, запускаемое в среде X11 для управления другими
графическими приложениями. Хотя их использование совершенно необязательно,
сессия X11 без оконного менеджера выглядит совершенно уродливо и не обладает
многими функциями, которые обычно ассоциируются с современной рабочей станцией.
</p>

<p>
Fluxbox &mdash; это оконный менеджер с гораздо более минималистской философией
чем у других популярных менеджеров, таких как KDE или GNOME. Хотя его основное
назначение такое же, в Fluxbox отсутствуют графический файловый менеджер,
иконки, меню &laquo;Пуск&raquo; и дополнительные утилиты. Тем не менее, при
желании их и многое другое можно достаточно легко установить. Это дает огромные
возможности для настройки, в чем и заключается философия Gentoo.
</p>

<p>
Это руководство предназначено для новичков во Fluxbox, любопытных или тех, кто
хочет узнать что-то новое о Gentoo/Fluxbox. Также это руководство описывает, как
добиться большей (хотя это и необязательно) функциональности посредством
использования программ от третьих разработчиков, которые хорошо работают вместе
с Fluxbox.
</p>

<p>
Также имейте в виду, что с начала 2005 года XFree86 была исключена из Gentoo
Portage. Это значит, что данное руководство подразумевает, что читатель
использует Xorg. Если это не так, то не все из этого руководства может быть
правильным, однако мы не пытаемся сохранить совместимость с Xfree86. Gentoo
рекомендует перейти на Xorg посредством команды <c>emerge xorg-x11</c>.
</p>
</body>
</section>
</chapter>

<chapter>
<title>Установка Fluxbox</title>
<section>
<title>Базовая установка</title>
<body>
<p>
В Gentoo имеется ebuild для быстрой и простой установки Fluxbox. Хотя в Gentoo
имеются USE-флаги <c>gnome</c> и <c>kde</c>, которые должны обеспечивать
совместимость для этих оконных менеджеров, автор не видит в них необходимости.
Если вам требуется программа , основанная на qt или gtk+ либо какая-нибудь
утилита KDE/GNOME, вы можете установить и настроить ее независимо.  Например,
автор использует Fluxbox с k3b, программой для записи CD-R(W) из KDE.
</p>

<p>
Также необходимо иметь программу для запирания экрана X для предотвращения
неавторизованного доступа, так что будет разумным установить <c>xlock</c>.
Подавляющее большинство пользователей также хотят иметь возможность
устанавливать свой собственный фон, поэтому поставим <c>eterm</c>, который к
тому же является симпатичным X11-терминалом.
</p>

<pre caption="Установка Fluxbox">
# <i>emerge fluxbox xlockmore x11-terms/eterm</i>
</pre>

<p>
Итак, вот и все! Теперь Fluxbox установлен! Однако, скорее всего только с
этим набором утилит вам не удастся им эффективно пользоваться. Следующие
разделы помогут установить другие потенциально необходимые пакеты и настроить
под себя Fluxbox и некоторые другие программы. Имейте в виду, что все эти шаги
необязательны, поэтому сами выбирайте.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Настройка Fluxbox</title>
<section>
<title>Подготовка X11</title>
<body>

<p>
Fluxbox это просто программа, которая выполняется в среде X11. При желании можно
ввести <c>startx</c> и затем в xterm ввести <c>fluxbox</c>. Однако, это по
меньшей мере неудобно. Если вы не хотите при загрузке компьютера сразу запускать
графическую оболочку, а наоборот хотите запускать X11 вручную, можно заставить X
автоматически загружать Fluxbox под обычным (не root) пользователем.
</p>

<pre caption="Редактирование xinit">
$ <i>echo "exec startfluxbox" > ~/.xinitrc</i>
</pre>

<p>
Это тоже не является идеальным решением для всех пользователей, так как многие
хотят работать в графической оболочке постоянно. Неудобно каждый раз запускать
<c>startx</c>, если предполагается постоянное использование GUI (графического
интерфейса пользователя). Кроме того такой подход представляет угрозу
безопасности.  Если запереть X-сессию при помощи <c>xlock</c>, но при этом сама
X11 запущена из консоли, посторонний с физическим доступом к компьютеру сможет
переключиться на консоль, остановить X11 и использовать вашу учетную запись.
Единственным способом избежать такого в данной ситуации является запуск X11 в
фоне, либо запуск ее из программы screen с последующим отсоединением и выходом
из консоли, что по меньшей мере утомительно. Если использовать графический
менеджер входа в систему, такая проблема не возникнет. С другой стороны, тогда
X11 будут запущены из-под root, что может быть не очень хорошо. На момент
написания нет ни одного эксплоита для данной версии, но если вы сильно
заинтересованы в высокой степени безопасности, либо не используйте X11 вообще,
либо используйте вышеописанный метод с программой screen. Имейте в виду, что это
относится не к Fluxbox, а к самой X11.
</p>

<p>
Существует несколько менеджеров графического входа в систему, мы будем
использовать gdm. Вы можете использовать любой другой менеджер на ваш вкус, но
gdm одинакого хорошо работает как с Fluxbox, так и с любыми другими оконными
менеджерами (GNOME, KDE, xfce), которые могут быть установлены у вас.
</p>

<pre caption="Менеджер входа в систему">
# <i>emerge gdm</i>
# <i>rc-update add xdm default</i>
</pre>

<impo>
Сначала установите gdm, а потом добавьте xdm к сценариям загрузки, ни в коем
случае не наоборот! Изменение порядка выполнения этих команд приведет к
неудаче. Также необходимо изменить один системный конфигурационный файл:
</impo>

<pre caption="Редактируем /etc/rc.conf">
DISPLAYMANAGER="gdm"
</pre>
</body>
</section>

<section>
<title>Темы оформления</title>
<body>

<p>
Если вы хотите истинного минимализма, то этот параграф можно пропустить. Тем не
менее, приятно давать пользователям возможность настраивать внешний вид их
оконного менеджера. Темы Fluxbox, стили Gentoo для любого оконного менеджера, а
также темы для любого *box оконного менеджера будут установлены с помощью этой
команды:
</p>

<pre caption="Установка стилей оформления">
# <i>emerge commonbox-styles commonbox-styles-extra \
  fluxbox-styles-fluxmod gentoo-artwork</i>
</pre>
</body>
</section>

<section>
<title>Синтаксис Fluxbox для Vim</title>
<body>

<p>
Теперь установим особую цветовую схему Fluxbox для <c>vim</c>. Так вам будет
проще работать с keys и init файлами для Fluxbox. Это очень маленькое
расширение, так что стоит его поставить (если вы конечно не являетесь
пользователем emacs, в таком случае рекомендую <c>emerge -C emacs &amp;&amp;
emerge vim gvim</c> ;-).
</p>

<pre caption="Установка синтаксиса Fluxbox">
# <i>emerge fluxbox-syntax</i>
</pre>
</body>
</section>

<section>
<title>Программа для запуска приложений</title>
<body>

<p>
В каждом оконном менеджере есть (или должна быть) своя программа, используемая
для запуска приложений без запуска консоли и вызова приложения оттуда.
Апплет для запуска приложений в Fluxbox называется <c>fbrun</c>. Он должен быть
уже установлен. Его можно запустить, введя <c>fbrun</c> в командной строке, но
запуск <c>fbrun</c> из консоли с последеющим запуском из него приложения еще
хуже, чем запуск самого приложения из консоли. Поэтому стоит задать быструю
клавишу или запись в меню Fluxbox, которая будет запускать <c>fbrun</c>, либо
и то, и другое. 
</p>

<p>
Создать пункт меню, названный "Запуск...", можно внеся следующие изменения в
файл <path>~/.fluxbox/menu</path>:
</p>

<pre caption="Определение пункта меню для запуска fbrun">
[exec] (Запуск...) {fbrun}
</pre>

<p>
Далее в этом руководстве вы найдете больше информации о меню.
</p>

<p>
Для подробной информации, такой как параметры командной строки, пожалуйста
прочитайте страницу руководства, введя в консоли man fbrun. Помните, что для
использования параметров командной строки вам будет необходимо снова
отредактировать файлы keys и/или menu, добавив в них необходимые изменения.
</p>
</body>
</section>

<section>
<title>Горячие клавиши в Fluxbox</title>
<body>

<p>
В стандартной поставке Fluxbox очень маленький набор горячих клавиш. Все, что
они позволяют, это переключаться между окнами и рабочими столами. Прежде чем
менять их, необходимо знать некоторые вещи. В файле горячих клавиш Fluxbox есть
странные модификаторы. Mod1, обычно известный как &laquo;Alt&raquo;, и Mod4 это
неназываемая (Windows) клавиша. Control и Shift обозначаются Control и Shift.
Тем не менее, обычно лучше использовать клавиши Alt/Windows, потому что другие
графические программы используют Control и Shift для своих горячих клавиш.
</p>

<p>
Все эти комбинации независимы, поэтому вы можете спокойно не вписывать то,
что не хотите, либо модифицировать под свои нужды. В этом руководстве
описываются горячие клавиши для тех программ, которые автор считает
наиболее распространенными, поэтому заменяйте имя программы, если оно
отличается от написанного здесь. Для более подробной информации
обратитесь к странице man для Fluxbox.
</p>

<p>
Итак, запускайте текстовый редактор (не из-под root) и открывайте файл
<path>~/.fluxbox/keys</path>. Давайте улучшим эти горячие клавиши.
</p>

<pre caption="Модификация горячих клавиш">
<comment>#блокирует графическую сессию текущего пользователя</comment>
Mod4 l   :ExecCommand xlock

<comment>#Набор программ с запуском по горячим клавишам. Это только примеры, я
#уверен вы поймете идею...</comment>
Mod1 f   :ExecCommand firefox
Mod1 t   :ExecCommand thunderbird
Mod1 o   :ExecCommand oowriter
Mod1 v   :ExecCommand gvim

<comment>#В Fluxbox отсутствует регулятор звука, поэтому мы сделаем небольшую
#хитрость, чтобы он появился (предполагается использование alsa, если у вас
#oss, тогда придумывайте сами</comment>
Mod1 e   :ExecCommand Eterm -name alsa -e alsamixer

<comment>#Это запускает fbrun, которй в свою очередь запускает другие
программы</comment>
Mod1 r   :ExecCommand fbrun

<comment>#Управление приложениями. Упрощает жизнь...</comment>
Mod1 4   :Close
Mod1 m   :Minimize

<comment>#Если вы пользуетесь aterm (emerge x11-terms/aterm), тогда следующая
#строчка запустит действительно красивый прозрачный aterm без границ,
#замечательно подходящий к разрешению 1024x768, при этом оставляя место для
#torsmo. Опять таки, модифицируйте как хотите.</comment>
Mod1 a   :ExecCommand aterm -name aterm -sl 3000 -tr +sb -sr -sk -bg black -fg
\
white -fade 90 -bl -tn xterm -fn \
-misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15 -g 116x57

<comment>#То же, что и предыдущая комбинация, но открывает терминал под root.
#Естественно, для использования этого вы должны знать пароль root.</comment>
Mod1 s   :ExecCommand aterm -name aterm -sl 3000 -tr +sb -sr -sk -bg black -fg
\
white -fade 90 -bl -tn xterm -fn \
-misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15 -g 116x57 -e su -
</pre>
</body>
</section>

<section>
<title>Системный монитор</title>
<body>

<p>
Многие хотят поставить себе системный монитор. Обычно используется Gkrellm, но в
духе минимализма Fluxbox мы будем использовать монитор попроще: Torsmo. Если
хотите, используйте другой монитор; в других местах есть куча howto.
</p>

<pre caption="Установка torsmo">
# <i>emerge torsmo</i>
</pre>

<p>
Стандартный конфигурационный файл Torsmo достаточно слабый, но вы можете
найти больше информации в странице man или в
<uri link="http://torsmo.sourceforge.net/readme.php">readme-файле</uri>.
</p>
</body>
</section>

<section>
<title>Иконки</title>
<body>

<p>
В Fluxbox нет утилиты или программы для рисования иконок на рабочем столе, все
действия осуществляются посредством горячих клавиш, или меню, появляющемся при
щелчке правой кнопкой мыши по рабочему столу. iDesk предоставляет такую
функциональность. Он предназначен для для пользователей минималистичным оконных
менеджеров, которые хотят вывести иконки в корневое окно. Он даже поддерживает
разные спецэффекты, например прозрачность! Несмотря на название, idesk не
связана с Apple или Mac (насколько известно автору).
</p>

<pre caption="Установка idesk">
# <i>emerge idesk</i>
</pre>

<p>
После инсталляции необходимо добавить значки в программу. Иконки idesk
управляются посредством конфигурационного файла, находящегося в
<path>~/.ideskrc</path>. Это достаточно длительный процесс и мы не можем
подробно описать его в этом руководстве. Для подробной информации обратитесь к
странице <c>man idesk</c>, посмотрите <uri
link="http://idesk.sourceforge.net/usage.html">руководство по использованию
iDesk</uri> и <uri
link="http://forums.gentoo.org/viewtopic-t-87262.html">ветку в Gentoo
Forums</uri>.
</p>
</body>
</section>

<section>
<title>Выбор графического файлового менеджера</title>

<body>
<p>
Важно заметить, что в Gentoo нет необходимости в файловом менеджере. Можно
полностью и действительно проще (по скромному мнению автора) совершать все
операции над файлами из командной строки. Однако, не все с этим
согласны...
</p>

<p>
Большинство новичков в Gentoo/Fluxbox теряются от отсутствия графического
файловога менеджера, такого как <c>nautilus</c> в Gnome. Сам Fluxbox не содержит
в себе такой программы, но ее, как всегда, легко установить.  Выбор достаточно
богатый, но в этом руководстве рассмотрены два менеджера: один для <uri
  link="#gentoo">минималистов</uri>, которые любят только текст и другой для тех
пользователей, которые любят <uri link="#rox">кликать по иконки</uri>.
Естественно, возможно установить оба сразу и попробовать каждый из них.
</p>
</body>
</section>

<section>
<title>Файловый менеджер Gentoo &mdash; минимализм</title>
<body>

<p>
Gentoo относится к файловым менеджерам, которые дают все преимущества
графического интерфейса без лишних "наворотов", которые обычно
ассоциируются с таким интерфейсом.
</p>

<pre caption="Установка файлового менеджера Gentoo">
# <i>emerge gentoo</i>
</pre>

<note>
На заметку: Файловый менеджер Gentoo является отдельным проектом от
дистрибутива Gentoo Linux. Для уточнения деталей смотрите <uri
link="/main/en/name-logo.xml#doc_chap4">порядок
использования названия и логотипа</uri> Gentoo.
</note>

<p>
Файловый менеджер Gentoo очень легко настроить использую графический интерфейс,
так что вперед.
</p>
</body>
</section>

<section>
<title>Файловый менеджер Rox &mdash; работает с иконками</title>
<body>

<p>
Rox относится к тем файловым менеджерам, которые используют иконки вместе
с текстом и более похож на Windows Explorer.
</p>

<pre caption="Установка файлового менеджера Rox">
# <i>emerge rox</i>
</pre>

<p>
Rox по своему поведению очень похож на "традиционные" файловые
менеджеры, поэтому его интерфейс должен быть интуитивным. Если нет, всегда
есть страницы man.
</p>
</body>
</section>

<section>
<title>Программа для просмотра картинок</title>
<body>

<p>
Многие оконные менеджеры включают в себя утилиты для просмотра картинок в
каталоге. Эти приложения маленькие и легкие, но не позволяют редактировать
изображения, что предполагается делать в <c>gimp</c> или аналогичном редакторе.
Это необходимо, если вы используете командную строку либо один из файловых
менеджеров <c>gentoo</c> или <c>rox</c>.
</p>

<pre caption="Установка xzgv">
# <i>emerge xzgv</i>
</pre>

<p>
<c>xzgv</c> может быть запущен из любого каталога и можеть показывать любой из
поддерживаемых графических форматов.
</p>
</body>
</section>

<section>
<title>Установка темы, фона рабочего стола и сценария запуска</title>
<body>

<p>
В Fluxbox есть набор тем, которые можно выбирать из меню, появляющегося по
правому щелчку, затем "Fluxbox Menu" и "System Styles". Обычно эти темы ставят
свой фон рабочего стола, который являет собой либо просто один цвет, либо
какой-нибудь градиент. Большинство людей предпочитают задавать свой собственный
фон, не связанный с используемой темой. Чтобы это сделать, необходимо изменить
еще один конфигурационный файл Fluxbox, который отвечает за действия при
запуске. Снова запустите текстовый редактор и откройте файл
<path>~/.fluxbox/startup</path>.
</p>

<p>
Если этот файл уже существует, очистите его содержимое. Добавьте в этот новый
файл, удаляя, где необходимо, комментарии и подставляя значения вместо
выделенных ВЕРХНИМ РЕГИСТРОМ выражений.
</p>

<pre caption="Редактируем сценарии загрузки Fluxbox">
<comment>#Сценарий загрузки Fluxbox в Gentoo

#Программы, которые должны работать постоянно а не запуститься один раз
#требуют "&amp;" после команды

#Отображать картинку загрузки Fluxbox
#fbsetbg -C /usr/share/fluxbox/splash.jpg

#Это задает фон рабочего стола. У вас должна быть установлена программа для
#реализации этого (рекомендуется x11-terms/eterm)
#bsetbg -f ПУТЬ_К_ИЗОБРАЖЕНИЮ

#Собственный каталог с шрифтами
#xset +fp ПУТЬ_К_КАТАЛОГУ_СО_ШРИФТАМИ

#Запускает программу отображения иконок
#idesk &amp;

#Запускает системный монитор
#torsmo &amp;

#Это должно быть последней командой!</comment>
exec /usr/bin/fluxbox -log ~/.fluxbox/log
</pre>
</body>
</section>

<section>
<title>Создание меню</title>
<body>

<p>
Автор создает меню в текстовом редакторе. Если вам такая идея по душе,
пожалуйста пропустите эту секцию и перейдите к разделу, описывающему <uri
link="#manual_menu">ручное создание меню</uri>. 
</p>

<p>
Даже после использования генератора мену (смотрите следующий раздел), можно
отредактировать файл <path>~/.fluxbox/menu</path> вручную, добавив или удалив
некоторые пакеты. Имейте в виду, что удаление программы из меню не повлечет
удаления этой программы из системы, только из персонального меню пользователя.
Вы все еще можете запустить эту программу из командной строки.
</p>

<p>
В системе уже есть программа, которая называется <c>fluxbox-generate_menu</c>,
которую можно использовать для автоматической генерации мену. Что
воспользоваться этой программой, вам понадобится Fluxbox версии 0.9.13 или
выше. Убедится в этом можно запустив <c>emerge --sync &amp;&amp; emerge -u
fluxbox</c>. Теперь у вас будет специальная версия этого скрипта, пропатченная
для Gentoo, чтобы находить больше программного обеспечения, чем раньше. Эта
версия несравнимо лучше по сравнению с предыдущими и нашла у меня в системе
программы, о которых я сам не знал. Запустите ее этой командой (не от root'а):
</p>

<pre caption="Генерация меню для >=fluxbox-0.9.13">
$ <i>fluxbox-generate_menu -is -ds</i>
</pre>

<p>
Мы рекомендуем использовать именно <c>fluxbox-generate_menu -is -ds</c>, а не
другие программы вроде <c>mmaker</c>, так как они не понимают структуры
каталогов Gentoo.
</p>

<note>
Даже если вы используете автогенерацию меню, у вас остается контроль над его
содержимым. Ручное создание и редактирование
<path>~/.fluxbox/usermenu</path> (смотрите описание синтаксиса в следующем
разделе) позволит вам создать личное меню, которое не будет удалено при
следующем запуске скрипта.
</note>
</body>
</section>

<section id="manual_menu">
<title>Ручное редактирование меню</title>
<body>

<p>
Меню Fluxbox это текстовый файл с достаточно простым синтаксисом, описанным в
этом параграфе. Меню по умолчанию находится в файле
<path>~/.fluxbox/menu</path>.
</p>

<p>
Элементы меню для запуска приложений определяются тегом <c>[exec]</c>. Можно
задать элемент меню после тега <c>[begin]</c> (корень меню) либо между
<c>[submenu]</c> и соответствующего ему тега <c>[end]</c> (определение подменю),
например:
</p>

<pre caption="Создание новых элементов меню">
# Свое меню fluxbox
[begin] (Fluxbox)
  <comment>(...)</comment>
  [exec] (XTerm белый на черном) {xterm -ls -fg white -bg black}
  <comment>(...)</comment>
  [submenu] (Другие терминалы)
    [exec] (Aterm default) {aterm}
    [exec] (Rxvt default) {rxvt}
  [end]
  <comment>(...)</comment>
[end]
</pre>

<p>
Определение корневого меню начинается с тега <c>[begin]</c>, после которого
идет его имя, находящееся между скобками и заканчивается относящимся к нему
тегом <c>[end]</c>. Все операторы меню (называемые здесь тегами) помещаются в
квадратные скобки, названия меню помещаются в скобки, а команды, отвечающие
названию, в фигурные скобки. В этом файле допускается использование
комментариев; это строки, начинающиеся с символа "<c>#</c>"
</p>

<p>
В вышеприведенном примере первая строчка, начинающаяся с <c>[exec]</c>, задает
новый пункт, который называется &laquo;XTerm белый на черном&raquo; и выполняет
команду <c>xterm -ls -fg white -bg black</c> как из командной строки. Далее идет
подменю, задаваемое тегом <c>[submenu]</c> и затем секция "Другие терминалы" с
еще двумя командами <c>[exec]</c>. У каждого подменю должен быть тег
<c>[end]</c>.
</p>

<p>
Есть и другие команды меню, которые вы можете использовать в файле
<path>~/.fluxbox/menu</path>. Чтобы узнать о них,почитайте <uri
  link="http://www.fluxbox.org/docbook.php">официальную документацию</uri>,
доступную онлайн.
</p>
</body>
</section>

<section>
<title>Заключение</title>
<body>

<p>
Поздравляем! Теперь Fluxbox установлен, настроен и готов к работе. Если у вас
есть какие-либо вопросы или предложения, пожалуйста напишите e-mail автору
и/или отправьте bug report в <uri link="http://bugs.gentoo.org/">Bugzilla</uri>
Gentoo.
</p>
</body>
</section>
</chapter>
</guide>

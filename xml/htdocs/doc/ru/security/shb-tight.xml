<?xml version='1.0' encoding='UTF-8'?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/en/security/shb-tight.xml,v 1.3 2006/09/18 09:22:48 neysx Exp $ -->
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">


<!-- Текст этого документа распространяется на условиях лицензии CC-BY-SA -->
<!-- См. http://creativecommons.org/licenses/by-sa/2.5 -->
<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<sections>

<version>1.1</version>
<date>2006-03-04</date>

<section>
<title>USE-флаги</title>
<body>

<p>
В Gentoo Linux файл <path>make.conf</path> содержит определенные пользователем
USE-флаги, а <path>/etc/make.profile/make.defaults</path> &mdash; USE-флаги по
умолчанию. Для данного руководства важны флаги <c>pam</c> (Pluggable
Authentication Modules), <c>tcpd</c> (Упаковщики TCP) и <c>ssl</c> (Secure
Socket Layer). Все они включены во флаги USE по умолчанию.
</p>

</body>
</section>

<section id="passwording_GRUB">
<title>Защита GRUB паролем</title>
<body>

<p>
В GRUB присутствует два различных способа защиты загрузчика паролем. В первом
используется открытый пароль, а во втором &mdash; шифрованием с использованием
md5+salt.
</p>

<pre caption="/boot/grub/grub.conf">
timeout 5
password changeme
</pre>

<p>
Благодаря этим строкам был добавлен пароль <c>changeme</c>. Если во время
загрузки пароль не будет введен, то GRUB просто будет использовать настройки
загрузки по умолчанию.
</p>

<p>
При добавлении пароля MD5 вы должны преобразовать открытый пароль в
зашифрованный. Он будет иметь тот же вид, что и в файле
<path>/etc/shadow</path>. Для дополнительной информации см. <c>man crypt</c>.
Зашифрованный пароль, например <e>changeme</e>, может выглядеть вот так:
<c>$1$T7/dgdIJ$dJM.n2wZ8RG.oEiIOwJUs</c>.
</p>

<p>
Вы можете зашифровать пароль прямо в оболочке GRUB:
</p>

<pre caption="md5crypt в оболочке grub">
#<i>/sbin/grub</i>

GRUB version 0.92 (640K lower / 3072K upper memory)

   [ Minimal BASH-like line editing is supported. For the first word, TAB lists
     possible command completions. Anywhere else TAB lists the possible
     completions of a device/filename. ]

grub> <i>md5crypt</i>

Password: <i>********</i>
<comment>(Было набрано слово changeme)</comment>
Encrypted: $1$T7/dgdIJ$dJM.n2wZ8RG.oEiIOwJUs.

grub> <i>quit</i>
</pre>

<p>
А теперь скопируйте полученный пароль в <path>/boot/grub/grub.conf</path>.
</p>

<pre caption="/boot/grub/grub.conf">
timeout 5
password --md5 $1$T7/dgdIJ$dJM.n2wZ8RG.oEiIOwJUs.
</pre>

<p>
Задержка в 5 секунд необходима в случае, если система физически недоступна, и
должна быть обеспечена возможность перезагрузки без использования клавиатуры.
Более подробно о паролях в GRUB вы можете узнать, набрав <c>info grub</c>.
</p>

</body>
</section>

<section id="passwording_LILO">
<title>Защита LILO паролем</title>
<body>

<p>
В LILO также поддерживается два способа защиты с помощью пароля: общий и для
отдельного образа, оба основаны на открытом тексте.
</p>

<p>
Общий пароль устанавливается вверху файла конфигурации и применим для каждого
загрузочного образа:
</p>

<pre caption="/etc/lilo.conf">
password=changeme
restricted
delay=3
</pre>

<p>
Пароль для отдельного образа устанавливается следующим образом:
</p>

<pre caption="/etc/lilo.conf">
image=/boot/bzImage
      read-only
      password=changeme
      restricted
</pre>

<p>
Если параметр <c>restricted</c> не введен, то пароль будет запрашиваться при
каждой загрузке.
</p>

<p>
Чтобы применить изменения в конфигурационном файле <path>lilo.conf</path>, вы
должны запустить <c>/sbin/lilo</c>.
</p>

</body>
</section>

<section>
<title>Ограничение доступа к консоли</title>
<body>

<p>
С помощью файла <path>/etc/securetty</path> можно указать терминальные
устройства (TTY), с которых будет разрешено входить в систему суперпользователю.
</p>

<p>
Рекомендуется закомментировать все строки за исключением <c>vc/1</c> (если у
вас devfs) или <c>tty1</c> (если у вас udev). Благодаря этому суперпользователь
сможет входить в систему только один раз и только с одного терминала.
</p>

<note>
Пользователи, входящие в группу &laquo;wheel&raquo; все еще могут
воспользоваться <c>su -</c>, чтобы стать суперпользователем на других TTY.
</note>

<pre caption="/etc/securetty">
<comment>(Для devfs)</comment>
vc/1
<comment>(Для udev)</comment>
tty1
</pre>

</body>
</section>

</sections>

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- REV 1.6 -->
<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.0 -->
<!-- Translated by: Anton --> 
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ru/handbook/hb-portage-configuration.xml,v 1.1 2005/03/11 14:54:03 sergey Exp $ -->

<sections>

<version>1.3</version>
<date>2004-10-24</date>

<section>
<title>Настройка Portage</title>
<subsection>
<body>

<p>
Как отмечалось ранее, Portage настраивается с помощью множества переменных,
которые вам следует задать в файле <path>/etc/make.conf</path>. За более полной и
подробной информацией обращайтесь к странице руководства по <path>make.conf</path>: 
</p>

<pre caption="Чтение страницы руководства по make.conf">
$ <i>man make.conf</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Опции сборки</title>
<subsection>
<title>Опции конфигурирования и компиляции</title>
<body>

<p>
Когда Portage собирает приложения, компилятору и сценарию конфигурации
передается содержимое следующих переменных:
</p>

<ul>
  <li>
    CFLAGS &amp; CXXFLAGS определяют желаемые флаги компилятора для C и C++.
  </li>
  <li>
    CHOST определяет информацию об используемой платформе для сценария конфигурации приложения.
  </li>
  <li>
    MAKEOPTS передается команде <c>make</c> и обычно применяется для установки степени
    параллельности, используемой во время компиляции. Более подробную информацию об
    опциях команды make можно найти в странице руководства по make.
  </li>
</ul>

<p>
Переменная USE также используется во время конфигурирования и компиляции, но о ней много
и подробно говорилось в предыдущих главах.
</p>

</body>
</subsection>
<subsection>
<title>Опции установки</title>
<body>

<p>
Когда Portage устанавливает новую версию программного продукта, файлы
более старых версий удаляются из вашей системы. Portage дает пользователю
5-ти секундную задержку перед стиранием старых версий. Эти 5 секунд задаются 
переменной CLEAN_DELAY.
</p>

</body>
</subsection>
</section>
<section>
<title>Защита конфигурационных файлов</title>
<subsection>
<title>Места, защищаемые Portage</title>
<body>

<p>
Portage записывает файлы, предоставленные новой версией программы, поверх старых, если
только эти файлы не расположены в  <e>защищенном</e> месте. Эти защищенные директории
определяются переменной CONFIG_PROTECT. Обычно, это места расположения файлов конфигурации.
Директории в списке разделены пробелами.
</p>

<p>
Файл, который должен был бы записан в такую защищенною директорию, переименовывается, а 
пользователь получает предупреждение о наличии новой версии (обычно) файла конфигурации.
</p>

<p>
Узнать текущее значение CONFIG_PROTECT можно из вывода <c>emerge
info</c>:
</p>

<pre caption="Получение значения CONFIG_PROTECT">
$ <i>emerge info | grep 'CONFIG_PROTECT='</i>
</pre>

<p>
Более подробная информация о защите конфигурационных файлов, предоставляемой Portage,
доступна через команду <c>emerge</c>:
</p>

<pre caption="Подробная информация о защите конфигурационных файлов">
$ <i>emerge --help config</i>
</pre>

</body>
</subsection>
<subsection>
<title>Исключение директорий</title>
<body>

<p>
Чтобы снять защиту определенных поддиректорий защищенной директории, вы можете
использовать переменную CONFIG_PROTECT_MASK.
</p>

</body>
</subsection>
</section>
<section>
<title>Опции скачивания</title>
<subsection>
<title>Адреса серверов</title>
<body>

<p>
В случае, когда запрошенная информация или данные не доступны на вашей системе, Portage
пытается получить их из Интернета. Расположение серверов для различных каналов скачивания
информации задаются следующими переменными:
</p>

<ul>
  <li>
    GENTOO_MIRRORS определяет список адресов серверов, которые содержат
    исходные коды (distfiles)
  </li>
  <li>
    PORTAGE_BINHOST определяет особое месторасположения сервера готовых (prebuilt)
    пакетов для вашей системы
  </li>
</ul>

<p>
Третья переменная содержит расположения rsync сервера, который вы используете
при обновлении своего дерева портежей (Portage tree):
</p>

<ul>
  <li>
    SYNC определяет адрес сервера, с которого Portage получает дерево портежей
    (Portage tree)
  </li>
</ul>

<p>
Переменные GENTOO_MIRRORS и SYNC могут быть установлены автоматически с помощью
программы <c>mirrorselect</c>. Вы должны выполнить <c>emerge mirrorselect</c>, прежде
чем сможете использовать ее. За более подробной информацией обращайтесь к системе
помощи mirrorselect:
</p>

<pre caption="Подробная информация о mirrorselect">
# <i>mirrorselect --help</i>
</pre>

<p>
Если вы вынуждены использовать прокси-сервер, вы можете использовать переменные
HTTP_PROXY, FTP_PROXY и RSYNC_PROXY, чтобы указать его адрес. 
</p>

</body>
</subsection>
<subsection>
<title>Команды загрузки данных</title>
<body>

<p>
Когда Portage требуется получить исходный код, по умолчанию используется <c>wget</c>. Вы 
можете это изменить через переменную FETCHCOMMAND.
</p>

<p>
Portage может возобновить загрузку частично уже загруженного исходного кода. По умолчанию
используется <c>wget</c>, но это может быть переопределено с помощью переменной RESUMECOMMAND. 
</p>

<p>
Удостоверьтесь, что ваши команды FETCHCOMMAND и RESUMECOMMAND сохраняют исходный код в
правильном месте. Внутри переменных вам следует использовать \${URI} и \${DISTDIR}, чтобы
указать на расположение исходных кодов и distfiles соответственно.
</p>

<p>
Вы также имеете возможность определить индивидуальные настройки для различных протоколов, 
используя FETCHCOMMAND_HTTP, FETCHCOMMAND_FTP, RESUMECOMMAND_HTTP, RESUMECOMMAND_FTP, и т.п.
</p>

</body>
</subsection>
<subsection>
<title>Настройки Rsync</title>
<body>

<p>
Вы не можете изменить команду rsync, которую Portage использует для обновления 
дерева портежей, но вы имеете возможность установить несколько переменных,
относящихся к команде rsync:
</p>

<ul>
  <li>
    RSYNC_EXCLUDEFROM указывает на файл, в котором указаны пакеты и/или категории,
    которые rsync должен игнорировать во время обновления.
  </li>
  <li>
    RSYNC_RETRIES определяет, сколько раз rsync должен пытаться соединиться с
    зеркалом, на которое указывает переменная SYNC. По умолчанию
    установлена равной 3.
  </li>
  <li>
    RSYNC_TIMEOUT определяет количество секунд, в течение которого rsync соединение
    может бездействовать, перед тем как rsync определит его как превысившее время ожидания.
    По умолчанию равна 180, но пользователям, использующим dialup, возможно, следует
    установить 300 или выше.
  </li>
</ul>

</body>
</subsection>
</section>
<section>
<title>Настройка Gentoo</title>
<subsection>
<title>Выбор ветви</title>
<body>

<p>
Вы можете изменить используемую вами ветвь, установив требуемое значение переменной ACCEPT_KEYWORDS.
По умолчанию используется стабильная ветвь для вашей архитектуры. Более подробно
о ветвях Gentoo можно прочитать в следующем разделе.
</p>

</body>
</subsection>
<subsection>
<title>Возможности Portage</title>
<body>

<p>
Вы можете включить отдельные возможности Portage через переменную FEATURES. Возможности
Portage рассматривались в предыдущих главах, например <uri 
link="?part=2&amp;chap=3">Portage Features</uri>.
</p>

</body>
</subsection>
</section>
<section>
<title>Поведение Portage</title>
<subsection>
<title>Распределение ресурсов</title>
<body>

<p>
С помощью переменной PORTAGE_NICENESS вы можете увеличивать или уменьшать значение nice,
которое используется Portage. Значение  PORTAGE_NICENESS <e>прибавляется</e> к текущему
значению nice.
</p>

<p>
Более подробно о значениях nice написано в странице руководства:
</p>

<pre caption="Подробная информация о nice">
$ <i>man nice</i>
</pre>

</body>
</subsection>
<subsection>
<title>Настройки вывода</title>
<body>

<p>
Переменная NOCOLOR (по умолчанию "false") определяет, следует ли Portage отключить использование
цвета в своем выводе.
</p>

</body>
</subsection>
</section>
</sections>

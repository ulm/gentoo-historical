<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ru/handbook/hb-portage-configuration.xml,v 1.4 2005/11/27 17:35:35 achumakov Exp $ -->

<sections>

<version>1.4</version>
<date>2005-01-22</date>

<section>
<title>Настройка Portage</title>
<subsection>
<body>

<p>
Как отмечалось ранее, Portage настраивается с помощью множества переменных,
которые вам следует задать в файле <path>/etc/make.conf</path>. За более полной
и подробной информацией обращайтесь к странице справки по 
<path>make.conf</path>: 
</p>

<pre caption="Чтение страницы справки по make.conf">
$ <i>man make.conf</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Параметры сборки</title>
<subsection>
<title>Параметры конфигурирования и компиляции</title>
<body>

<p>
Когда Portage собирает приложения, компилятору и сценарию конфигурации
передается содержимое следующих переменных:
</p>

<ul>
  <li>
  CFLAGS и CXXFLAGS определяют желаемые флаги компилятора для C и C++.
  </li>
  <li>
    CHOST определяет информацию об используемой платформе для сценария
    конфигурации приложения.
  </li>
  <li>
    MAKEOPTS передается команде <c>make</c> и обычно применяется для установки
    степени параллельности, используемой во время компиляции. Более подробная
    информация о параметрах команды make может быть найдена в странице
    руководства по make.
  </li>
</ul>

<p>
Переменная USE также используется во время конфигурирования и компиляции, но о
ней много и подробно говорилось в предыдущих главах.
</p>

</body>
</subsection>
<subsection>
<title>Параметры установки</title>
<body>

<p>
Когда Portage устанавливает новую версию программного продукта, файлы
более старых версий удаляются из вашей системы. Portage дает пользователю
5-ти секундную задержку перед стиранием старых версий. Эти 5 секунд задаются 
переменной CLEAN_DELAY.
</p>

</body>
</subsection>
</section>
<section>
<title>Защита конфигурационных файлов</title>
<subsection>
<title>Места, защищаемые Portage</title>
<body>

<p>
Portage записывает файлы, предоставленные новой версией программы, поверх
старых, если только эти файлы не расположены в  <e>защищенном</e> месте. Эти
защищенные каталоги определяются переменной CONFIG_PROTECT. Обычно, это места
расположения файлов конфигурации. Каталоги в списке разделены пробелами.
</p>

<p>
Файл, который должен был бы записан в такой защищенный каталог,
переименовывается, а пользователь получает предупреждение о наличии новой
версии (обычно) файла конфигурации.
</p>

<p>
Узнать текущее значение CONFIG_PROTECT можно из вывода <c>emerge --info</c>:
</p>

<pre caption="Получение значения CONFIG_PROTECT">
$ <i>emerge --info | grep 'CONFIG_PROTECT='</i>
</pre>

<p>
Более подробная информация о защите конфигурационных файлов, предоставляемой 
системой Portage, доступна через команду <c>emerge</c>:
</p>

<pre caption="Подробная информация о защите конфигурационных файлов">
$ <i>emerge --help config</i>
</pre>

</body>
</subsection>
<subsection>
<title>Исключение каталогов</title>
<body>

<p>
Чтобы снять защиту определенных подкаталогов защищенного каталога, вы можете
использовать переменную CONFIG_PROTECT_MASK.
</p>

</body>
</subsection>
</section>
<section>
<title>Параметры скачивания</title>
<subsection>
<title>Расположение сервера</title>
<body>

<p>
В случае, когда запрошенная информация или данные не доступны на вашей системе,
Portage пытается получить их из Интернета. Расположение серверов для различных
каналов скачивания информации задаются следующими переменными:
</p>

<ul>
  <li>
  GENTOO_MIRRORS определяет список адресов серверов, которые содержат
  исходный код (distfiles)
  </li>
  <li>
  PORTAGE_BINHOST определяет особое месторасположение сервера предварительно
  собранных для вашей системы (prebuilt) пакетов 
  </li>
</ul>

<p>
Третья переменная содержит расположения rsync сервера, который вы используете
при обновлении своего дерева портежей(Portage tree):
</p>

<ul>
  <li>
    SYNC определяет адрес сервера, с которого Portage получает дерево портежей
    (Portage tree)
  </li>
</ul>

<p>
Переменные GENTOO_MIRRORS и SYNC могут быть установлены автоматически с помощью
программы <c>mirrorselect</c>. Вы должны выполнить <c>emerge mirrorselect</c>,
прежде чем сможете использовать ее. За более подробной информации обращайтесь к
системе помощи mirrorselect:
</p>

<pre caption="Подробная информация о mirrorselect">
# <i>mirrorselect --help</i>
</pre>

<p>
Если вы вынуждены использовать прокси-сервер, то можете использовать переменные
HTTP_PROXY, FTP_PROXY и RSYNC_PROXY, чтобы указать его адрес. 
</p>

</body>
</subsection>
<subsection>
<title>Команды для скачивания данных (Fetch Commands)</title> 
<body>

<p>
Когда Portage требуется получить исходный код, по умолчанию используется
<c>wget</c>. Вы можете это изменить с помощью переменной FETCHCOMMAND.
</p>

<p>
Portage может возобновить скачивание частично загруженного исходного кода.
По умолчанию используется <c>wget</c>, но это может быть переопределено с
помощью переменной RESUMECOMMAND. 
</p>

<p>
Удостоверьтесь, что ваши команды FETCHCOMMAND и RESUMECOMMAND сохраняют
исходный код в правильном месте. Внутри этих переменных следует использовать
\${URI} и \${DISTDIR}, чтобы указать на расположение исходных кодов и distfiles
соответственно.
</p>

<p>
Также существует возможность определить индивидуальные настройки для различных
протоколов, используя FETCHCOMMAND_HTTP, FETCHCOMMAND_FTP, RESUMECOMMAND_HTTP,
RESUMECOMMAND_FTP, и т.п.
</p>

</body>
</subsection>
<subsection>
<title>Настройки rsync</title>
<body>

<p>
Вы не можете изменить команду rsync, которую Portage использует для обновления
дерева портежей, но есть возможность установить несколько
переменных, определяющих ее поведение:
</p>

<ul>
  <li>
    RSYNC_EXCLUDEFROM указывает на файл, в котором указанны пакеты и/или
    категории, которые rsync должен игнорировать во время обновления.
  </li>
  <li>
    RSYNC_RETRIES определяет, сколько раз rsync должен пытаться соединиться с
    зеркалом, на которое указывает переменная SYNC. По умолчанию
    установлена равной 3.
  </li>
  <li>
    RSYNC_TIMEOUT определяет количество секунд, в течение которого rsync
    соединение может бездействовать, перед тем как rsync определит его как
    превысившее время ожидания. По умолчанию равна 180, но если вы используете
    dialup или у вас медленный компьютер, возможно, следует установить значение
    этой переменной равным 300 или больше.
  </li>
</ul>

</body>
</subsection>
</section>
<section>
<title>Настройка Gentoo</title>
<subsection>
<title>Выбор ветви</title>
<body>

<p>
Вы можете изменить используемую вами ветвь, установив требуемое значение
переменной ACCEPT_KEYWORDS. По умолчанию используется стабильная ветвь для
вашей архитектуры. Более подробная информация о ветвях Gento содержится
в следующей главе.
</p>

</body>
</subsection>
<subsection>
<title>Возможности Portage</title>
<body>

<p>
Вы можете включить отдельные возможности Portage через переменную FEATURES.
Возможности Portage рассматривались в предыдущих главах, например
<uri link="?part=2&amp;chap=3">Возможности Portage</uri>.
</p>

</body>
</subsection>
</section>
<section>
<title>Поведение Portage</title>
<subsection>
<title>Распределение ресурсов</title>
<body>

<p>
С помощью переменной PORTAGE_NICENESS вы можете увеличивать или уменьшать
значение nice, которое используется Portage. Значение  PORTAGE_NICENESS
<e>прибавляется</e> к текущему значению nice.
</p>

<p>
Более подробно о значениях nice написано в странице справки:
</p>

<pre caption="Подробная информация о nice">
$ <i>man nice</i>
</pre>

</body>
</subsection>
<subsection>
<title>Настройки вывода</title>
<body>

<p>
Переменная NOCOLOR(по умолчанию "false") определяет, следует ли Portage
отключить использование цвета в своем выводе.
</p>

</body>
</subsection>
</section>
</sections>

<!-- Localization:
target-language: Russian
target-version: 1.4-r1
target-date: 2005-07-07
source-cvc-revision: 1.9
translated-by: Anton Filimonov
edited-by: Sergey Kuleshov
-->

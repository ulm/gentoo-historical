<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<!-- Текст этого документа распространяется на условиях лицензии CC-BY-SA -->
<!-- См. http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ru/handbook/hb-install-config.xml,v 1.12 2006/03/31 07:56:01 achumakov Exp $ -->

<sections>

<version>2.18</version>
<date>2006-03-28</date>

<section>
<title>Параметры файловых систем</title>
<subsection>
<title>Что такое fstab?</title>
<body>

<p>
В Linux все разделы, используемые системой, должны быть перечислены в
<path>/etc/fstab</path>.
В этом файле указываются точки подключения разделов (mountpoints,
местоположение разделов в файловой системе), порядок подключения,
а также дополнительные параметры (автоматический или ручной режим подключения,
достаточность прав пользователя для подключения и т.п.)
</p>

</body>
</subsection>
<subsection>
<title>Создание /etc/fstab</title>
<body>

<p>
В <path>/etc/fstab</path> используется специальный формат. Каждая строка
состоит из шести полей, разделяемых пробелами, знаками табуляции или их
сочетанием. Каждое поле имеет свое назначение:
</p>

<ul>
<li>
Первое поле обозначает <b>раздел (partition)</b> (путь к файлу устройства).
</li>
<li>
Второе поле указывает <b>точку подключения (mountpoint)</b>, в которую
монтируется раздел.
</li>
<li>
Третье поле задает тип <b>файловой системы (filesystem)</b>, используемой в 
разделе.
</li>
<li>
В четвертом поле указываются <b>параметры подключения (mountoptions)</b>, 
используемые <c>mount</c> при подключении раздела. Поскольку для каждой 
файловой системы существуют свои параметры, рекомендуется прочитать страницу 
справки по mount (<c>man mount</c>), где приведен их полный перечень. При 
указании нескольких параметров подключения их следует разделять запятыми.
</li>
<li>
Пятое поле используется <c>dump</c> для определения, требуется ли резервное 
копирование раздела средствами dump. Обычно это поле можно просто установить в 
<c>0</c> (ноль).
</li>
<li>
Шестое поле используется <c>fsck</c> для определения порядка <b>проверки 
(check)</b> файловых систем после некорректного завершения работы системы. Для 
корневой файловой системы рекомендуется значение <c>1</c>, а для остальных 
&mdash; <c>2</c> (или <c>0</c>, когда проверка файловой системы не требуется).
</li>
</ul>

<p>
Вариант файла <path>/etc/fstab</path> по умолчанию, входящий в Gentoo, <e>не 
является работоспособным</e>, поэтому необходимо создать собственный 
<path>/etc/fstab</path>, запустив <c>nano</c> (или ваш любимый редактор).
</p>

<pre caption="Открытие /etc/fstab">
# <i>nano -w /etc/fstab</i>
</pre>

<p>
Рассмотрим, как указываются параметры загрузочного раздела <path>/boot</path>. 
Это лишь пример, и если в вашей архитектуре не требуется раздел 
<path>/boot</path> (например, как в машинах Apple <b>PPC</b>), не копируйте 
пример дословно.
</p>

<p>
Для примера возьмем архитектуру x86, <path>/boot</path> &mdash; это раздел
устройства <path>/dev/hda1</path> с файловой системой <c>ext2</c>. При загрузке 
требуется его проверка. Напишем следующее:
</p>

<pre caption="Пример строки /boot в /etc/fstab">
/dev/hda1   /boot     ext2    defaults        1 2
</pre>

<p>
Некоторые пользователи предпочитают не подключать раздел <path>/boot</path>
автоматически, чтобы повысить безопасность системы. Для этого нужно заменить
<c>defaults</c> на <c>noauto</c>. В таком случае вам придется подключать раздел 
вручную каждый раз, когда он потребуется.
</p>

<p>
Теперь, чтобы повысить быстродействие, большинству пользователей стоит добавить 
параметр <c>noatime</c> в параметры подключения, что приведет к ускорению за 
счет отключения регистрации отметки времени доступа к файлам (обычно в ней все 
равно нет необходимости):
</p>

<pre caption="Улучшенная строка /boot в /etc/fstab">
/dev/hda1   /boot     ext2    defaults,noatime    1 2
</pre>

<p>
Продолжая в том же духе, добавим следующие три строки (для <path>/boot</path>, 
<path>/</path>, и раздела подкачки):
</p>

<pre caption="Еще три строки в /etc/fstab">
/dev/hda1   /boot     ext2    defaults,noatime  1 2
/dev/hda2   none      swap    sw                0 0
/dev/hda3   /         ext3    noatime           0 1
</pre>

<p>
И наконец, добавим правила для <path>/proc</path>, <c>tmpfs</c> (обязательно), 
а также для дисковода CD-ROM (если есть другие разделы или устройства, их
тоже можно указать):
</p>

<pre caption="Пример полного /etc/fstab">
/dev/hda1   /boot     ext2    defaults,noatime     1 2
/dev/hda2   none      swap    sw                   0 0
/dev/hda3   /         ext3    noatime              0 1

none        /proc     proc    defaults             0 0
none        /dev/shm  tmpfs   nodev,nosuid,noexec  0 0

/dev/cdroms/cdrom0    /mnt/cdrom    auto      noauto,user    0 0
</pre>

<p>
Параметр <c>auto</c> позволяет <c>mount</c> определять тип файловой системы 
автоматически (рекомендуется для съемных носителей, которые могут оказаться 
размечены в одной из множества существующих файловых систем), а <c>user</c> 
позволяет монтировать компакт-диски обычным пользователям.
</p>

<p>
Теперь на основе приведенного примера создайте собственный файл 
<path>/etc/fstab</path>. Если вы &mdash; пользователь <b>SPARC</b>, также 
добавьте в него следующую строку:
</p>

<pre caption="Добавление в /etc/fstab файловой системы openprom">
none        /proc/openprom  openpromfs    defaults      0 0
</pre>

<p>
Перепроверьте свой файл <path>/etc/fstab</path>, сохраните его, и 
выйдите из редактора, чтобы продолжить настройку.
</p>

</body>
</subsection>
</section>
<section>
<title>Параметры сети</title>
<subsection>
<title>Hostname, Domainname и т. д.</title>
<body>

<p>
Еще один вопрос, который нужно решить пользователю &mdash; как назвать свой 
компьютер. Он кажется довольно простым, но <e>многие</e> затрудняются дать 
подходящее имя для своей Linux-системы. Чтобы вам стало легче, запомните, что
какое бы имя вы не выбрали, потом его всегда можно изменить. Например, вы могли 
бы просто назвать свою систему <c>tux</c>, а домен &mdash; <c>homenetwork</c>.
</p>

<p>
Такие значения мы будем использовать в следующих примерах. Во-первых, установим
имя сетевого узла (hostname):
</p>

<pre caption="Установка имени узла">
# <i>nano -w /etc/conf.d/hostname</i>

<comment>(присвойте переменной HOSTNAME имя своего узла)</comment>
HOSTNAME="<i>tux</i>"
</pre>

<p>
Во-вторых, установим имя домена (domainname):
</p>

<pre caption="Установка имени домена">
# <i>nano -w /etc/conf.d/domainname</i>

<comment>(присвойте переменной DNSDOMAIN имя своего домена)</comment>
DNSDOMAIN="<i>homenetwork</i>"
</pre>

<p>
Если у вас есть домен NIS (а если вы не знаете, что это такое, то у вас его 
точно нет), его также необходимо указать: 
</p>

<pre caption="Установка имени NIS-домена">
# <i>echo nis.homenetwork &gt; /etc/nisdomainname</i>
</pre>

</body>
</subsection>
<subsection>
<title>Настройка сети</title>
<body>

<p>
Прежде, чем возмутиться: &laquo;Эй, мы же все это уже делали!&raquo; &mdash; 
вспомните, что подключение к сети, настроенное вначале, было предназначено лишь 
для установки Gentoo. Теперь же вы настраиваете сеть для постоянного 
использования.
</p>

<note>
Более подробные сведения о сетях, включая дополнительные темы, такие как 
объединение, образование мостов, настройка виртуальных сетей (VLAN) 802.1Q или
беспроводных сетей, представлены в разделе <uri link="?part=4">настройка сети в
Gentoo</uri>.
</note>

<p>
Все настройки сети собраны в файле <path>/etc/conf.d/net</path>. В
нем используется простой формат, хотя, если вы не знакомы с ручной 
настройкой сети, он не слишком очевиден. Но не бойтесь, мы все объясним. В 
файле <path>/etc/conf.d/net.example</path> приведен подробно 
прокомментированный пример, охватывающий много различных конфигураций.
</p>

<p>
По умолчанию используется DHCP, а дальнейшая настройка не требуется.
</p>

<p>
Если настройка сетевого подключения нужна вам для указания специфических 
параметров DHCP, или из-за того, что вы вообще не используете DHCP, откройте
<path>/etc/conf.d/net</path> в своем любимом редакторе (в этом примере 
использован <c>nano</c>):
</p>

<pre caption="Открытие /etc/conf.d/net для изменения">
# <i>nano -w /etc/conf.d/net</i>
</pre>

<p>
Вы увидите следующее:
</p>

<pre caption="/etc/conf.d/net по умолчанию">
# This blank configuration will automatically use DHCP for any net.*
# scripts in /etc/init.d.  To create a more complete configuration,
# please review /etc/conf.d/net.example and save your configuration
# in /etc/conf.d/net (this file :]!).
<comment>
(# Этот пустой файл настройки приводит к автоматическому использованию
 # DHCP всеми сценариями net.* из /etc/init.d. Для создания более полной
 # настройки, пожалуйста, просмотрите /etc/conf.d/net.example, а свою
 # настройку сохраните в /etc/conf.d/net (в этом файле :]!).            )</comment>
</pre>

<p>
Чтобы указать свой собственный адрес IP, маску сети и шлюз, потребуется 
настроить как <c>config_eth0</c>, так и <c>routes_eth0</c>:
</p>

<pre caption="Ручная настройка параметров IP для eth0">
config_eth0=( "192.168.0.2 netmask 255.255.255.0 brd 192.168.0.255" )
routes_eth0=( "default gw 192.168.0.1" )
</pre>

<p>
Чтобы при использовании DHCP указать специфические параметры, определите
<c>config_eth0</c> и <c>dhcp_eth0</c>:
</p>

<pre caption="Автоматическое получение адреса IP для eth0">
config_eth0=( "dhcp" )
dhcp_eth0="nodns nontp nonis"
</pre>

<p>
Список допустимых параметров дан в файле <path>/etc/conf.d/net.example</path>.
</p>

<p>
Если у вас несколько сетевых интерфейсов, повторите эти шаги для 
<c>config_eth1</c>, <c>config_eth2</c> и т.д.
</p>

<p>
Теперь сохраните параметры и выйдите из редактора, чтобы продолжить настройку.
</p>

</body>
</subsection>
<subsection>
<title>Автоматический запуск сетевого подключения при загрузке</title>
<body>

<p>
Для запуска сетевых интерфейсов при загрузке необходимо добавить их в уровень 
запуска по умолчанию. Если у вас интерфейсы типа PCMCIA, пропустите этот шаг, 
поскольку интерфейсы PCMCIA запускаются сценарием инициализации PCMCIA.
</p>

<pre caption="Добавление net.eth0 в уровень запуска default">
# <i>rc-update add net.eth0 default</i>
</pre>

<p>
Если у вас несколько сетевых интерфейсов, потребуется создать для них 
соответствующие сценарии инициализации <path>net.eth1</path>, 
<path>net.eth2</path> и т.д. Для этого можно использовать <c>ln</c>:
</p>

<pre caption="Создание дополнительных сценариев инициализации">
# <i>cd /etc/init.d</i>
# <i>ln -s net.eth0 net.eth1</i>
# <i>rc-update add net.eth1 default</i>
</pre>

</body>
</subsection>
<subsection>
<title>Указание сетевых узлов</title>
<body>

<p>
Теперь расскажем системе Linux о вашей сети. Эти сведения указываются в 
<path>/etc/hosts</path>, и помогают разрешению имен в IP-адреса для узлов, не 
обрабатываемых сервером имен. Например, если внутренняя сеть состоит из трех 
компьютеров, названных <c>jenny</c> (192.168.0.5), <c>benny</c> (192.168.0.6) и 
<c>tux</c> (192.168.0.7 &mdash; рассматриваемая система), нужно, открыв
<path>/etc/hosts</path>, ввести такие значения:
</p>

<pre caption="Открытие /etc/hosts">
# <i>nano -w /etc/hosts</i>
</pre>

<pre caption="Указание сведений об узлах сети">
127.0.0.1     localhost
192.168.0.5   jenny.homenetwork jenny
192.168.0.6   benny.homenetwork benny
192.168.0.7   tux.homenetwork tux
</pre>

<p>
Если ваша система &mdash; единственная (или разрешение имен полностью 
осуществляется серверами имен), хватит и одной строки. Например, если вы 
назвали свою систему <c>tux</c>:
</p>

<pre caption="/etc/hosts для автономных или полностью встроенных систем">
127.0.0.1     localhost tux
</pre>

<p>
Чтобы продолжить настройку, сохраните файл и выйдите из редактора.
</p>

<p>
Если у вас нет PCMCIA, можете перейти к разделу <uri 
link="#doc_chap3">параметры системы</uri>. Пользователям PCMCIA рекомендуется
прочитать следующий раздел, посвященный PCMCIA.
</p>

</body>
</subsection>
<subsection>
<title>Дополнительно: запуск PCMCIA</title>
<body>

<note>
pcmcia-cs существует только на платформах x86, amd64 and ppc.
</note>

<p>
Прежде всего, пользователям PCMCIA нужно установить пакет <c>pcmcia-cs</c>. Это 
относится и к пользователям, работающим с ядром 2.6 (даже если они не будут 
пользоваться драйверами PCMCIA из указанного пакета). При установке необходимо
указать <c>USE="-X"</c>, чтобы избежать установки xorg-x11:
</p>

<pre caption="Установка pcmcia-cs">
# <i>USE="-X" emerge pcmcia-cs</i>
</pre>

<p>
После установки <c>pcmcia-cs</c> включите <c>pcmcia</c> в уровень запуска <e>по
умолчанию</e>:
</p>

<pre caption="Добавление pcmcia в уровень запуска default">
# <i>rc-update add pcmcia default</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Параметры системы</title>
<subsection>
<title>Пароль root</title>
<body>

<p>
Прежде всего, нужно установить пароль root (администратора), набрав:
</p>

<pre caption="Установка пароля root">
# <i>passwd</i>
</pre>

<p>
Если вы хотите, чтобы root мог входить в систему через последовательный 
терминал, добавьте <c>tts/0</c> в <path>/etc/securetty</path>:
</p>

<pre caption="Добавление tts/0 to /etc/securetty">
# <i>echo "tts/0" &gt;&gt; /etc/securetty</i>
</pre>

</body>
</subsection>
<subsection>
<title>Параметры системы</title>
<body>

<p>
Для общей настройки системы в Gentoo используется <path>/etc/rc.conf</path>.
Откройте <path>/etc/rc.conf</path> и с удовольствием прочитайте все 
комментарии, находящиеся в этом файле :)
</p>

<pre caption="Открытие /etc/rc.conf">
# <i>nano -w /etc/rc.conf</i>
</pre>

<p>
Завершив изменение <path>/etc/rc.conf</path> сохраните файл и выйдите из 
редактора.
</p>

<p>
Как видите, этот файл подробно прокомментирован, что поможет вам в настройке
необходимых конфигурационных переменных. Можно настроить систему на 
использование unicode, а также указать редактор по умолчанию и диспетчер 
отображения (например, gdm или kdm).
</p>

<p>
Для управления раскладками клавиатуры в Gentoo используется 
<path>/etc/conf.d/keymaps</path>. Для настройки своей клавиатуры измените его. 
</p>

<pre caption="Открытие /etc/conf.d/keymaps">
# <i>nano -w /etc/conf.d/keymaps</i>
</pre>

<p>
Будьте особенно тщательны при установке переменной раскладки клавиатуры
<c>(KEYMAP)</c>: выбрав неверную раскладку, вы можете получить непредсказуемый
результат при попытке ввода с клавиатуры.
</p>

<note>
Пользователям систем SPARC, снабженных USB, и клонов SPARC может потребоваться 
вместо раскладки &laquo;sunkeymap&raquo; указать раскладку i386 (например, 
американскую &mdash; &laquo;us&raquo;). На большинстве систем <b>PPC</b> 
используются раскладки x86. Пользователям, желающим при загрузке иметь 
возможность использования раскладок клавиатуры ADB, необходимо разрешить 
обработку клавиатурных кодов ADB в ядре, и установить раскладку mac/ppc в 
<path>/etc/conf.d/keymaps</path>.
</note>

<p>
По завершении изменения <path>/etc/conf.d/keymaps</path> сохраните файл и 
выйдите из редактора.
</p>
 
<p>
Для настройки параметров часов в Gentoo используется 
<path>/etc/conf.d/clock</path>. Изменяйте его в соответствии со своими
потребностями.
</p>

<p>
Если аппаратные часы вашей системы настроены не на часовой пояс UTC (Гринвич), 
в файл необходимо добавить строку <c>CLOCK="local"</c>. В противном случае 
вы заметите сдвиг часового пояса. Более того, в Windows принято, что аппаратные 
часы установлены на местное время, и если вы собираетесь пользоваться двойной 
загрузкой, нужно соответственно определить эту переменную; в противном случае 
ваши часы &laquo;сойдут с ума&raquo;!
</p>

<p>
После завершения настройки <path>/etc/rc.conf</path> сохраните файл
и выйдите из редактора.
</p>

<p>
Если вы устанавливаете Gentoo не на оборудование типа IBM PPC64, переходите к
<uri link="?part=1&amp;chap=9">установке нужных системных средств</uri>.
</p>

</body>
</subsection>
<subsection>
<title>Настройка консоли</title>
<body>

<note>
Следующие сведения относятся к аппаратным платформам IBM PPC64.
</note>

<p>
Если вы запускаете Gentoo на системе IBM PPC64 с использованием виртуальной
консоли, необходимо раскомментировать соответствующую строку в 
<path>/etc/inittab</path>, чтобы виртуальная консоль могла порождать запрос 
входа в систему.
</p>

<pre caption="Включение поддержки hvc или hvsi в /etc/inittab">
hvc0:12345:respawn:/sbin/agetty -L 9600 hvc0
hvsi:12345:respawn:/sbin/agetty -L 19200 hvsi0
</pre>

<p>
При этом следует убедиться, что соответствующая консоль указана в 
<path>/etc/securetty</path>.
</p>

<p>
Теперь можете переходить к <uri link="?part=1&amp;chap=9">установке
нужных системных средств</uri>.
</p>

</body>
</subsection>
</section>
</sections>

<!-- *$Localization:
target-language: Russian
target-version: 2.18-r2
target-date: 2006-03-31
source-cvs-revision: 1.76
translated-by: (unknown); Alexey Chumakov [achumakov@gentoo.org]
edited-by:  Alexey Chumakov
-->

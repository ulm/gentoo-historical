<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ru/handbook/hb-portage-tools.xml,v 1.6 2012/12/09 19:13:29 swift Exp $ -->

<!-- Текст этого документа распространяется на условиях лицензии CC-BY-SA -->
<!-- См. http://creativecommons.org/licenses/by-sa/2.5 -->

<sections>

<abstract>
Для Portage существуют некоторые дополнительные программы, которые могут 
еще более улучшить ваш опыт использования Gentoo. Прочитайте, как 
использовать dispatch-conf и другие приложения.
</abstract>

<version>2</version>
<date>2010-10-04</date>

<section>
<title>dispatch-conf</title>
<body>

<p>
<c>dispatch-conf</c> это программа, которая помогает объединять файлы вида 
<path>_cfg0000_&lt;имя&gt;</path>. Такие файлы генерируются Portage, когда 
он хочет перезаписать файл в каталоге, который защищен переменной CONFIG_PROTECT.
</p>

<p>
С помощью <c>dispatch-conf</c> можно обновлять файлы конфигурации, сохраняя
при этом историю изменений. <c>dispatch-conf</c> хранит различия между файлами 
конфигурации в виде заплаток или в системе управления версиями RCS. Это означает, 
что если вы сделали ошибку при обновлении файла конфигурации, вы можете вернуться 
на предыдущую версию вашего конфигурационного файла в любое время.
</p>

<p>
При использовании <c>dispatch-conf</c>, вы можете попросить оставить 
конфигурационный файл как есть, использовать новый конфигурационный файл, 
отредактировать текущий, или заменить изменения между ними интерактивно. 
<c>dispatch-conf</c> также имеет некоторые дополнительные возможности:
</p>

<ul>
  <li>
    автоматическое обновление файлов, в которых обновились только комментарии
  </li>
  <li>
    автоматическое обновление файлов, которые отличаются только количеством
    пробелов
  </li>
</ul>

<p>
Убедитесь, что вы сначала отредактировали <path>/etc/dispatch-conf.conf</path> 
и создали каталог, прописанный в archive-dir.
</p>

<pre caption="Запускаем dispatch-conf">
# <i>dispatch-conf</i>
</pre>

<p>
При запуске <c>dispatch-conf</c> вас проведут через каждый измененный файл 
конфигурации, по одному. Нажмите <c>u</c> для обновления (замены) текущего 
конфигурационного файла новым и показа следующего файла. Нажмите <c>z</c>, 
чтобы удалить новый конфигурационный файл и показать следующий файл. Как 
только все конфигурационные файлы будут просмотрены, <c>dispatch-conf</c> 
закончит работу. Вы также можете нажать <c>q</c>, чтобы выйти в любое время.
</p>

<p>
Для более детальной информации проверьте man-страницу <c>dispatch-conf</c>. 
Она расскажет вам, как интерактивно слить текущий и новый конфигурационный файл, 
отредактировать новые конфигурационные файлы, просмотреть разницу между файлами, 
и многое другое.
</p>

<pre caption="Чтение справки по dispatch-conf">
$ <i>man dispatch-conf</i>
</pre>

</body>
</section>


<section>
<title>etc-update</title>
<body>

<p>
Вы также можете использовать <c>etc-update</c> для работы с файлами конфигурации. 
Она не так проста в использовании, как <c>dispatch-conf</c>, и имеет не так много 
возможностей, но она тоже дает возможность инерактивной работы, и тоже может 
автоматически обрабатывать тривиальные изменения.
</p>

<p>
Однако, в отличие от <c>dispatch-conf</c>, <c>etc-update</c> не сохраняет старые 
версии ваших конфигурационных файлов. Как только вы обновили файл, старая версия 
навсегда утеряна! Поэтому будьте очень осторожны, так как использование 
<c>etc-update</c> гораздо менее безопасно, чем использование <c>dispatch-conf</c>.
</p>

<pre caption="Запуск etc-update">
# <i>etc-update</i>
</pre>

<p>
После выполнения тривиальных обновлений, вы увидите запрос со списком 
защищенных файлов, ожидающих обновления. Внизу вам предложат следующие 
варианты:
</p>

<pre caption="Запрос etc-update">
Please select a file to edit by entering the corresponding number.
              (-1 to exit) (-3 to auto merge all remaining files)
                           (-5 to auto-merge AND not use 'mv -i'):

<comment>(Пожалуйста, выберите файл для правки, введя соответствующее число.
         (-1 - выход) (-3 - автоустановка всех оставшихся файлов)
                 (-5 для автоустановки БЕЗ использования 'mv -i'): )</comment>
</pre>

<p>
При вводе <c>-1</c>, <c>etc-update</c> выходит, прекращая последующие 
изменения. Если вы введете <c>-3</c> или <c>-5</c>, <e>все</e> перечисленные 
файлы конфигурации заменяются более новыми версиями. Следовательно, 
очень важно сначало отобрать файлы, которые не следует автоматически 
обновлять. Для этого надо только вводить номер, указанный слева от файлов.
</p>

<p>
Например, выбираем файл конфигурации <path>/etc/pear.conf</path>:
</p>

<pre caption="Обновление конкретного конфигурационного файла">
Beginning of differences between /etc/pear.conf and /etc/._cfg0000_pear.conf
<comment>[...]</comment>
End of differences between /etc/pear.conf and /etc/._cfg0000_pear.conf
1) Replace original with update 
2) Delete update, keeping original as is 
3) Interactively merge original with update 
4) Show differences again 
</pre>

<p>
Теперь можно увидеть различия между двумя файлами. Если вы считаете, что 
обновленный файл конфигурации можно использовать без проблем, введите 
<c>1</c>. Если вы считаете, что обновленный файл конфигурации не нужен, или не 
содержит новую или полезную информацию, введите <c>2</c>. Если вы хотите 
обновить текущий файл в интерактивном режиме, введите <c>3</c>.
</p>

<p>
Нет никакого смысла в подробном описании интерактивного обновления. Для полноты 
изложения, мы перечислим возможные команды, которые можно использовать при
интерактивном слиянии двух файлов. Вас встречают две строки (одна исходная,
вторая измененная) и запрос, в ответ на который можно ввести одну из следующих 
команд:
</p>

<pre caption="Команды, доступные при интерактивном слиянии">
ed:     редактировать и использовать оба варианта, каждый пометить заголовком
eb:     редактировать и использовать оба варианта
el:     редактировать и использовать левый вариант
er:     редактировать и использовать правый вариант
e:      редактировать новую версию
l:      использовать левую версию
r:      использовать правую версию
s:      молча включить общие строки
v:      включить общие строки, сообщив подробности
q:      выход
</pre>

<p>
Завершив обновление важных файлов конфигурации, вы можете автоматически 
обновить оставшиеся файлы конфигурации. <c>etc-update</c> выйдет, если не 
найдет других файлов, подлежащих обновлению.
</p>

</body>
</section>
<section>
<title>quickpkg</title>
<body>

<p>
С <c>quickpkg</c> вы можете создавать архивы пакетов, уже установленных в 
системе. Эти архивы можно использовать в качестве двоичных пакетов. Запуск
<c>quickpkg</c> прост: только укажите имена пакетов, которые нужно 
заархивировать.
</p>

<p>
Например, чтобы поместить в архив <c>curl</c>, <c>orage</c> и <c>procps</c>:
</p>

<pre caption="Пример использования quickpkg">
# <i>quickpkg curl orage procps</i>
</pre>

<p>
Двоичные пакеты будут сохранены в <path>$PKGDIR</path> (по умолчанию, в 
<path>/usr/portage/packages/</path>). Эти пакеты помещаются в 
<path>$PKGDIR/&lt;категория&gt;</path>.
</p>

</body>
</section>
</sections>

<!-- *$Localization:
target-language: Russian
target-date: 2010-10-04
source-cvs-revision: 1.12
translated-by: Analyzer
edited-by: Alexey Chumakov <achumakov@gentoo.org>
edited-by: Romanov Vladimir <blueboar2@gmail.com>
-->

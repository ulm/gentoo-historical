<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ru/handbook/hb-install-hppa-disk.xml,v 1.4 2013/03/22 19:55:34 swift Exp $ -->

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<sections>

<version>3</version>
<date>2013-02-23</date>

<section>
<title>Общие сведения о блочных устройствах</title>

<subsection>
<include href="hb-install-blockdevices.xml"/>
</subsection>

<subsection>
<title>Разделы и слайсы</title>
<body>

<p>
Не смотря на то, что теоретически возможно использовать весь диск для
размещения вашей Linux системы, этого почти никогда не случается на практике.
Вместо этого все большое блочное устройство (диск) разбивается на меньшие,
более удобные для обращения, блочные устройства. Для всех систем они
называются <e>разделами</e>. Другие архитектуры используют похожую технологию,
называемую <e>слайсы</e>.
</p>

</body>
</subsection>
</section>
<section>
<title>Разработка схемы разделения диска</title>
<subsection>
<title>Сколько и какого размера?</title>
<body>

<p>
Количество разделов очень сильно зависит от используемого ПО. Например если в
вашей системе зарегистрировано большое количество пользователей, вероятно вы
захотите, чтобы <path>/home</path> находился отдельно для увеличения
безопасности и упрощения создания резервных копий. Если вы устанавливаете
Gentoo в качестве почтового сервера, то <path>/var</path> должен находиться на
отдельном разделе, т. к. вся почта хранится в <path>/var</path>. Правильный
выбор файловой системы для разделов позволит увеличить производительность вашей
системы. Игровые серверы должны иметь отдельный раздел с <path>/opt</path>,
т. к. большая часть ПО для их работы устанавливается в этот каталог. Причина
выделения на собственный раздел аналогична для <path>/home</path>: безопасность
и резервные копии. Определенно стоит оставить побольше места для 
<path>/usr</path> т.к. помимо того, что здесь хранится большинство приложений,
одно дерево Portage занимает около 500 МБ, не считая архивов с исходными кодами,
размещенных внутри дерева.
</p>

<p>
Как вы можете видеть, все зависит от ваших целей. Наличие отдельных разделов или
томов имеет следующие преимущества:
</p>

<ul>
<li>
  Вы можете выбрать наиболее подходящую файловую систему для каждого раздела
  или тома.
</li>
<li>
  Вы не столкнетесь с нехваткой места на диске для всей системы, например если
  какое-нибудь неправильно работающее приложение постоянно производит запись
  на раздел или том.
</li>
<li>
  В случае необходимости проверка ФС займет меньше времени, т. к. проверка
  разных разделов может выполняться параллельно (однако еще больший выигрыш по
  времени дает использование нескольких физических дисков).
</li>
<li>
  Безопасность системы может быть улучшена если некоторые разделы будут
  смонтированы в режиме read-only (только для чтения), nosuid (setuid бит
  игнорируется), noexec (бит запуска игнорируется) и т.д.
</li>
</ul>

<p>
Однако у множества разделов также есть недостатки. Если они не сконфигурированы 
правильно, у вас будет система с огромным количеством свободного места на одном 
разделе и отсутствием его на другой. Другой проблемой является то, что отдельные 
разделы, особенно для важных точек монтирования, например <path>/usr</path> или <path>/var</path>, часто 
требуют загрузки с использованием initramfs, чтобы смонтировать разделы прежде чем 
запустятся другие загрузочные скрипты. Это не всегда является проблемой, так что 
результаты могут быть разные.
</p>

<p>
Также существует лимит в 15 разделов для SCSI и SATA.
</p>

</body>
</subsection>
</section>
<section>
<title>Использование fdisk в HPPA для создания разделов</title>
<body>

<p>
Используйте <c>fdisk</c> для создания необходимых разделов:
</p>

<pre caption="Разделение диска">
# <i>fdisk /dev/sda</i>
</pre>

<p>
Компьютеры HPPA используют стандартные таблицы разделов DOS. Чтобы создать
новую таблицу, просто задействуйте команду <c>o</c>.
</p>

<pre caption="Создание табицы разделов DOS">
# <i>fdisk /dev/sda</i>

Command (m for help): <i>o</i>
Building a new DOS disklabel.
</pre>

<p>
Для PALO (начальный загрузчик HPPA) для работы необходим специальный раздел.
Для этого вам необходимо создать в начале диска раздел размером не меньше 16
МБ. Тип раздела должен быть <e>f0</e> (Linux/PA-RISC boot).
</p>

<impo>
Если вы проигнорируете это и продолжите без специального раздела PALO, ваша
система перестанет любить вас <!--так в оригинале - system will stop loving
you--> и не сможет загружаться. Если ваш диск больше 2 ГБ, также проверьте,
что загрузочный раздел находится в первых 2 ГБ диска. Иначе PALO не сможет
прочитать ядро за пределами 2 ГБ.
</impo>

<pre caption="Простая схема разделов по умолчанию">
# <i>cat /etc/fstab</i>
/dev/sda2    /boot   ext2    noauto,noatime   1 1
/dev/sda3    none    swap    sw               0 0
/dev/sda4    /       ext4    noatime          0 0

# <i>fdisk /dev/sda</i>

Command (m for help): <i>p</i>

Disk /dev/sda: 4294 MB, 4294816768 bytes
133 heads, 62 sectors/track, 1017 cylinders
Units = cylinders of 8246 * 512 = 4221952 bytes

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1               1           8       32953   f0  Linux/PA-RISC boot
/dev/sda2               9          20       49476   83  Linux
/dev/sda3              21          70      206150   82  Linux swap
/dev/sda4              71        1017     3904481   83  Linux
</pre>

<p>
Теперь, когда разделы созданы, вы можете продолжить с <uri
link="#filesystems">создания файловых систем</uri>.
</p>

</body>
</section>
<section id="filesystems">
<title>Создание файловых систем</title>
<subsection>
<title>Введение</title>
<body>

<p>
Разделы созданы, настало время разместить файловые системы на них. Если вам
безразлично, какую ФС использовать и вы вполне довольны файловой системой,
используемой нами в этой Настольной книге по-умолчанию, вы можете перейти к
разделу <uri link="#filesystems-apply">Размещение файловых систем на
разделе</uri>. Если нет, то продолжайте чтение и узнайте больше о доступных для
использования файловых системах...
</p>

</body>
</subsection>

<subsection>
<include href="hb-install-filesystems.xml"/>
</subsection>

<subsection id="filesystems-apply">
<title>Размещение файловых систем на разделе</title>
<body>

<p>
Для создания файловой системы на разделе или томе существуют утилиты для
каждого доступного типа:
</p>

<table>
<tr>
  <th>Файловая система</th>
  <th>Команда</th>
</tr>
<tr>
  <ti>ext2</ti>
  <ti><c>mkfs.ext2</c></ti>
</tr>
<tr>
  <ti>ext3</ti>
  <ti><c>mkfs.ext3</c></ti>
</tr>
<tr>
  <ti>ext4</ti>
  <ti><c>mkfs.ext4</c></ti>
</tr>
<tr>
  <ti>reiserfs</ti>
  <ti><c>mkreiserfs</c></ti>
</tr>
<tr>
  <ti>xfs</ti>
  <ti><c>mkfs.xfs</c></ti>
</tr>
<tr>
  <ti>jfs</ti>
  <ti><c>mkfs.jfs</c></ti>
</tr>
</table>

<p>
К примеру, для создания загрузочного раздела (<path>/dev/sda2</path> в нашем
примере) с файловой системой ext2 и корневого раздела 
(<path>/dev/sda4</path> в нашем примере) c файловой системой ext4, вы 
должны выполнить следующие команды:
</p>

<pre caption="Размещение ФС на разделе">
# <i>mkfs.ext2 /dev/sda2</i>
# <i>mkfs.ext4 /dev/sda4</i>
</pre>

<p>
Теперь разместите файловые системы на вновь созданных разделах (или логических
томах).
</p>

</body>
</subsection>
<subsection>
<title>Активация раздела подкачки</title>
<body>

<p>
<c>mkswap</c> &mdash; команда, используемая для инициализации раздела подкачки:
</p>

<pre caption="Создание сигнатуры раздела подкачки">
# <i>mkswap /dev/sda3</i>
</pre>

<p>
Для активации раздела подкачки используется <c>swapon</c>:
</p>

<pre caption="Активация раздела подкачки">
# <i>swapon /dev/sda3</i>
</pre>

<p>
Создайте и активируйте раздел подкачки командой, описаной выше.
</p>

</body>
</subsection>
</section>
<section>
<title>Монтирование</title>
<body>

<p>
Теперь, когда разделы созданы и файловые системы размещены настало время
смонтировать эти разделы. Используйте команду <c>mount</c>. Не забудьте
предварительно создать необходимые каталоги для монтирования каждого раздела.
В этом примере мы создаем точку монтирования и монтируем корневой раздел:
</p>

<pre caption="Монтирование разделов">
# <i>mount /dev/sda4 /mnt/gentoo</i>
# <i>mkdir /mnt/gentoo/boot</i>
# <i>mount /dev/sda2 /mnt/gentoo/boot</i>
</pre>

<note>
Если вы хотите разместить <path>/tmp</path> на отдельном разделе, не забудьте
изменить права доступа к этому каталогу после монтирования: <c>chmod 1777
/mnt/gentoo/tmp</c>. Это также относится и к <path>/var/tmp</path>.
</note>

<p>
Нам также необходимо будет смонтировать ФС proc (виртуальный интерфейс ядра) в
каталог <path>/proc</path>. Но для начала надо разместить необходимые нам файлы
на разделах.
</p>

<p>
Переходите к разделу <uri link="?part=1&amp;chap=5">Подготовка установочных
файлов Gentoo</uri>.
</p>

</body>
</section>
</sections>

<!-- *$Localization:
target-language: Russian
target-date: 2013-02-23
source-cvs-revision: 1.31
translated-by: Vasiliy Golubev <vas@nightmail.ru>
translated-by: Azamat H. Hackimov <azazello1984@mail.ru>
edited-by: Vladimir Romanov <blueboar2@gmail.com>
-->

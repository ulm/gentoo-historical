<?xml version='1.0' encoding="UTF-8"?>

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link = "/doc/ru/env.d-howto.xml">

<title>Env.d HOWTO</title>
<author title="Author"><mail link="zhen@gentoo.org">John P. Davis</mail></author>
<author title="Переводчик"><mail link="pythoo@yandex.ru">Иван Зенков</mail></author>
<author title="Editor"><mail link="alv@linux-online.ru">Алексей Федорчук</mail></author>

<abstract>
Это руководство разъясняет значение и способы применения каталога
<path>/etc/env.d</path> и того, что в нем находится.
</abstract>

<version>1.4</version>
<date>21 Dec 2002</date>

<chapter>
<title>Введение, <c>env.d</c> и универсальные переменные</title>

<section>
	<title>Основные переменные рабочей среды в дистрибутиве Gentoo</title>
	<body>

<p>Один из самых частых вопросов, которые мы получаем от пользователей
Gentoo, это: "где находятся переменные рабочей среды и как они настроены?". Чтобы понять этот вопрос, сначала мы должны узнать, какие
бывают переменные. Обычно переменные устанавливаются с помощью команды
<c>export</c>. Например выполнив <c>export EDITOR="/usr/sbin/vim"</c>,
вы установите переменную сообщающую системе, что редактором по
умолчанию является vim. Есть много других переменных, которые могут
быть установлены на вашей Gentoo системе, вот некоторые из них:</p>

<note><c>export</c> выставляет переменные для оболочки и *всех*
дочерних процессов. Если вы хотите установить переменную, не действующую для дочерних процессов, то просто используйте что-то вроде <i>FOO="bar"</i>.</note>

<note>Ваш файл <i>00basic</i> может быть несколько другим. Это - не
проблема, поскольку это заданные по умолчанию переменные, настройки которых с самого начала упакованы в Gentoo.</note>

<info>Эти примеры могут быть найдены в <path>/etc/env.d/00basic</path>.</info>

<table>
<tr><th>Переменная</th><th>Функция переменной</th></tr>

<tr><ti>PATH</ti><ti> Эта переменная устанавливает путь поиска
программ. Символ ':' - разделитель путей. Пример переменной - что-то вроде
<c>PATH=/usr/local/bin:/opt/bin</c>.</ti></tr>

<tr><ti>ROOTPATH</ti><ti> Эта переменная похожа на PATH, но устанавливает путь поиска программ для пользователя <c>root</c>. Символ ':' - разделитель путей. Пример переменной -  <c>ROOTPATH=/usr/local/bin:/opt/bin</c>.</ti></tr>

<tr><ti>LDPATH</ti><ti> Эта переменная указывает путь поиска библиотек
для связывания. Тот же разделитель путей - ':'. Пример переменной будет
смотреться как <c>LDPATH=/usr/local/lib</c>.</ti></tr>

<tr><ti>MANPATH</ti><ti> Эта переменная указывает путь на каталоги man-страниц вашей системы. Чемто схоже с <i>PATH</i>, но только для man-страниц. Пример переменной - <c>MANPATH=/usr/share/man:/usr/local/share/man</c>.</ti></tr>

<tr><ti>INFODIR</ti><ti> Эта переменная указывает путь на каталоги с
info-страницами. Пример - <c>INFODIR=/usr/share/info</c>.</ti></tr>

<tr><ti>PAGER</ti><ti> Эта переменная устанавливает используемый вами пейджер, то есть less или more. Например, <c>PAGER=/usr/bin/less </c>.</ti></tr>

<tr><ti>EDITOR</ti><ti> Данная переменная устанавливает системный редактор. Например так - <c>EDITOR=/usr/bin/vim </c>.</ti></tr>
</table>

<p>Этот пример файла <i>00basic</i> даст вам представление о том, как все должно выглядеть, а также пригодится на случай, если с вашим <c>00basic</c> что-нибудь случиться.</p>

<pre caption = "00basic">
# Copyright 1999-2002 Gentoo Technologies, Inc.
# Distributed under the terms of the GNU General Public License, v2 or later
# $Header: /home/cvsroot/gentoo-src/rc-scripts/etc/env.d/00basic,v 1.6 2002/06/20 22:07
:37 azarah Exp $

PATH=/usr/local/bin:/opt/bin
ROOTPATH=/usr/local/bin:/opt/bin
LDPATH=/usr/local/lib
MANPATH=/usr/share/man:/usr/local/share/man
INFODIR=/usr/share/info
CVS_RSH=ssh
PAGER=/usr/bin/less
EDITOR=/usr/bin/vim
LESSOPEN="|lesspipe.sh %s"
</pre>

</body>
</section>

<section>
<title>Формат env.d</title>

<body>
<p>Файлы внутри <c>env.d</c> размещаются в логическом порядке так, чтобы выполнение <c>env-update</c> определяло переменные в заданной последовательности. Числа в начале названия файла определяют, в каком порядке производит их чтение, то есть <i>00basic</i> анализируется первым, <i>01что-то</i> вторым и т.д. Содержание внутри файлов также имеет определенный формат:</p>

<pre caption = "Содержание формата">
<comment># Это комментарий, как в BASH</comment>
<i>переменная1=/куда/-/то</i>
<comment>Некоторые переменные имеют разделитель ':'.</comment>
<i>пер1а=/путь/к/чему/-то:/другой/путь/куда-то</i>
<i>переменная2=/что_то</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Специальные переменные, и как это все вместе контактирует.</title>

<section>
<title>Специальные переменные</title>
<body>

<p>Есть некоторые специальные переменные, которые включены в <c>env.d</c>. Такие например как: <i>KDEDIRS, PATH, CLASSPATH, LDPATH, MANPATH, INFODIR, ROOTPATH, CONFIG_PROTECT, CONFIG_PROTECT_MASK</i>. Они специальные, потому что они обработаны особым способом, и помещены в специальные файлы, про которые я все объясню позже.</p>

<note>Некоторые из переменных, рассматриваемых ниже, также были рассмотрены в примере с <i>00basic</i>. Это хорошо, потому что значения переменных могут использоваться несколько раз в отдельных файлах, подробнее смотри ниже.</note>

<table>
<tr><th>Переменная</th><th>Функция переменной</th></tr>
<tr><ti>KDEDIRS</ti><ti> Эта переменная указывает путь для всех файлов
KDE.</ti></tr>

<tr><ti>PATH</ti><ti> Уже упомянуто, ':' - разделитель (см. выше).</ti></tr>

<tr><ti>CLASSPATH</ti><ti> Эта переменная указывает путь для Java
классов, ':' - разделитель.</ti></tr>

<tr><ti>LDPATH</ti><ti> Уже упомянуто, (см. выше).</ti></tr>

<tr><ti>MANPATH</ti><ti> Уже упомянуто (см. выше), ':' - разделитель.</ti></tr>

<tr><ti>INFODIR</ti><ti> Уже упомянуто (см. выше), ':' - разделитель.</ti></tr>

<tr><ti>ROOTPATH</ti><ti> Уже упомянуто (см. выше), ':' - разделитель.</ti></tr>

<tr><ti>CONFIG_PROTECT</ti><ti> Эта переменная определяет конфигурационные файлы <path>/etc</path>, которые не будут изменены после установки нового пакета. Параметры данной переменной могут быть разделены.</ti></tr>

<tr><ti>CONFIG_PROTECT_MASK</ti><ti>Эта переменная - инверсия переменной
CONFIG_PROTECT. Она определяет, какие файлы в защищенном каталоге (<path>/etc></path>) все-таки должны быть изменены после установки нового пакета.</ti></tr>
</table>

</body>
</section>

<section>
<title>Объединим все в одном</title>
<body>

<p>Хорошо, теперь когда я все объяснил, вы, вероятно, зададитесь вопросом: какое отношение все это имеет к вашей Gentoo системе? Сила <i>env.d</i> в том, что вы можете изменять эти переменные под свои нужды, как пожелаете. С описанным выше вам это будет легче сделать.</p>

<p>Теперь, когда мы знаем о том, как все устроено, пришло время объяснить, что происходит с этими переменными. Когда запускается <c>env-update</c>, то он связывает все эти файлы в указанном порядке. Помните, когда я сказал, что хорошо иметь множественные переменные <i>PATH</i>, находящиеся в различных файлах Это, потому что <c>env-update</c> проходит файлы последовательно соединяя пути вместе. Так, если у вас есть <i>PATH</i> для KDE, GNOME и для X, <c>env-update</c> свяжет все это в один объединенный путь. Нравится?</p>

<p>Так как эти переменные теперь связаны вместе, то важно обратить
внимание, где они сохранены.</p>

<note>Нижеперечисленные файлы создаются при запуске <c>env-update</c></note>

<pre caption = "Файлы созданные объединением всех фалов в env.d">
<i>LDPATH ----> /etc/ld.so.conf</i>
<i>CONFIG_PROTECT и CONFIG_PROTECT_MASK ----> /etc/profile.env (как
экспортированные переменные</i>
<i>Специальные и всякие ----> /etc/profile.env</i></pre>

<p>Если вы посмотрите внутрь <path>/etc/ld.so.conf</path>, вы увидите,
что источником размещенной там информации был <i>env.d</i>.</p>

<pre caption = "/etc/ld.so.conf">
# ld.so.conf autogenerated by env-update; make all changes to
# contents of /etc/env.d directory
/usr/local/lib
/usr/lib/gcc-lib/i686-pc-linux-gnu/3.2
/usr/lib/opengl/nvidia/lib
/usr/lib/mozilla
/usr/X11R6/lib
/opt/blackdown-jdk-1.3.1/jre/lib/i386/
/opt/blackdown-jdk-1.3.1/jre/lib/i386/native_threads/
/usr/qt/3/lib
/usr/qt/2/lib
/usr/kde/3/lib
</pre>

<p>Хорошо также узнать, что <path>/etc/profile.env</path> - это тоже
самое, что и ваш shell.env (то есть <i>csh.env</i> или <i>bash.env</i>). А хорошо это потому, что теперь вы можете использовать все ваши переменные в оболочке после следующего запуска.</p>

<pre capton = "Последовательность этапов действия env-update">
<i>/etc/env.d настройки ----env-update----> /etc/profile.env ---> /etc/profile 
---> bash ---> все ваши программы</i>
</pre>

<p>Теперь, когда у вас есть <i>profile.env</i>, он может выглядеть так: </p>

<pre caption = "/etc/profile.env">
export CONFIG_PROTECT='/usr/kde/3/share/config /usr/share/config'
export KDEDIRS='/usr/kde/3:/usr'
export MANPATH='/usr/share/man:/usr/local/share/man:/usr/X11R6/man:/opt/blackdown-jdk-1.3.1/man'
export INFODIR='/usr/share/info:/usr/X11R6/info'
export PATH='/usr/local/bin:/opt/bin:/opt/rar/bin:/usr/X11R6/bin:/opt/blackdown-jdk-1.3.1/bin:/opt/blackdown-jdk-1.3.1/jre/bin:/usr/qt/3/bin:/usr/qt/2/bin:/usr/kde/3/bin'
export CONFIG_PROTECT_MASK='/etc/gconf'
export CLASSPATH='/opt/blackdown-jdk-1.3.1/jre/lib/rt.jar:.'
export ROOTPATH='/usr/local/bin:/opt/bin:/opt/rar:/usr/X11R6/bin:/opt/blackdown-jdk-1.3.1/bin:/opt/blackdown-jdk-1.3.1/jre/bin:/usr/qt/3/bin:/usr/qt/2/bin:/usr/kde/3/bin'
export KDEDIR='/usr/kde/3'
export VIMRUNTIME='/usr/share/vim/vim61'
export JDK_HOME='/opt/blackdown-jdk-1.3.1'
export JAVAC='/opt/blackdown-jdk-1.3.1/bin/javac'
export PAGER='/usr/bin/less'
export HOSTNAME='l00ser.muc.edu'
export QMAKESPEC='linux-g++'
export LESSOPEN='|lesspipe.sh %s'
export CVS_RSH='ssh'
export EDITOR='/usr/bin/vim'
export QTDIR='/usr/qt/3'
export JAVA_HOME='/opt/blackdown-jdk-1.3.1'
export XINITRC='/etc/X11/xinit/xinitrc'
export MOZILLA_FIVE_HOME='/usr/lib/mozilla'
</pre>

<p>Хорошо, это все что я хотел сказать, наслаждайтесь и постарайтесь
ничего не нарушить!</p>

	</body>
</section>
</chapter>

<chapter>
<title>От редактора. Примеры применения</title>

<section>
	<title>Настройка локали</title>
	<body>

<p>
С помощью механизма <c>env-update</c> легко выполнить локализацию системы, например, установить русскую локаль (рассмотрено на примере KOI8-R). Для этого в конце файла <path>/etc/env.d/00basic</path> следует определить переменную LANG:
</p>

<pre capton = "Определение переменной LANG">
LANG="ru_RU.KOI8-R"
</pre>

<p>
а затем просто выполнить команду
</p>

<pre capton = "Включение локали">
# env-update
</pre>

<p>
и перечитать переменные окружения командой 
</p>

<pre capton = "Перечитывание переменных окружения">
# source /etc/profile
</pre>

<p>
В результате в ответ на команду <c>locale</c> будет выведено следующее:
</p>

<pre capton = "Вывод команды locale">
LANG=ru_RU.KOI8-R
LC_CTYPE="ru_RU.KOI8-R"
LC_NUMERIC="ru_RU.KOI8-R"
LC_TIME="ru_RU.KOI8-R"
LC_COLLATE="ru_RU.KOI8-R"
LC_MONETARY="ru_RU.KOI8-R"
LC_MESSAGES="ru_RU.KOI8-R"
LC_PAPER="ru_RU.KOI8-R"
LC_NAME="ru_RU.KOI8-R"
LC_ADDRESS="ru_RU.KOI8-R"
LC_TELEPHONE="ru_RU.KOI8-R"
LC_MEASUREMENT="ru_RU.KOI8-R"
LC_IDENTIFICATION="ru_RU.KOI8-R"
LC_ALL=
</pre>

<p>
Разумеется, тем же образом можно настроить и любую другую русскую (cp1251, например) и даже нерусскую:-) локаль.
</p>

	</body>
</section>
</chapter>

</guide>

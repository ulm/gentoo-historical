<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ru/gentoo-x86-quickinstall.xml,v 1.5 2005/12/04 00:28:20 achumakov Exp $ -->

<guide link="/doc/ru/gentoo-x86-quickinstall.xml" lang="ru">
<title>Краткое руководство по установке Gentoo Linux x86</title>

<author title="автор">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="автор">Steven Wagner</author>
<author title="переводчик">
  <mail link="mike.spacer@gmail.com">Михаил Ярмиш</mail>
</author>

<abstract>
В руководстве кратко описывается процесс установки Gentoo. Чтобы следовать 
этому руководству, нужен предшествующий опыт установки Gentoo Linux.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<!-- Текст этого документа распространяется на условиях лицензии CC-BY-SA -->
<!-- См. http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>2.8</version>
<date>2005-10-14</date>

<chapter>
<title>Краткое руководство по установке</title>
<section>
<title>Установочный диск</title>
<body>

<p>
Скачайте компакт-диск с одного из наших <uri 
link="/main/en/mirrors.xml">зеркал</uri>. ISO-образы находятся в каталогах: 
<path>releases/&lt;архитектура&gt;/&lt;выпуск&gt;/установочный-диск</path>. 
<e>Минимальный</e> установочный диск подходит только для установки из 
интернета; с <e>универсального</e> диска также возможна установка без обращения 
к сети.
</p>

<p>
<uri link="/doc/en/faq.xml#isoburning">Запишите</uri> компакт-диск, затем 
загрузитесь с него. В загрузочном окне нажмите <c>F2</c>, чтобы выяснить, какие 
варианты загрузки предлагаются. Если вам нужна поддержка PCMCIA, сразу после 
загрузки потребуется запустить сценарий инициализации <c>pcmcia</c>.
</p>

<p>
Установочные диски позволяют запускать сервер <c>sshd</c>, добавлять новых
пользователей, запускать <c>irssi</c> (консольный чат-клиент) и просматривать 
веб-страницы с помощью <c>lynx</c> или <c>links2</c>.
</p>

</body>
</section>
<section>
<title>Настройка сети</title>
<body>

<p>
Если ваша сеть еще не работает, для ее настройки можно использовать 
<c>net-setup</c>. Перед настройкой вам может потребоваться загрузить поддержку  
свой сетевой платы с помощью <c>modprobe</c>. Если у вас ADSL, используйте 
<c>adsl-setup</c> и <c>adsl-start</c>. Для поддержки PPTP, сначала 
отредактируйте <path>/etc/ppp/chap-secrets</path> и 
<path>/etc/ppp/options.pptp</path>, а затем запустите <c>pptp 
&lt;ip&nbsp;сервера&gt;</c>.
</p>

<p>
При беспроводном доступе для установки параметров соединения используйте 
<c>iwconfig</c>, а затем либо опять <c>net-setup</c>, либо запустите вручную
<c>ifconfig</c>, <c>dhcpcd</c> и/или <c>route</c>.
</p>

<p>
Если вы находитесь за прокси-сервером, не забудьте инициализировать 
систему с помощью <c>export http_proxy</c>, <c>ftp_proxy</c> и <c>RSYNC_PROXY</c>.
</p>

</body>
</section>
<section>
<title>Подготовка дисков</title>
<body>

<p>
Для организации разделов запустите <c>fdisk</c> или <c>cfdisk</c>. Вам
нужен хотя бы раздел подкачки (тип 82) и один раздел Linux (тип 83).
</p>

<p>
Для создания файловых систем на своих Linux-разделах используйте <c>mke2fs</c>, 
<c>mke2fs -j</c>, <c>mkreiserfs</c>, <c>mkfs.xfs</c> <c>mkfs.jfs</c>. 
Подготовьте свой раздел подкачки командами <c>mkswap</c> и <c>swapon</c>. 
</p>

<p>
Смонтируйте свежесозданные файловые системы в <path>/mnt/gentoo</path>. Создайте
каталоги для других точек монтирования (например, 
<path>/mnt/gentoo/boot</path>), если они вам нужны.
</p>

</body>
</section>
<section>
<title>Установка стадии</title>
<body>

<p>
Прежде всего, установите верную дату командой <c>date MMDDhhmmYYYY</c>. Далее
скачайте файл стадии с одного из наших <uri 
link="/main/en/mirrors.xml">зеркал</uri> или используйте находящийся на 
установочном диске (в <path>/mnt/cdrom/stages</path>). 
Перейдите в <path>/mnt/gentoo</path> и распакуйте стадию командой
<c>tar&nbsp;-xvjpf&nbsp;&lt;архив&nbsp;стадии&gt;</c>.
</p>

<p>
В случае установки без сети установите снимок портежей: перейдите в 
<path>/mnt/gentoo/usr</path> и запустите 
<c>tar&nbsp;-xvjf&nbsp;/mnt/cdrom/snapshots/&lt;файл снимка&gt;</c>. Другие
пользователи таким же образом могут скачать снимок портежей и установить его.
</p>

<p>
При установке без сети, скопируйте файлы исходников из 
<path>/mnt/cdrom/distfiles/</path> в 
<path>/mnt/gentoo/usr/portage/distfiles/</path>.
</p>

<p>
Отредактируйте <path>/mnt/gentoo/etc/make.conf</path> под ваши нужды (флаги 
USE, CFLAGS и CXXFLAGS). Для этого можно использовать редактор <c>nano</c>.
</p>

</body>
</section>
<section>
<title>Установка базовой системы Gentoo</title>
<body>

<p>
Сначала смонтируйте файловую систему <path>/proc</path>, скопируйте
файл <path>/etc/resolv.conf</path> поверх существующего, а затем смените 
корневой каталог (chroot) на свою среду Gentoo.
</p>

<pre caption="Подготовка и смена корневого каталога">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/etc/</i>
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i> &amp;&amp; <i>source /etc/profile</i>
</pre>

<p>
Если вы не выполняете бессетевую установку, командой <c>emerge --sync</c> 
обновите свое дерево портежей.
</p>

<p>
Далее убедитесь, что <path>/etc/make.profile</path> указывает на верный профиль.
Профиль по умолчанию должен подойти большинству пользователей; имеются подпрофили
для различных ядер (например, <path>2.4/</path> для профилей, основанных на 
ядре 2.4). Изменяйте профиль командой <c>ln -sfn</c>.
</p>

<ul>
  <li>
    Самогенерация системы (не выполняется при бессетевой установке) запускается 
    сценарием <c>scripts/bootstrap.sh</c> в каталоге <path>/usr/portage</path>.
  </li>
  <li>
    Установка системы (не выполняется при бессетевой установке) запускается 
    командой <c>emerge&nbsp;-e&nbsp;system</c> (или <c>-N</c>, если вы не меняли
    значения CFLAGS/CXXFLAGS по умолчанию).
  </li>
</ul>

</body>
</section>
<section>
<title>Настройка ядра</title>
<body>

<p>
Установите сведения о своем часовом поясе, сменив символьную ссылку 
<path>/etc/localtime</path> на указывающую на верное место в 
<path>/usr/share/zoneinfo</path> командой <c>ln -sf</c>.
</p>

<p>
Установите исходный код ядра (при установке без сети доступны 
<c>gentoo-sources</c> и <c>vanilla-sources</c>) и настройте его с помощью 
<c>make menuconfig</c>, затем 
<c>make&nbsp;&amp;&amp;&nbsp;make&nbsp;modules_install</c> внутри каталога 
<path>/usr/src/linux</path>. Скопируйте файл <path>arch/i386/boot/bzImage</path>
в <path>/boot</path>, заменяя существующий. Также можно выполнить 
<c>emerge&nbsp;genkernel</c> и <c>genkernel&nbsp;all</c>.
</p>

<p>
Пользователям, использующим Genkernel, потребуется выполнить 
<c>emerge&nbsp;coldplug</c> и 
<c>rc-update&nbsp;add&nbsp;coldplug&nbsp;default</c>.
</p>

</body>
</section>
<section>
<title>Настройка системы</title>
<body>

<p>
Отредактируйте свой <path>/etc/fstab</path>; пример показан ниже.
</p>

<pre caption="Пример файла fstab">
/dev/hda1   /boot     ext2    defaults,noatime     1 2
/dev/hda2   none      swap    sw                   0 0
/dev/hda3   /         ext3    noatime              0 1
none        /proc     proc    defaults             0 0
none        /dev/shm  tmpfs   nodev,nosuid,noexec  0 0
/dev/cdroms/cdrom0    /mnt/cdrom    auto      noauto,user    0 0
</pre>

<p>
Для настройки своей сети отредактируйте <path>/etc/conf.d/hostname</path> и
<path>/etc/conf.d/domainname</path>, запустите 
<c>rc-update&nbsp;add&nbsp;domainname&nbsp;default</c>, затем отредактируйте 
<path>/etc/conf.d/net</path>. Добавьте сценарий инициализации <c>net.eth0</c> к 
уровню запуска по умолчанию (default run level). Если у вас несколько сетевых 
карт (NIC), поместите символьные ссылки на них в сценарий инициализации 
<c>net.eth0</c>, и также добавьте их в уровень запуска по умолчанию.
</p>

<p>
Отредактируйте <path>/etc/hosts</path>; примеры приведены ниже:
</p>

<pre caption="Примеры файла /etc/hosts">
<comment>(Для статических IP-адресов)</comment>
127.0.0.1     localhost
192.168.0.5   jenny.homenetwork jenny
192.168.0.6   benny.homenetwork benny
192.168.0.7   tux.homenetwork tux

<comment>(Для динамических IP-адресов)</comment>
127.0.0.1     localhost.homenetwork tux localhost
</pre>

<p>
При необходимости установите (emerge) <c>pcmcia-cs</c> и добавьте его в уровень 
запуска по умолчанию.
</p>

<p>
Установите пароль root с помощью <c>passwd</c>.
</p>

<p>
Выполните необходимую настройку в файлах: <path>/etc/rc.conf</path>, 
<path>/etc/conf.d/rc</path>, <path>/etc/conf.d/keymaps</path>,
<path>/etc/conf.d/clock</path>.
</p>

</body>
</section>
<section>
<title>Установка системных утилит</title>
<body>

<p>
Пользователям ядра 2.4 нужно запустить <c>emerge&nbsp;--unmerge&nbsp;udev</c> 
и <c>emerge&nbsp;devfsd</c>.
</p>

<p>
Установите системный журнал, например <c>syslog-ng</c>, и добавьте его в
уровень запуска по умолчанию. Сделайте то же самое для демона cron, например,
<c>vixie-cron</c> (необязательный шаг).
</p>

<p>
Установите необходимые средства для файловых систем (<c>xfsprogs</c>, 
<c>reiserfsprogs</c> или <c>jfsutils</c>), а также для сети (<c>dhcpcd</c> или 
<c>rp-pppoe</c>).
</p>

</body>
</section>
<section>
<title>Настройка загрузчика</title>
<body>

<p>
Установите (emerge) <c>grub</c> или <c>lilo</c>. Отредактируйте 
<path>/boot/grub/grub.conf</path> или <path>/etc/lilo.conf</path>, 
соответственно. Ниже приведены примеры обоих.
</p>

<pre caption="Пример grub.conf">
default 0
timeout 30
splashimage=(hd0,0)/grub/splash.xpm.gz

<comment># для пользователей genkernel</comment>
title=Gentoo Linux 2.6.11-r3
root (hd0,0)
kernel /kernel-genkernel-x86-2.6.11-gentoo-r3 root=/dev/ram0 init=/linuxrc ramdisk=8192 real_root=/dev/hda3 udev
initrd /initramfs-genkernel-x86-2.6.11-gentoo-r3

<comment># для остальных пользователей (без initrd)</comment>
title=Gentoo Linux 2.6.11 r3
root (hd0,0)
kernel /kernel-2.6.11-gentoo-r3 root=/dev/hda3

<comment># только если вам нужна двойная загрузка</comment>
title=Windows XP
root (hd0,5)
makeactive
chainloader +1
</pre>

<pre caption="Пример файла lilo.conf">
boot=/dev/hda
prompt
timeout=50
default=gentoo

<comment># для пользователей, не использующих genkernel</comment>
image=/boot/kernel-2.6.11-gentoo-r3
  label=gentoo
  read-only
  root=/dev/hda3

<comment># для пользователей genkernel</comment>
image=/boot/kernel-genkernel-x86-2.6.11-gentoo-r3
  label=gentoo
  read-only
  root=/dev/ram0
  append="init=/linuxrc ramdisk=8192 real_root=/dev/hda3 udev"
  initrd=/boot/initramfs-genkernel-x86-2.6.11-gentoo-r3

<comment># Для двойной загрузки</comment>
other=/dev/hda6
  label=windows
</pre>

<p>
Пользователям GRUB необходимо установить GRUB в главную загрузочную запись 
(MBR) командой <c>grub-install&nbsp;/dev/hda</c> после копирования 
<path>/proc/mounts</path> в <path>/etc/mtab</path>. Пользователям LILO 
нужно запустить <c>/sbin/lilo</c>.
</p>

<p>
Выйдите из изолированной среды, размонтируйте все файловые системы и 
перезагрузитесь.
</p>

</body>
</section>
<section>
<title>Окончание установки</title>
<body>

<p>
Зайдите как <c>root</c>, затем добавьте одного или нескольких пользователей для 
повседневного использования командой 
<c>useradd&nbsp;-m&nbsp;-G&nbsp;&lt;группа&gt;&nbsp;&lt;имя 
пользователя&gt;</c>.
</p>

<p>
Если вы выполняли установку без сети, смонтируйте компакт-диск с пакетами в
<path>/mnt/cdrom</path> и выполните <c>export&nbsp;PKGDIR="/mnt/cdrom"</c>,
после чего вы сможете устанавливать дополнительное ПО, например, <c>kde</c>, 
командой <c>emerge&nbsp;-k&nbsp;&lt;имя пакета&gt;</c>.
для .
</p>

<p>
Спасибо за установку Gentoo!
</p>

</body>
</section>
</chapter>
</guide>

<!-- *$Localization:
target-language: Russian
target-version: 1.49-r2
target-date: 2005-12-04
translated-by: Mikhail Yarmish [mike.spacer@gmail.com]
edited-by: Alexey Chumakov [achumakov@gentoo.org]
-->

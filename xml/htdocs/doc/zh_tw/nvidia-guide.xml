<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/zh_tw/nvidia-guide.xml,v 1.4 2004/11/27 10:25:20 ccpz Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- rev 1.7 by ccpz -->
<guide link="/doc/zh_tw/nvidia-guide.xml" lang="zh_tw">
<title>Gentoo Linux nVidia 指南</title>

<author title="Author">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Translator">
  <mail link="palatis@gentoo.org.tw">Victor Tseng</mail>
</author>

<abstract>
許多 Gentoo 玩家的電腦裡面都有 nVidia 晶片，nVidia 也有提供加強您顯示卡效能的
Linux 專用驅動程式。這篇指南教您如何安裝以及設定這些驅動程式。
</abstract>

<license/>

<version>1.5</version>
<date>2004年9月24</date>
<!-- translate date: Jun 16, 2004 -->

<chapter>
<title>設定您的顯示卡</title>
<section>
<title>安裝適當的驅動程式</title>
<body>

<p>
nVidia 驅動程式包含核心模組，它必須被安裝於您現在使用的核心中。您的核心必須<!--
-->支援模組載入支援才能使用這個驅動程式。若您使用 <c>genkernel</c> 來設定核<!--
-->心，那麼您已經準備好了。若您不是使用 <c>genkernel</c>，請確認您的核心設定<!--
-->中的這個選項是啟動的：
</p>

<pre caption="啟動模組載入支援">
Loadable module support ---&gt;
  [*] Enable loadable module support
</pre>

<p>
你也需要啟動核心中的 <e>Memory Type Range Register</e>：
</p>
	   	 
<pre caption="啟動 MTRR">
Processor and Features ---&gt;
  [*] MTRR (Memory Type Range Register) support
</pre>
							   	 
<p>
nVidia 的模組以及函式庫分別放在兩個套件中：<c>nvidia-glx</c> 及 <c>nvidia-ke<!--
-->rnel</c>。前者為 X11 GLX 函式庫，而後者為核心模組。您兩個都需要，所以應該<!--
-->趁現在安裝他們。因為 <c>nvidia-glx</c> 依賴 <c>nvidia-kernel</c>，安裝
<c>nvidia-glx</c> 就足夠了。
</p>

<pre caption="安裝 nVidia 驅動程式">
# <i>emerge nvidia-glx</i>
</pre>

<p>
當安裝程式結束以後，請執行 <c>modprobe nvidia</c> 以將核心模組載入記憶體。
</p>

<pre caption="載入核心模組">
# <i>modprobe nvidia</i>
</pre>

<p>
您大概想在每次開機的時候都將此模組載入，所以請編輯 <path>/etc/modules.autolo<!--
-->ad.d/kernel-2.6</path> (或 <path>kernel-2.4</path>)，並在裡面加上 <c>nvid<!--
-->ia</c>。別忘了在儲存退出以後執行 <c>modules-update</c>！
</p>

<pre caption="執行 modules-update">
# <i>modules-update</i>
</pre>

</body>
</section>
<section>
<title>設定 X Server</title>
<body>

<p>
當安裝了適當的驅動程式以後，您必須設定 X Server (XFree86 或 Xorg)，讓它使用
<c>nvidia</c> 驅動程式，而不是預設的 <c>nv</c> 驅動程式。
</p>

<p>
使用您喜愛的文字編輯器 (例如 <c>nano</c> 或 <c>vim</c>) 開啟 <path>/etc/X11/<!--
-->XF86Config</path> (或 <path>/etc/X11/xorg.conf</path>)，接著來到 <c>Devic<!--
-->e</c> 小節。在此小節中，更改有關 <c>Driver</c> 那行：
</p>

<pre caption="在 X Server 設定檔中將 nv 改成 nvidia">
Section "Device"
  Identifier "nVidia Inc. GeForce2"
  <i>Driver     "nvidia"</i>
  VideoRam   65536
EndSection
</pre>

<p>
然後到 <c>Module</c> 小節然後確定載入 <c>glx</c> 模組以及 <c>dri</c> 沒有載入：
</p>
  	 
<pre caption="更新 Module 小節">
Section "Module"
<comment>(...)</comment>
<i># Load  "dri"
Load  "glx"</i>
<comment>(...)</comment>
EndSection
</pre>
  	 
<p>
執行 <c>opengl-update</c> 讓 X Server 使用 nVidia GLX 函式庫。
</p>

<pre caption="執行 opengl-update">
# <i>opengl-update nvidia</i>
</pre>

</body>
</section>
<section>
<title>測試您的顯示卡</title>
<body>

<p>
要測試您的 nVidia 顯示卡，啟動 X 然後執行 <c>glxinfo | grep direct</c> 指令，它應該告訴您直接貼圖已經啟動：
</p>

<pre caption="檢查直接貼圖狀態">
$ <i>glxinfo | grep direct</i>
direct rendering: Yes
</pre>

<p>
要測試您的 FPS，請執行 <c>glxgears</c>。
</p>

</body>
</section>
</chapter>

<chapter>
<title>解決問題</title>
<section>
<title>在有 4Gb 以上記憶體的電腦讓 2D 工作</title>
<body>
  	 
<p>
如果你在 nVidia 2D 加速上遇到困難，可能是你不能啟動 MTRR 的 write-combining
range。要確認的話，檢查 <path>/proc/mtrr</path> 的內容：
</p>
  	 
<pre caption="檢查是否啟動 write-combining">
# <i>cat /proc/mtrr</i>
</pre>
  	 
<p>
每一行都應該包含 "write-back" 或 "write-combining"。如果你看到有一行有
"uncachable" 你需要改變 BIOS 設定來修正。
</p>
  	 
<p>
重開機然後進入 BIOS，找到 MTRR 設定(通常在 "CPU Settings" 中)。把他的設定從
"continuous" 改成 "discrete"，然後開機回到 Linux。你會發現不再有
"uncachable" 而且 2D 加速可以正常工作。
</p>
  	 
</body>
</section>
<section>
<title>我碰到關於不支援 4K 堆疊大小的錯誤</title>
<body>
  	 
<p>
目前的 <c>nvidia-kernel</c> 只支援 8K 堆疊大小。比較新的核心 (2.6.6 及更新的) 已
經支援 4K 堆疊大小。在核心設定中不要選擇 4K 堆疊大小。你可以在
<c>Kernel Hacking</c> 區域中找到這項設定。
</p>
  	 
</body>
</section>
</chapter>
</guide>

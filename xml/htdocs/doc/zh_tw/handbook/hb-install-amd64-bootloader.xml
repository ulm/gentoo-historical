<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/zh_tw/handbook/hb-install-amd64-bootloader.xml,v 1.1 2004/09/17 09:55:08 bennyc Exp $ -->

<!-- rev 1.7 by Ccpz -->

<sections>
<section>
<title>決定您的選擇</title>
<subsection>
<title>介紹</title>
<body>

<p>
現在您的核心已經設定和已經編譯好相關的系統設定檔了，是時候該安裝一個程式來驅動
開機時所需要的核心。這個程式叫做 <e>開機程式</e>。
</p>

</body>
</subsection>
<subsection>
<title>選擇性: Framebuffer</title>
<body>

<p>
<e>如果</e> 您的核心有設定 framebuffer 的支援，您可以在您的開機程式設定檔內加入
<c>vga</c> 相關的設定。以下的列表將會是一些可用的 <c>vga</c> 參數。範例的設定檔
將使用 <e>800x600 @ 16bpp</e>， 所以是 <e>768</e>。
</p>

<table>
<tr>
  <ti></ti><th>640x480</th><th>800x600</th><th>1024x768</th><th>1280x1024</th>
</tr>
<tr>
  <th>8 bpp</th><ti>769</ti><ti>771</ti><ti>773</ti><ti>775</ti>
</tr>
<tr>
  <th>16 bpp</th><ti>785</ti><ti>788</ti><ti>791</ti><ti>794</ti>
</tr>
<tr>
  <th>32 bpp</th><ti>786</ti><ti>789</ti><ti>792</ti><ti>795</ti>
</tr>
</table>

<p>
請記得（或是寫下）您適用的數值；您稍後將需要到它。
</p>

</body>
</subsection>
</section>
<section>
<title>使用 GRUB</title>
<subsection>
<title>了解 GRUB 的意義</title>
<body>

<p>
了解 GRUB 的關鍵就是必須了解 GRUB 如何看待相關的硬碟和分割區。您的 Linux 分割區
<path>/dev/hda1</path> 將會被 GRUB 解釋為 <path>(hd0,0)</path>。請注意
<path>hd0,0</path> 外面的括號 － 它們是不可或缺的。
</p>

<p>
硬碟的計算是從 0 而不是 "a" 開始。請特別注意硬碟，GRUB 將不會計算 atapi-ide 光
碟機和燒錄機等裝置。（在正常的情況來說，除非特別從 bios 設定 SCSI 磁碟開機，
不然它們將取得比 ide 磁碟更高的號碼。
</p>

<p>
假如您有一個在 <path>/dev/hda</path> 的硬碟，在 <path>/dev/hdb</path> 的光碟機
，在 <path>/dev/hdc</path> 的燒錄機，第二棵硬碟在 <path>/dev/hdd</path> 和沒有
任何 SCSI 裝置。 <path>/dev/hdd7</path> 將會被翻譯成 <path>(hd1,6)</path>。
這或許聽起來有點詭異，但是我們將可以利用 GRUB 提供的 tab 完成結構（tab 
complete mechanism）讓您設定許多硬碟和分割區時方便許多。
</p>

<p>
差點忘記了，我們現在該安裝 GRUB 了。
</p>

</body>
</subsection>
<subsection>
<title>安裝 GRUB</title>
<body>

<p>
要安裝 GRUB，我們需要先安裝它。
</p>

<pre caption = "安裝 GRUB">
# <i>emerge --usepkg grub-static</i>
# <i>cp -Rpv /usr/share/grub/i386-pc/* /boot/grub</i>
</pre>

<p>
要開始設定 GRUB，您將要輸入 <c>grub</c>。您將會被帶領到 <path>grub&gt;</path>
的文字介面。現在您需要輸入正確的指令將 GRUB 的開機紀錄安裝到您的硬碟上。
</p>

<pre caption = "開始 GRUB 的介面">
# <i>grub</i>
</pre>

<note>
如果您的系統上沒有任何軟碟，將 <c>--no-floppy</c> 的選項加到以上指令的後面，
如此一來 grub 就不會在開始時尋找軟碟機了。
</note>

<p>
在範例的設定檔內，我們要安裝 GRUB，所以它才能從開機分割區 <path>/dev/hda1</path>
內讀 GRUB 的取相關資料，然後將 GRUB 開機紀律安裝到硬碟的MBR （master boot
record），如此一來我們一開機就會碰到 GRUB 的畫面。當然，如果您沒有按照範例設定，
請依照您的設定做更改。
</p>

<p>
GRUB 的 tab 完成架構 (tab completion mecanism）適用於 GRUB內。舉例來說，如果您
輸入 "<c>root(</c>"然後按下 TAB 鍵，您將會看到 GRUB 顯示出所有可用的裝置（如
<path>hd0</path>）。如果您輸入 "<c>root (hd0,</c>" 然後按下 TAB 鍵，您將會看到
GRUB 顯示出所有可選的分割區清單（如 <path>hd0,0</path>）。
</p>

<p>
GRUB 的 tab 鍵完成架構應該可以在 GRUB 的設定上簡單一點。現在我們將要開始設定
GRUB。
</p>

<pre caption = "將 GRUB 安裝到 MBR">
grub&gt; <i>root (hd0,0)</i>          <comment>（定義您的開機分割區所在的地方）</comment>
grub&gt; <i>setup (hd0)</i>           <comment>（將 GRUB 安裝到 MBR）</comment>
grub&gt; <i>quit</i>                  <comment>（離開 GRUB）</comment>
</pre>

<note>
如果您不打算將 GRUB 安裝到 MBR 而是其他分割區上，您將要小心的將 <c>setup</c>
指令指向正確的分割區。舉例來說，如果您要把 GRUB 安裝到 <path>/dev/hda3</path>
那麼您將需要用的的指令就會試 <c>setup (hd0,2)</c>。只有少數的使用者會這麼做。
</note>

<p>
雖然 GRUB 已安裝完成，我們還需要為它編寫一個設定檔，如此一來 GRUB 將自動的開啟
到您新建立的系統核心。使用 <c>nano</c> （或是其他的編輯器）建立一個
<path>/boot/grub/grub.conf</path>檔案：
</p>

<pre caption = "建立 /boot/grub/grub.conf">
# <i>nano -w /boot/grub/grub.conf</i>
</pre>

<p>
現在我們將要開始編寫<path>grub.conf</path>。您將會在下面找到兩個按照我們的範例所
使用的 <path>grub.conf</path> 設定檔，使用的是核心 
<path>kernel-2.6.5-gentoo</path>。我們只會在第一個 
<path>grub.conf</path> 內進行註解。
</p>

<ul>
  <li>
    第一個 <path>grub.conf</path> 適用於沒有使用 <c>genkernel</c> 編譯核心的使
    用者
  </li>
  <li>
    第二個 <path>grub.conf</path> 適用於使用 <c>genkernel</c> 的使用者
  </li>
</ul>

<pre caption = "未使用 genkernel 的 grub.conf">
<comment># 將為開機預設。0為第一，1為第二，以此類推。</comment>
default 0
<comment># 使用預設前等待的開機秒數。</comment>
timeout 30
<comment># 將漂亮又肥大的 splash-image 啟用：）
# 如果您沒有安裝顯示卡，請註解這行</comment>
splashimage=(hd0,0)/grub/splash.xpm.gz

title=Gentoo Linux 2.6.5
<comment># 儲存核心檔的分割區（或是作業系統）</comment>
root (hd0,0)
kernel /kernel-2.6.5-gentoo root=/dev/ram0 init=/linuxrc ramdisk=8192 real_root=/dev/hda3

<comment># 以下三行為 Windows 系統適合的雙重開機。</comment>
<comment># 在我們的例子，Windows是放在 /dev/hda6</comment>
title=Windows XP
rootnoverify (hd0,5)
makeactive
chainloader +1
</pre>

<pre caption = "genkernel 使用者適用的 grub.conf">
default 0
timeout 30
splashimage=(hd0,0)/grub/splash.xpm.gz

title=Gentoo Linux 2.6.5
root (hd0,0)
kernel /kernel-2.6.5 root=/dev/ram0 init=/linuxrc real_root=/dev/hda3
initrd /initrd-2.6.5-gentoo

<comment># 如果您想要雙重系統開機的話</comment>
title=Windows XP
root (hd0,5)
makeactive
chainloader +1
</pre>


<note>
如果您使用不同的分割設定或是核心檔案，請依個人的設定更改。但是請確認所有 GRUB 
相關的裝置（如<path>(hd0,0)</path>）和掛載點有相連的，而非 root。換句話說，
<path>(hd0,0)/grub/splash.xpm.gz</path> 實際上是放在 
<path>/boot/grub/splash.xpm.gz</path> 因為 <path>(hd0,0)</path> 是 
<path>/boot</path>。
</note>

<p>
如果您需要自行輸入任何參數給核心，只要將他們放在 kernel 的指令後面。我們已經傳送
了一個（<c>root=/dev/hda3</c> 或是 <c>real_root=/dev/hda3</c>），但是您也可以傳送
其他的指令。舉例來說，我們使用 <c>vga</c> 來設定之前提過的 framebuffer：
</p>

<pre caption = "將 vga 加入為核心參數">
title=Gentoo Linux
  root (hd0,0)
  kernel /kernel-2.6.5-gentoo root=/dev/hda3 vga=788
</pre>

<p>
<c>genkernel</c> 使用者應該要知道他們的新使用的和 LiveCD 一樣。舉例來說，如果您
有 SCSI 裝置，您應該在核心選項後面加入 <c>doscsi</c>。
</p>

<p>
現在儲存 <path>grub.conf</path> 檔案然後離開。目前為止， GURB 已經被完善的設定
，您將可以繼續到 <uri link="?part=1&amp;chap=10">安裝系統所需工具</uri>。
</p>

<p>
如果您有關於 GRUB 的問題，請參考 <uri
link="http://www.gnu.org/software/grub/grub-faq.html">GRUB FAQ</uri> 或是 <uri
link="http://www.gnu.org/software/grub/manual">GRUB 說明</uri>。
</p>

</body>
</subsection>
</section>
</sections>

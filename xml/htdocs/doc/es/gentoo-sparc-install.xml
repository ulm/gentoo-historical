<?xml version='1.0' encoding="UTF-8"?>

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/es/gentoo-sparc-install.xml">
<title>Gentoo Sparc/Sparc64 Linux Installation Guide</title>
<author title="Maintainer"><mail link="murphy@gentoo.org">Maarten Thibaut</mail></author>
<author title="Editor"><mail link="atom.stephens@ohiou.edu">Adam Stephens</mail></author>
<author title="Editor"><mail link="manson@gentoo.org">Rodney Rees</mail></author>
<author title="Traductor"><mail link="jstypo@imagencolor.com.ve">John Christian Stoddart</mail></author>

<abstract>Esta es una guía para instalar Gentoo Linux en una máquina basada en el CPU Sparc64. Si encuentra errores u omisiones, por favor envíele un correo al responsable o a uno de los editores. </abstract>

<version>0.4.2</version>
<date>10 diciembre 2002</date>
<chapter>
<title>Hardware Soportado</title>
<section>
<body>
<p>
* Máquinas con múltiples procesadores. El soporte realmente depende del kernel. Para nuestros fines, estas plataformas son iguales a máquina de un solo CPU. Las imágenes de arranque típicamente desactivan el SMP para reducir el tamaño del kernel.
</p>

<p>
Advertencia: La mayoría de estas plataformas no han sido probadas. Su desarrollo se lleva a cabo con poca gente. Informes acerca de instalaciones/plataformas que funcionen o no son bienvenidas en nuestras listas de correo.
</p>
</body>
</section>

<section>
<title>Soportados por el proyecto UltraLinux de 32 bits (sparc)</title>
<body>
<p>
<table>
<tr><th>* Sun4c architecture(*):</th></tr>
<tr><ti>    o SPARCstation SLC (4/20)</ti></tr>
<tr><ti>    o SPARCstation ELC (4/25)</ti></tr>
<tr><ti>    o SPARCstation IPC (4/40)</ti></tr>
<tr><ti>    o SPARCstation IPX (4/50)</ti></tr>
<tr><ti>    o SPARCstation/server 1 (4/60)</ti></tr>
<tr><ti>    o SPARCstation/server 1+ (4/65)</ti></tr>
<tr><ti>    o SPARCstation/server 2 (4/75)</ti></tr>
<tr><th>* Sun4d architecture:</th></tr>
<tr><ti>    o SparcCenter 2000</ti></tr>
<tr><th>* Sun4m architecture:</th></tr>
<tr><ti>    o SPARCclassic</ti></tr>
<tr><ti>    o SPARCstation LC (4/15)</ti></tr>
<tr><ti>    o SPARCstation LX (4/30)</ti></tr>
<tr><ti>    o SPARCstation 4</ti></tr>
<tr><ti>    o SPARCstation/server 5 (70, 85, 110, and 170(**) Mhz)</ti></tr>
<tr><ti>    o SPARCstation/server 10 (with most MBUS processor cards)</ti></tr>
<tr><ti>    o SPARCstation/server 20 (with most MBUS processor cards)</ti></tr>
<tr><ti>    o JavaStation 1 (***)</ti></tr>
<tr><ti>    o JavaStation 10 (***)</ti></tr>
<tr><ti>    o JavaStation E (***)</ti></tr>
<tr><ti>    o JavaEngine 1 (***)</ti></tr>
</table>
</p>

<p>
(*)   Existen problemas del kernel relacionados con el manejo de memoria del sun4c. Esto está siendo resuelto.
</p>

<p>
(**)  El SPARC 5 (también conocido como el TurboSPARC) de 170MHz solamente está soportado en los kernel más recientes. No hay mucho desarrollo activo y UltraLinux no es muy estable en este procesador.
</p>

<p>
(***) Vea la pregunta relacionada más adelante en esta misma sección.
</p>

<p>
<table>
<tr><th>* Se conoce que los siguientes módulos MBUS funcionan:</th></tr>
<tr><ti>    o SuperSPARC modelos 20, 30, 40, 402, 41, 412, 51, 512, 514, 52, 54,61, 612, 71, 712, 81</ti></tr>
<tr><ti>    o Todos los módulos HyperSPARC</ti></tr>
<tr><ti>    o Módulos Cypress</ti></tr>
</table>
</p>
</body>
</section>

<section>
<title>Soportado por el proyecto UltraLinux de 64-bit UltraLinux (sparc64)</title>
<body>
<p>
<table>
<tr><th>* Sun4u architecture:</th></tr>
<tr><ti>    o Estaciones de trabajo UltraSPARC con Sbus: Ultra1, Ultra2, Ultra1 Creator, Ultra2 Creator</ti></tr>
<tr><ti>    o Servidores UltraSPARC con Sbus: Netra i, Enterprise 1, 2, 150</ti></tr>
<tr><ti>    o Servidores grandes UltraSPARC con Sbus: Enterprise 3000, 3500, 4000, 4500, 5000, 6000, 6500, 10000</ti></tr>
<tr><ti>    o Computadores (tarjeta) UltraSPARC con PCI: SPARCengine CP1400, CP1500 (*)</ti></tr>
<tr><ti>    o Estaciones de trabajo UltraSPARC con PCI: Ultra30, UltraAXe, UltraAXi, UltraAXmp, Ultra5, Ultra10, Ultra60, Ultra80, SunBlade 100, SunBlade 1000</ti></tr>
<tr><ti>    o Servidores UltraSPARC con PCI: Netra X1(**), Netra T series(***), Enterprise 250, 450</ti></tr>
</table>
</p>
<p>
(*) Se conoce que estas tarjetas funcionan sin ningunas modificaciones, vea también (***)
</p>

<p>(**) Por ahora completamente soportada excepto por los interfaces de red incorporados.
</p>
<p>(***) Vea también el documento de soporte de plataforma de Eric Browser para los Sun Microsystems CP1400/CP1500/Netra-T1).
</p>
</body>
</section>

<section>
<title>Dispositivos</title>
<body>
<p>
<table>
<tr><th>* SCSI:</th></tr>
<tr><ti>    o Tarjetas Sun/PTI Qlogic SCSi</ti></tr>
<tr><ti>    o Tarjetas de expansión SCSI/ether Sbus</ti></tr>
<tr><ti>    o Lectores CD-ROM SCSI</ti></tr>
<tr><ti>    o Lectores de cinta SCSI</ti></tr>
<tr><th>* Dispositivos SCSI fabricados por terceros(*):</th></tr>
<tr><ti>    o NCR53c8xx</ti></tr>
<tr><ti>    o Adaptec SCSI</ti></tr>
<tr><ti>    o Qlogic/ISP</ti></tr>
<tr><th>* Tarjetas ethernet:</th></tr>
<tr><ti>    o Onboard SunLance</ti></tr>
<tr><ti>    o Sun QuadEthernet (**)</ti></tr>
<tr><ti>    o Sunswift Happy Meal SCSI/Ethernet</ti></tr>
<tr><ti>    o Myricom Gigabit Ethernet (Sbus)</ti></tr>
<tr><ti>    o Varias tarjetas PCI soportadas por Linux.</ti></tr>
<tr><th>* Tarjetas gráficas:</th></tr>
<tr><ti>    o MG1/MG2 - bwtwo (monocromática)</ti></tr>
<tr><ti>    o CG3 - cgthree (8 bit)</ti></tr>
<tr><ti>    o GX, GX+, TGX and TGX+ - cgsix (8 bit)</ti></tr>
<tr><ti>    o SX - cgfourteen (soporte solo para 8 bits)</ti></tr>
<tr><ti>    o TCX - SS4 y SS5 (respectivamente 8 y 24 bit, bus AFX)</ti></tr>
<tr><ti>    o LEO - ZX/TurboZX (24 bit)</ti></tr>
<tr><ti>    o FFB/FFB2 - Creator/Creator3D (24 bit)</ti></tr>
<tr><ti>    o PGX - ATI Rage Pro (8 bit)</ti></tr>
<tr><ti>    o PGX24 - ATI Mach64 (8 y 24 bit)</ti></tr>
<tr><ti>    o AFB - Elite3D (solo en modalidad acelerada ***, 24 bit)</ti></tr>
<tr><ti>    o Tarjetas gráficas OEM:</ti></tr>
<tr><ti>      + cgRDI (cgthree, 8 bit)</ti></tr>
<tr><ti>      + Raptor GFX (8 y 24 bit)</ti></tr>
<tr><th>* Almacenamiento:</th></tr>
<tr><ti>    o Todos los lectores y changers de cinta</ti></tr>
<tr><ti>    o StorEdge T3 (****)</ti></tr>
<tr><th>* Misceláneas:</th></tr>
<tr><ti>    o cónsola serial</ti></tr>
<tr><ti>    o audio basado en CS4231</ti></tr>
<tr><th>*  Lector floppy(*****)</th></tr>
</table>
</p><p>
(*) Arrancar de estas tarjetas requiere el firmware OBP.</p>
<p>
(**) La plataforma sun4c tiene lios con estas tarjetas por problemas con el firmware.
</p>
<p>(***) Use el servidor Xsun24 con la opción "-noFFB" para desactivar la aceleración, o si tiene el manejador de Solaris, vea el asunto relacionado en la sección "Corriendo".
</p>
<p>(****) Vea en <uri>http://open-projects.linuxcare.com/t3</uri> para mayor información sobre manejadores.
</p>
<p>(*****) Tal vez no funcione arrancar del floppy en ciertas máquinas basadas en el sparc64. El manejador del floppy ha sido desactivado en la imagen de arranque en el CD.
</p>
</body>
</section>

<section>
<title>No soportados</title>
<body>
<p>* Cualquier construcción userland de targets de 64 bit. La compilación del kernel funciona bien. Le hará falta el paquete egcs64-sparc, así que escriba: "emerge egcs64-sparc" para instalar el compilador, una vez que concluya el "emerge system".
</p>

<p>
* Por ahora el sistema X-windows system no está soportado en Gentoo Sparc, pero ...
</p>
</body>
</section>

<section>
<title>Space Requirements</title>
<body>
<p>Una instalación típica de Gentoo sparc usa unos 500-1000 MB. En sí mismo el Gentoo sparc utiliza unos 450 MB para la construcción del bootstrap completo. Esto se reduce a unos 150 al concluir la construcción. Probablemente no querrá hacer que su partición de arranque sea menor a 1 Gigabyte si utiliza una sola partición.</p>
</body>
</section>

<section>
<title>Kernel</title>
<body>
<p>Siempre utilize kernels de 64 bits en una máquina de 64 bits. Esto incluye los modelos Ultra 1, 2, 5, 10 y 60, la serie SunBlade, E250/E450, E4*00, E6*00, E10K y plataformas StarFire. La salida de <c>uname -m</c> en estas máquinas es "sparc64" o "sun4u".</p>

<p>Siempre utilize kernels de 32 bits en plataformas de 32 bits (sun4c, sun4d or sun4m). Estas incluyen al IPC/IPX, SparcStations, etc. La salida de "uname -m" deberá ser uno de los siguientes: "sparc", "sun4c", "sun4d" o "sun4m".</p>

<p>Por ahora estamos usando la variable ambiental ARCH, especificado en el archivo /etc/make.profile/make.defaults para determinar la arquitectura del kernel a compilar. Esto está sujeto a ser cambiado, probablemente por la variable USE, así <c>arch=sparc64</c>.</p>

<p>Construcciones de stage 1 realizadas en máquinas de 64 bits deben funcionar perfectamente en máquinas sparc32. Creo que también para máquinas stage2 (aunque no ha sido probado). Lo probaré.</p>

<note>El soporte de sparc32 es extremadamente limitado y por ahora no enteramente soportado.</note>

<p>Algunos kernel tienen problemas arrancando con mucha memoria. Intente remover alguna memoria, esto funcionó para mi o pruebe una imagen más reciente.</p>
</body>
</section>
</chapter>

<chapter>
<title>Parte 2: Arrancando</title>
<section>
<title>Métodos de arranque</title>
<body>
<p>
Existen tres maneras de arrancar:
</p>
<p>
<uri link="#doc_chap4_sect2">arranque a través de la red, o netboot</uri>
<uri link="#doc_chap4_sect3">arranque de un gestor de arranque SILO existente</uri>
<uri link="#doc_chap4_sect4">arranque del cdrom</uri>
</p>

<p>
El uso de un sistema Linux existente en el disco duro de la máquina es el método más fácil, ya que le proveerá un ambiente Unix y una conexión ethernet funcional. En este caso arranque a su sistema Linux, como lo hace habitualmente, monte la partición de destino en <path>/mnt/gentoo</path> y salte al <uri link="#doc_chap5">Paso 3</uri>.
</p>

<p>
Si el uso de un sistema Linux previamiente instalado no es posible, entonces haga un <uri link="#doc_chap4_sect2">netboot</uri>.
</p>
</body>
</section>

<section>
<title>Netboot</title>
<body>
<p>
Al prompt de arranque, escriba:
</p>

<pre>
ok <i>boot net</i>
</pre>
<note>Requerirá otra máquina en la misma red para proveerle RARP (le permite al cliente determinar su dirección IP) y el servicio TFTP (para ubicar el kernel a través de la red).
</note>

<p>
Puede encontrar buena documentación en las páginas sparc de Debian:
</p>
<p>
<uri>http://www.debian.org/releases/stable/sparc/install</uri>
</p>

<p>
Los SunBlades han sido soportados apenas recientemente y talvez tenga problemas para encontrar buenas imágenes de arranque. Se pueden obtener imágenes de arranque decentes en:
</p>

<p>
<uri>http://auric.debian.org/~bcollins/disks-sparc/current/</uri>
</p>

<p>
Una vez arrancado, escoja un disco para la instalación y configure la red. Cuando el disco de instalación debian woody le pide configurar un kernel, baje a <c>Execute a shell</c>.
</p>

<p>
Si su sistema de instalación debian falla al hacer peticiones de DNS, es porque probablemente no tiene acceso al archivo <path>/target/etc/resolv.conf</path>. Asegúrese que esté allí, porque es allí donde espera encontrarlo el instalador debian.
</p>

<p>
Puede usar su Linux para descomprimir el contenido del stage 1 en una partición y luego montarla desde la línea de comando al arrancar:
</p>
<pre>
ok <i>boot net root=/dev/sda4</i>
</pre>
</body>
</section>

<section>
<title>SILO existente</title>
<body>
<p>O tal vez puede usar su gestor SILO para arrancarlo (pulse TAB al aparecer SILO:). Por supuesto que significa que no podrá cargar módulos del kernel, pero eso tal vez no sea un problema ya que la configuración por defecto del kernel sparc habilita la mayoría de los manejadores de hardware SPARC. Puede usar su sistema Linux previamente instalado para compilar un kernel con los manejadores compilados estáticamente.</p>

<pre>ok <i>boot</i>
SILO: <codenote>Press TAB here.</codenote> boot:
linux
boot: <i>vmlinux root=/dev/hda4</i>
</pre>
<p>
o esto arrancará la cuarta partición en el primer disco:</p>
<pre>
boot: <i>4/vmlinux root=/dev/hda4</i>
</pre>
</body>
</section>

<section>
<title>CDROM</title>
<body>
<note>Arrancar desde el CDROM es la manera más fácil y por ende preferida.</note>

<p>
Por favor trate de usar un servidor espejo si fuese posible. Las imágenes ISO son extremadamente grandes. Obtenga la última imagen ISO de Gentoo de <uri>http://www.ibiblio.org/pub/Linux/distributions/gentoo/releases/1.1a/</uri> y user cdrecord para quemarla. Arranque desde el cd del prompt ok y escoja la opción del ramdisk:
</p>
<pre>
ok <i>boot cdrom</i>
SILO:
...
boot: <i>ramdisk</i>
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Part 3: Instalación de Gentoo</title>
<section>
<body>
<p>
Si ha usado netboot para arrancar su sistema y le ha permitido configurar sus discos, su objetivo estará montado como <path>/objetivo</path>. En este caso, tal vez quiera poner un symlink de <path>/mnt/gentoo</path> a <path>/objetivo</path> ya que la documentación asume <path>/mnt/gentoo</path>. Si no, debe montar una partición como <path>/mnt/gentoo</path> y usarlo para la instalación.
</p>

<note>Si ha usado Debian para arrancar su sistema, entonces

  particione su(s) disco(s) duro(s)
  configure su red
  ejecute un shell
</note>

<note>
Acerca de NFS

También se puede montar a través de NFS para los directorios /usr/portage y /usr/distfiles si se requieren.

Al usar /usr/distfiles montado a través de NFS, asegúrese que pueda escribirle y avísele al sistema con:

# export DISTDIR=/usr/distfiles
</note>

<note>
El emerge bootstrap usa unos 500MB para compilar y 150 MB al terminar. Si quiere un sistema completo que pueda compilar otros stage1, necesitará al menos un gigabyte, incluyendo los distfiles.
</note>

<note>
Puede usar wget para bajar el stage1 del sitio gentoo. Advertencia: las imágenes netboot de debian no incluyen un binario para el comando /usr/bin/bzip, así que obtenga un .tgz (si está disponible).
</note>

<p>Ahora pasaremos revista rápidamente al proceso de instalación. Crearemos las particiones, crearemos nuestros sistemas de archivo y extraeremos un tarball stage1, stage2 o stage3. Si estamos usando un tarball stage1 o stage2, tomaremos los pasos apropiados para llevar nuestro sistema a stage3. Una vez que estemos en stage3, podremos configurarlo (modificar los archivos de configuración, instalar un gestor de arranque, etc) y arrancarlo y tener un sistema Gentoo Linux plenamente funcional. Dependiendo de qué etapa o stage comenzamos, aquí está lo quese requiere para la instalación:</p>

<table>
<tr><th>tarball etapa o stage</th><th>pasos requeridos para la instalación</th></tr>
<tr><ti>1</ti><ti>particionamiento disco/creación sistema de archivos, emerge rsync, bootstrap, emerge system, emerge ppc-sources, configuración final</ti></tr>
<tr><ti>2</ti><ti>particionamiento disco/creación sistema de archivos, emerge rsync, emerge system, emerge linux sources, configuración final</ti></tr>
<tr><ti>3</ti><ti>particionamiento disco/creación sistema de archivos, emerge rsync (opcional), configuración final</ti></tr>
</table>

<p>El primer paso es la inserción de cualquier módulo requerido. Es posible que ésto no le haga falta, ya que el soporte para la mayoría del hardware sparc standard forma parte del kernel. Para ver una lista de todos los módulos para interfaces de red, escriba <c>ls /lib/modules/*/kernel/drivers/net/*</c>. Para cargar un módulo en particular, escriba:</p>

<pre>
# <i>modprobe pcnet32</i>
	<comment>(reemplace pcnet32 con el que requiera)</comment>
</pre>

<p>Ahora, si desea tener acceso a cualquier hardware SCSI que no fue descubierto durante el proceso de autodetección PCI, necesita cargar los módulos apropiados de /lib/modules, una vez más usando <c>modprobe</c>:</p>

<pre>
# <i>modprobe aic7xxx</i>
# <i>modprobe sr_mod</i>
# <i>modprobe sd_mod</i>
</pre>

<p>Arriba hemos hecho modprobe con el manejador SCSI <c>aic7xxx</c> y luego aseguramos que el soporte para el CD-ROM SCSI (<c>sr_mod</c>) y disco (<c>sd_mod</c>) han sido cargados.</p>

<note><c>hdparm</c> está incluido en el iso Gentoo. Si se requiere cambiar la configuración a alguno de sus discos, podrá hacerlo ahora. En hardware relativamente moderno ejecutar <c>hdparm -d 1 /dev/hdx</c> debe ser bastante seguro. Puede usar <c>hdparm -v /dev/hdx</c> para chequear la configuración del disco y <c>hdparm -t /dev/hdx</c> para revisar su desempeño.</note>
</body>
</section>

<section>
<title>Configure la red para la instalación</title>
<body>

<p>La instalación de Gentoo le permite configurar una red funcional, permitiéndole el uso de <c>ssh</c>, <c>scp</c> o <c>wget</c> como desee aún antes de comenzar el proceso de instalación. Aunque no lo necesite ahora, debe configurar su red. Una vez preparada, el Portage podrá usarla dentro del ambiente enjaulado ("chroot"), requerido para la instalación de Gentoo Linux.</p>
</body>
</section>

<section>
<title>Configuración manual de DHCP</title>
<body>

<p>Con DHCP la configuración de red es sencilla. Si su ISP no usa DHCP, continue a la sección Configuración estática, más adelante.
</p>

<pre caption="Configuración de redes con DHCP">
# <i>dhcpcd eth0</i> 
</pre>

<note>
Algunos ISP piden un nombre para su máquina. Para cumplir este requisito, agregue <c>-h mimaquina</c> al comando anterior.
</note>

<p>Si recibe advertencias <i>dhcpConfig</i>, no se preocupe, probablemente sean cosméticas. Continue en la sección Comprobando la red, más adelante.</p>
</body>
</section>

<section>
<title>Configuración estática manual</title>
<body>

<p>
Debemos configurar apenas lo suficiente para bajar las fuentes para construir el sistema y el interfaz localhost requerido. Escriba los siguientes comandos, reemplazando $IFACE con su interfaz a la red (normalmente <c>eth0</c>), $IPNUM con su dirección IP, $BCAST con su dirección broadcast y $NMASK con su máscara de red.  Para el comando <c>route</c>, sustituya $GTWAY con su gateway.
</p>

<pre>
# <i>/sbin/ifconfig $IFACE $IPNUM broadcast $BCAST netmask $NMASK</i>
# <i>/sbin/route add -net default gw $GTWAY netmask 0.0.0.0 metric 1</i>
</pre>

<p>Ahora crearemos el archivo <path>/etc/resolv.conf</path> para que funcione la resolución de nombres (el acto de encontrar sitios Web/FTP por nombre, en vez de por dirección IP).</p>

<note>Al momento, el único editor instalado por defecto es <c>nano</c>, pequeño y sencillo de usar. Use <c>nano</c> con la opción <c>-w</c> para desactivar la partición de líneas largas (line wrapping).
</note>

<p>Aquí hay una plantilla para crear su archivo <path>/etc/resolv.conf</path>:
</p>
<pre caption="Plantilla /etc/resolv.conf">
domain mydomain.com
nameserver 10.0.0.1
nameserver 10.0.0.2
</pre>

<p>Reemplace las direcciones <c>10.0.0.1</c> y <c>10.0.0.2</c> con las direcciones IP de su servidor DNS primario y secundario respectivamente.</p>
</body>
</section>

<section>
<title>Configuración del proxy</title>
<body>
<p>Si se encuentra detrás de un proxy, es necesario configurarlo antes de continuar. Exportaremos unas variables para que funcione adecuadamente.</p>

<pre>
# <i>export http_proxy="machine.company.com:1234" </i>
# <i>export ftp_proxy="$http_proxy" </i>
# <i>export RSYNC_PROXY="$http_proxy" </i>
</pre>
</body>
</section>

<section>
<title>Comprobando la red</title>
<body>

<p>Ahora que su red está configurada, el comando <c>/sbin/ifconfig -a</c> mostrará (ojalá!) que su interfaz de red está funcionando (busque las palabras clave <e>UP</e> y <e>RUNNING</e> en la salida de este comando).
</p>

<pre caption="/sbin/ifconfig para un interfaz de red funcional">
eth0      Link encap:Ethernet  HWaddr 00:50:BA:8F:61:7A
          inet addr:192.168.0.2  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::50:ba8f:617a/10 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1498792 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1284980 errors:0 dropped:0 overruns:0 carrier:0
          collisions:1984 txqueuelen:100
          RX bytes:485691215 (463.1 Mb)  TX bytes:123951388 (118.2 Mb)
          Interrupt:11
</pre>
</body>
</section>

<section>
<title>La red funciona!</title>
<body>
<p>La red debe estar configurada y funcionando. Deberá poder usar los comandos <c>ssh</c>, <c>scp</c> y <c>wget</c> para conectarse con otras máquinas en su red local o la internet.</p>
</body>
</section>
</chapter>

<chapter>
<title>Configurando particiones</title>
<section>
<body>
<p>Ya que el kernel pueder ver nuestro interfaz de red y controladores de disco, debemos configurar las particiones para Gentoo Linux.</p>

<note>Este próximo paso es por si pudo arrancar desde el CDROM. Si arrancó de cualquier otra manera, salte los siguientes tres pasos.</note>

<p>
Entonces, monte el CDROM y haga chroot al directorio adecuado según su plataforma:
</p>

<pre>
# <i>mount -t iso9660 -o ro /dev/cdroms/cdrom0 /mnt</i>
# <i>chroot /mnt/root-\`uname -m\` bin/bash</i>
# <i>source /etc/profile</i>
</pre>

<p>En este punto, tiene un ambiente de rescate que se puede utilizar para arreglar su sistema. También se pueden particionar los discos y montarlos para la instalación.
</p>

<note>
Al usar el CDROM, escriba (Ojo: este es un ejemplo, no corte y pegue!)
</note>

<pre>
# <i>fdisk /dev/hda</i>
# <i>mount -n /dev/hda2 /mnt/gentoo; cd /mnt/gentoo</i>
# <i>wget http://www.ibiblio.org/pub/Linux/distributions/gentoo/releases/build/1.4_rc1/sparc/stage1-sparc64-1.4_rc1.tbz2</i>
# <i>bunzip2 -c /stage1-sparc64-1.4_rc1.tbz2 | tar xvpf -</i>
# <i>cp /etc/resolv.conf etc/resolv.conf</i>
# <i>nano /etc/resolv.conf</i>
# <i>rm etc/make.profile</i>
</pre>

<note>La manera más sencilla de crear el Sun Disk Label es usar la opción <i>'s'</i> en fdisk y luego modificar las particiones según sus requerimientos.</note>

<note>Luego de montar su / a /mnt/gentoo siga y monte cualquier otra partición que pueda tener (por ejemplo, /boot /usr /var)</note>

<p>
Edite el archivo make.conf y comente cualquier otra definición para los siguientes:
</p>

<pre>
<i>CHOST="sparc-unknown-linux-gnu"
CFLAGS="-mcpu=v8 -mtune=v9 -O2 -pipe"
CXXFLAGS="-O3 -pipe"</i>
</pre>

<note>
Para /etc/make.conf cambie:

SYNC="rsync://cvs.gentoo.org/gentoo-portage"

a

SYNC="rsync://rsync.gentoo.org/gentoo-portage"
</note>

<pre>
# <i>mount -o bind /proc proc</i>
# <i>chroot /mnt/gentoo bin/bash</i>
# <i>env-update</i>
# <i>source /etc/profile</i>
# <i>emerge rsync</i>
# <i>rm etc/make.profile</i>
</pre>

<p>
Seleccione la plataforma adecuada, para sparc64:
</p>

<pre>
# <i>uname -m</i>
sparc64
# <i>ln -s ../usr/portage/profiles/default-sparc64-1.4 etc/make.profile</i>
</pre>

<p>
O para sparc:
</p>

<pre>
# <i>uname -m</i>
sparc
# <i>ln -s ../usr/portage/profiles/default-sparc-1.4 etc/make.profile</i>
</pre>

<p>
Si está arrancando desde el stage 1, corra:
</p>

<pre>
# <i>scripts/bootstrap.sh</i>
</pre>

<p>
Esto podrá tomar una cierta cantidad de tiempo. Ahora tendrá un Gentoo en stage 2.
</p>

<p>
Luego:
</p>

<pre>
# <i>export CONFIG_PROTECT=""</i>
# <i>emerge system</i>
</pre>

<p>
Ahora tiene su Gentoo en stage 3.
</p>
</body>
</section>
</chapter>

<chapter>
<title>Part 4: Building a kernel</title>
<section>
<body>
<p>
En las plataformas sparc64 necesitaremos un compiladora para objetivos de 64 bits:
</p>

<pre>
# <i>emerge egcs64-sparc</i>
</pre>

<p>
Luego obtenga las fuentes Linux. En este momento el paquete Gentoo sys-kernel/linux-sources parece contener algunos parches específicos a cierta plataforma que hace fallar la compilación. Si llega a descubrir la causa o mejor aún tiene un remedio, por favor archive un bug en nuestro bugzilla.
</p>

<p>
Obtenga el kernel "de vainilla" y hágalo usted mismo. Tenga cuidad, ya que cualquier desviación puede resultar en errores de compilación del kernel.
</p>

<pre>
# <i>cd /usr/src</i>
# <i>wget http://www.kernel.org/pub/linux/kernel/v2.4/linux-2.4.18.tar.bz2</i>
# <i>tar xvfj linux-2.4.18.tar.bz2</i>
# <i>mv linux linux-2.4.18</i>
# <i>ln -s linux-2.4.18 linux</i>
# <i>cd linux</i>
</pre>

<p>
Aplique los parches que desee al kernel en esta coyuntura. No aplique los parches del kernel serie -ac en sistemas sparc (lo hace extremadamente inestable). El sistema de archivos XFS no está soportado en Sparc por los momentos.</p>

<note>Arreglos: Nos podrá hacer falta más arreglos para las plataformas Sparc.</note>

<p>
Ahora debemos conseguir un archivo .config. Me gusta el tempfs (un sistema de archivos dinámico en RAM, muy bueno para máquinas con mucho RAM) así que copio el archivo y habilito tempfs así, ya se imaginan cómo.</p>

<pre>
# <i>sed -s 's/.*CONFIG_TMPFS.*/CONFIG_TMPFS=m/' \
	-s 's/.*CONFIG_DEVFS_FS.*/CONFIG_DEVFS_FS=y/' \
	-s 's/.*CONFIG_DEVFS_MOUNT.*/CONFIG_DEVFS_MOUNT=y/' \
	-s 's/.*CONFIG_EXT3_FS.*/CONFIG_EXT3_FS=y/' \
	arch/`uname -m`/defconfig \
	> .config</i>
</pre>

<p>
O sencillamente copie el archivo:
</p>

<pre>
# <i>cp arch/`uname -m`/defconfig .config</i>
</pre>

<p>
Se requiere el paso oldconfig para establecer unos vínculos:
</p>

<pre>
# <i>make ARCH=sparc64 oldconfig dep clean vmlinux modules</i>
# <i>make modules_install</i>
</pre>

<p>
El kernel debe ser menor que 3.6 para "caber" en el espacio de memoria que usa SILO:
</p>

<pre>
# <i>ls -al vmlinux</i>
-rwxr-xr-x    1 root     root      3503075 Apr 20 21:42 vmlinux
</pre>

<p>
Nos hace falta un GZIP normal para SILO.
</p>

<pre>
# <i>gzip -9 vmlinux</i>
# <i>cp vmlinux.gz /boot/vmlinuz-2.4.18</i>
# <i>ln /boot/vmlinuz-2.4.18 /vmlinuz</i>
</pre>

<p>
Si no ha configurado SILO en este disco y desea arrancar de el:
</p>

<pre>
# <i>emerge silo</i>
# <i>nano /etc/silo.conf</i>
# <i>silo</i>
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Configuración final</title>
<section>
<title>La zona horaria</title>
<body>

<note>Es extremadamente importante completar este paso. Se experimentará una importante desviación en el reloj si no se fija la hora local correctamente.
</note>

<p>Ahora debe tener un sistema en stage3 listo para su configuración final. Empezaremos este proceso configurando la zona horaria. Al hacer esto antes del construir el kernel aseguramos que los usuarios obtengan una salida razonable al ejecutar <c>uname -a</c>.</p>

<p>Busque su zona horaria (o GMT si usa Greenwich Mean Time) en <path>/usr/share/zoneinfo</path> y haga un enlace simbólico escribiendo:
</p>

<pre>
# <i>ln -sf /usr/share/zoneinfo/path/to/timezonefile /etc/localtime</i>
</pre>

<p>Tal vez quiera revisar en <path>/etc/rc.conf</path> para asegurarse que su zona horaria sea la correcta. </p>
</body>
</section>

<section>
<title>System logger y cron</title>
<body>
<p>Ahora debe escoger un logger para instalar. Ofrecemos sysklogd, el conjunto tradicional de daemons para logging. Ofrecemos también msyslog y syslog-ng al igual que metalog. Los usuarios más avanzados parecen querer alejarse de sysklogd (por un desempeño no muy bueno) y prefieren las alternativas más recientes. En caso de duda, tal vez quiera probar metalog, ya que es bastante popular. Para incorporar el logger escogido, escriba <e>una</e> de las siguientes cuatro líneas:
</p>

<pre>
# <i>emerge app-admin/sysklogd</i>
# <i>rc-update add sysklogd default</i>
<comment>o</comment>
# <i>emerge app-admin/syslog-ng</i>
# <i>rc-update add syslog-ng default</i>
<comment>o</comment>
# <i>emerge app-admin/metalog</i>
# <i>rc-update add metalog default</i>
<comment>o</comment>
# <i>emerge app-admin/msyslog</i>
# <i>rc-update add msyslog default</i>
</pre>

<warn>En caso de escoger syslog-ng necesita crear el archivo <path>/etc/syslog-ng/syslog-ng.conf</path>. Vea <path>/etc/syslog-ng</path> como ejemplo de un archivo de configuración.
</warn>

<impo>
Metalog escribe a disco en bloques, así que los mensajes no son grabados en seguida. Si está tratando de resolver problemas con un daemon, este comportamiento que mejora el desempeño no es de mucha ayuda. Cuando su sistema Gentoo Linux esté corriendo, puede enviar una señal USR1 a metalog para desactivar este comportamiento (significando que <i>tail -f <path>/var/log/everything/current</path></i> ocurrirá en tiempo real, como esperamos) y una señal USR2 para activar este comportamiento de nuevo.
</impo>

<p>Ahora puede opcionalmente, escoger un paquete cron que quiera utilizar. Ofrecemos dcron, fcron y vcron. Si no sabe cuál utilizar, escoja vcron. Se pueden instalar de la siguiente manera:</p>

<pre>
# <i>emerge sys-apps/dcron</i>
# <i>crontab /etc/crontab</i>
<comment>o</comment>
# <i>emerge sys-apps/fcron</i>
# <i>crontab /etc/crontab</i>
<comment>o</comment>
# <i>emerge sys-apps/vcron</i>

<comment>No se olvide de agregar su *cron al nivel init apropiado. </comment>

# <i>rc-update add *cron default </i>
</pre>

<p>Para mayor información acerca de cómo funciona cron bajo Gentoo Linux, vea <uri link="http://lists.gentoo.org/pipermail/gentoo-announce/2002-April/000151.html">este anuncio</uri>.</p>

<p>Para mayor información acerca de correr programas y daemons al arrancar, vea la <uri link="/doc/rc-scripts.html">guía rc-script</uri>. </p>
</body>
</section>

<section>
<title>/etc/fstab</title>
<body>

<p>Su sistema Gentoo Linux está casi listo para ser usado. Ahora sólo quedan por configurar algunos importantes archivos del sistema e instalar el cargador GRUB. El primer archivo a configurar es el <path>/etc/fstab</path>. Recuerde usar la opción <c>notail</c> para su partición de arranque si escoge crear un sistema de archivos ReiserFS. Recuerde especificar los sistemas de archivos <c>ext2</c> o <c>ext3</c> según sea apropiado.</p>

<p>Use algo como el <path>/etc/fstab</path> listado a continuación. Por supuesto, debe reemplazar "ROOT" y "SWAP" con los dispositivos que esté usando (tales como <c>hda1</c>, etc.).</p>

<pre>
<comment>
# /etc/fstab: información estática de sistemas de archivo.
#
# noatime desactiva atimes para mejorar el desempeño (atimes normalmente no se
# necesita; notail aumenta el desempeño de ReiserFS (a costa de la eficiencia
# en el almacenamiento). El no usar la opción noatime es seguro y si lo desea
# también cambiar entre notail y tail libremente.
# &lt;fs&gt;           &lt;mountpoint&gt;   &lt;type&gt;   &lt;opts&gt;          &lt;dump/pass&gt;

# NOTA: Si su partición de arranque es ReiserFS, aagregue la opción notail bajo opts.
</comment>
/dev/BOOT           /boot       ext2	 noauto,noatime	 1 2
/dev/ROOT           /           ext3	 noatime         0 1
/dev/SWAP           none        swap	 sw              0 0
/dev/cdroms/cdrom0  /mnt/cdrom  iso9660	 noauto,ro       0 0
proc                /proc       proc	 defaults        0 0
</pre>

<warn>Por favor note que la partición <i>/boot</i> NO está montada al arrancar. Esto es para proteger la data en <i>/boot</i> de corrupción. Si requiere acceso a <i>/boot</i>, por favor monte la partición!
</warn>
</body>
</section>

<section>
<title>Seleccionar la contraseña para root</title>
<body>
<p>Antes que se le olvide, configure la contraseña para el usuario root escribiendo:</p>
<pre>
# <i>passwd</i>
</pre>
</body>
</section>

<section>
<title>/etc/hostname</title>
<body>
<p>Edite este archivo para que contenga el nombre de su dominio plenamente calificado (FQDN o fully qualified domain name) en una sola línea, así <c>mymachine.mydomain.com</c>.

<pre>
# <i>echo mymachine.mydomain.com > /etc/hostname</i>
</pre>
</p>
</body>
</section>

<section>
<title>/etc/hosts</title>
<body>
<p>Este archivo contiene una lista de direcciones IP y nombres de hosts asociados. Lo usa el sistema para resolver las direcciones IP de las máquinas que no estén en su servidor DNS. Esta es una plantilla para este archivo:
</p>

<pre>
127.0.0.1      localhost
<comment># la siguiente linea contiene el IP de su red local y el nombre de la maquina asociada</comment>
192.168.1.1    mymachine.mydomain.com	mymachine
</pre>

<note>Si se encuentra en una red DHCP, puede ser útil fijar <i>localhost</i> al verdadero nombre de su máquina. Esto ayudará a GNOME y varios otros programas en la resolución de nombres.
</note>
</body>
</section>

<section>
<title>Final network configuration</title>
<body>
<p>
Agregue los nombres de cualquier módulo que requiere para el funcionamiento de su sistema al archivo <path>/etc/modules.autoload</path> (se pueden agregar cualquier opción necesario en la misma línea). Cuando arranque Gentoo Linux, éstos módulos serán automáticamente cargados. De particular importancia está su tarjeta de interfaz de red, si lo ha compilado como módulo:
</p>
<pre caption="/etc/modules.autoload">
3c59x
</pre>

<p>Edite el script <path>/etc/conf.d/net</path> para configurar la red para su primer arranque:
</p>
<pre>
# <i>nano -w /etc/conf.d/net</i>
# <i>rc-update add net.eth0 default</i>
</pre>

<p>
Si tiene múltiples tarjetas de red, debe crear los scripts <path>net.eth<comment>x</comment></path> adicionales para cada uno, donde (<comment>x</comment> = 1, 2, ...):
</p>

<pre caption="Multiple network interfaces">
# <i>cd /etc/init.d</i>
# <i>cp net.eth0 net.eth<comment>x</comment></i>
# <i>rc-update add net.eth<comment>x</comment> default</i>
</pre>
</body>
</section>

<section>
<title>Pasos finales: configurar ajustes básicos (incluyendo el mapa del teclado internacional)</title>
<body>
<pre caption="Configuración básica">
# <i>nano -w /etc/rc.conf</i>
</pre>

<p>
Siga las direcciones en el archivo para configurar los ajustes básicos. Los usuarios querrán asegurar que el <c>CLOCK</c> esté correctamente configurado. Usuarios del teclado internacional querrán configurar la variable <c>KEYMAP</c> (revise en <path>/usr/share/keymaps</path> para ver las distintas posibilidades).
</p>
</body>
</section>

<section>
<title>Configuración de su disco duro (hdparm)</title>
<body>

<p>
Agregue sus ajustes con <i>hdparm</i> al archivo <path>/etc/conf.d/local.start</path>, para que éstos se inicialicen cada arranque.</p>

<pre>
# <i>nano -w /etc/conf.d/local.start</i>
</pre>

<pre caption="agregue ajustes con hdparm a /etc/conf.d/local.start">
# Este es un buen lugar para cargar algún programa misceláneo
# al arrancar ( 1>&amp;2 )

# active DMA en ambos discos
hdparm -d 1 /dev/hda
hdparm -d 1 /dev/hdb
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Ha completado la instalación!</title>
<section>
<body>
<p>Felicitaciones! Acaba de concluir su instalación de Gentoo Linux en su máquina Sparc. Agradecemos cualquier comentario o sugerencia que tenga a fin de ayudarnos mejorar nuestro port a Sparc. Por favor suscríbase a la lista de correos gentoo-sparc y escríbanos. Gracias por tomar su tiempo en esta instalación.</p>

<p>ahora está en un punto donde puede hacer una de varias cosas. O desmontar todo y re-iniciar la máquina y comenzar a instalar ebuilds o puede empezar a hacerlo ahora.</p>
</body>
</section>
</chapter>

</guide>

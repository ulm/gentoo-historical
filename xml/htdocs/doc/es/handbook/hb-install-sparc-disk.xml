<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/handbook/hb-install-sparc-disk.xml,v 1.3 2006/05/22 21:55:03 yoswink Exp $ -->

<sections>

<version>2.5</version>
<date>2005-10-02</date>

<section>
<title>Introducción a los Dispositivos de Bloque</title>
<subsection>
<title>Dispositivos de Bloque</title>
<body>

<p>
Examinaremos de forma detallada los aspectos de Gentoo Linux así como
Linux en general que tengan que ver con discos, sistemas de ficheros
de Linux, particiones y dispositivos de bloque. Una vez que esté
familiarizado con las entrañas de los discos y sistemas de ficheros,
le guiaremos a través del proceso de creación de particiones y
sistemas de ficheros de su instalación Gentoo Linux.
</p>

<p>
Para empezar, explicaremos el término <e>dispositivos de
bloque</e>. Quizás el dispositivo de bloque más conocido es el que
representa el primer disco duro SCSI en un sistema Linux, a saber,
<path>/dev/sda</path>.
</p>

<p>
Los dispositivos de bloque representan una interfaz abstracta al disco.
Las aplicaciones pueden hacer uso de estas interfaces para interactuar
con el disco duro de la máquina sin importar el tipo de unidades que tenga: IDE,
SCSI, o cualquier otra. La aplicación puede simplemente direccionar el
almacenamiento en el disco como a una serie de bloques de acceso aleatorio
de 512-bytes situados de forma contigua.
</p>

<p>
Los dispositivos de bloque se muestran como entradas en <path>/dev/</path>.
Típicamente, el primer disco SCSI es nombrado <path>/dev/sda</path>, el
segundo <path>/dev/sdb</path> y así sucesivamente. Las unidades IDE se
nombran de forma similar, sin embargo, están prefijadas con hd en vez
de sd. Si está usando discos IDE, el primero será llamado
<path>/dev/hda</path>, el segundo <path>/dev/hdb</path> y así sucesivamente.
</p>

</body>
</subsection>
<subsection>
<title>Particiones</title>
<body>

<p>
Aunque teóricamente es posible utilizar el disco duro completo para
albergar la instalación Linux, esto casi nunca se hace. En su lugar,
los dispositivos de bloque enteros se dividen en partes más manejables
y pequeñas. Estas se conocen como <e>particiones</e> o <e>slices</e>.
</p>

<p>
La primera partición en el primer disco SCSI es <path>/dev/sda1</path>, la
segunda <path>/dev/sda2</path> y así sucesivamente. Similarmente, las
primeras dos particiones en el primer disco IDE son
<path>/dev/hda1</path> y <path>/dev/hda2</path>.
</p>

<p>
La tercera partición en sistemas Sun corresponde a un "disco completo" que
no debe contener un sistema de ficheros.
</p>

<p>
Los usuarios acostumbrados al esquema de particionamiento de DOS deberían notar
que las etiquetas de disco ("disklabels") en Sun no tienen particiones
"primarias" ni "extendidas". En cambio, por cada disco hay disponibles hasta
ocho particiones, siendo reservada la tercera de ellas.
</p>

</body>
</subsection>
</section>
<section>
<title>Diseñando un Esquema de Particionamiento</title>
<subsection>
<title>Esquema de Particionamiento predeterminado</title>
<body>

<p>
Si no está interesado en diseñar un esquema de particionamiento, la tabla
mostrada a continuación sugiere un punto de partida apropiado para la mayoría
de los sistemas. Para sistemas basados en discos IDE, reemplace <c>sda</c> por
<c>hda</c> donde corresponda.
</p>

<p>
Note que en general el uso de una partición <path>/boot</path> separada
<e>no</e> se recomienda en SPARC, pues complica la configuración del gestor de
arranque.
</p>

<table>
<tr>
  <th>Partición</th>
  <th>Sistema de ficheros</th>
  <th>Tamaño</th>
  <th>Punto de montaje</th>
  <th>Descripción</th>
</tr>
<tr>
    <ti>/dev/sda1</ti>
    <ti>ext3</ti>
    <ti>&lt;2 GBytes</ti>
    <ti>/</ti>
    <ti>
      Partición raíz. Para sistemas sun4c, sun4d y sun4m algunas PROMs
      requieren que el tamaño de esta partición sea de menos de 1 GByte y que
      sea la primera partición en el disco.
    </ti>
</tr>
<tr>
    <ti>/dev/sda2</ti>
    <ti>swap</ti>
    <ti>512 MBytes</ti>
    <ti>Ninguno</ti>
    <ti>
      Partición de intercambio. Para el bootstrap y ciertas compilaciones
      grandes se requiere al menos de 512 MBytes de memoria RAM (incluyendo
      la memoria de intercambio ("swap")).
    </ti>
</tr>
<tr>
    <ti>/dev/sda3</ti>
    <ti>Ninguno</ti>
    <ti>Disco completo</ti>
    <ti>Ninguno</ti>
    <ti>
      Partición correspondiente al disco completo. Indispensable en sistemas
      SPARC.
    </ti>
</tr>
<tr>
    <ti>/dev/sda4</ti>
    <ti>ext3</ti>
    <ti>Al menos 2 GBytes</ti>
    <ti>/usr</ti>
    <ti>
      Partición /usr. Acá es donde se instalan las aplicaciones. Por omisión,
      esta partición también se usa para datos de Portage (que toman cerca de
      de 500 MBytes excluyendo el código fuente).
    </ti>
</tr>
<tr>
    <ti>/dev/sda5</ti>
    <ti>ext3</ti>
    <ti>Al menos 1GByte</ti>
    <ti>/var</ti>
    <ti>
      Partición /var. Se utiliza para datos generados por los programas.
      Portage usa de forma predeterminada esta partición para espacio temporal
      mientras compila. Algunas aplicaciones grandes como Mozilla y
      OpenOffice.org necesitan aquí más de 1 GByte de espacio temporal cuando
      se compilan.
    </ti>
</tr>
<tr>
    <ti>/dev/sda6</ti>
    <ti>ext3</ti>
    <ti>El resto del espacio en disco</ti>
    <ti>/home</ti>
    <ti>
      Partición /home. Utilizada para los directorios personales de los
      usuarios.
    </ti>
</tr>
</table>

</body>
</subsection>
</section>

<section id="fdisk">
<title>Utilizando fdisk para particionar su disco</title>
<subsection>
<body>

<p>
Las siguientes instrucciones explican cómo particionar el disco duro
según el esquema descrito anteriormente:
</p>

<table>
<tr>
  <th>Partición</th>
  <th>Descripción</th>
</tr>
<tr>
    <ti>/dev/sda1</ti>
    <ti>/</ti>
</tr>
<tr>
    <ti>/dev/sda2</ti>
    <ti>Partición de intercambio (swap)</ti>
</tr>
<tr>
    <ti>/dev/sda3</ti>
    <ti>Partición del disco completo</ti>
</tr>
<tr>
    <ti>/dev/sda4</ti>
    <ti>/usr</ti>
</tr>
<tr>
    <ti>/dev/sda5</ti>
    <ti>/var</ti>
</tr>
<tr>
    <ti>/dev/sda6</ti>
    <ti>/home</ti>
</tr>
</table>

<p>
Cambie el esquema de particionamiento según su propio criterio. Recuerde
mantener la partición raíz totalmente dentro de los primeros 2 GBytes del disco
en sistemas antiguos. Existe también un límite de 15 particiones para discos
SCSI y SATA.
</p>

</body>
</subsection>
<subsection>
<title>Iniciando fdisk</title>
<body>

<p>
Inicie <c>fdisk</c> pasándole su disco como argumento:
</p>

<pre caption="Iniciar fdisk">
# <i>fdisk /dev/sda</i>
</pre>

<p>
Debería ver el intérprete de comandos de fdisk:
</p>

<pre caption="El intérprete de comandos de fdisk">
Command (m for help):
</pre>

<p>
Para ver las particiones disponibles, escriba <c>p</c>:
</p>

<pre caption="Listar las particiones disponibles">
Command (m for help): <i>p</i>

Disk /dev/sda (Sun disk label): 64 heads, 32 sectors, 8635 cylinders
Units = cylinders of 2048 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System
/dev/sda1             0       488    499712   83  Linux native
/dev/sda2           488       976    499712   82  Linux swap
/dev/sda3             0      8635   8842240    5  Whole disk
/dev/sda4           976      1953   1000448   83  Linux native
/dev/sda5          1953      2144    195584   83  Linux native
/dev/sda6          2144      8635   6646784   83  Linux native
</pre>

<p>
Note la aparición de <c>Sun disk label</c> en la salida. Si esto no sale,
entonces el disco está usando el esquema de particionamiento de DOS y no el de
Sun. En ese caso, teclee <c>s</c> para asegurarse que el disco tiene una tabla
de partición Sun:
</p>

<pre caption="Creación de una etiqueta de disco Sun (Sun Disklabel)">
Command (m for help): s
Building a new sun disklabel. Changes will remain in memory only,
until you decide to write them. After that, of course, the previous
content won't be recoverable.

Drive type
   ?   auto configure
   0   custom (with hardware detected defaults)
   a   Quantum ProDrive 80S
   b   Quantum ProDrive 105S
   c   CDC Wren IV 94171-344
   d   IBM DPES-31080
   e   IBM DORS-32160
   f   IBM DNES-318350
   g   SEAGATE ST34371
   h   SUN0104
   i   SUN0207
   j   SUN0327
   k   SUN0340
   l   SUN0424
   m   SUN0535
   n   SUN0669
   o   SUN1.0G
   p   SUN1.05
   q   SUN1.3G
   r   SUN2.1G
   s   IOMEGA Jaz
Select type (? for auto, 0 for custom): <i>0</i>
Heads (1-1024, default 64):
Using default value 64
Sectors/track (1-1024, default 32):
Using default value 32
Cylinders (1-65535, default 8635):
Using default value 8635
Alternate cylinders (0-65535, default 2):
Using default value 2
Physical cylinders (0-65535, default 8637):
Using default value 8637
Rotation speed (rpm) (1-100000, default 5400): <i>10000</i>
Interleave factor (1-32, default 1):
Using default value 1
Extra sectors per cylinder (0-32, default 0):
Using default value 0
</pre>

<p>
Puede encontrar los valores correctos en la documentación de su disco. La
opción 'auto configure' normalmente no funciona.
</p>

</body>
</subsection>
<subsection>
<title>Eliminación de las particiones existentes</title>
<body>

<p>
Es hora de eliminar las particiones existentes en el disco. Para ello teclee
<c>d</c> y presione intro. Se le preguntará por el número de partición que
desearía eliminar. Para borrar la partición <path>/dev/sda1</path> ya existente
teclee:
</p>

<pre caption="Eliminar una partición">
Command (m for help): <i>d</i>
Partition number (1-4): <i>1</i>
</pre>

<p>
<e>No debería eliminar la partición 3 (partición de disco completo).</e>
Esta es indispensable. Si esta partición no existe, siga las instrucciones
para la "Creación de una etiqueta de disco Sun ("Sun Disklabel")" indicadas
más arriba.
</p>

<p>
Luego de eliminar todas las particiones salvo la de "disco completo", debería
tener un esquema de particionamiento similar al siguiente:
</p>

<pre caption="Ver un esquema de particionamiento vacío">
Command (m for help): <i>p</i>

Disk /dev/sda (Sun disk label): 64 heads, 32 sectors, 8635 cylinders
Units = cylinders of 2048 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System
/dev/sda3             0      8635   8842240    5  Whole disk
</pre>


</body>
</subsection>

<subsection>
<title>Creación de la partición raíz</title>
<body>

<p>
Estamos listos para crear la partición raíz. Para hacer esto, teclee <c>n</c>
para crear una nueva partición, luego teclee <c>1</c> para crear la partición
raíz. Cuando se le pregunte por el valor del primer cilindro, presione intro.
Asimismo cuando el sistema solicite el valor del último cilindro, teclee
<c>+512M</c> para crear una partición de <c>512MBytes</c> de tamaño. Asegúrese
que toda la partición raíz está dento de los primeros 2GBytes del disco. Puede
ver la salida de estos pasos a continuación:
</p>

<pre caption="Crear la partición raíz">
Command (m for help): <i>n</i>
Partition number (1-8): <i>1</i>
First cylinder (0-8635): <i>(presione Intro)</i>
Last cylinder or +size or +sizeM or +sizeK (0-8635, default 8635): <i>+512M</i>
</pre>

<p>
Ahora, cuando teclee <c>p</c>, debería ver impreso el siguiente esquema de
particionamiento:
</p>

<pre caption="Listado del esquema de particionamiento">
Command (m for help): <i>p</i>

Disk /dev/sda (Sun disk label): 64 heads, 32 sectors, 8635 cylinders
Units = cylinders of 2048 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System
/dev/sda1             0       488    499712   83  Linux native
/dev/sda3             0      8635   8842240    5  Whole disk
</pre>

</body>
</subsection>
<subsection>
<title>Creación de una partición de intercambio ("swap")</title>
<body>

<p>
A continuación, vamos a crear ahora la partición de intercambio. Para ello,
teclee <c>n</c> para crear una nueva partición, y luego <c>2</c> para
para crear la segunda partición, <path>/dev/sda2</path> en nuestro caso.
Cuando el sistema solicite introducir el valor del primer cilindro, pulse intro
y cuando solicite el valor del último, teclee <c>+512M</c> para crear una
partición de 512 Mb. Cuando lo haya hecho, teclee <c>t</c> para ajustar el
tipo de partición y luego teclee <c>82</c> para fijar el tipo
"Linux Swap". Una vez completados estos pasos, al teclear <c>p</c> visualizará
una tabla de particiones que es similar a esta:
</p>

<pre caption="Listado de las particiones disponibles">
Command (m for help): <i>p</i>

Disk /dev/sda (Sun disk label): 64 heads, 32 sectors, 8635 cylinders
Units = cylinders of 2048 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System
/dev/sda1             0       488    499712   83  Linux native
/dev/sda2           488       976    499712   82  Linux swap
/dev/sda3             0      8635   8842240    5  Whole disk
</pre>

</body>
</subsection>
<subsection>
<title>Creación de las particiones /usr, /var y /home</title>
<body>

<p>
Finalmente vamos a crear las particiones /usr, /var y /home. Tal como antes,
teclee <c>n</c> para crear una partición nueva, luego teclee <c>4</c> para
crear la tercera partición, <path>/dev/sda4</path> en nuestro caso. Cuando se
le solicite el valor del primer cilindro, pulse intro y cuando se le solicite
el valor del último, ingrese <c>+2048M</c> para crear una partición de 2 GBytes
de tamaño. Repita este proceso para <path>sda5</path> y <path>sda6</path>
usando tamaños de acuerdo a su criterio. Una vez que esté listo, debería ver
algo como esto:
</p>

<pre caption="Listado completo de la tabla de particiones">
Command (m for help): <i>p</i>

Disk /dev/sda (Sun disk label): 64 heads, 32 sectors, 8635 cylinders
Units = cylinders of 2048 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System
/dev/sda1             0       488    499712   83  Linux native
/dev/sda2           488       976    499712   82  Linux swap
/dev/sda3             0      8635   8842240    5  Whole disk
/dev/sda4           976      1953   1000448   83  Linux native
/dev/sda5          1953      2144    195584   83  Linux native
/dev/sda6          2144      8635   6646784   83  Linux native
</pre>

</body>
</subsection>
<subsection>
<title>Guardar y salir</title>
<body>

<p>
Para guardar el esquema de particionamiento y salir de <c>fdisk</c>, teclee
<c>w</c>:
</p>

<pre caption="Guardar y salir de fdisk">
Command (m for help): <i>w</i>
</pre>

<p>
Ahora que sus particiones están creadas, puede proseguir con la
<uri link="#filesystems">Creación de Sistemas de Ficheros</uri>.
</p>

</body>
</subsection>
</section>
<section id="filesystems">
<title>Creación de Sistemas de Ficheros</title>
<subsection>
<title>Introducción</title>
<body>

<p>
Ahora que sus particiones están creadas, es hora de formatearlas para poder
tener un sistema de ficheros en ellas. Si no le importa el tipo de sistema de
ficheros que va a escoger y está conforme con lo que se usa de forma
predeterminada en este manual, continúe con <uri link="#filesystems-apply">
Creación de un Sistema de Ficheros en una Partición</uri>. En caso contrario,
siga leyendo para aprender sobre los sistemas de ficheros disponibles ...
</p>

</body>
</subsection>
<subsection>
<title>¿Sistemas de Ficheros?</title>
<body>

<p>
Hay disponibles varios sistemas de ficheros, algunos conocidos por ser estables
en la arquitectura SPARC. Ext2 y ext3, por ejemplo, se sabe que funcionan bien.
Otros sistemas de ficheros alternativos puede que no funciones correctamente.
</p>

<p>
<b>ext2</b> es un sistema de ficheros Linux probado, pero no dispone
de soporte para transacciones ("journaling"), lo que significa que las
comprobaciones rutinarias al arrancar pueden tardar bastante tiempo. Ahora, hay
muchas opciones alternativas, sistemas de ficheros de nueva generación
con soporte para transacciones cuya integridad puede ser verificada
con mayor rapidez, por lo que gozan de mayor popularidad. Los sistemas
de ficheros transaccionales previenen retrasos durante el reinicio del
equipo, incluso cuando el sistema de ficheros está en un estado
inconsistente.
</p>

<p>
<b>ext3</b> es la versión transaccional de ext2 que proporciona
soporte para una rápida recuperación además de otros modos mejorados
de funcionamiento como registro completo y ordenado de datos. Ext3 es
un buen sistema de ficheros además de fiable. Posee una opción adicional
para indización basada en árboles B que proporciona un alto rendimiento
en casi todas las situaciones. Se puede activar esta opción añadiendo
<c>-O dir_index</c> al comando <c>mke2fs</c>. En resumen, ext3 es un
excelente y confiable sistema de ficheros.
</p>

</body>
</subsection>
<subsection id="filesystems-apply">
<title>Creación de Sistema de Ficheros en una Partición</title>
<body>

<p>
Para crear un sistema de ficheros en una partición o volumen existen
herramientas específicas para cada sistema de ficheros:
</p>

<table>
<tr>
  <th>Sistema de ficheros</th>
  <th>Comando de creación</th>
</tr>
<tr>
  <ti>ext2</ti>
  <ti><c>mke2fs</c></ti>
</tr>
<tr>
  <ti>ext3</ti>
  <ti><c>mke2fs -j</c></ti>
</tr>
<tr>
  <ti>ext3 con indización en árboles B hashed (Solamente en núcleos 2.6)</ti>
  <ti><c>mke2fs -j -O dir_index</c></ti>
</tr>
</table>

<p>
Por ejemplo, para formatear la partición raíz (<path>/dev/sda1</path> en nuestro
caso) como ext2 y las particiones <path>/usr</path>, <path>/var</path> y
<path>/home</path> (<path>/dev/sda4</path>, <path>5</path> y <path>6</path>,
de acuerdo a nuestro ejemplo respectivamente) como ext3, utilizaría los
siguientes comandos:
</p>

<pre caption="Creación de un sistema de ficheros en una partición">
# <i>mke2fs /dev/sda1</i>
# <i>mke2fs -j /dev/sda4</i>
# <i>mke2fs -j /dev/sda5</i>
# <i>mke2fs -j /dev/sda6</i>
</pre>

</body>
</subsection>
<subsection>
<title>Activando la Partición de Intercambio</title>
<body>

<p>
<c>mkswap</c> es el comando usado para inicializar particiones de intercambio:
</p>

<pre caption="Inicialización de una partición de intercambio">
# <i>mkswap /dev/sda2</i>
</pre>

<p>
Para activar la partición, use el comando <c>swapon</c>:
</p>

<pre caption="Activar la partición de intercambio">
# <i>swapon /dev/sda2</i>
</pre>

<p>
Cree y active la partición de intercambio con los comandos mencionados arriba.
</p>

</body>
</subsection>
</section>
<section>
<title>Montaje</title>
<body>

<p>
Ahora que sus particiones están inicializadas y albergan sistemas de ficheros,
es hora de montarlas mediante el comando <c>mount</c>. No olvide crear los
directorios de puntos de montaje necesarios para cada partición que ha creado.
Por ejemplo:
</p>

<pre caption="Montaje de las particiones">
# <i>mount /dev/sda1 /mnt/gentoo</i>
# <i>mkdir /mnt/gentoo/usr</i>
# <i>mount /dev/sda4 /mnt/gentoo/usr</i>
# <i>mkdir /mnt/gentoo/var</i>
# <i>mount /dev/sda5 /mnt/gentoo/var</i>
# <i>mkdir /mnt/gentoo/home</i>
# <i>mount /dev/sda6 /mnt/gentoo/home</i>
</pre>

<note>
Si quiere que su <path>/tmp</path> resida sobre una partición separada,
asegúrese de cambiar los permisos después de montarla:
<c>chmod 1777 /mnt/gentoo/tmp</c>. Esto también es válido para
<path>/var/tmp</path>.
</note>

<p>
También necesitamos montar el sistema de ficheros proc (la interfaz virtual del
núcleo) en <path>/proc</path>. Pero primero necesitaremos situar nuestros
ficheros en las particiones.
</p>

<p>
Continúe con <uri link="?part=1&amp;chap=5">Instalación de Ficheros de
Instalación de Gentoo</uri>.
</p>

</body>
</section>
</sections>

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/handbook/hb-install-system.xml,v 1.30 2006/02/28 00:27:34 yoswink Exp $ -->

<sections>

<version>2.18</version>
<date>2006-02-27</date>

<section>
<title>Chrooting</title>
<subsection>
<title>Opcional: Seleccionando servidores réplica</title>
<body>

<p>
Para poder descargar el código fuente rápidamente se recomienda seleccionar
un servidor réplica rápido. Portage comprobará en su archivo 
<path>make.conf</path> la variable GENTOO_MIRRORS y utilizará los servidores
que se especifican allí. Puede navegar en nuestra 
<uri link="/main/en/mirrors.xml">lista de réplicas</uri> y buscar un servidor
(o servidores) que estén cerca de su localización (ya que estos suelen 
resultar los más rápidos), pero no nosotros le facilitamos una bonita 
herramienta llamada <c>mirrorselect</c> la cual proporciona una 
interfaz amigable para seleccionar los servidores réplicas que quiera.
</p>

<pre caption="Utilizando mirrorselect para la variable GENTOO_MIRRORS">
# <i>mirrorselect -i -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<warn>
No seleccione ningún servidor con IPv6. Nuestros stages no soportan 
actualmente IPv6.
</warn>

<p>
Otra importante configuración es la variable SYNC en <path>make.conf</path>. 
Esta variable contiene el servidor rsync que quiere utilizar para actualizar
su árbol Portage (la colección de ebuilds, scripts que contienen toda la 
información que Portage necesita para descargar e instalar software). Aunque
puede introducir manualmente el servidor SYNC, <c>mirrorselect</c> puede
encargarse también de esto:
</p>

<pre caption="Seleccionando un servidor rsync utilizando mirrorselect">
# <i>mirrorselect -i -r -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<p>
Después de ejecutar <c>mirrorselect</c> es recomendable que compruebe sus 
configuraciones en <path>/mnt/gentoo/etc/make.conf</path>.
</p>

</body>
</subsection>
<subsection>
<title>Copiar la información DNS</title>
<body>

<p>
Aún queda una cosa que hacer antes de entrar en el nuevo entorno,
copiar la información sobre los DNS en <path>/etc/resolv.conf</path>. 
Necesita hacer esto para asegurarse de que la red continúe funcionando 
después de entrar en el nuevo entorno. <path>/etc/resolv.conf</path> 
contiene los servidores de nombres para su red.
</p>

<pre caption="Copiando los DNS">
<comment>(La opción "-L" es necesaria para asegurarnos que no copiamos un 
enlace simbólico)</comment>
# <i>cp -L /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</i>
</pre>

</body>
</subsection>
<subsection>
<title>Montar el sistema de archivos /proc y /dev</title>
<body>

<p>
Monte el sistema de ficheros <path>/proc</path> en 
<path>/mnt/gentoo/proc</path> para permitir a la instalación
utilizar la información proporcionada por el kernel incluso dentro
del entorno chroot y, posteriormente, montar (de forma transparente) el
sistema de archivos <path>/dev</path>.
</p>

<pre caption="Montando /proc">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>mount -o bind /dev /mnt/gentoo/dev</i> 
</pre>

</body>
</subsection>
<subsection>
<title>Entrando al nuevo entorno</title>
<body>

<p>
Ahora que todas las particiones están inicializadas y el sistema base
instalado, es hora de entrar en nuestro nuevo entorno de instalación
<e>chrooting</e>. Esto significa pasar desde el actual
entorno de instalación (CD de instalación u otro medio) hacia tu
entorno de instalación (o sea, las particiones inicializadas).
</p>

<p>
El cambio de raíz se hace en tres pasos. Primero cambiamos la raíz
desde <path>/</path> (en el medio de instalación) a <path>/mnt/gentoo</path>
(en tus particiones) usando <c>chroot</c>. Después crearemos un nuevo entorno
usando <c>env-update</c>, el cual, en esencia crea las variables de entorno.
Finalmente, cargamos esas variables en memoria tecleando <c>source</c>.
</p>

<pre caption = "Entrando al nuevo entorno">
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i>
 * Caching service dependencies...
# <i>source /etc/profile</i>
# <i>export PS1="(chroot) $PS1"</i>
</pre>

<p>
¡Enhorabuena! Estás dentro de tu nuevo entorno Gentoo Linux.
Por supuesto aún no hemos terminado, todavía quedan unas cuantas
secciones ;)
</p>

</body>
</subsection>
</section>

<section>
<title>Configurar Portage</title>
<subsection>
<title>Opcional: Actualizando el árbol Portage</title>
<body>

<p>
Debería actualizar ahora su árbol Portage a la última versión. 
<c>emerge --sync</c> hará esto por nosotros. 
</p>

<pre caption="Actualizando el árbol Portage">
# <i>emerge --sync</i>
<comment>(Si está utilizando un terminal lento como algunos framebuffers 
o consolas seriales, puede añadir la opción --quiet para aumentar la
velocidad del proceso:)</comment>
# <i>emerge --sync --quiet</i>
</pre>

<p>
Si está detrás de un firewall que bloquea el tráfico rsync, puede utilizar
<c>emerge-webrsync</c> el cual descargará e instalará una imagen de Portage
para su sistema.
</p>

<p>
Si ha advertido que está disponible una nueva versión de Portage y debe
actualizarlo, puede ignorar esta advertencia sin miedo. El Portage
será actualizado durante la instalación.
</p>

</body>
</subsection>
<subsection>
<title>Eligiendo el perfil adecuado</title>
<body>

<p>
Primero, una pequeña definición:
</p>

<p>
Un perfil es la piedra inicial de cualquier sistema Gentoo. No solamente 
especifica unos valores predeterminados para CHOST, CFLAGS,  y otras 
variables importantes , también bloquea del sistema ciertos rangos de 
versiones de algunos paquetes. Son mantenidos por los desarrolladores de 
Gentoo.
</p>

<p>
Tiempo atrás, los perfiles raramente los tocaba el usuario. Sin embargo, 
ahora los usuarios de x86, hppa y alpha puede elegir entre dos perfiles, 
uno para los kernel 2.4 y otro para la serie 2.6. Este requisito ha sido 
impuesto para la integración de los kernels 2.6. Las arquitecturas ppc y 
ppc64 también disponen de varios perfiles disponibles. Hablaremos sobre 
esto más adelante.
</p>

<p>
Se puede ver el perfil actualmente utilizado con el siguiente comando:
</p>

<pre caption="Comprobando el perfil del sistema">
 # <i>ls -l /etc/make.profile</i>
lrwxrwxrwx  1 48 Apr  8 18:51 /etc/make.profile -> ../usr/portage/profiles/default-linux/x86/2006.0/
</pre>
 
<p>
Si se está utilizando una de las tres arquitecturas mencionadas anteriormente,
el perfil por defecto proporciona un sistema basado en Linux 2.6. Este es el 
que recomendamos, pero existe la posibilidad de elegir otro.
</p>

<p>
Algunos usuarios pueden querer instalar un sistema basado en el antiguo 
perfil 2.4. Si tiene una buena razón para esto, entonces lo primero que
debe comprobar es que existe un perfil adicional. En x86, podemos 
hacerlo de la siguiente manera:
</p>

<pre caption="Comprobando si existen perfiles adicionales">
# <i>ls -d /usr/portage/profiles/default-linux/x86/no-nptl/2.4</i>
/usr/portage/profiles/default-linux/x86/no-nptl/2.4
</pre>

<p>
Lo anterior muestra que existe un perfil 2.4 adicional. (no se queja
de que falta un archivo o directorio). Se recomienda que utilice el 
que viene por defecto, pero si quiere cambiarlo, puede hacerlo de la
siguiente manera:
</p>

<pre caption="Cambiando a un perfil 2.4">
<comment>(Asegúrese de utilizar la arquitectura correcta, el ejemplo es para x86)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/x86/no-nptl/2.4 /etc/make.profile</i>
<comment>(Consultando los ficheros en el perfil 2.4)</comment>
# <i>ls -FGg /etc/make.profile/</i>
total 12
-rw-r--r--  1 939 Dec 10 14:06 packages
-rw-r--r--  1 347 Dec  3  2004 parent
-rw-r--r--  1 573 Dec  3  2004 virtuals
</pre>

<p>
Para ppc, existen varios perfiles disponibles proporcionados por 2006.0
</p>
  	 
<pre caption="Perfiles PPC">
<comment>(Perfil PPC Genérico, para todas las máquinas PPC)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0 /etc/make.profile</i>
<comment>(Perfil G3)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G3 /etc/make.profile</i>
<comment>(Perfil G3 Pegasos)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G3/Pegasos/ /etc/make.profile</i>
<comment>(Perfil G4 (Altivec))</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G4 /etc/make.profile</i>
<comment>(Perfil G4 (Altivec) Pegasos)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G4/Pegasos/ /etc/make.profile</i>
</pre>
  	 
<p>
Para ppc64, exiten también nuevos perfiles proporcionados por 2006.0
</p>
  	 
<pre caption="Perfiles PPC64">
<comment>(Perfil PPC64 Genérico de userland 64bit, para todas las máquinas PPC64)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/64bit-userland /etc/make.profile</i>
<comment>(Perfil PPC64 Genérico de userland 32bit, para todas las máquinas PPC64)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/32bit-userland /etc/make.profile</i>
<comment>(Cada tipo de userland tiene distintos sub perfiles de tal manera que, sustituya (userland) por el tipo elegido anteriormente).</comment>
<comment>(Perfil 970 para JS20)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/970/pmac /etc/make.profile</i>
<comment>(Perfil G5)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/970/pmac /etc/make.profile</i>
<comment>(Perfil POWER3)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/power3 /etc/make.profile</i>
<comment>(Perfil POWER4)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/power4 /etc/make.profile</i>
<comment>(Perfil POWER5)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/power5 /etc/make.profile</i>
<comment>(El perfil multilib no es estable para está versión.)</comment>
</pre>

</body>
</subsection>
<subsection id="configure_USE">
<title>Configurando la variable USE</title>
<body>

<p>
<c>USE</c> es una de las variables más importantes que Gentoo proporciona a 
sus usuarios. Muchos programas pueden ser compilados con o sin soporte 
opcional para ciertas cosas. Por ejemplo, algunos programas pueden ser 
compilados con soporte gtk,o con soporte qt. Otros programas pueden ser 
compilados con o sin soporte SSL. Algunos programas pueden ser compilados 
con soporte framebuffer en lugar de soporte X11 (servidor X).
</p>

<p>
Muchas distribuciones compilan sus paquetes con el mayor soporte posible,
aumentando el tamaño de los programas y su tiempo de carga, sin mencionar 
una cantidad enorme de dependencias. Con Gentoo puedes definir con que 
opciones debe ser compilado un paquete. Ahí es donde actúa la variable 
<c>USE</c>.
</p>

<p>
En la variable <c>USE</c> definimos palabras clave que son mapeadas a 
opciones de compilación. Por ejemplo <e>ssl</e> compilará los programas 
que lo requieran con soporte ssl.<e>-X</e> quitara el soporte para el servidor 
X (nótese el signo menos delante). <e>gnome gtk -kde -qt</e> compilará tus 
programas con soporte para gnome y gtk, pero sin soporte para kde (y qt), 
haciendo tu sistema completamente compatible con GNOME.
</p>

<p>
Los valores por defecto de la variable <c>USE</c> se encuentran en
<path>make.defaults</path>, archivos de su perfil. Encontrará los archivos
<path>make.defaults</path> en el directorio al cual apunte
<path>/etc/make.profile</path> y todos sus directorios padres. El valor
predeterminado de configuración de la variable <c>USE</c> es la suma de todas
las configuraciones de <c>USE</c> en todos los archivos
<path>make.defaults</path>. Lo que modifique en <path>/etc/make.conf</path> se
calcula contra estos valores. Si pone algún valor en su <c>USE</c>, es añadido
a la lista por defecto. Si elimina algo en su variable <c>USE</c>, poniéndole
un signo menos delante, es eliminado de la lista por defecto (si estaba en
ella claro). <e>Nunca</e> cambie nada en <path>/etc/make.profile</path> ya que
se sobreescribirá cuando actualice Portage!
</p>

<p>
Puede encontrar una descripción más amplia sobre la variable <c>USE</c> en la
segunda parte del Manual de Gentoo <uri link="?part=2&amp;chap=1">Capítulo 1:
Variables USE</uri>. Encontrará una descripción más extensa sobre las opciones
de la variable USE en su sistema, en
<path>/usr/portage/profiles/use.desc</path>.
</p>

<pre caption="Viendo las opciones disponibles">
# <i>less /usr/portage/profiles/use.desc</i>
<comment>(Puede desplazarse arriba y abajo utilizando sus teclas de flechas y
salir pulsando 'q')</comment>
</pre>

<p>
Como ejemplo, te mostramos unas opciones <c>USE</c> para un sistema basado 
en KDE con DVD, ALSA y soporte para grabar CD's.
</p>

<pre caption="Abriendo /etc/make.conf">
# <i>nano -w /etc/make.conf</i>
</pre>

<pre caption="Configurando la variable USE">
USE="-gtk -gnome qt kde dvd alsa cdr"
</pre>

</body>
</subsection>
<subsection>
<title>Opcional: Locales para GLIBC</title>
<body>

<p>
Probablemente querrá utilizar solamente una o dos configuraciones locales 
en su sistema. Después de compilar <c>glibc</c> se crea un amplio conjunto 
de variables locales. En este punto puede activar la variable USE 
<c>userlocales</c> y especificar solamente las variables locales que necesite
en <path>/etc/locales.build</path>. Solamente haga esto si conoce que locales
debe utilizar.
</p>

<pre caption="Activando la variable USE 'userlocales' para glibc">
# <i>mkdir -p /etc/portage</i>
# <i>echo "sys-libs/glibc userlocales" >> /etc/portage/package.use</i>
</pre>

<p>
Ahora puede especificar las variable locales que quiere utilizar:
</p>

<pre caption="Abriendo /etc/locales.build">
 # <i>nano -w /etc/locales.build</i>
</pre>

<p>
Las siguientes "locales" son un ejemplo para tener, al mismo tiempo, los
idiomas: Inglés (Estados unidos) y Español (España) con sus respectivos
formatos (por ejemplo UTF-8).
</p>

<pre caption="Especificando sus locales">
en_US/ISO-8859-1
en_US.UTF-8/UTF-8
es_ES/ISO-8859-15
es_ES@euro/ISO-8859-15
</pre>

<p>
Ahora continúe con <uri
link="?part=1&amp;chap=7">Configurando el Kernel</uri>.
</p>

</body>
</subsection>
</section>
</sections>

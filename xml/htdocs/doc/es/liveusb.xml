<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/liveusb.xml,v 1.1 2006/01/09 00:14:13 yoswink Exp $ -->

<guide link="/doc/es/liveusb.xml" lang="es">
<title>COMO (HOWTO): LiveUSB en Gentoo Linux</title>

<author title="Autor">
  <mail link="brix@gentoo.org">Henrik Brix Andersen</mail>
</author>
<author title="Traductor">
  <mail link="anpereir@gentoo.org">Andrés Pereira</mail>
</author>

<abstract>
Este COMO explica los pasos necesarios para la creación de LiveUSB en Gentoo
Linux, en otras palabras, cómo emular un CD de Instalación de Gentoo Linux
usando un llavero USB.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>1.0</version>
<date>2006-01-04</date>

<chapter>
<title>Introducción</title>
<section>
<title>El LiveUSB</title>
<body>

<p>
Esta guía explica cómo crear <e>LiveUSB en Gentoo Linux</e> o, en otras
palabras, cómo emular un CD de Instalación de Gentoo Linux usando un
llavero USB. Esto es particularmente útil para instalar Gentoo Linux en
portátil moderno sin lector de CD-ROM.
</p>

<p>
Aunque las instrucciones que se presentan en este documento están orientadas
al CD de instalación de Gentoo Linux usando un llavero USB, deberían
funcionar para cualquier dispositivo de bloques siempre y cuando
ajuste los nombres de dispositivos como corresponde.
</p>

</body>
</section>
<section>
<title>Prerrequisitos</title>
<body>

<p>
Para usar LiveUSB en Gentoo Linux necesita lo siguiente:
</p>

<ul>
  <li>Un dispositivo USB que pueda arrancar (al menos de 64MB)</li>
  <li>Una computadora con soporte de arranque a partir de dispositivos USB</li>
</ul>

<p>
También va a necesitar acceso a lo siguiente para crear el LiveUSB:
</p>

<ul>
  <li>
    Una computadora ejecutando Gentoo Linux (o alternativamente otra
    distribución de Linux)
  </li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Preparando el llavero USB</title>
<section>
<title>Particionando el llavero</title>
<body>

<warn>
Estas instrucciones borrarán todos los datos del llavero USB. Asegúrese de
respaldar sus datos antes.
</warn>

<impo>
Este COMO asume que el nodo de dispositivo <path>/dev/sda</path> corresponde a
su llavero USB. Si tiene otros dispositivos de tipo SCSI, asegúrese de usar
el nodo de dispositivo adecuado.
</impo>

<p>
Cree una partición FAT32 en su llavero USB y márquela para que arranque usando
<c>fdisk</c>. A continuación se presenta un ejemplo de esquema de
particionamiento:
</p>

<pre caption="Ejemplo de esquema de particionamiento">
# <i>fdisk -l /dev/sda</i>

Disk /dev/sda: 1048 MB, 1048313856 bytes
33 heads, 61 sectors/track, 1017 cylinders
Units = cylinders of 2013 * 512 = 1030656 bytes

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *           1        1017     1023580    b  W95 FAT32
</pre>

</body>
</section>
<section>
<title>Creando el sistema de ficheros</title>
<body>

<p>
Cree un sistema de ficheros FAT32 en el llavero USB usando <c>mkdosfs</c>:
</p>

<pre caption="Ejecutando mkdosfs">
<comment>(Asegúrese de tener instalado sys-fs/dosfstools)</comment>
# <i>emerge -av sys-fs/dosfstools</i>
# <i>mkdosfs -F 32 /dev/sda1</i>
mkdosfs 2.11 (12 Mar 2005)
</pre>

</body>
</section>
<section>
<title>Instalando el Registro de Arranque Maestro (Master Boot Record)</title>
<body>

<p>
Instale el Registro de Arranque Maestro precompilado (MBR) desde <c>syslinux</c>
en el llavero USB:
</p>

<pre caption="Instalando el MBR">
<comment>(Asegúrese de tener instalado sys-boot/syslinux-3.00 o superior)</comment>
# <i>emerge -av '>=sys-boot/syslinux-3*'</i>
# <i>dd if=/usr/lib/syslinux/mbr.bin of=/dev/sda</i>
0+1 records in
0+1 records out
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Copiando los ficheros</title>
<section>
<title>Montando el CD de instalación de Gentoo Linux</title>
<body>

<p>
Descargue el fichero <path>install-x86-minimal-2005.1-r1.iso</path> desde su
<uri link="/main/en/where.xml">servidor réplica</uri> local de Gentoo y monte
la imagen ISO en <path>/mnt/cdrom/</path> como se muestra a continuación:
</p>

<pre caption="Montando la imagen del CD de instalación de Gentoo Linux">
<comment>(Cree el punto de montaje /mnt/cdrom/ si es necesario)</comment>
# <i>mkdir -p /mnt/cdrom</i>
# <i>mount -o loop,ro -t iso9660 install-x86-minimal-2005.1-r1.iso /mnt/cdrom/</i>
</pre>

</body>
</section>
<section>
<title>Montando el LiveUSB</title>
<body>

<p>
Monte el llavero recién formateado en <path>/mnt/usb/</path> tal como se
indica abajo:
</p>

<pre caption="Montando el llavero USB">
<comment>(Cree el punto de montaje /mnt/usb/ si es necesario)</comment>
# <i>mkdir -p /mnt/usb</i>
# <i>mount -t vfat /dev/sda1 /mnt/usb/</i>
</pre>

</body>
</section>
<section>
<title>Copiando los ficheros</title>
<body>

<p>
Copie los ficheros del CD de instalación de Gentoo Linux al LiveUSB. Los
ficheros necesitan ser reordenados un poco pues haremos uso del gestor
de arranque <c>syslinux</c> en vez de <c>isolinux</c>:
</p>

<pre caption="Copiando los ficheros">
# <i>cp -r /mnt/cdrom/* /mnt/usb/</i>
# <i>mv /mnt/usb/isolinux/* /mnt/usb/</i>
# <i>mv /mnt/usb/isolinux.cfg /mnt/usb/syslinux.cfg</i>
# <i>rm -rf /mnt/usb/isolinux*</i>

<comment>(El núcleo memtest86 tiene que ser renombrado para cargarlo vía syslinux)</comment>
# <i>mv /mnt/usb/memtest86 /mnt/usb/memtest</i>
</pre>

<p>
Ahora puede desmontar la imagen ISO:
</p>

<pre caption="Desmontando la imagen ISO">
# <i>umount /mnt/cdrom/</i>
</pre>

</body>
</section>
<section>
<title>Ajustando la configuración del gestor de arranque</title>
<body>

<p>
Ajuste el fichero de configuración de syslinux usando <c>sed</c> como se
muestra más abajo. El parámetro <c>scandelay=10</c> introducirá un retraso de
10 segundos antes de intentar montar el sistema de ficheros. Esto es necesario
para permitir que el llavero USB se prepare al conectarlo.
</p>

<pre caption="Ajustando los parámetros de arranque">
# <i>sed -i \
    -e "s:cdroot:cdroot scandelay=10:" \
    -e "s:kernel memtest86:kernel memtest:" \
    /mnt/usb/syslinux.cfg</i>
</pre>

<note>
Considere añadir <c>docache</c> a los parámetros de arranque. Esto permitirá
ejecutar <c>umount /mnt/cdrom/</c> luego del arranque de manera que pueda
desenchufar el llavero USB.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Instalando un gestor de arranque</title>
<section>
<title>Desmontando el llavero</title>
<body>

<p>
Asegúrese de desmontar el llavero USB antes de instalar el gestor de arranque:
</p>

<pre caption="Desmontando el llavero USB">
# <i>umount /mnt/usb/</i>
</pre>

</body>
</section>
<section>
<title>Instalando syslinux</title>
<body>

<p>
Finalmente instale el gestor de arranque <c>syslinux</c> en el llavero USB:
</p>

<pre caption="Ejecutando syslinux">
# <i>syslinux /dev/sda1</i>
</pre>

<impo>
Tendrá que ejecutar nuevamente <c>syslinux /dev/sda1</c> cada vez que modifique
el fichero <path>syslinux.cfg</path> para que los cambios de configuración
tomen efecto.
</impo>

</body>
</section>
</chapter>

<chapter>
<title>Usando el LiveUSB</title>
<section>
<title>Arranque</title>
<body>

<p>
Inserte el llavero USB y encienda su computadora, asegurándose que la BIOS
está configurada para que el PC arranque desde el USB. Si todo va bien debería
ver el prompt estándar de syslinux.
</p>

<p>
De aquí en adelante debería ser capaz de seguir las instrucciones de
instalación presentes en el <uri link="/doc/es/handbook/">Manual de
Gentoo</uri>.
</p>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/genkernel.xml,v 1.8 2006/04/06 00:39:23 yoswink Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/es/genkernel.xml" lang="es">
<title>Guía Genkernel de Gentoo Linux</title>

<author title="Autor">
  <mail link="plasmaroo@gentoo.org">Tim Yamin</mail>
</author>
<!-- folajimi@speakeasy.net -->
<author title="Colaborador">
Jimi Ayodele
</author>
<!-- thseiler@gmail.com -->
<author title="Soporte NFS">
  Thomas Seiler
</author>
<author title="Traductor">
   <mail link="chiguire@gentoo.org">John Christian Stoddart</mail>
</author>
<author title="Traductor">
   <mail link="bass@gentoo.org">José Alberto Suárez López</mail>
</author>
<author title="Traductor">
   <mail link="yoswink@gentoo.org">José Luis Rivero</mail>
</author>
<author title="Traductor">
  <mail link="ervin@activalink.net">Ervin Sarkisov</mail>
</author>
<author title="Traductor">
  <mail link="anpereir@gentoo.org">Andrés Pereira</mail>
</author>

<abstract>
Esta guía intenta proporcionar un marco de referencia para todas
las funciones proporcionadas por genkernel.
</abstract>

<license/>

<version>1.4.3</version>
<date>2005-12-16</date>

<chapter>
<title>Introducción</title>
<section>
<title>Fundamentos</title>
<body>

<p>
Genkernel está diseñado para permitir a los usuarios que no suelen compilar
un núcleo propio utilizar una configuración similar a la del CD de
Instalación Gentoo que auto-detecta su hardware.
Algunos usuarios también pueden estar interesados en utilizar genkernel para
aquél hardware que precisa de un núcleo operativo e inicialización antes de
que arranque el sistema. Genkernel también compila automáticamente los módulos
de su núcleo, lo que permite usar el hardware que requiere la carga de estos
módulos con parámetros personalizados.
</p>

</body>
</section>
<section>
<title>Público objetivo</title>
<body>

<p>
Genkernel a menudo es una buena elección para aquellos que no están
acostumbrados a compilar su propio núcleo o para los que no están seguros
de su configuración de hardware. Genkernel está diseñado para aliviar el
proceso de compilación del núcleo y debería dar soporte por defecto a la
mayoría de su hardware.
</p>

<p>
Sin embargo, si conoce los drivers que requiere su sistema, puede reducir aún
más el tiempo de compilación del núcleo. Esto es posible debido a que puede
indicarle a genkernel que sólo construya los drivers relevantes a su hardware.
Con frecuencia el número de drivers que requiere su sistema será menor
(implicando un tiempo de compilación más corto) que los que provee la
configuración por defecto.
</p>

</body>
</section>
<section>
<title>Instalando genkernel</title>
<body>

<p>
Puede obtener genkernel ejecutando simplemente el comando <c>emerge
genkernel</c>. Si está usando la <uri
link="/doc/es/handbook/2005.1/hb-install-about.xml#doc_chap2_sect1">Plataforma
de Referencia de Gentoo (GRP)</uri> recuerde instalar los paquetes binarios
usando la opción <c>-k</c> de emerge. Ya que algunos paquetes de genkernel en
GRP pueden ser anticuados, ese parámetro puede no ser el mismo. Se recomienda
consultar siempre <c>genkernel --help</c> para obtener ayuda sobre cómo usar
la versión de genkernel instalada en su sistema.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Trabajando con genkernel</title>
<section>
<title>Cómo usar genkernel</title>
<body>

<p>
Aunque hay varias formas de ejecutar genkernel, el enfoque menos inapropiado es
mediante <c>genkernel all</c>. Con este se usa una configuración genérica que
funciona bien en la mayoría de los sistemas. Tal como se mencionaba antes, este
enfoque presenta ciertas desventajas pues la mayor parte de los módulos creados
no son útiles para el usuario promedio y puede incrementar el tiempo de
compilación. Abajo se muestra una ilustración de un enfoque más eficiente el
cual se logra al pasar ciertos parámetros a genkernel como el usuario root:
</p>

<pre caption="Ejecutando genkernel (con parámetros)"> 
# <i>genkernel --bootsplash --no-install --no-clean --menuconfig all</i>
</pre>

<p>
La línea descrita arriba provoca que genkernel construya un núcleo con
la pantalla de presentación de arranque activada (<c>--bootsplash</c>) el
cual tendrá que ser instalado manualmente (<c>--no-install</c>). Mientras se
esté preparando el árbol de fuentes del núcleo, genkernel se abstendrá de
borrar cualquiera de los archivos objeto preexistentes en el árbol de las
fuentes (<c>--no-clean</c>). Se desplegará al usuario una herramienta de
configuración basada en menús para seleccionar qué módulos se construirán en
el sistema (<c>--menuconfig</c>).
</p>

<p>
Existen otros parámetros que alteran el resultado de genkernel. Por ejemplo,
reemplazar <c>--no install</c> con el parámetro <c>--install</c> permite
a genkernel instalar automáticamente el nuevo núcleo en el directorio
<path>/boot</path>. Al usar el parámetro  <c>--mountboot</c> permite que
genkernel monte su partición <path>/boot</path> automáticamente si es
necesario.
</p>

<p>
Recuerde, genkernel está diseñado para que la compilación del núcleo sea
fácil y sin mayores inconvenientes. Por esta razón, genkernel ofrece diversos
parámetros para facilitar el esfuerzo que involucra la compilación del
núcleo. Por ejemplo, hay algunos parámetros que ayudan con la configuración
del núcleo, mientras que hay otros que afectan la compilación actual. Algunos
por su parte incluso pueden servir de ayuda en la depuración del proceso de
compilación. Aquellos que estén interesados en optimizaciones adicionales
tengan en cuenta que existen parámetros que afectan el ensamblado del núcleo,
el empaquetamiento e incluso la inicialización del núcleo.
</p>

<p>
El resto de este capítulo examina la funcionalidad de varios parámetros y
las acciones disponibles de genkernel. Algunos de los parámetros tienen
variantes que llevan a cabo la operación contraria. Dichas variantes tienen
antepuesto el prefijo <b><c>no-</c></b> y sus efectos se encierran dentro de
paréntesis cuadrados, [].
</p>

</body>
</section>
<section>
<title>Parámetros de Configuración</title>
<body>

<p>
Los parámetros de configuración listados abajo le ayudan a decidir qué
características deberían estar activadas o no en el núcleo previo a su
compilación. Incluso puede elegir si el archivo de configuración creado
en el proceso debería ser o no guardado. Los siguientes son los parámetros
principales de configuración:
</p>

<ul>
  <li>
    <b>--<c>no-</c>menuconfig</b>: Activa <e>[o desactiva]</e> el comando
    <c>make menuconfig</c> (que invoca a la utilidad de configuración
    interactiva del núcleo basada en menús de pantalla) antes de compilar
    el núcleo.
  </li>
  <li>
    <b>--gconfig</b>: Provee la utilidad de configuración del núcleo que
    depende de las bibliotecas GTK+-. La ventaja de esta opción es que la
    mayoría de los usuarios encuentran que usar esta herramienta hace más
    fácil y clara la configuración del núcleo ya que se basa en el sistema
    X-Window. Su desventaja es que <b>necesita</b> el sistema X-Window para
    usarla, así que no funcionará en la línea de comandos.
  </li>
  <li>
    <b>--xconfig</b>: Provee la utilidad de configuración del núcleo que
    depende de las bibliotecas QT. La ventaja de esta opción es que la
    mayoría de los usuarios encuentran que usar esta herramienta hace más
    fácil y clara la configuración del núcleo ya que se base en el sistema
    X-Window. Su desventaja es que <b>necesita</b> el sistema X-Window para
    usarla, así que no funcionará en la línea de comandos.
  </li>
  <li>
    <b>--<c>no-</c>save-config</b>: Guarda <e>[o no]</e> el archivo de
    configuración delnúcleo a un archivo en el directorio
    <path>/etc/kernels/</path> para uso posterior.
  </li>
</ul>
</body>
</section>
<section>
<title>Parámetros de Compilación</title>

<body>

<p>
Los siguientes parámetros normalmente hacen efecto durante la compilación
actual:
</p>

<ul>
  <li>
   <b>--kerneldir=<path>/ruta/a/las/fuentes/</path></b>: Especifica una
   ubicación alternativa a las fuentes del núcleo en vez de la ubicación
   por defecto <path>/usr/src/linux/</path>.
  </li>
  <li>
    <b>--kernel-config=<path>/ruta/al/archivo/de/configuración</path></b>:
    Especifica qué archivo alternativo de configuración del núcleo será
    usado en vez del archivo por defecto
    <path>/ruta/a/las/fuentes/.config</path>.
  </li>
  <li>
    <b>--module-prefix=<path>/ruta/al/directorio/de/prefijo</path></b>:
    Especifica un prefijo al directorio donde serán instalados los módulos del
    núcleo (la ruta por defecto es el directorio <path>/lib/modules/</path>).
  </li>
</ul>

<ul>
  <li>
    <b>--<c>no-</c>clean</b>: Activa <e>[o desactiva]</e> el comando <c>make
    clean</c> antes de compilar su núcleo. El comando <c>make clean</c>
    elimina todos los archivos objeto y dependencias del árbol de fuentes del
    núcleo.
  </li>
  <li>
    <b>--<c>no-</c>mrproper</b>: Activa <e>[o desactiva]</e> el comando <c>make
    mrproper</c> antes de compilar su núcleo. Tal como el comando <c>make
    clean</c>, <c>make mrproper</c> elimina todos los archivos objeto y
    dependencias del árbol de fuentes del núcleo. Sin embargo, los archivos
    de configuración anteriores (en <path>/ruta/a/las/fuentes/.config</path> o
    <path>/ruta/a/las/fuentes/config.old</path>) <b>también</b> serán borrados
    del árbol de fuentes del núcleo.
  </li>
  <li>
    <b>--oldconfig</b>: Ejecuta el comando <c>make oldconfig</c>, el cual
    intenta reunir información de configuración de la arquitectura del sistema
    a partir del script genérico ubicado en <path>/usr/share/genkernel/</path>.
    Este es un proceso no-interactivo; no se requiere el usuario dé
    información. También, si se usa <c>--oldconfig</c> junto con
    <c>--clean</c>, este último parámetro es negado lo que resulta en la
    activación del parámetro <c>--no-clean</c>.
  </li>
</ul>

<ul>
  <li>
    <b>--callback="<c>echo Hola</c>"</b>: Realiza una llamada a los argumentos
    especificados (<c>echo Hola</c>, en este caso) luego de que se hayan
    compilado el núcleo y los módulos relevantes, pero antes de compilar la
    imagen de initrd. Esto puede ser útil si quiere instalar módulos externos
    en la imagen initrd invocándolos a través de la llamada
    "callback" y redefiniendo el grupo de módulos de genkernel.
  </li>
</ul>

<ul>
  <li>
    <b>--<c>no-</c>install</b>: Activa <e>[o desactiva]</e> el comando
    <c>make install</c>, que instala su nueva imagen del núcleo, el archivo
    de configuración, la imagen initrd y el mapa de símbolos del sistema en
    su partición boot ya montada.  Así mismo se instalarán los módulos
    compilados.
  </li>
  <li>
    <b>--<c>no-</c>initrdmodules</b>: Esta opción no copia ningún módulo al
    initrd creado por genkernel. Este parámetro es una excepción a la regla
    del prefijo <c>no-</c>; al omitir este prefijo crea un parámetro inválido
    de genkernel.
  </li>
  <li>
    <b>--genzimage</b>: Crea la imagen initrd previo a la imagen del núcleo.
    (Este hack actualmente sólo es válido en los sistemas Pegasos PPC).
  </li>
</ul>

</body>
</section>
<section>
<title>Parámetros del Compilador</title>
<body>

<p>
Genkernel soporta los siguientes parámetros que pueden ser pasados a
aplicaciones relevantes mientras está siendo ensamblado el núcleo. Dichos
parámetros hacen efecto sobre el <e>compilador</e> usado para el proceso
de compilación del núcleo aunque a un nivel mucho más bajo.
</p>

<ul>
  <li>
    <b>--kernel-cc=<c>algúnCompilador</c></b>: Especifica qué compilador
    utilizar para compilar el núcleo.
  </li>
  <li>
    <b>--kernel-ld=<c>algúnEnlazador</c></b>: Define el enlazador que debe
    ser utilizado durante el proceso de compilación de su núcleo.
  </li>
  <li>
    <b>--kernel-as=<c>algúnEnsamblador</c></b>: Especifica qué ensamblador
    utilizar para ensamblar el núcleo.
  </li>
  <li>
    <b>--kernel-make=<c>algúnMake</c></b>: Define una alternativa para <e>GNU
    Make</e> a utilizar durante la compilación del núcleo.
  </li>
</ul>

<ul>
  <li>
    <b>--utils-cc=<c>algúnCompilador</c></b>: Especifica que compilador utilizar
    para compilar las utilidades auxiliares.
  </li>
  <li>
    <b>--utils-ld=<c>algúnEnlazador</c></b>: Define el enlazador que debe ser
    utilizado durante el proceso de compilación de las utilidades auxiliares.
  </li>
  <li>
    <b>--utils-as=<c>algúnEnsamblador</c></b>: Especifica qué ensamblador
    utilizar para ensamblar las utilidades auxiliares.
  </li>
  <li>
    <b>--utils-make=<c>algúnMake</c></b>: Define una alternativa para <e>GNU
    Make</e> a usar durante la compilación de las utilidades auxiliares.
  </li>
</ul>

<ul>
  <li>
    <b>--makeopts=<c>-jX</c></b>: Define el número de hebras concurrentes que
    puede implementar la utilidad make mientras está siendo compilado el
    núcleo (y sus utilitarios).  La variable <b>'X'</b> es un número que se
    obtiene al sumar uno (1) al número de procesadores usados por el sistema.
    Así, para un sistema que tenga una CPU, el parámetro apropiado es
    <c>-j2</c>; un sistema con 2 procesadores usará el parámetro <c>-j3</c> y
    así sucesivamente. <e>(Un sistema con un sólo procesador que soporte la
    tecnología Hyper-Threading&trade; (HT) puede usar el parámetro
    </e><c>-j3</c> <e>toda vez que se haya activado el soporte de
    Procesamiento Múltiple Simétrico (SMP) en el núcleo).</e>
  </li>
</ul>

</body>
</section>
<section>
<title>Parámetros de Depuración</title>
<body>

<p>
El uso de parámetros de depuración durante el proceso de compilación del
núcleo controla la cantidad de información que se reporta, así como la
presentación de dicha información.
</p>

<ul>
<li>
  <b>--debuglevel=<c>NivelDeVerbosidad</c></b>: Controla el nivel de
  verbosidad de la información que entrega genkernel. La variable
  <c>NivelDeVerbosidad</c> es un entero cuyo valor está entre 0 y 5. El nivel
  '0' representa la mínima cantidad de información de salida mientras que '5'
  entrega tanta información como es posible acerca de las actividades de
  genkernel durante el proceso de compilación del núcleo.
</li>
<li>
  <b>--debugfile=<path>/ruta/al/archivo/de/salida</path></b>: Ignora el valor
  ajustado por el parámetro <c>--debuglevel</c> y envía <b>todos</b> los
  datos de depuración generados por genkernel al archivo de salida
  especificado, el cual se ubica por defecto en
  <path>/var/log/genkernel.log</path>.
</li>
<li>
  <b>--no-color</b>: Activa <e>[o desactiva]</e> la salida en colores de la
  información de depuración (generada por genkernel) usando secuencias de
  escape.
</li>
</ul>

</body>
</section>

<section>
<title>Parámetros de Inicialización</title>
<body>

<p>
Los parámetros indicados aquí son usados para crear ciertos efectos durante
el inicio del sistema. Algunos de estos parámetros son meramente para efectos de
estética mientras que otros pueden ser esenciales para la activación de algunas
características en el sistema.
</p>

<ul>
  <li>
    <b>--<c>no-</c>bootsplash</b>: Activa <e>[o desactiva]</e> el soporte
    para la <uri link="http://www.bootsplash.org/">pantalla de presentación
    de arranque</uri> en el initrd que genkernel va a construir. Esta
    característica está soportada en un número limitado de arquitecturas y se
    requiere de un núcleo que también le dé soporte.
  </li>
  <li>
    <b>--<c>no-</c>gensplash</b>: Activa <e>[o desactiva]</e> el soporte para
    <uri
    link="http://dev.gentoo.org/~spock/projects/gensplash/">gensplash</uri>
    en el initrd que genkernel va a construir. El utilitario gensplash tiene
    la intención de ser el reemplazo de bootsplash y está diseñado para su uso
    con núcleo de las series 2.6.X. Para anular el tema por defecto usado por
    gensplash use el parámetro <b>--gensplash=<c>TemaPreferido</c></b> (donde
    <c>TemaPreferido</c> es el título de uno de los directorios ubicados dentro
    del directorio <path>/etc/splash/</path>.
  </li>
  <li>
    <b>--gensplash-res=<c>ResoluciónPreferida</c></b>: Este parámetro le
    permite seleccionar las resoluciones de pantalla de arranque soportadas
    en el initrd durante el inicio del sistema. Esto es útil por dos motivos:
    Primero, que puede seleccionar las resoluciones de pantalla de arranque
    que sólo son relevantes a su sistema. Segundo, evita hacer uso de mayor
    espacio en disco requerido por initrd (puesto que initrd no ofrece
    soporte para aquellas resoluciones irrelevantes a la configuración de su
    sistema). No obstante, puede que desee omitir este parámetro si el núcleo
    está siendo compilado para un CD de Instalación; esto permite soporte de
    gensplash para todas las resoluciones posibles.
  </li>
  <li>
    <b>--do-keymap-auto</b>: Fuerza la selección del mapa de teclado durante
    la secuencia de arranque.
  </li>
  <li>
    <b>--lvm2</b>: Incluye soporte de almacenamiento vía <uri
    link="http://sources.redhat.com/lvm2/">Administración Lógica de
    Volúmenes</uri> (LVM2) a partir de binarios <e>estáticos</e>, si están
    disponibles en el sistema.  Los binarios (estáticos) de LVM2 se compilan
    en caso de no estar presentes. Asegúrese de instalar el paquete lvm2 en
    su sistema con <c>emerge lvm2</c> antes de activar este parámetro y
    revise la <uri link="/doc/es/lvm2.xml">Guía de Instalación de LVM2 en
    Gentoo</uri>.
  </li>
  <li>
    <b>--evms2</b>: Incluye suporte de almacenamiento usando el <uri
    link="http://evms.sourceforge.net/">Sistema de Administración Empresarial
    de Volúmenes</uri> (EVMS2), si está disponible. Asegúrese de instalar el
    paquete evms en su sistema con <c>USE=static emerge evms2</c> antes de
    usar este parámetro de genkernel. <e>(Al omitir el parámetro
    </e><c>USE=static</c> <e>durante la instalación del paquete fallará al
    incluir los binarios estáticos necesarios).
    </e>
  </li>
  <li>
    <b>--dmraid</b>: Incluye suporte para <uri
    link="http://people.redhat.com/~heinzm/sw/dmraid/readme">DMRAID</uri>; la
    utilidad que crea mapeos RAID usando el subsistema de mapeo de
    dispositivos del núcleo. DMRAID descubre, activa, desactiva y muestra las
    propiedades de conjuntos de software RAID (por ejemplo, ATARAID) y
    particiones DOS contenidas.
  </li>
  <li>
    <b>--linuxrc=/ruta/a/su/linuxrc</b>: Especifica la ruta al archivo creado
    por el usuario y denominado <e>linuxrc</e> &mdash; un script inicializado
    durante la etapa de inicio del núcleo previo al proceso de arranque. (La
    ubicación por defecto del script linuxrc debería ser el directorio
    <path>/usr/share/genkernel/</path>) Este script le permite iniciar el
    arranque de un pequeño y modular núcleo y cargar los drivers necesarios
    (como módulos) por el sistema.
  </li>
  <li>
    <b>--cachedir=/ruta/a/un/directorio/alternativo/</b>: Anula la ubicación
    por defecto del caché usado mientras se compila el núcleo.
  </li>
  <li>
    <b>--tempdir=/ruta/al/nuevo/directorio/temporal</b>: Especifica la
    ubicación del directorio temporal usado por genkernel mientras compila el
    núcleo.
  </li>
  <li>
    <b>--unionfs</b>: Incluye soporte del <uri
    link="http://www.fsl.cs.sunysb.edu/project-unionfs.html">Sistema de
    Unificación de Archivos</uri> en la imagen del initrd.
  </li>
</ul>

</body>
</section>
<section>
<title>Parámetros misceláneos</title>
<body>

<p>
Genkernel también soporta una serie de otros parámetros que no pueden
clasificarse en las categorías descritas anteriormente:
</p>

<ul>
  <li>
    <b>--mountboot</b>: Detecta si el directorio <path>/boot/</path>
    necesita o no ser montado en una partición separada. Revisará el archivo
    <path>/etc/fstab</path> para ver cómo montar la partición boot en un
    sistema de archivos (si es necesario).
  </li>
  <li>
    <b>--kernname=<c>Sobrenombre</c></b>: Le permite modificar el nombre del
    núcleo y las imagenes initrd en el directorio <path>/boot/</path>, de
    manera que las imagenes producidas por el núcleo sean
    kernel-<c>Sobrenombre</c>-version e initramfs-<c>Sobrenombre</c>-version.
  </li>
</ul>

</body>
</section>
<section>
<title>Acciones posibles</title>
<body>

<p>
Una acción le dice a genkernel qué construir. Actualmente, se reconocen las
siguientes acciones:
</p>

<ul>
  <li><c>initrd</c>: Construye solamente la imagen initrd</li>
  <li><c>bzImage</c>: Construye solamente la imagen del núcleo</li>
  <li>
    <c>kernel</c>: Construye solamente la imagen del núcleo y los módulos
  </li>
  <li>
    <c>all</c>: Construye todas las etapas &mdash; initrd, imagen del núcleo y
    módulos
  </li>
</ul>

<p>
La última acción, <c>all</c>, es la que se recomienda para la mayoría de los
usuarios pues construye las etapas requeridas para tener un núcleo funcional.
Recuerde, una <e>acción</e> simplemente le dice a genkernel qué
<e>construir</e> y no qué <e>instalar</e>.
</p>

</body>
</section>
<section>
<title>Configuración del Gestor de Arranque</title>
<body>

<p>
Para configurar genkernel de modo que funcione con su gestor de arranque,
se deberían hacer tres o cuatros cambios al archivo de configuración del gestor:
</p>
<ol>
  <li>
    Añada los parámetros del núcleo <c>root=/dev/ram0</c> e
    <c>init=/linuxrc</c> para pasarles a la imagen del kernel.
  </li>
  <li>
    Añada por ejemplo <c>real_root=/dev/hda3</c>, a los parámetros de núcleo
    que pasamos a la imagen en caso de que <path>/dev/hda3</path> sea su
    partición de raíz.
  </li>
  <li>
    Si está utilizando la pantalla de presentación de arranque (bootsplash),
    añada un parámetro correcto para el modo de pantalla, por ejemplo
    <c>vga=0x317</c>, así como <c>splash=verbose</c> o <c>splash=silent</c>
    según el nivel de detalle que desee.
  </li>
  <li>
    Añada initrd a la configuración de su gestor de arranque; véase <uri
    link="/doc/es/handbook/handbook-x86.xml?part=1&amp;chap=10">El Manual de
    Gentoo</uri> para aprender como hacerlo con el tipo de gestor de arranque
    que posee.
  </li>
</ol>
</body>
</section>
</chapter>

<chapter>
<title>Opciones de configuración</title>
<section>
<title>Editando /etc/genkernel.conf</title>
<body>

<p>
Pasar parámetros a genkernel desde la línea de comandos puede ser engorroso,
especialmente si tiene cerca de una docena de parámetros:
</p>

<pre caption="Ejecutando genkernel (sobrecargado con parámetros)">
# <i>genkernel --debuglevel=5 --no-color --no-mrproper --clean --gensplash \
--kerneldir=/ruta/alternativa/a/las/fuentes/del/núcleo --install --menuconfig \
--kernel-config=/ruta/al/archivo/de/configuración --save-config --mountboot all</i>
</pre>

<p>
Afortunadamente existe un archivo de configuración donde se puede ajustar (o
cambiar) la mayoría de las opciones básicas en la medida que sea necesario.
Lo que sigue a continuación es un resumen de las opciones más relevantes:
</p>

<ul>
  <li>
    <b>MENUCONFIG=<c>[yes|no]</c></b>: Esta opción es equivalente al
    parámetro <c>--menuconfig</c> usado por genkernel, que a su vez usa el
    comando <c>make menuconfig</c> para invocar la utilidad de configuración
    del núcleo basada en línea de comandos. Para invocar la utilidad
    automáticamente durante la configuración del núcleo mediante este script,
    ajuste aquí la opción 'yes', de lo contrario elija 'no'.
  </li>
  <li>
    <b>CLEAN=<c>[yes|no]</c></b>: Al ajustar esta opción a 'yes' equivale al
    parámetro <c>--clean</c> usado por genkernel e invoca el comando <c>make
    clean</c> para eliminar todos los archivos objeto y dependencias del
    árbol de fuentes del núcleo. Por el contrario, al ajustar esta opción a
    'no' crea un efecto de cascada &#8212; que es equivalente al parámetro
    <c>--no-clean</c> de genkernel y que inhabilita el comando <c>make
    clean</c> e implica el parámetro <c>--no-mrproper</c> de genkernel
    &mdash; lo que esencialmente anula el comando <c>make mrproper</c>.
  </li>
  <li>
    <b>MRPROPER=<c>[yes|no]</c></b>: Ajustar esta opción a 'yes' equivale al
    parámetro <c>--mrproper</c> usado por genkernel e invoca el comando
    <c>make mrproper</c>, el cual elimina por completo los archivos de
    configuración presentes en el árbol de fuentes del núcleo. Seleccionar
    'no' es equivalente al parámetro <c>--no-mrproper</c>, que desactiva el
    comando <c>make mrproper</c>.
  </li>
  <li>
    <b>MOUNTBOOT=<c>[yes|no]</c></b>: Ajustar esta opción a 'yes' equivale al
    parámetro <c>--mountboot</c> y monta automáticamente el directorio
    <path>/boot/</path> (de ser necesario) en tiempo de compilación. Si el
    directorio <path>/boot/</path> está en una partición separada considere
    activar esta opción puesto que es esencial más tarde y no tendrá que
    recordarlo en ese momento.
  </li>
  <li>
    <b>SAVE_CONFIG=<c>[yes|no]</c></b>: Luego de configurar el núcleo, las
    opciones seleccionadas se almacenan en <path>.config</path> en el árbol
    de fuentes del núcleo. Este script puede ser sobreescrito durante la
    próxima compilación del núcleo o incluso eliminado del árbol de fuentes
    del núcleo. Eligiendo 'yes' equivale al parámetro <c>--save-config</c> y
    guarda todas las opciones seleccionadas durante la configuración del
    núcleo en un script en el directorio <path>/etc/kernels/</path>.  Si
    elige 'no' mantiene el <e>status quo</e>.
  </li>
  <li>
    <b>USECOLOR=<c>[yes|no]</c></b>: Ajustar esta opción a 'yes' es
    equivalente al parámetro <c>--color</c> que muestra la salida de
    genkernel en colores para facilitar la depuración (cuando es necesario).
  </li>
  <li>
    <b>DEBUGLEVEL=<c>[0|1|2|3|4|5]</c></b>: Esta opción es para ajustar el
    nivel de verbosidad de la salida que genera genkernel &mdash; Si ajusta
    esta opción a '0' con <c>--debuglevel=0</c> hará que se suprima toda la
    salida generada por genkernel; mientras que ajustándola a '5' con
    <c>--debuglevel=5</c> tendrá el efecto contrario, es decir, mostrará al
    usuario toda la salida generada por genkernel.
  </li>
</ul>

<p>
Al elegir las opciones apropiadas en <path>/etc/genkernel.conf</path>, puede
reducir hasta la mitad del número de parámetros pasados a genkernel en la
línea de comandos.
</p>

<pre caption="Ejecutando genkernel (con parámetros) luego de usar genkernel.conf">
# <i>genkernel --gensplash --kerneldir=/ruta/alternativa/a/las/fuentes/del/núcleo \
--kernel-config=/ruta/al/archivo/de/configuración --install all</i>
</pre>

<p>
Los resultados obtenidos por ambos métodos son idénticos pero el último tiene
la mayor parte de las opciones almacenadas en un script que puede ser modificado
después.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Arranque por Red con genkernel</title>
<section>
<title>Arranque por Red a partir de un CD de Instalación</title>
<body>

<p>
El utilitario genkernel puede construir el núcleo y las imagenes initrd que dan
soporte para arranque por red, o <e>netboot</e>ing. Con suerte, debería ser
capaz de hacer netboot en cualquier computador reciente en el ambiente
ofrecido por el CD de Instalación.
</p>

<p>
La magia está en el el script linuxrc de genkernel: este intentará realizar un
<e>netmount</e> (montaje vía red) del CD de Instalación usando NFS. A partir
de allí los <e>scripts de inicio</e> del CD de Instalación pueden tomar el
control como si el CD estuviera presente de forma local.
</p>

</body>
</section>
<section>
<title>Construyendo el Núcleo y las Imagenes Initrd con Soporte para Arranque por Red</title>
<body>

<p>
Para activar el soporte de arranque por red incluya las siguientes opciones
mientras configura el núcleo:
</p>

<warn>
El soporte para arranque por red con genkernel es experimental y puede presentar
bugs.
</warn>

<p>
Primero, la imagen del núcleo debe incluir los drivers para sus tarjetas de
interfaz de red (NIC). Normalmente, los drivers para tales dispositivos serán
compilados como módulos. Sin embargo, es esencial (para el arranque por red)
tener dichos drivers compilados directamente en la imagen del núcleo y <b>no</b>
como módulos.
</p>

<pre caption="Configurando un núcleo de la serie 2.6.x para dar soporte al driver de las tarjetas de red">
Device Drivers --->
   Networking Support --->
      Ethernet (10 or 100Mbit)  --->
         [*] Ethernet (10 or 100Mbit) 
         &lt;*&gt;   El driver para su tarjeta de red
<comment>(Asegúrese de seleccionar &lt;*&gt; y no &lt;M&gt;)</comment>
</pre>

<p>
Segundo, sugerimos que active las opciones: <c>IP: kernel level
autoconfiguration</c> y <c>IP: DHCP support</c>. Esto evita una capa
innecesaria de complejidad ya que la dirección IP y la ruta NFS al CD de
instalación pueden ser configuradas en un servidor DHCP.  Por supuesto, esto
significa que la línea de comandos del núcleo permanecerá constante para
todas las máquinas &mdash; lo que es muy importante para realizar
<e>etherbooting</e> (arranque vía ethernet).
</p>

<pre caption="Configurando un núcleo de la serie 2.6.x para dar soporte a DHCP">
Device Drivers --->
   Networking Support --->
      Networking options 
         [*] TCP/IP networking--->
         [*]   IP: kernel level autoconfiguration
         [*]     IP: DHCP support
<comment>(Estas opciones le dicen al núcleo que envíe una petición DHCP al iniciar
el arranque)</comment>
</pre>

<p>
Adicionalmente, debería activar SquashFS ya que la mayoría de los CD de
Instalación modernos de Gentoo lo requieren. El soporte para SquashFS no se
incluye en el árbol genérico de fuentes del núcleo. Para activar SquashFS,
debe conseguir y aplicar los parches necesarios para las fuentes genéricas
del núcleo o instalar <c>gentoo-sources</c>.
</p>

<pre caption="Configurando el núcleo para dar soporte a SquashFS">
File systems--->
   Miscellaneous filesystems --->
      [*] SquashFS 2.X - Squashed file system support
</pre>

<p>
Una vez completado el proceso de compilación, cree un <e>tarball</e> (tar.gz)
que contenga los módulos del núcleo. Este paso es solamente necesario si
su versión del núcleo no concuerda con la versión de la imagen del núcleo
del CD de Instalación.
</p>

<pre caption="Creando un tarball comprimido que contenga los módulos del núcleo">
<comment>(Crea un tar.gz que contiene todos los módulos)</comment>
# <i>cd /</i>
# <i> tar -cf /tmp/modules-X.Y.Z.tar.gz /lib/modules/X.Y.Z/</i>
</pre>

<p>
Dependiendo de su mecanismo de arranque por red necesitará hacer alguno de
los siguientes pasos:
</p>

<pre caption="Creando una imagen de arranque">
<comment>(Crea una imagen de etherboot)</comment>
# <i>emerge mknbi</i>
# <i>cd /boot</i>
# <i>mkelf-linux -params="root=/dev/ram0 init=/linuxrc ip=dhcp" núcleo... initrd... > etherboot.img</i>

<comment>(Crea una imagen OpenBoot / SPARC64 TFTP)</comment>
# <i>emerge sparc-utils</i>
# <i>cd /boot</i>
# <i>elftoaout kernel... -o kernel.aout</i>
# <i>piggyback64 kernel.aout System.map-... initrd-...</i>
# <i>mv kernel.aout openboot.img</i> <comment>(Esta en la imagen de arranque)</comment>

<comment>(PXE no necesita de más pasos, el núcleo e initrd pueden ser usados tal cual)</comment>
</pre>

<p>
Finalmente, copie este núcleo a su servidor TFTP. Los detalles dependen de
la arquitectura y están más allá del alcance de esta guía. Por favor, consulte
la documentación de su plataforma.
</p>

</body>
</section>
<section>
<title>Configuración de NFS</title>
<body>
<p>
Para configurar un recurso compartido de NFS que contenga el CD de Instalación,
use el dispositivo loop para montar la imagen ISO y luego copie los contenidos
del CD en el recurso NFS. Como característica extra, los scripts initrd de
genkernel extraerán todos los archivos tar.gz ubicados en el directorio
<path>/nfs/livecd/add/</path>. Todo lo que debe hacer aquí es copiar
el archivo <c>modules-X.Y.Z.tar.gz</c> al directorio
<path>/nfs/livecd/add/</path>.
</p>

<pre caption="Preparando el recurso compartido NFS">
<comment>(Esto asume que /nfs/livecd es un recurso compartido NFS)</comment>
# <i>mount /tmp/gentoo-livecd.iso /mnt/cdrom -o loop</i>
# <i>cp -p /mnt/cdrom /nfs/livecd</i>
# <i>umount /mnt/cdrom</i>

<comment>(Copie modules.tar.gz en /add)</comment>
# <i>mkdir /nfs/livecd/add</i>
# <i>cp /tmp/modules-X.Y.Z.tar.gz /nfs/livecd/add</i>
</pre>

</body>
</section>
<section>
<title>Configuración de DHCP</title>
<body>

<p>
Las imagenes del arranque por red (netboot) le pedirán a su servidor DHCP una
IP así como el parámetro de la ruta raíz. Ambos pueden ser especificados por
máquina usando un dirección MAC para identificarlas:
</p>

<pre caption="Configuración de ejemplo de cliente en dhcpd.conf">
...

host netbootableMachine {
         hardware ethernet 11:22:33:44:55:66;
         fixed-address 192.168.1.10;
         option root-path "192.168.1.2:/nfs/livecd";
}
<comment># Aquí, 192.168.1.2 el servidor NFS
# Mientras que 192.168.1.10 será la dirección IP de la máquina que arrancará por red</comment>
...
</pre>

</body>
</section>
<section>
<title>Instrucciones de Arranque por Red</title>
<body>

<p>
El arranque por red es nuevamente muy dependiente de la plataforma. La parte
importante es especificar los parámetros <c>ip=dhcp</c> y <c>init=/linuxrc</c>
en la línea de comandos del núcleo pues esto activará la interfaz de red y le
dirá a los scripts initrd que monten el CD de Instalación vía NFS. Aquí le
mostramos algunos consejos dependientes de la plataforma:
</p>

<pre caption="Instrucciones de Arranque por Red">
<comment># Etherboot - Inserte el disco de etherboot en la disquetera y reinicie
# La línea de comandos del núcleo fue especificada cuando se construyó la imagen</comment>

<comment># Sparc64 - Presione Stop-A en el intérprete de arranque</comment>
ok boot net ip=dhcp init=/linuxrc

<comment># PXE - Configure pxelinux (parte de syslinux),
luego cree un archivo pxelinux.cfg/default similar a:</comment>

DEFAULT gentoo
TIMEOUT 40
PROMPT 1

LABEL gentoo
    KERNEL kernel-X.Y.Z
    APPEND initrd=initrd-X.Y.Z root=/dev/ram0 init=/linuxrc ip=dhcp
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Conclusión</title>

<section>
<title>¿Automatizar o no automatizar?</title>
<body>

<p>
El propósito de genkernel es otorgar un alternativa (más fácil) a la clásica
y forma efectiva de compilar el núcleo. Como siempre, es libre de decidir
si quiere o no automatizar el proceso de compilación del núcleo.
</p>

</body>
</section>
</chapter>

</guide>

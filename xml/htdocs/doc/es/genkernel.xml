<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/es/genkernel.xml">
<title>Guía Genkernel de Gentoo Linux</title>

<author title="Autor">
  <mail link="plasmaroo@gentoo.org">Tim Yamin</mail>
</author>

<author title="Editor-Es">
   <mail link="bass@gentoo.org">José Alberto Suárez López</mail>
</author>

<author title="Follow-up Editor-Es">
   <mail link="chiguire@gentoo.org">John Christian Stoddart</mail>
</author>

<author title="Traductor">
  <mail link="ervin@activalink.net">Ervin Sarkisov</mail>
</author>

<abstract>
Esta guía intenta proporcionar un marco de referencia para todas
las funciones proporcionadas por Genkernel.
</abstract>

<license/>

<version>1.0.0.1</version>
<date>Abril 22, 2003</date>

<chapter>
<title>Introducción</title>
<section>
<title>Introducción</title>
<body>

<p>
Genkernel está diseñado para permitir a los usuarios que no suelen compilar
un núcleo propio utilizar una configuración similar a la de LiveCD de Gentoo 
que autodetecta su hardware.
</p>

<p>
Algunos usuarios pueden estar interesados en utilizar genkernel para aquél hardware 
que precisa de un núcleo operativo e inicialización antes de poder ser arrancado. 
Genkernel también compila automáticamente los módulos de su núcleo, lo que permite
usar el hardware que requiere la carga de estos módulos con parámetros personalizados.
</p>
</body>
</section>

<section>
<title>¿Es Genkernel es para mí?</title>
<body>

<p>
Genkernel a menudo es una buena elección para aquellos que no están acostumbrados 
a compilar su propio núcleo o para los que no están seguros de su configuración de 
hardware.
</p>

<p>
Ya que genkernel está diseñado para un uso genérico, debe poder soportar todo su 
hardware, lo que significa que se compilarán los drivers y módulos, asimismo, compilar 
un núcleo propio es amenudo mucho más rápido si sabe lo que necesita.
</p>

<p>
Sin embargo, genkernel actualmente no soporta el arranque del sistema de particiones 
LVM2/EVMS2. Por ahora, se les recomienda a los usuarios utilizar un núcleo compilado 
manualmente para estos casos.
</p>
</body>
</section>

<section>
<title>Obtener Genkernel</title>
<body>

<p>
Puede obtener genkernel ejecutando simplemente el comando <c>emerge genkernel</c>. 
Que no se le olvide usar la opción <c>-k</c> si está utilizando un paquete binario, 
por ejemplo de GRP. Ya que algunos paquetes de genkernel en GRP pueden ser anticuados 
y ese parámetro puede no ser el mismo. Se recomienda consultar siempre <uri link="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=1&amp;chap=9">El 
Handbook (Manual) de Gentoo</uri> y la salida de <path>genkernel --help</path>.
</p>
</body>
</section>

<section>
<title>Plataformas Soportadas</title>
<body>

<p>
A partir de la versión 3.0.2 de genkernel, las siguientes plataformas están soportadas: 
alpha, amd64, parisc, parisc64, ppc, ppc64, sparc, sparc64, y x86. Si opina que hay algún
error y fallo de funcionamiento con el código soportado y no con genkernel por favor
registre una incidencia en <uri link="http://bugs.gentoo.org">El Bugzilla de Gentoo</uri>.
</p>
</body>
</section>
</chapter>

<chapter>
<title>Uso de Genkernel</title>
<section>
<title>Introducción</title>
<body>

<p>
Genkernel está diseñado para funcionar en siguientes modos de operación:
</p>

<ul>
  <li>modo "all" (todo): construye el núcleo así como el initrd</li>
  <li>modo "kernel" (núcleo): construye solamente la imagen del núcleo</li>
  <li>modo "initrd": sólo construye initrd</li>
</ul>

<p>
La mayoría de usuarios sólo deseará utilizar el modo "all" que implica a su vez 
la creación del núcleo y de initrd. <b>Tenga en cuenta</b> que los modos "kernel" 
y "initrd" actualmente son accesos directos al modo "all", por lo tanto carecen 
de funcionalidad propia.
</p>

<p>
Aunque genkernel principalmente es un comando para hacerle la vida
fácil a la hora de compilar el núcleo, esta también dotado de muchos
parámetros útiles para permitirle personalizar su configuración y
compilación.
</p>

</body>
</section>
<section>
<title>Parámetros de Compilador para Genkernel</title>
<body>

<p>
Genkernel soporta los siguientes parámetros que pueden ser pasados a aplicaciones
relevantes cuando su núcleo esté ya ensamblado:
</p>

<ul>
  <li>
    <b>--kernel-as=<c>algúnEnsamblador</c></b>: Especifica que ensamblador utilizar
    para ensamblar el núcleo.
  </li>
  <li>
    <b>--kernel-cc=<c>algúnCompilador</c></b>: Especifica que compilador utilizar
    para compilar el núcleo.
  </li>
  <li>
    <b>--kernel-ld=<c>algúnEnlazador</c></b>: Define el enlazador que debe ser utilizado
    durante el proceso de compilación de su núcleo.
  </li>
  <li>
    <b>--kernel-make=<c>algúnMake</c></b>: Define una alternativa para GNU Make 
    a utilizar durante la compilación del núcleo.
  </li>
</ul>

<ul>
  <li>
    <b>--utils-as=<c>algúnEnsamblador</c></b>: Especifica que ensamblador utilizar
    para ensamblar las utilidades auxiliares.
  </li>
  <li>
    <b>--utils-cc=<c>algúnCompilador</c></b>: Especifica que compilador utilizar
    para compilar las utilidades auxiliares.
  </li>
  <li>
    <b>--utils-ld=<c>algúnEnlazador</c></b>: Define el enlazador que debe ser utilizado
    durante el proceso de compilación de las utilidades auxiliares.
  </li>
  <li>
    <b>--utils-make=<c>algúnMake</c></b>: Define una alternativa para GNU Make 
    a usar durante la compilación de las utilidades auxiliares.
  </li>
</ul>

<ul>
  <li>
    <b>--makeopts=<c>-jTareas</c></b>: Define los argumentos que serán pasados
    al GNU Make cuando las utilidades auxiliares del núcleo así como el núcleo 
    en si se estén compilando.
  </li>
</ul>

</body>
</section>

<section>
<title>Parámetros Genkernel del Núcleo</title>
<body>

<p>
Genkernel soporta los siguientes parámetros, algunos de ellos 
tienen su correspondiente <c>--<b>no-</b>opción</c> que afecta
la manera en que se compila el kernel:
</p>

<ul>
  <li>
    <b>--callback="echo Hola"</b>: Esta rutina realiza una llamada a los argumentos
    especificados una vez que el núcleo y los respectivos módulos estén compilados,
    siempre antes de que se construya el initrd. El parámetro resulta útil cuando
    se desea instalar módulos externos dentro del initrd, invocándolos a través
    de la llamada <c>--callback=</c> y redefiniendo el grupo de módulos de Genkernel.
  </li>
  <li>
    <b>--<c>no-</c>clean</b>: Esta opción habilita o <e>no</e> la ejecución de 
    <c>make clean</c> antes de compilar su núcleo, lo que causa que todas las 
    dependencias y ficheros object se eliminen.
  </li>
  <li>
    <b>--<c>no-</c>mrproper</b>: Esta opción habilita o <e>no</e> la ejecución de
    <c>make mrproper</c> antes de compilar su núcleo, lo que causa la eliminación de 
    las dependencias, ficheros object y <b>archivos de configuración</b>.
  </li>
</ul>

<ul>
  <li>
    <b>--kerneldir=<path>/ubicación/de/las/fuentes</path></b>: Especifica la ubicación
    alternativa del código fuente del núcleo en lugar del directorio por defecto 
    <path>/usr/src/linux</path>.
  </li>
  <li>
    <b>--kernel-config=<path>/ubicación/del/fichero/configuración</path></b>: Esta opción
    define el fichero alternativo de configuración del núcleo que debe ser utilizado, en 
    lugar del <path>/ubicación/de/las/fuentes/.config</path> por defecto.
  </li>
</ul>

<ul>
  <li>
    <b>--<c>no-</c>bootsplash</b>: El parámetro añade o <e>no</e> el soporte para 
    la pantalla de presentación de arranque dentro del initrd que genkernel va a construir. 
    No todas las arquitecturas la soportan, ni tampoco todos los kernels.
  </li>
  <li>
    <b>--<c>no-</c>menuconfig</b>: Esta opción ejecuta o <e>no</e> el programa de configuración
    del núcleo basada en menús de pantalla antes de compilar el núcleo, y después de ejecutar
    <c>make oldconfig</c>.
  </li>
</ul>

<ul>
  <li>
    <b>--no-initrdmodules</b>: Esta opción no copia ningún modulo a initrd creado por 
    genkernel.
  </li>
  <li>
    <b>--<c>no-</c>install</b>: El parámetro define si genkernel debe realizar o <e>no</e>
    la instalación del núcleo, los módulos y initrd una vez finalizada la compilación.
  </li>
</ul>

</body>
</section>

<section>
<title>Otros Parámetros de Genkernel</title>
<body>

<p>
Genkernel también soporta una serie de otros parámetros que no pueden
clasificarse en las categorías descritas anteriormente:
</p>

<ul>
  <li>
    <b>--arch-override=<c>algúnArquitectura</c></b>: Este parámetro puede
    ser utilizado para modificar la arquitectura del sistema detectada por
    genkernel. Esta opción se utiliza en caso de que el mecanismo de auto-detección 
    falle (en este caso por favor registre una incidencia) o si desea realizar 
    una compilación cruzada del núcleo.
  </li>
</ul>

<ul>
  <li>
    <b>--busybox-config=<path>/ubicación/de/configuración-busybox</path></b>: 
    Este parametro define la ubicación alternativa del fichero de configuración 
    de busybox.
  </li>
  <li>
    <b>--busybox-bin=<path>/ubicación/de/binario-busybox.tar.bz2</path></b>: 
    Haciendo uso de esta opción se consigue no compilar el binario busybox,
    usando en su lugar el fichero tar proporcionado. Tenga en cuenta que
    busybox <e>tiene que</e> ser compilado de forma estática.
  </li>
</ul>

<ul>
  <li>
    <b>--minkernpackage=<path>/ubicación/de/sunúcleo.tar.bz2</path></b>: 
    Este parámetro devuelve un fichero tar del núcleo, denominado 
    <path>kernel</path> y initrd llamado <path>initrd</path> en el archivo
    específico. No se incluirán ni los módulos ni datos de rutas.
  </li>
</ul>

</body>
</section>

<section>
<title>Ejecución de Genkernel</title>
<body>

<p>
Para ejecutar genkernel lo único que necesita es el binario con sus respectivos
parámetros y derechos de administrador. Por ejemplo:
</p>

<pre caption="Ejecución de genkernel">
# genkernel --menuconfig --no-clean --no-install --bootsplash all
<comment>(El comando producirá un núcleo, permitiéndole configurarlo
según su criterio, sin tocar los ficheros compilados object,
con soporte de pantalla de presentación de arranque habilitado pero sin
instalar nada).</comment>
</pre>

<p>
En caso de que desee que genkernel instale su núcleo, tiene que asegurarse
de que su partición <path>/boot</path> este montada. Las últimas versiones de
Genekernel lo intentarán hacer automáticamente en caso de que la variable
MOUNTBOOT tenga valor "yes" en el fichero de configuración de genkernel
<path>/etc/genkernel.conf</path>.
</p>

<pre caption="Montando manualmente su /boot">
<comment>(Sólo si /boot es una entrada válida en /etc/fstab)</comment>
# mount /boot
<comment>(... en caso contrario habrá que definir el dispositivo IDE)</comment>
# mount /dev/hda1 /boot
<comment>(... y en caso de discos SCSI ...)</comment>
# mount /dev/sda1 /boot
</pre>
</body>
</section>

<section>
<title>Configuración de Genkernel para Funcionar con su Gestor de Arranque</title>
<body>

<p>
Para hacer que genkernel funcione con su gestor de arranque, deben ser
realizados varios cambios en la configuración del gestor.
</p>

<ol>
  <li>
    Añada los parámetros del núcleo <c>root=/dev/ram0</c> e <c>init=/linuxrc</c> para
    para pasarles a la imagen del kernel.
  </li>
  <li>
    Añada por ejemplo <c>real_root=/dev/hda3</c>, a los parámetros de núcleo que pasamos
    a la imagen en caso de que <path>/dev/hda3</path> sea su partición de raíz.
  </li>
  <li>
    Si está utilizando la pantalla de presentación de arranque (bootsplash), añada un parametro
    correcto para el modo de pantalla, por ejemplo <c>vga=0x317</c>, así como 
    <c>splash=verbose</c> o <c>splash=silent</c> según el nivel de detalle que desee.
  </li>
  <li>
    Añada initrd a la configuración de su gestor de arranque; véase <uri 
    link="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=1&amp;chap=9">El Handbook de
    Gentoo</uri> para aprender como hacerlo con el tipo de gestor de arranque que posee.
  </li>
</ol>
</body>
</section>
</chapter>

<chapter>
<title>Portando Genkernel</title>
<section>
<title>Introducción</title>
<body>

<p>
Una vez que su arquitectura tenga las librerías y utilidades que requiere
genkernel, podemos ponernos en marcha. Las necesidades del genkernel consisten
de tener un núcleo operativo para la arquitectura en cuestión, un compilador, 
GNU make, así como una distribución operativa de busybox.
</p>

<p>
Para cada arquitectura, genkernel utiliza 
<path>/usr/share/genkernel/archNombre</path> para almacenar ficheros de
configuración específicos de esta arquitectura.
</p>

</body>
</section>
<section>
<title>Como Funciona el Sistema de Arranque</title>
<body>

<ol>
  <li>
    El gestor de arranque carga la imagen de genkernel, construido según los 
    ficheros de configuración del mismo, así como el initrd producido por
    genkernel.
  </li>
  <li>
    El núcleo arranca, asigna una pequeña cantidad de RAM en la cual busybox será
    inicializado, que a su vez prueba si puede cargar los módulos definidos en
    la lista <e>modules_load</e> para la arquitectura de la máquina.
  </li>
  <li>
    Una vez hecho esto, el sistema arranca si el parámetro <c>real_root</c> esta
    correctamente definido y apunta al dispositivo de arranque, lo que permite a 
    la utilidades busybox localizar los recursos que necesita.
  </li>
</ol>
</body>
</section>

<section>
<title>Ficheros de Configuración</title>
<body>

<ul>
  <li>
    <path>busy-config</path>: Este es el fichero de configuración utilizado
    para compilar busybox para su instalación.
  </li>
  <li>
    <path>config.sh</path>: El script que establece algunas variables externas
    de genkernel. Como ejemplo, véase alguno de los ficheros 
    <path>config.sh</path>.
  </li>
  <li>
    <path>modules_load</path>: Dentro de este fichero, que está en formato de 
    ancho fijo podemos localizar el listado de aquellos módulos que deben ser 
    cargados para soportar SCSI, FireWire y PCMCIA. Si no hay ningún módulo disponible 
    para su plataforma, deje el fichero <path>modules_load</path> en blanco.
  </li>
</ul>

<ul>
  <li>
    <path>kernel-config</path>: El fichero de configuración del núcleo utilizado
    por defecto con cualquier versión del mismo.
  </li>
  <li>
    <path>kernel-config-2.4</path>: El fichero de configuración del núcleo basado en 2.4.
  </li>
  <li>
    <path>kernel-config-2.6</path>: El fichero de configuración del núcleo basado en 2.6.
  </li>
</ul>

</body>
</section>
</chapter>
</guide>

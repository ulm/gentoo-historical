<?xml version = '1.0' encoding = 'UTF-8' ?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/Attic/ltsp.xml,v 1.3 2004/08/26 18:25:06 bass Exp $ -->
<guide link="/doc/en/ltsp.xml" >
  <title>Gentoo - Guía de LTSP</title>
  <author title="Author" >
    <mail link="lanius@gentoo.org" >Heinrich Wendel</mail>
  </author>
  <author title="Author" >
    <mail link="josiah@ritchietribe.net" >Josiah Ritchie</mail>
  </author>
  <author title="Editor" >
    <mail link="swift@gentoo.org" >Sven Vermeulen</mail>
  </author>
  <author title="Editor" >
    <mail link="bass@gentoo.org" >José Alberto Suárez López</mail>
  </author>
  <author title="Traductor" >
    <mail link="carles@carles.no-ip.info" >Carles Ferrer Peris</mail>
  </author>
  <abstract>
Esta guía muestra cómo poner en marcha un servidor LTSP en Gentoo.
</abstract>
  <license/>
  <version>1.6</version>
  <date>August 20, 2004</date>
  <chapter>
    <title>Introducción</title>
    <section>
      <title>¿Qué es LTSP?</title>
      <body>
        <p>
LTSP es la abreviatura de &quot;Linux Terminal Server Project&quot; (&quot;Proyecto de Servidor de Terminales Linux&quot;). Instalado en un servidor proporciona a varias estaciones de trabajo (llamadas por eso 'thin-clients') entornos idénticos. Todas las aplicaciones se ejecutan en el servidor y por lo tanto puede utilizar viejos PCs y convertirlos en terminales X. Esto reduce costes y mantenimiento especialmente en un entorno donde se necesite tener un área de trabajo uniforme en cada ordenador que usted utilice, por ejemplo en una escuela o una empresa.
</p>
      </body>
    </section>
  </chapter>
  <chapter>
    <title>Instalación</title>
    <section>
      <title>Preliminares</title>
      <body>
        <p>
Todos los ejemplos en este documento presuponen que la dirección IP de su servidor es 192.168.0.254, su dominio se llama sudominio.com y su red es 192.168.0.0/24.
</p>
      </body>
    </section>
    <section>
      <title>Instalación</title>
      <body>
        <p>
En primer lugar, usted debe disponer de un sistema Gentoo en funcionamiento. Por favor, lea el Manual de instalación de Gentoo para su arquitectura en <uri link="http://www.gentoo.org/doc/es/" >Recursos de Documentación de Gentoo</uri>.
</p>
        <p>
Después puede comenzar con el paso más sencillo, instalar el núcleo de las utilidades ltsp:
</p>
        <pre caption="Emerge LTSP" >
# <i>emerge ltsp-core</i>
        </pre>
        <p>
Lo que instalará los siguientes paquetes y dependencias:
</p>
        <ul>
          <li>
            <b>XFree</b>: Son llamados Terminales X. adivina por qué :)</li>
          <li>
            <b>DHCP</b>: DHCP es un protocolo para automatizar la configuración de ordenadores que utilicen TCP/IP, usado por ltsp para distribuir las direcciones IP a los puestos de trabajo ('workstations').</li>
          <li>
            <b>NFS</b>: NFS es un protocolo que permite acceder a los discos duros a través de la red, usado por ltsp para montar un sistema base para los puestos de trabajo.</li>
          <li>
            <b>TFTP</b>: TFTP es un protocolo de transferencia de ficheros simple, usado por ltsp para transferir el kernel a los puestos de trabajo.</li>
          <li>
            <b>XINETD</b>: Xinetd es un potente sustituto de inetd, con características avanzadas, usado por ltsp para arrancar tftp.</li>
        </ul>
        <note>
Si usted tiene la variable &quot;USE&quot; &quot;kde&quot; o &quot;gnome&quot;, también se instalará un sistema completo kde o gnome.
</note>
      </body>
    </section>
  </chapter>
  <chapter>
    <title>Configuración</title>
    <section>
      <body>
        <p>
Después de que el proceso de emerge haya acabado se deben configurar todos los servicios:
</p>
      </body>
    </section>
    <section>
      <title>Registro del sistema</title>
      <body>
        <p>
Para analizar los problemas fácilmente, el registro ('logger') del sistema debe ser configurado para que acepte peticiones remotas. Por favor, lea la documentación de su registro del sistema para conseguir esto. Si, por ejemplo, está usando sysklogd, todo lo que necesita es editar <path>/etc/conf.d/sysklogd</path> y añadir &quot;-r&quot; a la línea SYSLOGD:
</p>
        <pre caption="/etc/conf.d/sysklogd" >
SYSLOGD=&quot;-m 0 -r&quot;
KLOGD=&quot;-c 3 -2&quot;
</pre>
      </body>
    </section>
    <section>
      <title>NFS</title>
      <body>
        <p>
El siguiente paso es editar el fichero <path>/etc/exports</path>, para permitir a las estaciones de trabajo montar el sistema de ficheros raíz. Debería haber al menos dos líneas en él:
</p>
        <pre caption="/etc/exports" >
/opt/ltsp/i386             192.168.0.0/255.255.255.0(ro,no_root_squash,async)
/var/opt/ltsp/swapfiles    192.168.0.0/255.255.255.0(rw,no_root_squash,async)
</pre>
        <note>
Tendrá que cambiar la red/máscara de red para que se corresponda con su red/máscara de red.
</note>
        <p>
Ahora inicie NFS.
</p>
        <pre caption="Iniciando nfs" >
# <i>rc-update add nfs default</i>
# <i>/etc/init.d/nfs start</i>
        </pre>
      </body>
    </section>
    <section>
      <title>xinetd/tftp</title>
      <body>
        <p>
TFTP requiere un poco más de configuración para conseguir que funcione correctamente. En primer lugar, edite <path>/etc/conf.d/in.tftpd</path> para indicar las opciones y la ruta de acceso de tftpd correctamente:
</p>
        <pre caption="/etc/conf.d/in.tftpd" >
INTFTPD_PATH=&quot;/tftpboot&quot;
INTFTPD_OPTS=&quot;-s ${INTFTPD_PATH}&quot;
</pre>
        <p>
El parámetro -s especifica que TFTP se ejecute en el modo seguro de chroot (recomendado). Esto significa que usted no necesita incluir la ruta  <path>/tftpboot</path> en la configuración de DHCP, por ejemplo.
</p>
        <p>
Luego, configure xinetd para ejecutar TFTP y permitir las conexiones remotas. Por defecto TFTP no será iniciado por xinetd, por ello debe editar  <path>/etc/xinetd.d/tftp</path> y cambiar <c>disable=yes</c> por <c>disable=no</c>. Si no existe el fichero basta crear <path>/etc/xinetd.d/tftp</path> con el siguiente contenido.
</p>
        <pre caption="/etc/xinetd.d/tftp" >
service tftp
{
        disable = no
        socket_type = dgram
        protocol = udp
        wait = yes
        user = root
        server = /usr/sbin/in.tftpd
}
</pre>
        <p>
Ahora edite <path>/etc/xinetd.conf</path> y &quot;comente&quot; la línea <c>only_from = localhost</c> añadiendo al principio de la misma una <c>#</c>. Finalmente, inicie xinetd.
</p>
        <pre caption="Iniciando xinetd" >
# <i>rc-update add xinetd default</i>
# <i>/etc/init.d/xinetd start</i>
        </pre>
      </body>
    </section>
    <section>
      <title>Resolución de nombres</title>
      <body>
        <p>
Para que las estaciones de trabajo encuentren todos los recursos, debe estar disponible una correcta resolución de nombres. Hay varias maneras de conseguirlo. Una es configurar un servidor DNS para la red local, otra (y más simple) es tener casi idénticos ficheros <path>/etc/hosts</path> en todos los sistemas. Vamos a usar esta última.
</p>
        <p>
Todos los puestos de trabajo deben estar listados en <path>/etc/hosts</path>. Eche un vistazo al ejemplo:
</p>
        <pre caption="/etc/hosts" >
127.0.0.1        localhost
192.168.0.254    server      server.sudominio.com
192.168.0.1      ws001       ws001.sudominio.com
</pre>
      </body>
    </section>
    <section>
      <title>Configuración de DHCP</title>
      <body>
        <p>
Este es el paso más complicado en mi opinión. Usted tiene que crear una configuración DHCP válida (<path>/etc/dhcp/dhcpd.conf</path>). Aquí tiene un ejemplo:
</p>
        <pre caption="dhcpd.conf" >
          <codenote>Opciones generales</codenote>
default-lease-time            21600;
max-lease-time                21600;
use-host-decl-names           on;
ddns-update-style             ad-hoc;

<codenote>Opciones de bootp</codenote>
allow booting;
allow bootp;

<codenote>Opciones de red</codenote>
option subnet-mask            255.255.255.0;
option broadcast-address      192.168.0.255;
option routers                192.168.0.254;
option domain-name-servers    192.168.0.254;
option log-servers            192.168.0.254;
option domain-name            &quot;sudominio.com&quot;;

<codenote>Opciones de rutas de LTSP</codenote>
option root-path              &quot;192.168.0.254:/opt/ltsp/i386&quot;;
filename                      &quot;/lts/vmlinuz-2.4.24-ltsp-1&quot;;

<codenote>Si usted tiene estaciones de trabajo con tarjetas de red ISA &quot;descomente&quot;</codenote>
          <codenote>las líneas siguientes y cambie el driver y el IO</codenote>
#option option-128 code 128 = string;
#option option-129 code 129 = text;
#option option-128 e4:45:74:68:00:00;
#option option-129 &quot;NIC=ne IO=0x300&quot;;

shared-network WORKSTATIONS {
  subnet 192.168.0.0 netmask 255.255.255.0 {
    <codenote>Distribuye IPs dinámicas a los clientes</codenote>
    range dynamic-bootp 192.168.0.1 192.168.0.16;
    <codenote>Estación con una configuración específica para arranque PXE</codenote>
    #host ws001 {
    #  hardware ethernet     00:E0:06:E8:00:84;
    #  fixed-address         192.168.0.1;
    #}
  }
}
</pre>
        <p>
Si sus puestos de trabajo soportan PXE, deberá incluir cada una de ellos tal como hemos hecho con <e>host ws001</e> (no se olvide 'descomentar' la línea). No les dé una dirección que esté en el rango de direcciones dinámicas, en caso contrario sería posible que una estación de trabajo tuviera la misma IP que otra (lo cual es molesto). Si usted copia y pega el ejemplo anterior, recuerde reemplazar cualquier comentario &quot;//&quot; con &quot;##&quot;, ya que si no dhcp fallará al arrancar.
</p>
        <p>
Para más información al respecto lea el 'handbook' oficial: <uri>http://www.dhcp-handbook.com/</uri>
        </p>
        <p>
Ahora inicie DHCP tal como hizo con NFS y xinetd:
</p>
        <pre caption="Inicio de dhcp" >
# <i>rc-update add dhcp default</i>
# <i>/etc/init.d/dhcp start</i>
        </pre>
        <note>
DHCPD necesita para funcionar tener activado en el kernel CONFIG_PACKET y CONFIG_FILTER.
</note>
      </body>
    </section>
    <section>
      <title>Configuración de LTSP</title>
      <body>
        <p>
Hay varias opciones para configurar los puestos de trabajo, vea <uri>http://www.ltsp.org/documentation/ltsp-3.0-4-en.html#AEN903</uri> para una completa descripción de <path>/opt/ltsp/i386/etc/lts.conf</path>.
</p>
        <p>
Como sugerencias para empezar, primero podría empezar copiando <path>/opt/ltsp/i386/etc/lts.conf.example</path> como <path>/opt/ltsp/i386/etc/lts.conf</path> y editar éste último. Podría intentar cambiar la opción <c>SCREEN_01</c> con <c>SCREEN_01 = startx</c>. Para usar un ratón USB en el cliente remoto, añada las siguientes líneas MODULE, y cambie las líneas X_MOUSE_* así:
</p>
        <pre caption="/opt/ltsp/i386/etc/lts.conf" >
MODULE_01          = usb-uhci
MODULE_02          = mousedev
MODULE_03          = usbmouse
X_MOUSE_PROTOCOL   = &quot;IMPS/2&quot;
X_MOUSE_DEVICE     = &quot;/dev/input/mice&quot;
</pre>
      </body>
    </section>
    <section>
      <title>Displaymanager</title>
      <body>
        <p>
Ahora tiene que cambiar la configuración del gestor de ventanas también para aceptar conexiones remotas.
</p>
        <p>
Primero cambie el fichero <path>/etc/X11/xdm/Xaccess</path>, 'descomentando' la línea siguiente:
</p>
        <pre caption="/etc/X11/xdm/Xaccess" >
#*                   #cualquier host puede obtener una ventana de login
</pre>
        <p>
Ahora cambie la configuración del gestor de ventanas que use:
</p>
        <p>
          <b>XDM</b>: En <path>/etc/X11/xdm/xdm-config</path> 'comente' <c>DisplayManager.requestPort: 0</c>
        </p>
        <p>
          <b>KDM</b>: En <path>/usr/kde/3.1/share/config/kdm/kdmrc</path> busque la sección <c>[Xdmcp]</c> y cambie <c>Enable = false</c> a <c>Enable = true</c>.
</p>
        <p>
          <b>GDM</b>: En <path>/etc/X11/gdm/gdm.conf</path> busque la sección <c>[xdmcp]</c> y cambie <c>Enable = false</c> a <c>Enable = True</c>.
</p>
        <p>
Entonces arranque el gestor de ventanas:
</p>
        <pre caption="Inicio de xdm" >
# <i>rc-update add xdm default</i>
# <i>/etc/init.d/xdm start</i>
        </pre>
        <warn>
Parece que actualmente hay problemas con XDM y GDM. El autor usa KDM para resolver esas cuestiones.
</warn>
        <p>
Recuerde, si su gestor de ventanas está ya en marcha, reiniciar el servidor X con CTRL-ALT-BACKSPACE no reinicia el gestor de ventanas.
</p>
      </body>
    </section>
    <section>
      <title>Crear un disquete de arranque</title>
      <body>
        <p>
Si sus estaciones de trabajo no soportan el arranque PXE, puede crear un disquete de arranque para arrancarlas y conectarlas al servidor de terminales. Vaya a <uri>http://www.rom-o-matic.net</uri>, seleccione la última versión, elija su tarjeta de red, pulse <e>Get ROM</e> y grabe la imagen en un disquete:
</p>
        <pre caption="Escribiendo la imagen en el floppy disk" >
# <i>cat nicfile.zdsk > /dev/fd0</i>
        </pre>
      </body>
    </section>
  </chapter>
  <chapter>
    <title>Resolución de problemas</title>
    <section>
      <body>
        <p>
Hay muchas cosas que puedan ser el origen del problema, pero también hay varios recursos al respecto que pueden ayudarle a resolver sus problemas:
</p>
        <ul>
          <li>La documentación oficial:
<uri>http://www.ltsp.org/documentation/</uri>, en especial la sección de resolución de problemas.</li>
          <li>El canal IRC de gentoo: irc.freenode.org #gentoo</li>
          <li>El canal IRC de ltsp: irc.freenode.org #ltsp</li>
          <li>Las listas de correo de ltsp <uri>http://ltsp.org/mailinglists.php</uri> están llenas de buen saber.</li>
        </ul>
      </body>
    </section>
  </chapter>
  <chapter>
    <title>FAQ</title>
    <section>
      <body>
        <p>
          <b>P:</b> Mis puestos de trabajo tienen CPUs Pentium II, pero mi servidor está compilado con <c>march=athlon-xp</c>, ¿funcionará?
</p>
        <p>
          <b>R:</b> Eso no es ningún un problema, por que todas las aplicaciones se ejecutan en el servidor.
</p>
        <p>
          <b>P:</b> ¿Qué CPU y cuánta RAM debe tener el servidor?
</p>
        <p>
          <b>R:</b> Este es un buen documento con sugerencias al respecto: <uri>http://ltsp.org/documentation/server_suggestions.html</uri>.
</p>
        <p>
          <b>P:</b> ¿Tiene más información al respecto de PXE?
</p>
        <p>
          <b>R:</b> Sí, mire <uri>http://ltsp.org/documentation/eproms.txt</uri> y <uri>http://ltsp.org/documentation/pxe.howto.html</uri>.
</p>
        <p>
          <b>P:</b> ¿Es posible usar aceleración 3D por software en las estaciones de trabajo?
</p>
        <p>
          <b>R:</b> Si utiliza tarjetas NVidia eche un vistazo a <uri>http://ltsp.org/documentation/nvidia.txt</uri>.
</p>
        <p>
          <b>P:</b> En algunas aplicaciones las fuentes se ven con mala calidad, ¿qué puedo hacer?
</p>
        <p>
          <b>R:</b> Tiene que configurar el XFontServer, añada <c>USE_XFS=Y</c> a su <path>lts.conf</path>, edite <path>/etc/X11/fs/config</path> y 'comente' <c>no-listen: tcp</c>, reemplace <c>XFS_PORT=&quot;-1&quot;</c> con <c>XFS_PORT=&quot;7100&quot;</c> en <path>/etc/conf.d/xfs</path> y arranque xfs: 
<c>/etc/init.d/xfs start</c>. También compruebe que <path>/etc/X11/XF86Config</path> (o <path>/etc/X11/xorg.conf</path>) contenga <c>FontPath &quot;unix/:7100&quot;</c> en la sección Files.

</p>
        <p>
          <b>P: </b> ¿Cómo puedo usar la tarjeta de sonido en una estación de trabajo?
</p>
        <p>
          <b>R: </b> Hay un paquete ltsp-sound en gentoo, para más información lea el fichero que se incluye <path>README</path>.
</p>
      </body>
    </section>
  </chapter>
  <chapter>
    <title>Glosario</title>
    <section>
      <body>
        <p>
          <b>
            <uri link="http://www.ltsp.org" >LTSP</uri>
          </b>
&quot;LTSP proporciona una manera sencilla de utilizar puestos de trabajo de bajo coste basados en terminales tanto gráficos como de texto con un servidor GNU/Linux.&quot;
</p>
        <p>
          <b>
            <uri link="http://www.webopedia.com/TERM/P/PXE.html" >PXE</uri>
          </b>
&quot;Abreviatura de Pre-Boot Execution Environment (Entorno de ejecución previo al arranque). Pronunciado como &quot;pixie&quot;, PXE es uno de los componentes de la especificación WfM de Intel. Permite a una estación de trabajo arrancar desde un servidor en una red antes de arrancar el sistema operativo del disco duro local. Una estación de trabajo con PXE habilitado conecta su tarjeta de red a la LAN con un 'jumper', el cual la mantiene conectada a la red incluso si está apagada.&quot;
</p>
      </body>
    </section>
  </chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?> 

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/printing-howto.xml,v 1.9 2006/03/31 23:06:53 chiguire Exp $ -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/es/printing-howto.xml"> 

<title>Guía de Impresión Gentoo</title> 

<author title="Autor">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Editor">
  <mail link="nightmorph@gentoo.org">Joshua Saddler</mail>
</author>
<author title="Traductor">
  <mail link="chiguire@gentoo.org">John Christian Stoddart</mail>
</author>
<author title="Traductor">
  <mail link="yoswink@gentoo.org">José Luis Rivero</mail>
</author>
<author title="Traductor">
  <mail link="LinuxBlues@gentoo-es.org">Fernando M. Bueno</mail>
</author>

<abstract>
Este documento cubre la instalación y mantenimiento de impresoras usando CUPS y
Samba. Cubre la instalación local y la instalación en red y también muestra
instrucciones acerca de cómo usar impresoras compartidas desde otros sistemas
operativos.
</abstract> 

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>2.9</version>
<date>2006-03-20</date>

<chapter>
<title>Impresión y Gentoo Linux</title>
<section>
<title>Usar las Herramientas Adecuadas</title>
<body>

<p>
Linux tiene un excelente soporte de impresoras; la herramienta adecuada para
ello se llama CUPS (<uri link="http://www.cups.org">Sistema Común de Impresión Unix</uri>).
Desde el comienzo del proyecto, en 1999, la instalación y mantenimiento de CUPS
ha mejorado drásticamente.
</p>

<p>
En este documento cubriremos cómo usar CUPS para configurar una impresora local
o en red. No lo haremos con gran detalle dado que el proyecto dispone de una
<uri link="http://www.cups.org/documentation.php">excelente documentación</uri>
disponible para un uso más avanzado.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Configurar el Núcleo</title>
<section>
<title>Introducción</title>
<body>

<p>
Cuando se quiera instalar una impresora en el sistema, debe saberse el tipo de
conexión que dicha impresora usará. Puede ser a través de un puerto local como
el paralelo (LPT) o bien a través del Bus Serie Universal (USB) o ¿está en red?
Si lo está, ¿usa el protocolo de impresión internet (IPP) o bien lo hace a
través del protocolo de Microsoft Windows SMB-CIFS (Compartir de Microsoft
Windows)?
</p>

<p>
Las siguientes secciones explican la configuración mínima del núcleo requerida.
Por supuesto, ello depende de la conexión que vaya a tener la impresora al
sistema, así pues, hemos separado las instrucciones en virtud a la misma:
</p>

<ul>
  <li><uri link="#lpt">Impresora Conectada Localmente (LPT)</uri></li>
  <li><uri link="#usb">Impresora Conectada Localmente (USB)</uri></li>
  <li><uri link="#ipp">Impresora Conectada Remotamente (IPP)</uri></li>
  <li><uri link="#smb-cifs">Impresora Conectada Remotamente (SMB-CIFS)</uri></li>
</ul>

<p>
Así pues, pasamos a <path>/usr/src/linux</path> y ejecutamos <c>make
menuconfig</c> para configurar el núcleo. Si se usó <c>genkernel</c> para
configurarlo, deben seguirse estas indicaciones también para comprobar que no
falta ningún requisito.
</p>

<p>
En los siguientes ejemplos de configuración, añadiremos el soporte necesario
<e>integrado</e> en el núcleo, no como módulos. Ésto no es obligatorio; si se
desea puede añadirse soporte modular. En cuyo caso, no hay que olvidar cargar
los módulos necesarios después. También emplearemos una configuración del núcleo
2.6 como ejemplo; los usuarios del núcleo 2.4 deben encontrar las directivas
para configurar el núcleo en otra parte.
</p>

<p>
Ahora, nos dirigimos a la sección adecuada para configurar (o comprobar) el
núcleo.
</p>

</body>
</section>
<section id="lpt">
<title>Impresora Conectada Localmente (LPT)</title>
<body>

<p>
El puerto LPT se usa normalmente para identificar el puerto paralelo de la
impresora. Es necesario habilitar previamente el soporte para el puerto
paralelo, exactamente "PC-style parallel port support" (excepto si se es un
usuario de SPARC), después de lo cual habilitaremos el soporte para una
impresora a través del puerto paralelo (parallel printer support).
</p>

<pre caption="Configuración de una impresora por el puerto paralelo">
Device Drivers --&gt;
  &lt;*&gt; Parallel port support
  &lt;*&gt;   PC-style hardware

Device Drivers --&gt;
  Character Devices --&gt;
    &lt;*&gt; Parallel printer support
</pre>

<p>
Algunos usuarios necesitarán habilitar otras opciones en la sección <c>Parallel
port support</c>. Hay que ver la opción de ayuda <c>(Help)</c> en la
configuración del núcleo para más información.
</p>

<p>
Eso es todo; salimos de la configuración del núcleo y lo compilamos. No hay que
olvidar copiar la imagen del núcleo a <path>/boot</path> (ni montar la
partición <path>/boot</path> en caso de ser necesario) y, por supuesto,
actualizar la configuración del gestor de inicio (grub o lilo) antes de
reiniciar el sistema.
</p>

<p>
Ahora continuamos con <uri link="#cups">Instalar y Configurar CUPS</uri>.
</p>

</body>
</section>
<section id="usb">
<title>Impresora Conectada Localmente (USB)</title>
<body>

<p>
Para habilitar la impresión USB, necesitamos soporte USB y soporte para
impresora USB.
</p>

<pre caption="Configuración de la impresora por puerto USB">
Device Drivers --&gt;
  USB Support --&gt;
    &lt;*&gt; Support for Host-side USB
    <comment>(...)</comment>
    --- USB Host Controller Drivers
    <comment>(Hay que seleccionar el HCD que use el sistema. Si no se sabe cuál
     hay que seleccionar, puede ejecutarse "lspci -v | grep HCI" desde otra
     terminal)</comment>
    &lt;*&gt; EHCI HCD (USB 2.0) support <comment>( ó )</comment>
    &lt;*&gt; OHCI HCD support           <comment>( ó )</comment>
    &lt;*&gt; UHCI HCD (most Intel and VIA) support
    <comment>(...)</comment>
    &lt;*&gt; USB Printer support
</pre>

<p>
Eso es todo; salimos de la configuración del núcleo y lo compilamos. No hay que
olvidar copiar la imagen del núcleo a <path>/boot</path> (ni montar la
partición <path>/boot</path> en caso de ser necesario) y, por supuesto,
actualizar la configuración del gestor de inicio (grub o lilo) antes de
reiniciar el sistema.
</p>

<p>
Ahora continuamos con <uri link="#cups">Instalar y Configurar CUPS</uri>.
</p>

</body>
</section>
<section id="ipp">
<title>Impresora Conectada Remotamente (IPP)</title>
<body>

<p>
Para poder conectar a una impresora remotamente a través del protocolo de
impresión Internet (Internet Printing Protocol) el núcleo tan sólo necesita
soporte de red. Asumiendo que el núcleo ya lo tendrá, continuamos con
<uri link="#cups">Instalar y Configurar CUPS</uri>.
</p>

</body>
</section>
<section id="smb-cifs">
<title>Impresora Conectada Remotamente (SMB-CIFS)</title>
<body>

<p>
El núcleo deberá soportar SMB CIFS:
</p>

<pre caption="Configuración de impresora SMB-CIFS">
File systems --&gt;
  Network File Systems --&gt;
    &lt;*&gt; SMB file system support (to mount Windows shares etc.)
    &lt;*&gt; CIFS support (advanced network file system for Samba, Windows and other CIFS compliant servers)
</pre>

<p>
Eso es todo; salimos de la configuración del núcleo y lo compilamos. No hay que
olvidar copiar la imagen del núcleo a <path>/boot</path> (ni montar la
partición <path>/boot</path> en caso de ser necesario) y, por supuesto,
actualizar la configuración del gestor de inicio (grub o lilo) antes de
reiniciar el sistema.
</p>

<p>
Ahora continuamos con <uri link="#cups">Instalar y Configurar CUPS</uri>.
</p>

</body>
</section>
</chapter>
<chapter id="cups">
<title>Instalar y Configurar CUPS</title>
<section>
<title>Instalación</title>
<body>

<p>
Instalar CUPS con Gentoo es muy sencillo. CUPS dispone de algunas
características opcionales que pueden interesarnos. Para habilitar o
inhabilitar estas características, usaremos los parámetros USE asociados
a las mismas.
</p>

<table>
<tr>
  <th>Parámetro USE</th>
  <th>Efecto en CUPS</th>
</tr>
<tr>
  <ti>nls</ti>
  <ti>
    Habilita el soporte para el lenguaje nacional. Con nls, CUPS será capaz de
    proporcionarnos mensajes en nuestro idioma, con lo cual podremos disfrutar
    de CUPS en nuestra lengua materna.
  </ti>
</tr>
<tr>
  <ti>pam</ti>
  <ti>
    Si se necesita autenticación de los trabajos de impresión a través de los
    módulos de autenticación de conexión (Pluggable Authentication Modules),
    con este parámetro se activará el soporte PAM para CUPS.
  </ti>
</tr>
<tr>
  <ti>samba</ti>
  <ti>
    Si se quieren compartir impresoras conectadas localmente con sistemas
    Windows en nuestra red usando el protocolo SMB-CIFS, o si se quieren
    usar impresoras compartidas desde sistemas Windows, será necesario
    añadir soporte SAMBA.
  </ti>
</tr>
<tr>
  <ti>slp</ti>
  <ti>
    En un entorno en el que la impresora puede hacerse disponible como un
    servicio. Con el Protocolo de Localización de Servicios se pueden localizar
    y configurar servicios en nuestro sistema de forma muy sencilla. Hay que
    habilitar este parámetro USE si la impresora está disponible como servicio
    o si se pretende hacerla disponible como tal.
  </ti>
</tr>
<tr>
  <ti>ssl</ti>
  <ti>
    Si se desea autenticación remota y/o privacidad, se necesita soporte para
    la capa de conexión segura (Secure Socket Layer), que permitirá el
    cifrado de sesiones de impresión. El soporte para la capa de conexión
    segura deberá estar habilitado en todos los sistemas que participen en la
    red.
  </ti>
</tr>
</table>

<p>
Comprobemos los parámetros USE actuales. Si queremos modificar alguno de ellos
tan sólo para CUPS, añadiremos los adecuados en
<path>/etc/portage/package.use</path>.
</p>

<pre caption="Configuración de parámetros USE para CUPS">
# <i>emerge -pv cups</i>
[ebuild N     ] net-print/cups-1.1.23-r1  +nls +pam -samba -slp +ssl 0 kB

<comment>(Para añadir soporte SAMBA a CUPS, por ejemplo)</comment>
# <i>vim /etc/portage/package.use</i>
net-print/cups samba
</pre>

<p>
Si estamos satisfechos con el resultado, dejamos que Portage instale CUPS.
</p>

<pre caption="Instalación de CUPS">
# <i>emerge cups</i>
</pre>

<p>
El proceso de compilación puede informarnos acerca de la necesidad de ejecutar
<c>rc-update add coldplug default</c>. Si vamos a emplear una impresora USB y
se ha añadido todo el soporte necesario como módulos, esto permitirá cargar
automáticamente todos los módulos USB del núcleo necesarios al inicio.
</p>

<p>
Si la impresora está conectada localmente en el sistema, es necesario cargar
CUPS automáticamente al iniciarlo. Debemos asegurarnos de que la impresora está
conectada y funcionando antes de iniciar CUPS.
</p>

<pre caption="Iniciando CUPS automáticamente">
# <i>/etc/init.d/cupsd start</i>
# <i>rc-update add cupsd default</i>
</pre>

</body>
</section>
<section>
<title>Configuración</title>
<body>

<p>
La configuración por defecto de CUPS en <path>/etc/cups/cupsd.conf</path>
será suficiente para la mayoría de usuarios. De cualquier forma, algunos
de ellos necesitarán realizar algunos cambios en la configuración de CUPS.
</p>

<p>
En las siguientes secciones, cubriremos algunos de los cambios que son
necesarios a menudo:
</p>

<ul>
  <li>
    En <uri link="#remote_usage">Acceso a una impresora remota</uri>
    permitiremos a otros sistemas utilizar la impresora conectada a esta
    estación de trabajo Linux.
  </li>
  <li>
    En <uri link="#remote_admin">Administración remota de CUPS</uri>
    otorgaremos acceso a la administración de CUPS desde sistemas remotos.
  </li>
  <li>
    En <uri link="#windows_pcl">Habilitar soporte para los controladores PCL
    Windows</uri> configuraremos CUPS para soportar los controladores PCL de
    Windows. Esto es necesario si se desea que sistemas Windows sean capaces
    de usar una impresora compartida a través de Samba, dado que la mayoría de
    controladores Windows son controladores PCL.
  </li>
  <li>
    En <uri link="#setup_remote">Configurar una impresora remota</uri>
    configuraremos nuestro sistema para usar una impresora conectada a otro
    sistema (no Windows).
  </li>
</ul>

</body>
</section>
<section id="remote_usage">
<title>Acceso a una impresora remota</title>
<body>

<p>
Si queremos que otros sistemas empleen nuestra impresora a través de IPP
(protocolo de impresión internet) es necesario conceder permiso
para acceder a la impresora explícitamente en <path>/etc/cups/cupsd.conf</path>.
Si se quiere compartir la impresora usando SAMBA, este cambio no es necesario.
</p>

<p>
Abrimos <path>/etc/cups/cupsd.conf</path> con nuestro editor y añadimos una
línea <c>Allow</c> para el o los sistemas que deben poder llegar a nuestra
impresora. En el siguiente ejemplo, concedemos acceso a la impresora a todo
sistema cuya dirección IP empiece por <c>192.168.0</c>.
</p>

<pre caption="Permitir acceso remoto a la impresora">
&lt;Location /&gt;
Order Deny,Allow
Deny From All
Allow From 127.0.0.1
<i>Allow From 192.168.0.*</i>
&lt;/Location&gt;
</pre>

</body>
</section>
<section id="remote_admin">
<title>Administración remota de CUPS</title>
<body>

<p>
Si estamos interesados en la administración remota, necesitaremos proporcionar
acceso a otros sistemas, no sólo al sistema local, para la administración de
CUPS. Editamos <path>/etc/cups/cupsd.conf</path> y permitimos el acceso a los
sistemas deseados. Por ejemplo, para permitir el acceso al sistema con la
dirección IP 192.168.0.3:
</p>

<pre caption="Permitir el acceso remoto en /etc/cups/cupsd.conf">
&lt;Location /admin&gt;
<comment>(...)</comment>
Order Deny,Allow
Deny From All
Allow From 127.0.0.1
<i>Allow From 192.168.0.3</i>
&lt;/Location&gt;
</pre>

<p>
No debemos olvidar reiniciar CUPS después de hacer modificaciones al archivo
<path>/etc/cups/cupsd.conf</path> ejecutando <c>/etc/init.d/cupsd restart</c>.
</p>

</body>
</section>
<section id="windows_pcl">
<title>Habilitar soporte para los controladores PCL Windows</title>
<body>

<p>
Los controladores PCL envían datos en crudo al servidor de impresión. Para
habilitar el soporte de dichos datos en CUPS, necesitaremos editar
<path>/etc/cups/mime.types</path> y descomentar la línea
<c>application/octet-stream</c>. Después editaremos también
<path>/etc/cups/mime.convs</path> y quitaremos el comentario a
<c>application/octet-stream</c>.
</p>

<pre caption="Habilitar la impresión de datos en modo directo">
# <i>vim /etc/cups/mime.types</i>
<comment>(Quitamos el comentario a la línea para que muestre:)</comment>
application/octet-stream

# <i>vim /etc/cups/mime.convs</i>
<comment>(Quitamos el comentario a la línea para que muestre:)</comment>
application/octet-stream     application/vnd.cups-raw    0    -
</pre>

<p>
No debemos olvidar reiniciar CUPS después de hacer cambios a
<path>/etc/cups/cupsd.conf</path> ejecutando <c>/etc/init.d/cupsd restart</c>.
</p>

</body>
</section>
<section id="setup_remote">
<title>Configurar una impresora remota</title>
<body>

<p>
Si las impresoras están conectadas a un servidor de impresión CUPS remoto, se
puede configurar de forma muy sencilla nuestro sistema para que use la
impresora remota, modificando el archivo <path>/etc/cups/client.conf</path>.
</p>

<p>
Asumiendo que la impresora está conectada a un sistema llamado
<c>printserver.mydomain</c>, abrimos con un editor
<path>/etc/cups/client.conf</path> y añadimos la directiva <c>ServerName</c>:
</p>

<pre caption="Modificación de client.conf">
# <i>vim /etc/cups/client.conf</i>

<comment>
(Hay que sustituir printserver.mydomain con el nombre adecuado del servidor de
impresión)
</comment>
ServerName <i>printserver.mydomain</i>
</pre>

<p>
El sistema remoto tendrá una configuración por defecto de la impresora que
emplearemos. Si deseamos cambiar la impresora por defecto, usaremos
<c>lpoptions</c>:
</p>

<pre caption="Cambiar la impresora por defecto">
<comment>(Primero veamos una lista de las impresoras disponibles)</comment>
# <i>lpstat -a</i>
hpljet5p accepting requests since Jan 01 00:00
hpdjet510 accepting requests since Jan 01 00:00

<comment>
(Configuramos la impresora HP LaserJet 5P como impresora por defecto:)
</comment>
# <i>lpoptions -d hpljet5p</i>
</pre>

</body>
</section>
</chapter>

<chapter id="configure_printer">
<title>Configurar la impresora</title>
<section>
<title>Introducción</title>
<body>

<p>
Si la impresora que queremos configurar está disponible remotamente a través de
un servidor de impresión (ejecutando CUPS) no necesitaremos seguir estas
instrucciones. En su lugar, seguiremos estas otras <uri link="#setup_remote">
Configurar una impresora remota</uri>.
</p>

</body>
</section>
<section>
<title>Detectar la Impresora</title>
<body>

<p>
Si se tiene una impresora USB o la impresora conectada al puerto paralelo
estaban funcionando cuando se inició el sistema Linux, podremos encontrar
información del núcleo diciéndonos que detectó la impresora satisfactoriamente.
De cualquier forma esto es sólo una indicación y no un requisito.
</p>

<pre caption="Obteniendo información del núcleo">
<comment>(Para una impresora por el puerto paralelo)</comment>
$ <i>dmesg | grep -i print</i>
parport0: Printer, Hewlett-Packard HP LaserJet 2100 Series

<comment>(Para una impresora por el puerto USB)</comment>
$ <i>lsusb</i>
<comment>(...)</comment>
Bus 001 Device 007: ID 03f0:1004 Hewlett-Packard DeskJet 970c/970cse
</pre>

</body>
</section>
<section>
<title>Instalar la impresora</title>
<body>

<p>
Para tener la impresora instalada en el sistema, lanzamos nuestro navegador e
introducimos la dirección <uri link="http://localhost:631">http://localhost:631
</uri>. Con lo cual aparecerá la interfaz web de CUPS, desde la que podremos
realizar todas las tareas de administración.
</p>

<p>
Vamos a <e>Tareas de administración</e> y entramos con el usuario root y la
contraseña pertinente. Cuando llegamos a la interfaz administrativa, hacemos
click en <e>Añadir impresora</e> y nos encontraremos con una pantalla que nos
permitirá introducir la siguiente información:
</p>

<ul>
  <li>
    El <e>Nombre</e> de la cola de impresión, un breve pero descriptivo nombre
    usado en el sistema para identificar la impresora. Este nombre no debe
    contener ni espacios ni caracteres especiales. Por ejemplo, para la
    impresora HP LaserJet 5P podemos indicar <c>hpljet5p</c>.
  </li>
  <li>
    La <e>Ubicación</e>, una descripción de dónde se encuentra localizada la
    impresora físicamente (por ejemplo, en mi habitación, o en la cocina encima
    del lavavajillas, ...). Esto es para ayudarnos a mantener varias impresoras.
  </li>
  <li>
    La <e>Descripción</e> donde debemos añadir una completa descripción de la
    impresora. El uso más frecuente es añadir el nombre completo de la impresora
    (como "HP LaserJet 5P").
  </li>
</ul>

<p>
La siguiente pantalla nos pregunta acerca de la Conexión. Podremos elegir entre
varios tipos. La siguiente tabla muestra algunos de ellos, pero no es
exhaustiva.
</p>

<table>
<tr>
  <th>Dispositivo</th>
  <th>Descripción</th>
</tr>
<tr>
  <ti>AppSocket/HP JetDirect</ti>
  <ti>
    Este dispositivo especial permite acceder a impresoras remotas a través de
    una conexión HP JetDirect. Sólo algunas impresoras específicas lo soportan.
  </ti>
</tr>
<tr>
  <ti>Internet Printing Protocol (IPP o HTTP)</ti>
  <ti>
    Usaremos este para acceder a una impresora remota a través del protocolo de
    impresión internet, bien directamente (IPP) o bien a través de HTTP.
  </ti>
</tr>
<tr>
  <ti>LPD/LPR Host or Printer</ti>
  <ti>
    Seleccionaremos este si la impresora es remota y está conectada a un
    servidor LPD/LPR.
  </ti>
</tr>
<tr>
  <ti>Parallel Port #1</ti>
  <ti>
    Seleccionaremos este cuando la impresora se encuentre conectada localmente
    al puerto paralelo (LPT). Cuando la impresora se detecta automáticamente se
    añadirá su nombre al dispositivo también.
  </ti>
</tr>
<tr>
  <ti>USB Printer #1</ti>
  <ti>
    Elegiremos este cuando la impresora esté conectada localmente a un puerto
    USB. El nombre de la impresora se anexará al nombre del dispositivo
    automáticamente.
  </ti>
</tr>
</table>

<p>
Si se está instalando una impresora remota, se nos preguntará acerca de la URI
de la impresora:
</p>

<ul>
  <li>
    Un servidor de impresión LPD requiere la sintaxis
    <c>lpd://hostname/queue</c>
  </li>
  <li>
    Una impresora HP JetDirect requiere la sintaxis
    <c>socket://hostname</c>
  </li>
  <li>
    Una impresora IPP requiere la sintaxis
    <c>ipp://hostname/printers/printername</c> o bien
    <c>http://hostname:631/ipp/queue</c>.
    <!-- If for some reason a user wants to use HP's internal ipp syntax,
    they'd use ipp://hostname/ipp/<name> , which used to be mentioned here.
    However, this document describes using CUPS' ipp syntax, so that one was
    dropped in favor of the correct working syntax, which is the first
    example. -->
  </li>
</ul>

<p>
A continuación seleccionamos el fabricante de la impresora y en la subsiguiente
pantalla, el modelo y el número. Para muchas impresoras pueden encontrarse
múltiples controladores. Puede seleccionarse uno en este momento o bien buscar
en la <uri link="http://www.linuxprinting.org/printer_list.cgi">
Lista de impresoras LinuxPrinting.org</uri> uno más adecuado. Pueden cambiarse
los controladores fácilmente posteriormente.
</p>

<p>
Una vez hayamos seleccionado el controlador, CUPS nos informará de que la
impresora ha sido añadida satisfactoriamente al sistema. Ahora podemos
seleccionar la opción <c>Administrar impresoras</c> en la interfaz de
administración y seleccionar <c>Configurar impresora</c> para modificar los
parámetros de la misma (resolución, formato de página, ...).
</p>

</body>
</section>
<section>
<title>Comprobar y Reconfigurar la Impresora</title>
<body>

<p>
Para verificar que la impresora está funcionando correctamente vamos a
<c>Administrar impresoras</c>, seleccionamos la impresora y pulsamos en
<c>Imprimir página de prueba</c>.
</p>

<p>
Si la impresora no parece funcionar correctamente, pulsaremos en <c>Modificar
impresora</c> para reconfigurarla. Se nos mostrarán los mismos mensajes que
aparecieron durante la primera instalación, pero la configuración por defecto
será nuestra configuración ahora.
</p>

<p>
Si no se tiene idea de porqué la impresora no está funcionando, podemos obtener
alguna pista comprobando el fichero <path>/var/log/cups/error_log</path>. En el
siguiente ejemplo encontramos que hay un problema de permisos, probablemente
debido a un parámetro <c>Allow</c> inadecuado en <path>/etc/cups/cupsd.conf
</path>.
</p>

<pre caption="Buscando errores CUPS">
# <i>tail /var/log/cups/error_log</i>
<comment>(...)</comment>
E [11/Jun/2005:10:23:28 +0200] [Job 102] Unable to get printer status (client-error-forbidden)!
</pre>

</body>
</section>
<section>
<title>Instalar el Mejor Controlador</title>
<body>

<p>
Existen muchos controladores de impresoras; para encontrar cuál de ellos ofrece
el mayor rendimiento para nuestra impresora, visitamos la <uri
link="http://www.linuxprinting.org/printer_list.cgi">Lista de impresoras
LinuxPrinting</uri>. Seleccionamos la marca y el tipo para ver el controlador
que nos recomiendan. Por ejemplo, para la HP LaserJet 5P, en esta página nos
recomiendan el controlador <c>ljet4</c>.
</p>

<p>
Descargue el archivo PPD y colóquelo en <path>/usr/share/cups/model</path>,
luego ejecute <c>/etc/init.d/cupsd restart</c> como el superusuario (root).
Esto proporcionará el controlador a través de la interfaz web de CUPS.
Ahora reconfigure su impresora como se ha descrito anteriormente.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Uso de Controladores Especiales para la Impresora</title>
<section>
<title>Introducción</title>
<body>

<p>
Algunas impresoras requieren controladores específicos para proporcionar
características adicionales que no se proporcionan siguiendo el método de
configuración descrito anteriormente. En este capítulo explicamos cómo hacer
funcionar algunas de estas impresoras bajo Gentoo Linux.
</p>

<p>
Cubriremos las siguientes impresoras y/o controladores:
</p>

<ul>
  <li><uri link="#gimp-print">Controlador Gimp-Print</uri></li>
  <li><uri link="#hplip">Controlador HPLIP</uri> (HPOJ y HPIJS quedan obsoletos)</li>
  <li><uri link="#pnm2ppa">Controlador PNM2PPA</uri></li>
</ul>

</body>
</section>
<section id="gimp-print">
<title>Controlador Gimp-Print</title>
<body>

<p>
Los controladores <uri link="http://gimp-print.sf.net">gimp-print</uri> son
de gran calidad, de código fuente abierto para varias impresoras Canon, Epson,
HP, Lexmark, Sony, Olympus y PCL que soportan CUPS, ghostscript, El Gimp y
otras aplicaciones.
</p>

<p>
El árbol portage de Gentoo contiene un ebuild para los controladores gimp-print.
Tan sólo hay que usar <c>emerge</c> para instalarlos. Es importante hacer notar
que el ebuild atiende a varios parámetros USE (como <c>cups</c> y <c>ppds</c>).
¡Es necesario habilitar como mínimo esos dos parámetros!
</p>

<pre caption="Instalación de los controladores gimp-print">
# <i>emerge gimp-print</i>
</pre>

<p>
Cuando el proceso emerge concluya, los controladores Gimp-Print estarán
disponibles a través de la interfaz web de CUPS.
</p>

</body>
</section>
<section id="hplip">
<title>Controlador HPLIP</title>
<body>

<p>
El <uri link="http://hpinkjet.sf.net">proyecto HPLIP</uri> incorpora el
controlador hpijs e incluye soporte para escáner y herramientas para varios
periféricos multi-función. Para que soporte la impresión, <e>debemos</e>
habilitar el parámetro USE <c>ppds</c>.
</p>

<pre caption="Instalación de los controladores hplip">
<comment>(Compruebe que esté activado el parámetro USE ppds)</comment>
# <i>emerge -vp hplip</i>
These are the packages that I would merge, in order:

Calculating dependencies ...done!
[ebuild  N    ] net-print/hplip-0.9.5  +X +cups +foomaticdb <comment>+ppds</comment> -qt -scanner -snmp +usb 9,255 kB 

Total size of downloads: 9,255 kB

# <i>emerge hplip</i>
# <i>/etc/init.d/hplip start</i>
# <i>/etc/init.d/cupsd restart</i>
# <i>rc-update add hplip default</i>
</pre>

<p>
Cuando el proceso emerge concluya, los controladores de impresión estarán
disponibles a través de la interfaz web de CUPS.
</p>

</body>
</section>
<section id="pnm2ppa">
<title>Controlador PNM2PPA</title>
<body>

<p>
PPA es una tecnología de HP orientada a enviar todo el procesamiento de bajo
nivel al sistema, en lugar de a la impresora. Con lo cual las impresoras son
menos caras, pero consumen muchos más recursos.
</p>

<p>
Si en el enlace de <uri
link="http://www.linuxprinting.org/printer_list.cgi">LinuxPrinting</uri> nos
informan de que el controlador <uri link="http://pnm2ppa.sourceforge.net/">
pnm2ppa</uri> es nuestra mejor opción, debemos instalar el filtro <c>pnm2ppa</c>
en nuestro sistema:
</p>

<pre caption="Instalación del filtro pnm2ppa">
# <i>emerge pnm2ppa</i>
</pre>

<p>
Una vez instalado, descargue el fichero PPD para su impresora desde el sitio
Web <uri link="http://www.linuxprinting.org/printer_list.cgi">
LinuxPrinting</uri> y ubíquelo en el directorio
<path>/usr/share/cups/model</path>. Luego, configure su impresora usando los
pasos explicados anteriormente.
</p>

</body>
</section>
</chapter>

<chapter id="windows">
<title>Imprimiendo desde y hacia Microsoft Windows</title>
<section>
<title>Configuración de un cliente Windows IPP</title>
<body>

<p>
Microsoft Windows soporta IPP (Aunque los usuarios de Windows 9x y ME
necesitarán <uri
link="http://support.microsoft.com/default.aspx?scid=kb;es-es;294439">instalarlo</uri>
por separado). Para instalar una impresora conectada a nuestro sistema Linux
bajo Windows, lanzamos el asistente <c>Agregar impresora</c> y seleccionamos
<c>impresora de red</c>. Cuando nos pregunte acerca de la dirección URL de la
impresora, usaremos la sintaxis <c>http://hostname:631/printers/queue</c>.
</p>

<p>
Hay que asegurarse de que los sistemas <uri link="#remote_usage">pueden acceder
</uri> a la impresora.
</p>

</body>
</section>
<section>
<title>
Configuración de un Cliente Windows para una impresora compartida con Samba
</title>
<body>

<p>
Para compartir la impresora en la red SMB-CIFS, se debe tener SAMBA instalado y
configurado correctamente. Cómo hacerlo escapa a las pretensiones de este
documento, pero trataremos brevemente la configuración de impresoras compartidas
SAMBA.
</p>

<p>
Abrimos <path>/etc/samba/smb.conf</path> con nuestro editor y añadimos una
sección <c>[printers]</c> al mismo:
</p>

<pre caption="Añadiendo la sección [printers]">
[printers]
  comment      = All printers
  path         = /var/spool/samba
  browseable   = no
  guest ok     = no
  writable     = no
  printable    = yes
  public       = yes
  printer name = hpljet5p
</pre>

<p>
Ahora vamos al principio del archivo <path>smb.conf</path> hasta que nos
encontremos en la sección <c>[global]</c>. Localizamos los ajustes <c>printcap
name</c> y <c>printing</c> y los dirigimos hacia <c>cups</c>:
</p>

<pre caption="Modificaciones en la sección [global]">
[global]
  <comment>(...)</comment>
  printcap name = <i>cups</i>
  printing      = <i>cups</i>
</pre>

<p>
Hemos de asegurarnos de <uri link="#windows_pcl">Habilitar soporte para los
controladores PCL Windows</uri> en CUPS. Después reiniciamos el servicio <c>smb
</c> para hacer las modificaciones efectivas.
</p>

</body>
</section>
<section>
<title>
Configuración de un Cliente Linux para un Servidor de Impresión Windows
</title>
<body>

<p>
Antes de nada, debemos asegurarnos de que la impresora está compartida en el
sistema Windows.
</p>

<p>
Después, en la interfaz web de CUPS, configuraremos la impresora como se
describió anteriormente. Notaremos que CUPS ha añadido otro controlador
denominado <c>Windows Printer vía SAMBA</c>. Lo seleccionamos y usaremos
la sintaxis <c>smb://username:password@workgroup/server/printername</c> o
<c>smb://server/printername</c> para la URI.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Aplicaciones Relacionadas con la Impresión</title>
<section>
<title>Introducción</title>
<body>

<p>
Existen muchas herramientas que nos ayudarán a configurar una impresora, usar
filtros de impresión adicionales, añadir características adicionales de nuestra
impresora, etc. En este capítulo mostramos una de ellas; por supuesto, no vamos
a mostrar una lista exhaustiva ni vamos a cubrir la herramienta con gran
detalle.
</p>

</body>
</section>
<section>
<title>Gtk-LP - Una Herramienta de Configuración de Impresoras Gtk</title>
<body>

<p>
Con <uri link="http://gtklp.sourceforge.net/index.shtml">Gtk-LP</uri> podemos
instalar, modificar y configurar la impresora desde una aplicación Gtk. Emplea
CUPS y proporciona toda la capacidad de CUPS. Merece la pena emplearla si no
resulta de nuestro agrado la interfaz web de CUPS o necesitamos de una
aplicación auto-suficiente para nuestras rutinas de impresión diarias.
</p>

<p>
Para instalarla, emerge <c>gtklp</c>:
</p>

<pre caption="Instalación de Gtk-LP">
# <i>emerge gtklp</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Resolución de problemas</title>
<section>
<title>Error: Unable to convert file 0 to printable format</title>
<body>

<p>
Si está experimentando problemas de impresión y
<path>/var/log/cups/error_log</path> muestra este mensaje:
</p>

<pre caption="Bitácora de error">
Unable to convert file 0 to printable format
</pre>

<p>
Necesita reinstalar <c>ghostscript-esp</c> con el parámetro USE <c>cups</c>.
Puede añadir <c>cups</c> a sus parámetros USE en <path>/etc/make.conf</path>
o bien puede activarla solamente para <c>ghostscript-esp</c> tal como se
muestra a continuación:
</p>

<pre caption="Agregar cups a ghostscript-esp">
# <i>echo "app-text/ghostscript-esp cups" &gt;&gt; /etc/portage/package.use</i>
</pre>

<p>
Luego instale <c>ghostscript-esp</c> con emerge. Una vez que haya finalizado,
asegúrese de reiniciar  <c>cupsd</c> después.
</p>

<pre caption="Reiniciar cupsd">
# <i>/etc/init.d/cupsd restart</i>
</pre>

</body>
</section>
</chapter>

</guide>

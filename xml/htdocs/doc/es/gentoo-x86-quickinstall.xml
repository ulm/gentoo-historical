<?xml version = '1.0' encoding = 'UTF-8' ?>

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/gentoo-x86-quickinstall.xml,v 1.13 2006/06/05 16:13:56 chiguire Exp $ -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/es/gentoo-x86-quickinstall.xml" lang="es" >
<title>Guía rápida de instalación Gentoo Linux x86</title>

<author title="Autor">
  <mail link="neysx@gentoo.org">Xavier Neys</mail>
</author>
<author title="Autor" >
  <mail link="swift@gentoo.org" >Sven Vermeulen</mail>
</author>
<author title="Autor" >Steven Wagner</author>
<author title="Traductor" >
  <mail link="bass@gentoo.org" >José Alberto Suárez López</mail>
</author>
<author title="Traductor" >
  <mail link="chiguire@gentoo.org" >John Christian Stoddart</mail>
</author>
<author title="Traductor" >
  <mail link="yoswink@gentoo.org" >José Luis Rivero</mail>
</author>
<author title="Traductor" >
  <mail link="jmboris@linuxmail.org" >Juan Manuel Jaramillo</mail>
</author>
<author title="Traductor" >
  <mail link="carles@carles.no-ip.info" >Carles Ferrer Peris</mail>
</author>

<abstract>
La guía rápida de instalación cubre los detalles del proceso de
instalación de forma no detallada. Su propósito es permitir a los 
usuarios realizar una instalación desde un stage3 en en un abrir y 
cerrar de ojos. Los usuarios deben tener experiencia previa en la 
instalación de Gentoo Linux si desean seguir esta guía.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>3</version>
<date>2006-05-15</date>

<chapter>
<title>Introducción</title>
<section>
<body>
  	 
<p>
Esta guía contiene todos los comandos que deben utilizarse para completar
una  instalación de Gentoo desde un stage3. Se necesitará una conexión
a Internet para descargar las instantáneas del stage3 y de Portage.
</p>
  	 
<p>
Se indica el tiempo de ejecución de todos los comandos que duran más de un
par de segundos en completarse. El tiempo ha sido calculado en un PC con un
AMD 2000 1.66  Ghz, 512 Mb de RAM y dos discos SATA conectados a una
controladora por hardware.
</p>
  	 
<pre caption="Especificaciones del PC de pruebas">
<comment>(Las siguientes especificaciones y la información del cronometraje
deberían ayudar a determinar el tiempo necesario para completar la 
instalación)
</comment>
  	 
# <i>grep bogo /proc/cpuinfo</i>
bogomip       : 3337.81
  	 
# <i>hdparm -tT /dev/sda</i>
/dev/sda:
Timing cached reads:   1100 MB in  2.00 seconds = 549.97 MB/sec
Timing buffered disk reads:  224 MB in  3.01 seconds =  74.36 MB/sec
  	 
# <i>grep MemTotal /proc/meminfo</i>
MemTotal:       509248 kB
</pre>
  	 
</body>
</section>
</chapter> 

<chapter>
<title>Guía rápida de instalación</title>
<section>
<title>Medios de instalación</title>
<body>
	
<p>
Descargue un CD desde uno de nuestros 
<uri link="/main/en/mirrors.xml"> servidores espejo</uri>. Puede encontrar
la ISO del CD minimal en <path>releases/x86/&lt;release&gt;/installcd</path>
o la ISO del LiveCD en <path>releases/x86/&lt;release&gt;/livecd</path>.
El CD de instalación <e>minimal</e> sólo es práctico para instalaciones
a través de Internet. Se puede utilizar el <e>LiveCD</e> para realizar una
instalación sin red tal como se detalla en 
<uri link="/doc/es/handbook/2006.0/handbook-x86.xml">Manual Gentoo Linux 2006.0 x86</uri>.
Recomendamos el CD minimal.
</p>

<p>
<uri link="/doc/en/faq.xml#isoburning" >Grabe</uri> el CD y arranque con él.
</p>

</body>
</section>
<section>
<title>Arrancar con el CD</title>
<body>

<p>
Pulse <c>F2</c> en la pantalla de arranque para localizar qué opciones
de inicio están disponibles. Se puede iniciar tanto <c>gentoo</c> como
<c>gentoo-nofb</c>, la última deshabilita el framebuffer. Si se inicia
el LiveCD no hay que olvidarse de añadir la opción <c>nox</c> para evitar
que se inicie el entorno gráfico X. Algunas opciones permiten habilitar o
deshabilitar determinadas características. Si todo va bien, se detectará
el hardware y se cargarán todos los módulos. Si el núcleo falla y no
arranca correctamente o si el ordenador se cuelga durante el inicio, se
pueden probar diversas configuraciones. La forma más segura es
probablemente usar la opción <c>nodetect</c> y cargar explícitamente los
módulos cuando sea necesario.
</p>
  	 
<pre caption="Arrancar con el CD minimal">
Gentoo Linux Installation LiveCD                     http://www.gentoo.org
Enter to Boot; F1 for kernels  F2 for options.
boot: <i>gentoo-nofb</i>
<comment>(en caso de problemas)</comment>
boot: <i>gentoo-nofb nodetect</i>
</pre>
  	 
</body>
</section>
<section>
<title>Opcional: carga de módulos</title>
<body>
  	 
<p>
Si utiliza la opción <c>nodetect</c> se deberán cargar los módulos
necesarios una vez arrancado el sistema. Se necesitará habilitar la red y
tener acceso a los discos. El comando <c>lspci</c> nos puede ayudar a
identificar el hardware.
</p>

<pre caption="Caga de los módulos necesarios">
livecd root # <i>lspci</i>
<comment>(Use la salida de lspci para identeficar los módulos
necesarios)</comment>
	
<comment>(Lo siguiente es un ejemplo, adáptelo a su hardware)</comment>
livecd root # <i>modprobe 3w-9xxx</i>
livecd root # <i>modprobe r8169</i>
</pre>

</body>
</section>
<section>
<title>Configuración de red</title>
<body>
	
<p>
Si su red todavía no está todavía lista, puede utilizar <c>net-setup</c> para
configurarla. Puede que necesite cargar previamente el soporte para su tarjeta
de red utilizando <c>modprobe</c>. Si tiene ADSL, use <c>adsl-setup</c> y
<c>adsl-start</c>.  Para el soporte de PPTP, primero hay que editar
<path>/etc/ppp/chap-secrets</path> y <path>/etc/ppp/options.pptp</path> y
después utilizar <c>pptp &lt;serverip&gt;</c>.
</p>

<p>
Para el acceso inalámbrico, utilice <c>iwconfig</c> para configurar los
parámetros de la red sin hilos y después utilice tanto <c>net-setup</c>
nuevamente o <c>ifconfig</c>, <c>dhcpcd</c> y/o <c>route</c> manualmente.
</p>

<p>
Si está tras un proxy, no se olvide de inicializar su sistema utilizando
<c>export http_proxy</c>, <c>ftp_proxy</c> y <c>RSYNC_PROXY</c>.
</p>

<pre caption="Configuración asistida de la red">
livecd root # <i>net-setup eth0</i>
</pre>
  	 
<p>
Alternativamente, se puede iniciar la red manualmente. El ejemplo siguiente
asigna la dirección IP 192.168.1.10 a su PC y define 192.168.1.1 como
encaminador y servidor de nombres.
</p>
  	 
<pre caption="Configuración manual de la red">
livecd root # <i>ifconfig eth0 192.168.1.10/24</i>
livecd root # <i>route add default gw 192.168.1.1</i>
livecd root # <i>echo nameserver 192.168.1.1 > /etc/resolv.conf</i>
</pre>
  	 
<p>
El CD de instalación permite arrancar un servidor <c>sshd</c>, añadir
usuarios adicionales, ejecutar <c>irssi</c> (un cliente de chat para la
línea de comandos) y navegar por la web con <c>lynx</c> o <c>links</c>.
</p>
  	 
</body>
</section>
<section>
<title>Opcional: conectarse al nuevo sistema a través de ssh</title>
<body>
  	 
<p>
La opción más interesante es, desde luego, <c>sshd</c>. Puede iniciarse
para entonces conectarnos desde otra máquina y copiar y pegar los comandos
de esta guía.
</p>
  	 
<pre caption="Arrancar sshd">
livecd root # <i>time /etc/init.d/sshd start</i>
* Generating hostkey ...
<comment>(sshd genera la clave y muestra más información)</comment>
* starting sshd ...                            [ok]
  	 
real   0m13.688s
user   0m9.420s
sys    0m0.090s
</pre>
  	 
<p>
Ahora estableceremos la contraseña para root en el entorno del liveCD de
forma que podamos conectarnos desde otro PC. Por favor, tenga en cuenta
que permitir a root la conexión a través de ssh no está recomendado en
circunstancias normales. Si no confía en la red local, debería usar una
contraseña larga y compleja, y debería usarla sólo hasta que 
desaparezca en el primer reinicio.
</p>
  	 
<pre caption="Establecer la contraseña de root">
livecd root # <i>passwd</i>
New UNIX password: <comment>escriba_la_contraseña</comment>
Retype new UNIX password: <comment>escriba_la_contraseña</comment>
passwd: password updated successfully
</pre>
  	 
<p>
Ahora, se puede inciar una terminal en otro PC y conectarse a la nueva
máquina, seguir el resto de esta guía en otra ventana, y copiar y pegar
comandos.
</p>
  	 
<pre caption="Conectarse al nuevo sistema desde otro PC">
<comment>(Use la dirección IP de su nueva máquina)</comment>
$ <i>ssh root@192.168.1.10</i>
The authenticity of host '192.168.1.10 (192.168.1.10)' can't be established.
RSA key fingerprint is 96:e7:2d:12:ac:9c:b0:94:90:9f:40:89:b0:45:26:8f.
Are you sure you want to continue connecting (yes/no)? <i>yes</i>
Warning: Permanently added '192.168.1.10' (RSA) to the list of known hosts.
Password: <comment>escriba_la_contraseña</comment>
</pre>

</body>
</section>
<section>
<title>Preparación de los discos</title>
<body>

<p>
Use <c>fdisk</c> o <c>cfdisk</c> para crear el esquema de particionado.
Necesitaremos por lo menos una partición de intercambio (swap, tipo 82)
y una partición Linux (tipo 83). En el siguiente ejemplo se creará una
partición <path>/boot</path>, una partición de intercambio y otra 
principal tal como se ve en el Manual de instalación de Gentoo. El 
nombre del dispositivo será algo como <path>/dev/sda</path> para discos
SATA o SCSI, o <path>/dev/hda</path> para discos IDE.
</p>

<pre caption="Creaciçón de las particiones">
livecd ~ # <i>fdisk /dev/sda</i>
  	 
<comment>(El resto de esta guía sigue este mismo esquema de
particionado)</comment>
livecd ~ # <i>fdisk -l /dev/sda</i>
  	 
Disk /dev/sda: 599.9 GB, 599978409984 bytes
255 heads, 63 sectors/track, 72943 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
  	 
   Device Boot      Start         End      Blocks   Id  System
/dev/sda1               1          12       96358+  83  Linux
/dev/sda2              13         110      787185   82  Linux swap / Solaris
/dev/sda3             111       72943   585031072+  83  Linux
</pre>

<p>
Utilice <c>mke2fs</c>, <c>mke2fs -j</c>, <c>mkreiserfs</c>, <c>mkfs.xfs</c> y
<c>mkfs.jfs</c> para crear los sistemas de ficheros en sus particiones Linux.
Inicialice la partición de intercambio mediante <c>mkswap</c> y <c>swapon</c>.
</p>

<pre caption="Creación de los sistemas de ficheros y activación de la swap">
<comment>(ext2 es todo lo que se necesita en la partición /boot)</comment>
livecd ~ # <i>mke2fs /dev/sda1</i>
	
<comment>(Usaremos ext3 en la partición raiz)</comment>
livecd ~ # <i>mke2fs -j -O dir_index /dev/sda3</i>
	
<comment>(Creación y activación de la swap)</comment>
livecd ~ # <i>mkswap /dev/sda2 &amp;&amp; swapon /dev/sda2</i>
</pre>

<p>
Monte los recientemente creados sistemas de ficheros en
<path>/mnt/gentoo</path>. Cree los directorios para otros puntos de montaje
(como <path>/mnt/gentoo/boot</path>) si los necesita y montelos también.
</p>

<pre caption="Montaje de los sistemas de ficheros">
livecd ~ # <i>mount /dev/sda3 /mnt/gentoo</i>
livecd ~ # <i>mkdir /mnt/gentoo/boot</i>
livecd ~ # <i>mount /dev/sda1 /mnt/gentoo/boot</i>
</pre>

</body>
</section>
<section>
<title>Configurando el Stage</title>
<body>

<p>
En primer lugar, asegúrese que la fecha del sistema es correcta con <c>date
MMDDhhmmYYYY</c>. Use el sistema de hora UTC.
</p>

<pre caption="Establecer la fecha y el sistema de hora UTC">
<comment>(Verificación del reloj)</comment>
livecd ~ # <i>date</i>
Mon Mar  6 00:14:13 UTC 2006

<comment>(Si se necesita, estableceremos fecha y hora)</comment>
livecd ~ # <i>date 030600162006</i> <comment>(El formato es 
MMDDhhmmYYYY)</comment>
Mon Mar  6 00:16:00 UTC 2006
</pre>

<p>
Luego descargue un stage desde uno de nuestros
<uri link="/main/en/mirrors.xml" >servidores espejo</uri>. Vaya a
<path>/mnt/gentoo</path> y descomprima el stage utilizando
<c>tar xjpf &lt;stage3 tarball&gt;</c>.
</p>

<pre caption="Descarga del archivo de un stage3">
livecd ~ # <i>cd /mnt/gentoo</i>
livecd gentoo # <i>links http://www.gentoo.org/main/en/mirrors.xml</i>
<comment>(Elija un servidor espejo, cámbiese al directorio
releases/x86/current/stages, resalte el stage3 de su elección,
probablemente stage3-i686-2006.0.tar.bz2 y pulse D para 
descargarlo)</comment>
  	 
<comment>(<b>O</b> descárguelo directamente con wget sin elegir un 
espejo cercano)</comment>
livecd ~ # <i>cd /mnt/gentoo</i>
livecd gentoo # <i>wget http://gentoo.osuosl.org/releases/x86/current/stages/stage3-i686-2006.0.tar.bz2</i>
</pre>
  	 
<pre caption="Desempaquetado del archivo del stage3">
livecd gentoo # <i>time tar xjpf stage3*</i>
  	 
real  1m13.157s
user  1m2.920s
sys   0m7.230s
</pre>

<p>
Instale la última imagen disponible de Portage. Hágalo igual que con el
archivo del stage3: elija un servidor espejo cercano desde la
<uri link="/main/en/mirrors.xml" >lista</uri>, descárguelo y desempaquételo.
</p>

<pre caption="Descarga de la última instantánea de Portage">
livecd gentoo # <i>cd /mnt/gentoo/usr</i>
livecd usr # <i>links http://www.gentoo.org/main/en/mirrors.xml</i>
<comment>(Elija un servidor espejo, cámbiese al directorio snapshots,
resalte <b>portage-latest.tar.bz2</b> y pulse D para descargarlo)</comment>
	
<comment>(<b>O</b> descárguelo directamente con wget sin utilizar un
servidor espejo cercano)</comment>
livecd gentoo # <i>cd /mnt/gentoo/usr</i>
livecd usr # <i>wget http://gentoo.osuosl.org/snapshots/portage-latest.tar.bz2</i>
</pre>

<pre caption="Desempaquetado del archivo de Portage">
livecd usr # <i>time tar xjf portage*</i>
	
real  0m51.523s
user  0m28.680s
sys   0m12.840s
</pre>

</body>
</section>
<section>
<title>Chroot</title>
<body>

<p>
Monte el sistema de ficheros <path>/proc</path>, sobrescriba el fichero
<path>/etc/resolv.conf</path> y luego cambie el directorio raíz (chroot)
a su entorno Gentoo.
</p>

<pre caption="Chroot" >
livecd usr # <i>cd /</i>
livecd / # <i>mount -t proc proc /mnt/gentoo/proc</i>
livecd / # <i>cp -L /etc/resolv.conf /mnt/gentoo/etc/</i>
livecd / # <i>chroot /mnt/gentoo /bin/bash</i>
livecd / # <i>env-update &amp;&amp; source /etc/profile</i>
>>> Regenerating /etc/ld.so.cache...
</pre>

</body>
</section>
<section>
<title>Establecimiento de la zona horaria</title>
<body>

<p>
Configure su zona horaria copiando el fichero correcto desde
<path>/usr/share/zoneinfo</path> sobre el fichero <path>/etc/localtime</path>.
</p>

<pre caption="Copia del fichero de la zona horaria">
<comment>(Se usa Bruselas como ejemplo)</comment>
livecd / # <i>cp /usr/share/zoneinfo/Europe/Brussels /etc/localtime</i>
livecd / # <i>date</i>
Wed Mar  8 00:46:05 CET 2006
</pre>

</body>
</section>
<section>
<title>Establecimiento de los nombres de host y dominio</title>
<body>

<p>
Estableceremos el nombre del computador en <path>/etc/conf.d/hostname</path>
y en <path>/etc/hosts</path>. En el ejemplo siguiente, usaremos
<c>miordenador</c> como nombre de host y <c>en.misitio</c> como nombre de
dominio. Podremos editar ambos ficheros con <c>nano</c> o usar los 
comandos siguientes:
</p>

<pre caption="Establecimiento de los nombres de host y dominio">
livecd / # <i>cd /etc</i>
livecd etc # <i>echo "127.0.0.1 miordenador.en.misitio miordenador localhost" > hosts</i>
livecd etc # <i>sed -i -e 's/HOSTNAME.*/HOSTNAME="miordenador"/' conf.d/hostname</i>
<comment>(Uso del nombre de host definido y verificación)</comment>
livecd etc # <i>hostname miordenador</i>
livecd etc # <i>hostname -f</i>
miordenador.en.misitio
</pre>

</body>
</section>
<section>
<title>Configuración del núcleo</title>
<body>

<p>
Instale las fuentes del núcleo (normalmente <c>gentoo-sources</c> o
<c>vanilla-sources</c>), configúrelas, compílelas y copie el fichero
<path>arch/i386/boot/bzImage</path> en <path>/boot</path>.
</p>

<pre caption="Instalación de las fuentes del núcleo, compilación e
instalación del núcleo">
livecd / # <i>time emerge gentoo-sources</i>
	
real  2m51.435s
user  0m58.220s
sys   0m29.890s
livecd / # <i>cd /usr/src/linux</i>
livecd linux # <i>make menuconfig</i>
<comment>(Configure su núcleo)</comment>
livecd linux # <i>time make -j2</i>
	
<comment>(El tiempo de ejecución depende bastante de las opciones
elegidas</comment>
real  3m51.962s
user  3m27.060s
sys   0m24.310s

livecd linux # <i>make modules_install</i>
livecd linux # <i>cp arch/i386/boot/bzImage /boot/kernel</i>
</pre>

</body>
</section>
<section>
<title>Configuración del sistema</title>
<body>

<p>
Edite su <path>/etc/fstab</path> y reemplace <c>BOOT</c>, <c>ROOT</c> y
<c>SWAP</c> con los nombres correspondientes de sus particiones. No olvide
verificar que los sistmas de ficheros coinciden con los de su instalación.
</p>

<pre caption="Ejemplo de fstab" >
livecd linux # <i>cd /etc</i>
livecd etc # <i>nano -w fstab</i>
/dev/<i>sda1</i>   /boot     ext2    noauto,noatime     1 2
/dev/<i>sda3</i>   /         ext3    noatime            0 1
/dev/<i>sda2</i>   none      swap    sw                 0 0
</pre>

<p>
Configure la red en <path>/etc/conf.d/net</path>. Añada el guión de
inicio <c>net.eth0</c> al nivel de ejecución por defecto. Si tiene
varias tarjetas de red, haga un enlace simbólico al guión de inicio
<c>net.eth0</c> para cada una de ellas y añádalos igualmente al nivel
de ejecución por defecto. Puede tanto editar <path>/etc/conf.d/net</path>
con <c>nano</c> como usar los comandos siguientes:
</p>

<pre caption="Configuración de la red">
livecd etc # <i>cd conf.d</i>
livecd conf.d # <i>echo 'config_eth0=( "192.168.1.10/24" )' >> net</i>
livecd conf.d # <i>echo 'routes_eth0=( "default via 192.168.1.1" )' >> net</i>
livecd conf.d # <i>rc-update add net.eth0 default</i>
<comment>(Si ha compilado el controlador de la tarjeta de red como módulo,
añádalo a /etc/modules.autoload.d/kernel-2.6)</comment>
livecd conf.d # <i>echo r8169 >> /etc/modules.autoload.d/kernel-2.6</i>
<comment>(Si quiere reconectarse por ssh después de haber reiniciado su
nuevo sistema:)</comment>
livecd conf.d # <i>rc-update add sshd default</i>
</pre>

<note>
Instale <c>pcmcia-cs</c> y añádalo al nivel de ejecución por defecto
si lo necesita.
</note>

<p>
Establezca la contraseña de root con <c>passwd</c>.
</p>

<pre caption="Establezca la contraseña de root">
livecd conf.d # <i>passwd</i>
New UNIX password: <comment>escriba_la_contraseña</comment>
Retype new UNIX password: <comment>escriba_la_contraseña_nuevamente</comment>
passwd: password updated successfully
</pre>

<p>
Verifique la configuración del sistema en <path>/etc/rc.conf</path>, 
<path>/etc/conf.d/rc</path>, <path>/etc/conf.d/keymaps</path>,
<path>/etc/conf.d/clock</path> y edite alguno de los ficheros si es
necesario
</p>

<pre caption="Opcional: edición de algunos ficheros de configuración">
livecd conf.d # <i>nano -w /etc/rc.conf</i>
livecd conf.d # <i>nano -w /etc/conf.d/rc</i>
livecd conf.d # <i>nano -w /etc/conf.d/keymaps</i>
livecd conf.d # <i>nano -w /etc/conf.d/clock</i>
</pre>

</body>
</section>
<section>
<title>Instalación de las herramientas del sistema</title>
<body>

<p>
Instale una bitácora del sistema como <c>syslog-ng</c> y un demonio de
cron como <c>vixie-cron</c>, y añádalos a ambos al nivel de ejecución
por defecto.
</p>

<note>
Los demonios de cron dependen de un MTA por lo que puede que
<c>mail-mta/ssmtp</c> sea puesto como dependencia. Si quiere utilizar un
MTA más avanzado, podría instalarlo ahora. Si tiene prisa, deje que ssmtp
sea instalado y quítelo después cuando instale el MTA de su elección
</note>

<pre caption="Instalación de una bitácora del sistema de y un demonio de
cron">
livecd conf.d # <i>time emerge syslog-ng vixie-cron</i>
	
real  1m52.699s
user  1m1.630s
sys   0m35.220s
livecd conf.d # <i>rc-update add syslog-ng default</i>
livecd conf.d # <i>rc-update add vixie-cron default</i>
</pre>

<p>
Instale las herramientas del sistema (<c>xfsprogs</c>, <c>reiserfsprogs</c>
o <c>jfsutils</c>) y red (<c>dhcpcd</c> o <c>rp-pppoe</c>) precisas, si
es que necesita alguna.
</p>

<pre caption="Instalación de herramientas extra si son necesarias">
livecd conf.d # <i>emerge xfsprogs</i>           <comment>(Si usa sistemas
de ficheros XFS)</comment>
livecd conf.d # <i>emerge jfsutils</i>           <comment>(Si usa sistemas
de ficheros JFS)</comment>
livecd conf.d # <i>emerge reiserfsprogs</i>      <comment>(Si usa sistemas
de ficheros Reiser file system)</comment>
livecd conf.d # <i>emerge dhcpcd</i>             <comment>(Si necesita un
cliente DHCP)</comment>
livecd conf.d # <i>USE="-X" emerge rp-pppoe</i>  <comment>(Si necesita
conectividad PPPoE ADSL)</comment>
</pre>

</body>
</section>
<section>
<title>Configuración del gestor de arranque</title>
<body>

<p>
Haga emerge de <c>grub</c> o <c>lilo</c>. Configure uno de los dos 
<path>/boot/grub/grub.conf</path> o <path>/etc/lilo.conf</path> e 
instale el gestor de arranque correspondiente.
</p>

<p>
<b>1. Usando grub</b>
</p> 	 

<pre caption="Hacer emerge de grub y editar su fichero de configuración">
livecd conf.d # <i>time emerge grub</i>
	
real  1m8.634s
user  0m39.460s
sys   0m15.280s
livecd conf.d # <i>nano -w /boot/grub/grub.conf</i>
</pre>

<pre caption="Ejemplo de grub.conf" >
default 0
timeout 10

title=Gentoo
root (hd0,0)
kernel /boot/kernel root=/dev/sda3
</pre>

<pre caption="Instalación de grub">
livecd conf.d # <i>grub</i>
Probing devices to guess BIOS drives. This may take a long time.
	
grub> <i>root (hd0,0)</i>
 Filesystem type is ext2fs, partition type 0x83
	
grub> <i>setup (hd0)</i>
 Checking if "/boot/grub/stage1" exists... yes
 Checking if "/boot/grub/stage2" exists... yes
 Checking if "/boot/grub/e2fs_stage1_5" exists... yes
 Running "embed /boot/grub/e2fs_stage1_5 (hd0)"...  16 sectors are embedded.
succeeded
 Running "install /boot/grub/stage1 (hd0) (hd0)1+16 p (hd0,0)/boot/grub/stage2 /boot/
grub/menu.lst"... succeeded
Done.
	
grub> <i>quit</i>
</pre>

<p>
Ahora continue en la <uri link="#reboot">sección reiniciando</uri>.
</p>

<p>
<b>2. Usando lilo</b>
</p>

<pre caption="Hacer emerge de lilo y editar su fichero de configuración">
livecd conf.d # <i>time emerge lilo</i>

real  0m47.016s
user  0m22.770s
sys   0m5.980s
livecd conf.d # <i>nano -w /etc/lilo.conf</i>
</pre>

<pre caption="Ejemplo de lilo.conf" >
boot=/dev/sda
prompt
timeout=50
default=gentoo

image=/boot/kernel
  label=Gentoo
  read-only
  root=/dev/sda3
</pre>

<pre caption="Instalación de lilo">
livecd conf.d # <i>lilo</i>
Added Gentoo *
</pre>

</body>
</section>
<section id="reboot">
<title>Reinicio</title>
<body>

<p>
Salga del entorno de chroot, desmonte todos los sistemas de ficheros y reinicie:
</p>

<pre caption="Reinicio">
livecd conf.d # <i>exit</i>
livecd / # <i>umount /mnt/gentoo/proc /mnt/gentoo/boot /mnt/gentoo</i>
livecd / # <i>reboot</i>
<comment>(No se olvide de quitar el CD)</comment>
</pre>

</body>
</section>
<section id="after-reboot">
<title>Finalizar la instalación</title>
<body>

<note>
En nuestra máquina de pruebas, el intervalo de tiempo <b>total</b> entre
el indicador de comandos en el arranque del CD minimal y el indicador del
ingreso en el sistema después de reiniciar fue de <b>00:42:31</b>. ¡Sí,
menos de una hora! Note que este tiempo incluye incluso la descarga del
stage3, de la instantánea de Portage y de algunos paquetes y el tiempo
empleado en configurar el núcleo.
</note>
	
<p>
Entre como <c>root</c>, luego añada uno o más usuarios para el día a día
utilizando <c>useradd</c>.
</p>

<pre caption="Entrada en su nuevo sistema desde otro PC">
<comment>(Limpie su fichero known_hosts puesto que su nueva máquina ha 
generado una nueva y definitiva clave sshd)
</comment>
$ <i>nano -w ~/.ssh/known_hosts</i>
<comment>(Busque la IP de su nuevo PC y borre la línea, luego guarde el 
fichero y salga de nano)</comment>
	
<comment>(Use la dirección IP de su nuevo sistema)</comment>
$ <i>ssh root@192.168.1.10</i>
The authenticity of host '192.168.1.10 (192.168.1.10)' can't be established.
RSA key fingerprint is 96:e7:2d:12:ac:9c:b0:94:90:9f:40:89:b0:45:26:8f.
Are you sure you want to continue connecting (yes/no)? <i>yes</i>
Warning: Permanently added '192.168.1.10' (RSA) to the list of known hosts.
Password: <comment>introduzca_la_contraseña</comment>
</pre>

<pre caption="Añadir un nuevo usuario">
miordenador ~ # <i>adduser -g users -G lp,wheel,audio,cdrom,portage,cron -m john</i>
miordenador ~ # <i>passwd john</i>
New UNIX password: <comment>Introduzca la contraseña de John</comment>
Retype new UNIX password: <comment>Introduzca la contraseña de John otra vez</comment>
passwd: password updated successfully
</pre>

</body>
</section>
<section>
<title>Últimos  retoques de la configuración</title>
<body>
  	 
<p>
Comenzaremos seleccionando los servidores espejo cercanos definiendo las
variables <c>RSYNC</c> y <c>GENTOO_MIRRORS</c> en
<path>/etc/make.conf</path> o bien utilizando <c>mirrorselect</c>.
También podemos definir en este momento el número de procesos de
compilación concurrentes.
</p>
  	 
<pre caption="Uso de mirrorselect y establecimiento de MAKEOPTS">
miordenador ~ # <i>emerge mirrorselect</i>
miordenador ~ # <i>mirrorselect -i -o >> /etc/make.conf</i>
miordenador ~ # <i>mirrorselect -i -r -o >> /etc/make.conf</i>
<comment>(Normalmente (el número de procesadores +1) es un buen valor)</comment>
miordenador ~ # <i>echo 'MAKEOPTS="-j2"' >> /etc/make.conf</i>
</pre>
  	 
<p>
Ahora es un buen momento para habilitar o deshabilitar algunas opciones
USE. Ejecute <c>emerge -vpe</c> para listar todos los paquetes instalados
y sus opciones USE habilitadas o deshabilitadas. Edite
<path>/etc/make.conf</path> o alternativamente use el siguiente comando
para definir la variable USE:
</p>
  	 
<pre caption="Ver las opciones USE en uso y habilitar o deshabilitar algunas">
miordenador ~ # <i>emerge -vpe world</i>
<comment>(Portage muestra los paquetes y sus opciones USE; como ejemplo,
vamos a deshabilitar ipv6 y fortran, y habilitar userlocales y
unicode)</comment>
miordenador ~ # <i>echo 'USE="nptl nptlonly -ipv6 -fortran userlocales unicode"' >> /etc/make.conf</i>
</pre>

<p>
Si habilita la opción USE <c>userlocales</c> para versiones de glibc que
todavía las soportan, debe editar <path>/etc/locales.build</path> y definir
las locales que quiere crear.
</p>

<p>
Versiones posteriores de glibc ignoran la opción USE de userlocales y
utilizan en su lugar <path>/etc/locale.gen</path>. Si está actualizando
glibc a una de esas versiones, debería crear <path>/etc/locale.gen</path>
<e>y eliminar</e> <path>/etc/locales.build</path>. Verifique la salida de
<c>emerge -vpe world</c> para conocer si glibc soporta la opción USE de
userlocales.
</p>

<pre caption="Definición de locales">
miordenador ~ # <i>cd /etc</i>
<comment>(Para versiones de glibc con la opción USE de userlocales)</comment>
miordenador etc # <i>nano -w locales.build</i>
  	 
<comment>(Para versiones recientes de glibc, convierta locales.build)</comment>
miordenador etc # <i>grep '^[^#].*' locales.build | sed 's:/: :' >locale.gen</i>
miordenador etc # <i>rm locales.build</i>
miordenador etc # <i>nano -w locale.gen</i>
</pre>
  	 
<p>
Finalmente pero no menos importante, puede querer modificar la variable
<c>CFLAGS</c> en su <path>/etc/make.conf</path> para optimizar el código
a sus necesidades específicas. Por favor, tenga en cuenta que raramente
se necesita utilizar una larga lista de opciones que pueden llegar incluso
a estropear el sistema. Es recomendable especificar el tipo de procesador
en la opción <c>march</c> e incluir <c>-O2 -pipe</c>.
</p>
  	 
<p>
También puede querer pasarse a <b>~x86</b>.Sólo debería hacer esto si
es capaz de manejar los posibles ebuilds o paquetes rotos. Si más bien
quiere mantener su sistema estable, no añada la variable
<c>ACCEPT_KEYWORDS</c>. También es una buena idea añadir
<c>FEATURES="parallel-fetch ccache"</c>.
</p>
  	 
<note>
En el momento de escribir esto, la versión ~x86 de <c>portage</c> es
significativamente más rápida cuando actualiza su caché. Incluso si pone
la palabra clave x86 puede querer usar la versión ~x86 de Portage. Mire
el capítulo <uri link="/doc/es/handbook/handbook-x86.xml?part=3&amp;chap=3#doc_chap2">Mezclando
estable con pruebas</uri>
</note>
  	 
<pre caption="Ultima edición de make.conf">
miordenador etc # <i>nano -w make.conf</i>
<comment>(Establezca -march a su tipo de CPU en CFLAGS)</comment>
CFLAGS="-O2 -march=<i>athlon-xp</i> -pipe"
<comment>(Añada la siguiente línea)</comment>
FEATURES="parallel-fetch ccache"
<comment>(Añada lo siguiente únicamente si sabe lo que está haciendo)</comment>
ACCEPT_KEYWORDS="~x86"
</pre>
  	 
<p>
Puede querer recompilar todo su sistema para hacer un uso completo de los
últimos cambios de configuración hechos. Tomará bastante tiempo en
completarse y obtendrá unos mínimos beneficios de velocidad. Le
recomendamos que deje que su sistema se optimice por sí solo de forma
gradual cada vez que salgan versiones nuevas de los paquetes.
</p>
  	 
<p>
Recompilar sólo los paquetes que han sido ya actualizados desde la
versión o que han sido afectados por las nuevas opciones USE tomará
bastante tiempo. Podría también quitar los paquetes que bloquean una
actualización. Busque los "[blocks <brite>B</brite>     ]" en la salida
de <c>emerge -vpuD --newuse world</c> y utilice <c>emerge -C</c> para
quitarlos.
</p>
  	 
<pre caption="Actualización de los paquetes">
<comment>(Instale ccache)</comment>
miordenador etc # <i>emerge ccache</i>
  	 
<comment>(Por favor tenga en cuenta que cambiar a ~x86 causa que muchos
paquetes sean actualizados</comment>
miordenador etc # <i>emerge -vpuD --newuse world</i>
<comment>(Dé una buena revisión a la lista de paquetes y sus opciones
USE, quite los paquetes que bloqueen otros si los hay, e inicie el largo
proceso)</comment>
miordenador etc # <i>time emerge -vuD --newuse world</i>
<comment>(79 paquetes han sido (re)compilados)</comment>
  	 
real  180m13.276s
user  121m22.905s
sys   36m31.472s
  	 
<comment>(Reinstale libtool para prevenir potenciales problemas)</comment>
miordenador etc # <i>emerge libtool</i>
  	 
<comment>(Actualice los ficheros de configuración, asegurándose de
<b>no</b> dejar a etc-update que actualice ficheros que usted ha
editado)</comment>
miordenador etc # <i>etc-update</i>
  	 
<comment>(Si perl ha sido actualizado, debería ejecutar el guión
perl-cleaner)</comment>
miordenador etc # <i>time perl-cleaner all</i>
real  1m6.495s
user  0m42.699s
sys   0m10.641s
  	 
<comment>(En caso de una actualización mayor de python, debería ejecutar
el guión python-updater)</comment>
miordenador etc # <i>python-updater</i>
</pre>
  	 
</body>
</section>
<section>
<title>Qué hacer a continuación</title>
<body>

<p>
Dependiendo de lo que se supone deba hacer su nueva máquina Gentoo,
probablemente querrá instalar aplicaciones de servidor o un sistema de
escritorio. Sólo como ejemplo, <c>emerge gnome</c> y <c>emerge kde</c>
han sido cronometrados en el sistema ~x86 instalado tal como se describe
antes. Ambos instalados desde el mismo punto de partida.
</p>
  	 
<p>
Puede ver nuestro <uri link="/doc/es/">índice de documentación</uri> para saber cómo instalar la aplicaciones de su elección.
</p>

<impo>
Lo siguiente sólo es un ejemplo. De ninguna manera es una configuración
recomendada.
</impo>
  	 
<pre caption="Emerge GNOME">
miordenador etc # <i>emerge -vp gnome</i>
<comment>(Vea la lista de paquetes y sus opciones USE, luego edite make.conf si es necesario.</comment>
miordenador etc # <i>nano -w /etc/make.conf</i>
<comment>Las siguientes opciones USE han sido definidas)</comment>
USE="nptl nptlonly -ipv6 -fortran unicode svg hal dbus \
  -kde -qt -arts -eds -esd gnome gstreamer gtk -xmms firefox"
  	 
miordenador etc # <i>time emerge gnome</i>
<comment>(326 paquetes han sido instalados)</comment>
  	 
real  520m44.532s
user  339m21.144s
sys   146m22.337s
</pre>
  	 
<pre caption="Emerge KDE">
miordenador etc # <i>emerge -vp kde-meta</i>
<comment>(Vea la lista de paquetes y sus opciones USE, luego edite make.conf si es necesario.</comment>
miordenador etc # <i>nano -w /etc/make.conf</i>
<comment>Las siguientes opciones USE han sido definidas)</comment>
USE="nptl nptlonly -ipv6 -fortran unicode svg hal dbus \
   kde qt -arts -eds -esd -gnome -gstreamer -gtk -xmms -firefox"
  	 
miordenador etc # <i>time emerge kde-meta</i>
<comment>(391 han sido instalados)</comment>
  	 
real  1171m25.318s
user  851m26.393s
sys   281m45.629s
</pre>

</body>
</section>
</chapter>
</guide>

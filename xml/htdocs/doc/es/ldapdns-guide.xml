<?xml version='1.0' encoding="UTF-8"?>

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/es/Attic/ldapdns-guide.xml,v 1.1 2008/05/02 17:15:38 chiguire Exp $ -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/en/ldapdns-guide.xml" lang="es">
<title>Gentoo LDAP-DNS Guide</title>

<author title="Autor">
  <mail link="fnjordy@gmail.com">Steve-o</mail>
</author>
<author title="Editor">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Traductor">
  <mail link="jesus.riveroa@gmail.com">Jesús Rivero</mail>
</author>

<abstract>
Con ldapdns se pueden proveer servicios de DNS a una red de manera
sencilla. Los registros DNS utilizado se almacenan en un entorno
LDAP. Este documento le guiará en la configuración de OpenLDAP y
ldapdns.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>0.2</version>
<date>2006-03-25</date>

<chapter>
<title>Introducción</title>
<section>
<body>

<p>
LDAPDNS es un pequeño servidor que provee servicios DNS a una red. Con
servicios de DNS se puede manejar la resolución de nombres de manera
centralizada haciendo obsoletas las tediosas modificaciones al archivo
<path>/etc/hosts</path> cada vez que un sistema es agregado/eliminado
o cambia su nombre.
</p>

<p>
El paquete LDAPDNS utiliza un servicio LDAP para almacenar todos los
registros DNS (una línea que contiene una relación entre un hostname y
una dirección IP). LDAP es un protocolo estándar para obtener
información de una base de conocimiento representada jerárquicamente
(directorios).  El servicio LDAP más conocido para Linux es OpenLDAP,
una implementación libre de LDAP.
</p>

<p>
Con esta pequeña guía en sus manos será capaz de configurar servicios
de DNS en su red realizando el menor esfuerzo posible.
</p>
</body>
</section>
</chapter>

<chapter>
<title>Configurando LDAP-DNS</title>
<section>
<body>

<p>
Primero, instale <c>net-dns/ldapdns</c>.
</p>

<pre caption="Instalando ldapdns">
# <i>emerge net-dns/ldapdns</i>
</pre>

<p>
Ahora configure <c>ldapdns</c> para almacenar los registros DNS de su
red. Utilizaremos <c>ldapdns-conf</c> que utiliza la siguiente
sintáxis:
</p>

<pre caption="Sintáxis para ldapdns-conf">
ldapdns-conf acct logacct /ruta su-dirección-ip ldaphost dn [sufijo]
</pre>

<table>
<tr>
  <th>Palabra clave</th>
  <th>Explicación</th>
  <th>Ejemplo</th>
</tr>
<tr>
  <ti>acct</ti>
  <ti>Usuario con el que se ejecutará ldapdns</ti>
  <ti>ldapdns</ti>
</tr>
<tr>
  <ti>logacct</ti>
  <ti>Usuario con el que ldapdns logging se ejecutará</ti>
  <ti>dnslog</ti>
</tr>
<tr>
  <ti>/ruta</ti>
  <ti>Directorio home para ldapdns (dentro de un chroot)</ti>
  <ti><path>/var/lib/ldapdns</path></ti>
</tr>
<tr>
  <ti>su-dirección-ip</ti>
  <ti>Dirección IP en la que se escuchará</ti>
  <ti>127.0.0.1</ti>
</tr>
<tr>
  <ti>ldaphost</ti>
  <ti>Dirección del servicio LDAP</ti>
  <ti><c>ldapi://%2fvar%2frun%2fopenldap%2fslapd.sock</c></ti>
</tr>
<tr>
  <ti>dn</ti>
  <ti>Credenciales de acceso a LDAP</ti>
  <ti>cn=Manager,dc=<c>su-dominio</c></ti>
</tr>
<tr>
  <ti>sufijo</ti>
  <ti>Ruta LDAP opcional para almacenar todas las consultas</ti>
  <ti>ou=Machines,dc=<c>su-dominio</c></ti>
</tr>
</table>

<p>
Se debería sustituir la dirección IP <c>127.0.0.1</c> por una
dirección que pueda ser accedida por todos los equipos de su red. No
olvide utilizar el nombre de dominio que quiere utilizar en lugar de
<c>su-dominio</c>.
</p>

<pre caption="Ejemplo de ejecución de ldapdns-conf">
# <i>ldapdns-conf ldapdns dnslog /var/lib/ldapdns 127.0.0.1 ldapi://%2fvar%2frun%2fopenldap%2fsldapd.sock cn=Manager,dc=su-dominio ou=Machines,dc=su-dominio</i>
</pre>

<p>
Ahora configure la contraseña de acceso a LDAP:
</p>

<pre caption="Setting the LDAP login password">
# <i>echo SuPasswordSecreto &gt; /var/lib/ldapdns/root/password</i>
# <i>chmod 0400 /var/lib/ldapdns/root/password</i>
</pre>

<p>
Ahora configure ldapdns para que utilize un método de autenticación
simple y los esquemas cosine LDAP:
</p>

<pre caption="Configurando ldapdns">
# <i>echo simple &gt; /var/lib/ldapdns/env/LDAP_AUTH</i>
# <i>echo cosine &gt; /var/lib/ldapdns/env/SCHEMA</i>
</pre>

<p>
De manera opcional, puede configurar una dirección electrónica para el
servicio:
</p>

<pre caption="Configurando una dirección electrónica maestra">
# <i>echo SuDirección@electrónica &gt; /var/lib/ldapdns/env/HOSTMASTER</i>
</pre>

<p>
Agregue el servicio a la búsqueda supervisada y ejecúte el supervisor
de servicios si no lo ha hecho antes:
</p>

<pre caption="Administrando los servicios de supervisión">
# <i>ln -s /var/lib/ldapdns /service</i>
# <i>/etc/init.d/svscan start</i>
# <i>rc-update add svscan default</i>
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Configurando OpenLDAP</title>
<section>
<body>

<p>
Ahora se necesita configurar OpenLDAP con el esquema DNS. Edite
<path>/etc/openldap/slapd.conf</path> con su editor favorito y
asegúrese de que las siguientes tres líneas existan:
</p>

<pre caption="Editando /etc/openldap/sldap.conf">
include         /etc/openldap/schema/cosine.schema
include         /etc/openldap/schema/inetorgperson.schema
include         /etc/openldap/schema/nis.schema
</pre>

<p>
Inicie LDAP con la dn base que definió previamente en
<c>ldapdns-conf</c>.  Para esto, es necesario crear un archivo
<path>bootstrap.diff</path> (es sólo un nombre) en el que se
almacenará la información del DNS.
</p>

<p>
Como un ejemplo, se provee un <uri
link="bootstrap.ldif.txt">bootstrap.ldif</uri> para un dominio
ficticio <c>cherchetoujours.org</c>.
</p>

<p>
Ahora inicie LDAP con esta información:
</p>

<pre caption="Bootstrapping LDAP">
# <i>ldapadd -x -D "cn=Manager,dc=su-dominio" -W -f bootstrap.ldif</i>
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Probando la Instalación</title>
<section>
<body>

<p>
Ya está todo configurado. Pruebe su configuración con <c>nslookup</c>
(parte de <c>net-dns/bind-tools</c>):
</p>

<pre caption="Probando la configuración de ldapdns">
# <i>nslookup ns1.su-dominio</i>
 Note:  nslookup is deprecated and may be removed from future releases.
 Consider using the `dig' or `host' programs instead.  Run nslookup with
 the `-sil[ent]' option to prevent this message from appearing.
 Server:         <i>127.0.0.1</i>
 Address:        <i>127.0.0.1#53</i>

 Name:   ns1.example.com
 Address: <comment>(Su dirección IP)</comment>
</pre>
</body>
</section>
</chapter>

<chapter>
<title>Recursos</title>
<section>
<body>

<p>
El archivo <uri
link="http://cvs.lp.se/doc/ldapdns/README.configure.gz">README.configure.gz</uri>
del proyecto ldapdns.
</p>
</body>
</section>
</chapter>
</guide>

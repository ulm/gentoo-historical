<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/nl/handbook/hb-working-portage.xml,v 1.2 2005/02/09 15:43:59 neysx Exp $ -->

<sections>

<version>1.44</version>
<date>2005-02-08</date>

<section>
<title>Welkom bij Portage</title>
<body>

<p>
Portage is waarschijnlijk Gentoo's meest opmerkelijke innovatie in
softwarebeheer. Met zijn hoge flexibiliteit en zijn enorme hoeveelheid aan
mogelijkheden wordt het vaak gezien als de beste softwarebeheertool die voor
Linux beschikbaar is.
</p>

<p>
Portage is geheel geschreven in <uri link="http://www.python.org">Python</uri>
en <uri link="http://www.gnu.org/software/bash">Bash</uri> en is daardoor
zichtbaar voor gebruikers omdat het beide script talen zijn.
</p>

<p>
De meeste gebruikers zullen met Portage werken via de <c>emerge</c> tool. Dit
hoofdstuk is niet bedoeld om de beschikbare informatie uit de emerge handleiding
te herhalen. Voor een complete lijst met emerge's opties, lees de handleiding:
</p>

<pre caption="De emerge handleiding lezen">
$ <i>man emerge</i>
</pre>

</body>
</section>
<section>
<title>De Portageboom</title>
<subsection>
<title>Ebuilds</title>
<body>

<p>
Als we over pakketten praten, bedoelen we meestal softwaretitels die
beschikbaar zijn via de Portageboom. De Portageboom is een verzameling van
<e>ebuilds</e>, bestanden die alle informatie bevatten die Portage nodig heeft
(om te installeren, te zoeken, uit te lezen, ...). Deze ebuilds zitten standaard
in <path>/usr/portage</path>.
</p>

<p>
Op het moment dat je Portage vraagt een taak met betrekking tot softwaretitels
uit te voeren, zal hij de ebuilds op je systeem als basis gebruiken. Daarom is
het belangrijk dat je regelmatig je ebuilds op je systeem vernieuwt zodat
Portage weet over nieuwe software, veiligheidsupdates, etc.
</p>

</body>
</subsection>
<subsection>
<title>De Portageboom updaten</title>
<body>

<p>
<!-- loopt nog niet erg lekker -->
De Portageboom wordt normaal gesproken geupdate met <uri
link="http://rsync.gentoo.org">rsync</uri>, een snel groeiend
bestandsoverdrachtprogramma. Updaten is erg makkelijk omdat het <c>emerge</c>
commando een front-end voor rsync biedt:
</p>

<pre caption="De Portageboom updaten">
# <i>emerge --sync</i>
</pre>

<p>
Indien je door je firewallbeperkingen geen rsync kunt gebruiken, kan je nog
steeds je Portageboom updaten door onze dagelijks gegenereerde Portageboom
snapshots te gebruiken. De <c>emerge-webrsync</c> tool haalt deze automatisch
op en installeert deze meteen:
</p>

<pre caption="Emerge-webrsync draaien">
# <i>emerge-webrsync</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Software beheren</title>
<subsection>
<title>Zoeken naar software</title>
<body>

<p>
Om door de Portageboom naar softwaretitels te zoeken, kun je de in <c>emerge</c>
ingebouwde zoekfunctie gebruiken. Standaard geeft <c>emerge --search</c> de naam
terug van de pakketten waarbij de titel (volledig of deels) overeenkomt met de
gegeven zoekterm.
</p>

<p>
Om bijvoorbeeld te zoeken naar alle pakketten met "pdf" in hun naam:
</p>

<pre caption="Zoeken naar pdf-genaamde pakketten">
$ <i>emerge --search pdf</i>
</pre>

<p>
Indien je ook door de beschrijvingen wil zoeken, kun je <c>--searchdesc</c>
(of <c>-S</c>) gebruiken
</p>

<pre caption="zoeken naar pdf-gerelateerde pakketten">
$ <i>emerge --searchdesc pdf</i>
</pre>

<p>
Als we kijken naar de uitkomst, zul je zien dat het een boel informatie
weergeeft. De velden hebben een duidelijke naam dus daar gaan we niet
verder op in.
</p>

<pre caption="Voorbeeld van de emerge --search resultaten">
*  net-print/cups-pdf
      Latest version available: 1.5.2
      Latest version installed: [ Not Installed ]
      Size of downloaded files: 15 kB
      Homepage:    http://cip.physik.uni-wuerzburg.de/~vrbehr/cups-pdf/
      Description: Provides a virtual printer for CUPS to produce PDF files.
      License:     GPL-2
</pre>

</body>
</subsection>
<subsection>
<title>Software installeren</title>
<body>

<p>
Als een softwaretitel gevonden hebt die je wil installeren, kun je dit
gemakkelijk doen met <c>emerge</c>: voeg gewoon de pakket naam toe. Om
bijvoorbeeld <c>gnumeric</c> in installeren:
</p>

<pre caption="gnumeric installeren">
# <i>emerge gnumeric</i>
</pre>

<p>
Omdat veel applicaties op elkaar steunen, is het heel goed mogelijk dat enkele
andere applicaties ook worden geïnstalleerd. Geen zorgen, Portage kan de
afhankelijkheden prima aan. Als je wil weten wat Portage <e>zou</e> installeren
als je hem vraagt een bepaald pakket te installeren, voeg <c>--pretend</c> toe:
</p>

<pre caption="Doe alsof je gnumeric installeert">
# <i>emerge --pretend gnumeric</i>
</pre>

<p>
Als je Portage vraagt een pakket te installeren, zal hij, indien nodig, de
benodigde broncodes van internet downloaden en standaard opslaan in
<path>/usr/portage/distfiles</path>. Hierna zal hij het pakket uitpakken,
compileren en installeren. Als je wil dat Portage de broncodes alleen downloadt
zonder ze te installeren, voeg de <c>--fetchonly</c> optie toe aan het
<c>emerge</c> commando:
</p>

<pre caption="Alleen de broncodes downloaden voor gnumeric">
# <i>emerge --fetchonly gnumeric</i>
</pre>

</body>
</subsection>
<subsection>
<title>Software verwijderen</title>
<body>

<p>
Als je een softwarepakket van je systeem wil verwijderen, gebruik <c>emerge
--unmerge</c>. Dit vertelt Portage dat hij alle bestanden van dat pakket moet
verwijderen <e>behalve</e> de configuratie bestanden van die applicatie als je
ze gewijzigd hebt na de installatie. De configuratie bestanden laten staan heeft
het voordeel dat je direct verder kunt werken als je besluit het pakket opnieuw
te installeren.
</p>

<p>
Echter, een <brite>grote waarschuwing</brite> is van toepassing: Portage zal
<e>niet</e> controleren of het pakket dat je wil verwijderen vereist is voor
een ander pakket. Het zal echter wel waarschuwen als je een belangrijk pakket
wil verwijderen wat tot gevolg heeft dat je systeem niet meer werkt.
</p>

<pre caption="Gnumeric van het systeem verwijderen">
# <i>emerge --unmerge gnumeric</i>
</pre>

<p>
Als je een pakket van je system verwijdert, blijven de afhankelijkheden van dat
pakket op je systeem geïnstalleerd. Om Portage al deze afhankelijkheden te
laten vinden, kun je <c>emerge</c>'s <c>--depclean</c> functie gebruiken. We
gaan het hier later over hebben.
</p>

</body>
</subsection>
<subsection>
<title>Je systeem updaten</title>
<body>

<p>
Om je systeem in vorm te houden (en niet te vergeten de meest recente
veiligheidsupdates te installeren), dien je je systeem regelmatig te updaten.
Omdat Portage alleen de ebuilds in je Portageboom controleert, dien je eerst
je Portageboom te updaten. Als dat klaar is, kun je je systeem updaten met
<c>emerge --update world</c>:
</p>

<pre caption="Je systeem updaten">
# <i>emerge --update world</i>
</pre>

<p>
Portage zal dan zoeken naar een nieuwere versie van de applicaties die jij hebt
geïnstalleerd. Hij zal echter alleen de versies controleren van de applicaties
die jij specifiek hebt geïnstalleerd - niet de afhankelijkheden. Als je ieder
pakket op je systeem wil updaten, voeg het <c>--deep</c> argument toe:
</p>

<pre caption="Je gehele systeem updaten">
# <i>emerge --update --deep world</i>
</pre>

<p>
Als je een van je <uri link="?part=2&amp;chap=2">USE flags</uri> recent hebt
gewijzigd wil je misschien ook <c>--newuse</c> toevoegen. Portage controleert
dan of er nieuwe pakketten geïnstalleerd moeten worden of hercompilatie van
reeds geïnstalleerde pakketten nodig is:
</p>

<pre caption="Een complete update uitvoeren">
# <i>emerge --update --deep --newuse world</i>
</pre>

</body>
</subsection>
<subsection>
<title>Mini pakketten</title>
<body>

<p>
Sommige pakketten in de Portageboom hebben niet echt inhoud maar worden
gebruikt om een verzameling van pakketten te installeren. Het <c>kde</c> pakket
zal bijvoorbeeld de hele KDE-omgeving op je systeem installeren door
KDE-gerelateerde pakketten als afhankelijkheden op je systeem te installeren.
</p>

<p>
Als je zo'n pakket wil verwijderen, zal <c>emerge --unmerge</c> weinig zin
hebben omdat de afhankelijkheden op je systeem blijven staan.
</p>

<p>
Portage heeft de functionaliteit om ouderloze afhankelijkheden te verwijderen,
maar omdat de beschikbaarheid van software dynamisch afhankelijk is, dien je
eerst je gehele systeem te updaten, inclusief veranderingen die je hebt
doorgevoerd door je USE vlaggen aan te passen. Hierna kun je <c>emerge
--depclean</c> gebruiken om de ouderloze afhankelijkheden te verwijderen. Als
dit klaar is, dien je de applicaties te herbouwen die dynamisch gelinkt zijn
aan de nu verwijderde software titels.
</p>

<p>
Dit gebeurt met de drie volgende commandos:
</p>

<pre caption="Ouderloze afhankelijkheden verwijderen">
# <i>emerge --update --deep --newuse world</i>
# <i>emerge --depclean</i>
# <i>revdep-rebuild</i>
</pre>

<p>
<c>revdep-rebuild</c> wordt geleverd door het <c>gentoolkit</c> pakket; vergeet
deze niet eerst te emergen:
</p>

<pre caption="Het gentoolkit pakket installeren">
# <i>emerge gentoolkit</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Als Portage klaagt ...</title>
<subsection>
<title>Over SLOTs, virtuals, branches, architecturen en profielen</title>
<body>

<p>
Zoals eerder gezegd, Portage is extreem krachtig en ondersteunt veel
mogelijkheden die andere softwarebeheer tools niet hebben. Om dit te begrijpen
zullen we enkele aspecten van Portage uitleggen zonder te diep er op in te gaan.
</p>

<p>
Met Portage kunnen verschillende versies van een enkel pakket gelijktijdig op
het systeem staan. Terwijl andere distributies de gewoonte hebben hun pakketten
te noemen naar de versie (zoals <c>freetype</c> en <c>freetype2</c>) gebruikt
Portage een technologie genaamd <e>SLOT</e>s. Een ebuild stelt een bepaald SLOT
voor zijn versie vast. Ebuilds met verschillende SLOTs kunnen gelijktijdig op
het systeem staan. Het <c>freetype</c> pakket heeft bijvoorbeeld ebuilds met
<c>SLOT="1"</c> en <c>SLOT="2"</c>.
</p>

<p>
Er zijn ook pakketten die dezelfde functionaliteit bieden, maar op een andere
manier geïmplementeerd zijn. <c>metalog</c>, <c>sysklogd</c> en <c>syslog-ng</c>
zijn bijvoorbeeld allemaal systeemloggers. Applicaties die steunen op de
beschikbaarheid van "een systeemlogger" kunnen bijvoorbeeld niet steunen op
<c>metalogd</c> omdat andere systeemloggers net zo goed er op kunnen staan.
Portage staat daarom <e>virtuals</e> toe: iedere systeemlogger biedt
<c>virtual/syslog</c> zodat applicaties op <c>virtual/syslog</c> kunnen steunen.
</p>

<p>
Software in de Portageboom kan in verschillende branches zitten. Standaard
accepteert je systeem alleen pakketten waarvan Gentoo ze stabiel acht. De
meeste nieuwe softwaretitels zitten nadat ze worden toegevoegd in de testing
branch, wat betekent dat er meer getest moet worden voordat ze stabiel worden
bevonden. Hoewel je de ebuilds wel zult zien in de Portageboom, zal Portage ze
niet updaten voordat ze in de stable branch worden gezet.
</p>

<p>
Bepaalde software is alleen beschikbaar voor enkele architecturen. Of de
software werkt niet op andere architecturen of het moet verder getest worden of
de ontwikkelaar die de software in de Portageboom heeft gezet kan niet
controleren of de software op andere architecturen werkt.
</p>

<p>
Iedere Gentoo installatie volgt een bepaald <c>profiel</c> wat, onder andere,
de lijst met voor het systeem noodzakelijke software bevat.
</p>

</body>
</subsection>
<subsection id="blocked">
<title>Blokkerende pakketten</title>
<body>

<pre caption="Portage waarschuwing over blokkerende pakketten (met --pretend)">
[blocks B     ] gnome-base/bonobo-activation (from pkg gnome-base/libbonobo-2.4.0)
</pre>

<pre caption="Portage waarschuwing over blokkerende pakketten (zonder
--pretend)">
!!! Error: the gnome-base/bonobo-activation package conflicts with another package.
!!!        both can't be installed on the same system together.
!!!        Please use 'emerge --pretend' to determine blockers. 
</pre>

<p>
Ebuilds bevatten specifieke velden die Portage vertelt over zijn
afhankelijkheden. Er zijn twee mogelijke afhankelijkheden: bouw
afhankelijkheden, bepaald in <c>DEPEND</c> en run-time (draai) afhankelijkheden,
bepaald in <c>RDEPEND</c>. Als een van deze afhankelijkheden uitdrukkelijk een
pakket of virtual als <e>niet</e> compatibel markeert, volgt er een blokkade.
</p>

<p>
Om een blokkade op te lossen, kun je kiezen om het pakket niet te installeren of
het pakket wat problemen geeft te unmergen. In het gegeven voorbeeld kun je
kiezen om <c>libbonobo</c> niet te installeren of <c>bonobo-activation</c> te
verwijderen.
</p>

</body>
</subsection>
<subsection id="masked">
<title>Verborgen pakketten</title>
<body>

<pre caption="Portage waarschuwing over verborgen pakketten">
!!! all ebuilds that could satisfy "bootsplash" have been masked. 
</pre>

<pre caption="Portage waarschuwing over verborgen pakketten - reden">
!!! possible candidates are:

- gnome-base/gnome-2.8.0_pre1 (masked by: <i>~x86 keyword</i>)
- lm-sensors/lm-sensors-2.8.7 (masked by: <i>-sparc keyword</i>)
- sys-libs/glibc-2.3.4.20040808 (masked by: <i>-* keyword</i>)
- dev-util/cvsd-1.0.2 (masked by: <i>missing keyword</i>)
- media-video/ati-gatos-4.3.0 (masked by: <i>package.mask</i>)
- sys-libs/glibc-2.3.2-r11 (masked by: <i>profile</i>)
</pre>

<p>
Als je een pakket wil installeren dat niet voor jouw systeem beschikbaar is,
zul je een foutmelding zien. Je zou een andere applicatie die wel voor jou
beschikbaar is kunnen installeren of wachten tot het pakket wel voor jou
beschikbaar is. Er is altijd een reden waarom een pakket verborgen is:
</p>

<ul>
  <li>
    <b>~arch keyword</b> betekent dat de applicatie niet voldoende is getest om
    in de stabiele branch gezet te worden. Wacht een paar dagen of weken en
    probeer het opnieuw.
  </li>
  <li>
    <b>-arch keyword</b> of <b>-* keyword</b> betekent dat de applicatie niet
    werkt op jouw architectuur. Als je gelooft dat het pakket prima werkt, vul
    dan een bug in op onze <uri link="http://bugs.gentoo.org">bugzilla</uri>
    website. Doe dit alsjeblieft wel in het Engels.
  </li>
  <li>
    <b>missing keyword</b> betekent dat de applicatie nog niet op jouw
    architectuur is getest. Vraag het architectuur porting team om het te testen
    of test het pakket voor ze en vertel je bevindingen op onze <uri
    link="http://bugs.gentoo.org">bugzilla</uri> website. Ook dit graag in het
    Engels.
  </li>
  <li>
    <b>package.mask</b> betekent dat het pakket corrupt, onstabiel of erger
    bevonden is en daarom met opzet verborgen is, gebruik dit niet.
  </li>
  <li>
    <b>profile</b> betekent dat het pakket niet geschikt bevonden is voor jouw
    profiel. De applicatie kan je systeem breken als je dit installeert of het
    is gewoon niet compatibel met het door jou gebruikte profiel.
  </li>
</ul>

</body>
</subsection>
<subsection id="missingdependencies">
<title>Afwezige afhankelijkheden</title>
<body>

<pre caption="Portage waarschuwing over afwezige afhankelijkheden">
emerge: there are no ebuilds to satisfy "&gt;=sys-devel/gcc-3.4.2-r4".

!!! Problem with ebuild sys-devel/gcc-3.4.2-r4
!!! Possibly a DEPEND/*DEPEND problem. 
</pre>

<p>
De applicatie die je probeert te installeren steunt op een ander pakket die niet
beschikbaar is voor jouw systeem. Controleer <uri
link="http://bugs.gentoo.org">bugzilla</uri> of het bekend is en zo niet, meld
het dan alsjeblieft. Tenzij je branches combineert zou dit niet voor mogen komen
en is dus een bug.
</p>

</body>
</subsection>
<subsection id="ambiguousebuild">
<title>Overkoepelende ebuild naam</title>
<body>

<pre caption="Portage waarschuwing over overkoepelende ebuild namen">
!!! The short ebuild name "aterm" is ambiguous.  Please specify
!!! one of the following fully-qualified ebuild names instead:

    dev-libs/aterm
    x11-terms/aterm
</pre>

<p>
De applicatie die je probeert te installeren heeft een naam die overeenkomt met
meerdere pakketten. Je dient de categorienaam ook op te geven. Portage zal je
meerdere opties geven waaruit je kan kiezen.
</p>

</body>
</subsection>
<subsection id="circulardependencies">
<title>Circulaire afhankelijkheden</title>
<body>

<pre caption="Portage waarschuwing over Circulaire afhankelijkheden">
!!! Error: circular dependencies: 

ebuild / net-print/cups-1.1.15-r2 depends on ebuild / app-text/ghostscript-7.05.3-r1
ebuild / app-text/ghostscript-7.05.3-r1 depends on ebuild / net-print/cups-1.1.15-r2 
</pre>

<p>
Twee (of meer) pakketten die je wil installeren hangen af van elkaar en kunnen
daarom niet geïnstalleerd worden. Dit is zeer waarschijnlijk een fout in de
Portageboom. Sync na een tijdje en probeer het opnieuw. Je kunt ook op <uri
link="http://bugs.gentoo.org">bugzilla</uri> kijken of het een bekend probleem
is, zo niet, vertel het ons dan alsjeblieft. Ook nu weer graag in het Engels.
</p>

</body>
</subsection>
<subsection id="fetchfailed">
<title>Fetch faalde</title>
<body>

<pre caption="Portage waarschuwing over fetch failed">
!!! Fetch failed for sys-libs/ncurses-5.4-r5, continuing...
<comment>(...)</comment>
!!! Some fetch errors were encountered.  Please see above for details.
</pre>

<p>
Portage was niet in staat om de broncodes van de gegeven applicatie te
downloaden en zal (indien mogelijk) proberen door te gaan met andere applicaties
te installeren. Deze fout kan ontstaan doordat een mirror nog niet volledig
gesynchroniseerd is of omdat de ebuild naar de verkeerde locatie verwijst. De
server waar de broncodes staan kan ook om een of andere reden down zijn.
</p>

<p>
Probeer het na een uur opnieuw om te zien of het probleem nog steeds bestaat.
</p>

</body>
</subsection>
<subsection id="profileprotect">
<title>Systeem profiel beveiliging</title>
<body>

<pre caption="Portage waarschuwing over profiel-beveiligde pakketten">
!!! Trying to unmerge package(s) in system profile. 'sys-apps/portage'
!!! This could be damaging to your system.
</pre>

<p>
Je hebt gevraagd om een pakket wat deel uitmaakt van je systeems hoofd pakketten
van je systeem te verwijderen. Het staat in je profiel als noodzakelijk en zou
daarom niet van je systeem verwijderd moeten worden.
</p>

</body>
</subsection>
</section>
</sections>

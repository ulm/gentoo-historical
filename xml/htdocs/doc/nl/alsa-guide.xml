<?xml version='1.0' encoding="iso-8859-1"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<!-- 
  Sync: 1.18
-->

<guide link = "/doc/nl/alsa-guide.xml">
<title>Gentoo Linux ALSA Gebruikersgids</title>
<author title="Author"><mail link="zu@pandora.be">
	Vincent Verleye</mail>
</author>
<author title="Author"><mail link="g2boojum@gentoo.org">
    Grant Goodyear</mail>
</author>
<author title="Author"><mail link="agenkin@gentoo.org">
    Arcady Genkin</mail>
</author>
<author title="Editor"><!-- zhen@gentoo.org -->
	John P. Davis
</author>

<author title="Translator"><mail link="zu@pandora.be">
    Vincent Verleye</mail>
</author>
<author title="Translator">
	<mail link="blubber@gentoo.org">Tiemo Kieft</mail>
</author>

<abstract>
Deze gebruikersgids zal je tonen hoe je het Advanced Linux Sound Architecture 
(ALSA) installeert en configureert in Gentoo Linux. Ter aanvulling van de 
Gentoo Linux Desktop Configuratie Handleiding, moet deze gebruikersgids je 
meer informatie geven omtrend dit onderwerp.
</abstract>

<version>1.3.3</version>
<date>9 Oktober 2003</date>

<chapter>
<title>Introductie</title>
<section>
	<title>Wat is ALSA?</title>
<body>
<p>
De Advanced Linux Sound Architecture (ALSA) is een project om het Linux 
geluidssysteem te verbeteren door grote delen van de code te herschrijven.
De verwachting is dat ALSA zal worden geïntegreerd in de Linux 2.6.x kernel 
(of 3.x.x -- welke eerst komt) zodra het volledig afgewerkt is.
</p>

<p>
ALSA biedt audio en MIDI functionaliteit voor Linux.
</p>
 
<p>
Zoals te vinden is op <uri>http://www.alsa-project.org</uri>, biedt ALSA de 
volgende functionaliteit aan:
<ul><li> Efficiënte ondersteuning van alle types van audio kaarten, van 
goedkope geluidskaarten tot professionele multi-kanaal geluidskaarten.</li>
    <li> Volledig modulaire audio drivers.</li>
    <li> SMP en thread-safe ontwerp.</li>
    <li> User space bibliotheek (alsa-lib) voor het vereenvoudigen van het 
	programmeren van applicaties en om een hoger niveau te bieden van 
	level functionaliteit.</li>
    <li> Ondersteuning voor het oudere OSS API, met binary compatibiliteit 
	voor de meeste OSS programma's.</li> 
</ul>
Er zijn echter nog een aantal noemenswaardige dingen die ALSA speciaal maken, zoals ondersteuning voor het Full Duplex afspelen en opnemen,
ondersteuning voor meerdere geluidskaarten, hardware mixen van streams, uitgebreide mixer mogelijkheden (voor de ondersteuning
van de functies van nieuwe geluidskaarten), ...
</p>
</body>
</section>
<section>
	<title>Waarom ALSA?</title>
<body>
<p>
Als je geluidskaart ondersteund wordt door het Linux kernel geluids systeem of het commerciele OSS/4Front geluids driver systeem,
dat kan gevonden worden in alle 2.4.x Linux kernels, zou je eigenlijk net zo goed <e>deze modules</e> kunnen installeren voor gebruik met jouw geluidskaart.
Als je dit wilt, lees dan de instructies van de <uri link="http://www.tldp.org/HOWTO/Sound-HOWTO/index.html">Linux Sound HOWTO</uri>.
</p> 
<p>
Maar, die OSS/4Front stuurprogramma's hebben enkele beperkingen -- het commercieel aspect is er één van.
ALSA is een poging om deze beperkingen te omzeilen en dit te doen op een Open Source manier.
ALSA is een geluids stuurprogramma systeem dat volledig GPL en LGPL is, en het biedt een professioneel kwaliteits systeem voor het opnemen, afspelen
en MIDI sequencing.
</p> 
</body>
</section>
<section>
	<title>Welke kaarten worden ondersteund door ALSA?</title>
<body>
<p>
ALSA probeert zoveel mogelijk (nieuwe) kaarten te ondersteunen door het aanbieden van open-source stuurprogramma's.
Sommige fabrikanten leveren echter alleen maar stuurprogramma's in binaire vorm.
</p>
<p>Om te weten of jouw geluidskaart ondersteund wordt, kun je hier een Soundcard Matrix vinden met ondersteunde en niet-ondersteunde kaarten: 
<uri>http://www.alsa-project.org/alsa-doc/</uri>.
</p>
</body>
</section>
</chapter>

<chapter>
<title>Installatie</title>
<section>
<title>Gentoo USE vlaggen</title>
<body>

<p>
Om programmas met ALSA ondersteuning te compilen moet je je ervan vergewissen
dat je <e>alsa</e> in je use variabele hebt staan. Echter, sommige 
programmas ondersteunen ALSA niet en hebben OSS nodig, ALSA heeft OSS emulatie
als je <e>oss</e> in je use variabele hebt staan voor je start.
</p>

</body>
</section>

<section>
	<title>Kernel modules</title>
<body>
<p>
Aangezien de meeste onder ons nog altijd de 2.4.x kernel gebruiken, zullen we de kernel modules en de modules van ALSA afzonderlijk moeten compileren. Mensen die een 2.5.x kernel gebruiken kunnen dit doen aan de hand van hun kernel configuratie, aangezien de ALSA modules daar ingesloten zijn bij de kernel sources en daar kunnen worden gebouwd.
</p>
<p>
Eerst moeten we ervoor zorgen dat onze kernel configuratie geschikt is voor het gebruik met ALSA.
Het enige wat je nodig hebt in je kernel configuratie is de Sound Card Support, die moet gebouwd worden als module (M).
Dit zal de module <c>soundcore.o</c> bouwen.
</p>
<p>
<note>
Het is mogelijk dat dit kan werken als je de Sound Card Support rechtstreeks in de kernel (Y) bouwt in plaats van het als module (M) te bouwen.
De officiele ALSA documentatie echter, raadt aan deze als module te bouwen, sinds ALSA zal proberen deze te laden.
</note>
</p>
<p>Als je al een werkende kernel configuratie hebt, zorg er dan voor dat je alle geluids stuurprogramma's uit de kernel configuratie verwijdert (behalve Sound Card Support).
Als je dit wilt doen zonder te moeten rebooten, zou je dit kunnen doen:
</p>
<pre>
# <i>cd /usr/src/linux</i>
# <i>cp .config ~/</i>
# <i>make mrproper</i>
# <i>cp ~/.config .</i>
# <i>make menuconfig</i>
</pre>
<p>
Selecteer nu <e>Sound Card Support</e> als een module (M) en deselecteer alle andere geluids stuurprogramma's.
Verlaat het menu en zeg Y als er gevraagd wordt je kernel configuratie te bewaren.
Bouw hierna de modules:
</p>
<pre>
# <i>make dep clean</i>
# <i>make modules modules_install</i>
</pre>
<p>
Voordat je nieuwe modules worden geïnstalleerd, zal deze laatste lijn al je modules van de vorige configuratie verwijderen, 
inclusief die van een vorige ALSA installatie.
</p>
<p>
<impo>
Dit wil zeggen dat iedere keer je een kernel hercompileert, je <c>alsa-driver</c> ook zal moeten hercompileren.
</impo>
</p>
<p>
<note>Het is echter niet nodig om <c>nvidia-kernel</c> te herinstalleren, de Nvidia stuurprogramma's bevinden zich in een aparte map 
in <path>/lib/modules/*/video</path> en zullen niet worden verwijderd door een <c>make modules modules_install</c>
</note>
</p>
</body>
</section>

<section>
	<title>ALSA modules</title>
<body>

<p>
Nu is het tijd om de ALSA stuurprogramma's te installeren voor jouw geluidskaart(en). Als je geluidskaart PCI is, dan kun je de naam en het type van je geluidskaart
vinden door te kijken naar de uitvoer van /proc/pci.
</p>
<pre>
# <i>grep audio /proc/pci</i>
</pre>

<p>
<warn>
Als je een vorige geluids configuratie had en er zijn nog altijd niet-ALSA geluidsmodules geladen, zorg dan <e>nu</e> voor dat ze niet meer geladen zijn.
Controleer met <c>lsmod</c> en gebruik <c>rmmod</c> om alle geluidsmodules te verwijderen uit het actief geheugen.
</warn>
</p>

<p>
Nu zouden we simpelweg een <c>emerge alsa-driver</c> kunnen doen, dit zou <e>alle</e> ALSA geluids stuurprogramma's compileren en installeren.
</p>
<p>
Om echter wat tijd te sparen, kun je de <e>Module Naam</e> van je geluidskaart(en) opzoeken op de
<uri link="http://www.alsa-project.org/alsa-doc">ALSA Soundcard Matrix</uri> door de <e>Details</e> link te volgen in de <e>Driver en Docs</e> kolom in de rij van de chipset van jouw geluidskaart.
De mijne is <c>snd-emu10k1</c>, aangezien ik een SBlive! geluidskaart heb, met chipset <e>EMU10K1</e>.
We zullen nu de ALSA_CARDS environment waarde zetten naar deze module naam voor het emergen (maar zonder het snd voorvoegsel), zodat emerge alleen de stuurprogramma's zal compileren voor de kaarten die we nodig hebben.
</p>

<pre>
# <i>env ALSA_CARDS='emu10k1' emerge alsa-driver</i> 
</pre>


<note>
Je kunt deze waarde ook toevoegen in <path>/etc/make.conf</path>, zodat je bij een volgende herinstallatie van de alsa-driver gewoon <c>emerge alsa-driver</c> kunt typen. Je kunt dit bijvoorbeeld zo doen: <c>echo 'ALSA_CARDS="emu10k1"' >> /etc/make.conf</c>
</note>

<note>
Wanneer je ALSA stuurprogramma's wilt installeren voor meer dan één geluidskaart, kun je de ALSA_CARDS waarde zetten op 
een lijst van stuurprogramma's, gescheiden door spaties: 
<c>env ALSA_CARDS='emu10k1 intel8x0 ens1370' emerge alsa-driver</c>
</note>

<note>Als je OSS compabiliteit wilt, zorg er dan voor dat je een emerge doet van <i>alsa-oss</i>, dit is de ALSA/OSS compatibiliteits
wrapper. </note>

<note>
Als je van plan bent om je kernel meerdere malen opnieuw te compilen, dan is
het handig om <c>alsa-driver</c> met <c>--buildpkg</c> te emergen. Zo worden
de binaries opgeslagen, zodat je de driver niet telkens opnieuw hoeft te 
compilen. Als je je kernel opnieuw gecompiled hebt doe je simpelweg
<c>emerge --usepkg alsa-driver</c> om de binary drivers opnieuw te installeren.
</note>

<p>
Hierna, zouden de ALSA modules geïnstalleerd moeten zijn op je systeem.
</p>
</body>
</section>
<section>
	<title>Configuratie van ALSA</title>
<body>
<p>
Laten we nu beginnen met het configureren, zodat we ALSA kunnen doen werken zoals het hoort.
We zullen enkele bestanden moeten bewerken, zodat ons systeem weet dat de vers geïnstalleerde ALSA modules aanwezig zijn.
</p>

<p>Ten eerst heb je <c>alsa-utils</c> nodig op je computer:\</p>

<pre caption="alsa-utils emergen">
# <i>emerge alsa-utils</i>
</pre>

<p>Vervolgens moet je <path>/etc/modules.d/alsa</path> aanpassen.</p>

<warn>
Het is niet nodig om <path>/etc/modules.conf</path> met de hand te bewerken. In plaats hiervan, bewerk altijd de bestanden in <path>/etc/modules.d</path>.
</warn>
<p>
Controleer de ALSA sectie <e>aan het einde van het bestand</e>.
Door het aanpassen van deze regel kun je het maximum aantal geluidskaarten aanpassen dat je hebt (in het algemeen is dit één, en is hier dus geen aanpassing nodig).
</p>
<p>
<pre caption="Aan het einde van /etc/modules.d/alsa">
<comment>Zet dit op het juiste aantal geluidskaarten aanwezig.</comment>
options snd cards_limit=1
</pre>
</p>
<p>
Nu zullen we aanduiden welke geluids stuurprogramma's ALSA moet gebruiken. In hetzelfde bestand, pas aan als volgt:
<pre caption="In /etc/modules.d/alsa">
## and then run `modules.update' command.
## Read alsa-driver's INSTALL file in /usr/share/doc for more info.
##
##  ALSA portion
alias snd-card-0 snd-emu10k1
<comment>Als je meer dan één geluidskaart hebt, voeg dan toe als volgt:</comment>
## alias snd-card-1 snd-intel8x0
## alias snd-card-2 snd-ens1370
##  OSS/Free portion
## alias sound-slot-0 snd-card-0
## alias sound-slot-1 snd-card-1
##
</pre>
</p>
<p>
<note>
Als je meer dan één geluidskaart hebt, pas dan de <c>cards_limit</c> waarde aan en voeg meer snd-card aliassen toe aan het bestand.
Ik heb hier zelf geen ervaring mee, maar je kunt voorbeelden van configuraties vinden met twee of meer geluidskaarten in
<uri link="http://www.alsa-project.org/alsa-doc/alsa-howto/c1660.htm">Hoofdstuk 6</uri>
van de <uri link="http://www.alsa-project.org/alsa-doc/alsa-howto/alsa-howto.html">ALSA Howto</uri>.
</note>
</p>
<p>
Het laatste wat we moeten doen in dit bestand, bijna op het einde, is controleren of deze regels niet in commentaar staan:
<pre caption="Op het einde van /etc/modules.d/alsa">
alias /dev/mixer snd-mixer-oss
alias /dev/dsp snd-pcm-oss
alias /dev/midi snd-seq-oss
</pre>
</p>
<p>
Controleer nu nog eens het bestand <path>/etc/modules.d/alsa</path> en als je er zeker van bent dat alles ok is, voer dan <c>modules-update</c> uit.
<pre>
# <i>modules-update</i>
</pre>
</p>
<note>
Het uitvoeren van <c>modules-update</c> op dit punt zal de gegevens van in <path>/etc/modules.d/alsa</path> toevoegen aan het bestand <path>/etc/modules.conf</path>
</note>
<p>
We moeten ook controleren of in /etc/devfsd.conf de alsa apparaten en permissies correct geregistreerd staan.
</p>
<pre caption="/etc/devfsd.conf">
# ALSA/OSS stuff
# Comment/change these if you want to change the permissions on
# the audio devices
LOOKUP          snd          MODLOAD ACTION snd
LOOKUP          dsp          MODLOAD
LOOKUP          mixer        MODLOAD
LOOKUP          midi         MODLOAD
REGISTER        sound/.*     PERMISSIONS root.audio 660
REGISTER        snd/.*       PERMISSIONS root.audio 660
</pre>
<note>
Let er op dat devfsd.conf de permissies van /dev/sound op root.audio zet. Dus, voor niet-root gebruikers is het nodig dat zij deel uitmaken van de audio
groep om audio te gebruiken.
</note>
</body>
</section>
</chapter>
<chapter>
<title>Het opstarten van ALSA</title>
<section>
	<title>Het toevoegen van ALSA aan een runlevel</title>
<body>
<p>
Het eerste wat we nu moeten doen, is zorgen dat ALSA wordt opgestart tijdens het booten van ons Gentoo Linux systeem. We doen dit zo:
<pre>
# <i>rc-update add alsasound boot</i>
</pre>
</p>
<p>
<warn>Let er op dat het alsasound script moet worden toegevoegd aan het "boot" runlevel, niet het "default" runlevel.</warn>
</p>
</body>
</section>
<section>
	<title>Starten en het regelen van de gedempte kanalen.</title>
<body>
<p>
Aangezien we Linux gebruikers zijn, willen we liever de computer niet herstarten. Dus zullen we het alsasound script manueel starten.
</p>
<pre>
# <i>/etc/init.d/alsasound start</i>
</pre>
<p>
ALSA is nu opgestart. Als alles gaat zoals het moet, zouden nu de ALSA modules geladen moeten zijn, controleer dit met het commando <c>lsmod</c>.
Het geluid zal echter nog niet werken, want de kanalen zijn nog 
altijd gedempt. We gebruiken hiervoor <c>amixer</c>. 
</p>
<pre caption="amixer draaien">
# <i>amixer</i>
</pre>
<p>
<warn>
Je zou dit niet moeten krijgen, maar <e>als</e> je een foutboodschap krijgt zoals "amixer: Mixer attach default error: No such file or directory", dan moet je
manueel <c>snd-mixer-oss</c> en <c>snd-pcm-oss</c> laden door middel van het <c>modprobe</c> commando. Je moet dit slechts eenmaal doen. Voer hierna weer amixer uit.
</warn>
</p>
<pre caption="enkel als je een fout krijgt als je amixer voor het eerst uitvoert">
# <i>modprobe snd-mixer-oss</i>
# <i>modprobe snd-pcm-oss</i>
# <i>amixer</i>
</pre>
<p>
Als je zover gekomen bent, kunnen we nu zowel de Master en PCM channels 
regelen zodat ze niet meer gedempt zijn. Sommige hardware vereist dat ook het
Center kanaal en het Surround kanaal ongedempt worden.
</p>
<p>
<pre>
# <i>amixer set Master 100 unmute</i>
# <i>amixer set PCM 100 unmute</i>

<comment>Alleen als het bovenstaande niet werkt</comment>

# <i>amixer set Center 100 unmute</i>
# <i>amixer set Surround 100 unmute</i>
<comment>Test het geluid</comment>
# <i>aplay $KDEDIR/share/sounds/pop.wav</i> <comment>(pop.wav maakt deel uit van KDE)</comment>
</pre>
</p>
We controleren of het geluid werkt door gebruik te maken van het commando aplay (alsa play). Als je een pop geluidje hoort, dan werkt het geluidsysteem inderdaad.
Regel hierna de geluids niveau's naar eigen smaak; het ncurses-gebaseerde <c>alsamixer</c> is een zeer goede manier om de kanalen te krijgen zoals je het echt wilt.
<p>
Je kunt hierna beginnen met het emergen van <c>alsa-xmms</c> wat ALSA functionaliteit biedt voor XMMS.
</p>
Als je je systeem herstart, zal het <e>alsasound</e> init script de geluids niveau's correct opslaan en opnieuw instellen.
</body>
</section>
</chapter>
<chapter>
<title>Nog enkele notities</title>
<section>
	<title>Wat te doen na het upgraden van de kernel..</title>
<body>
<p>Wanneer je ooit je kernel opnieuw bouwt, of een upgrade doet naar een andere kernel, moet je de ALSA modules herbouwen (als je met een 2.4.x kernel werkt, dit is niet zo bij 2.5.x kernels).</p>
<p>Alhoewel je misschien de <c>alsa-driver</c>, <c>alsa-libs</c> en <c>alsa-utils</c> geïnstalleerd hebt, moet je enkel die eerste opnieuw emergen, aangezien dit de modules zal plaatsen in
<path>/lib/modules/*/kernel/sound/pci/</path>.</p>
<pre caption="nodig na iedere kernel hercompilatie">
# <i>emerge alsa-driver</i>
</pre>
</body>
</section>
<section>
	<title>/etc/modules.autoload.d/kernel-2.4</title>
<body>
<p>
Je zult dit bestand nooit moeten aanpassen voor het gebruik met ALSA. Na onze <c>rc-update add alsasound boot</c> zal ons systeem
de correcte ALSA modules laden tijdens het opstarten.</p>
<p>Het is overbodig om <c>snd-pcm-oss</c> of <c>snd-mixer-oss</c> toe te voegen in dit bestand.
Lees hierover <uri link="http://www.djcj.org/LAU/guide/alsbook/faq1.html">deze FAQ</uri> even na voor meer informatie.</p>
</body>
</section>

<section>
<title>Bekende bugs</title>
<body>

<note>
Deze handleiding loopt achter op de alsa-ontwikkeling. De kans is er dat deze
bugs al zijn opgelost op het moment van lezen.
</note>

<ul>
  <li>Als je <b>veel herrie</b> hoort tijdens het gebruik van <b>oss</b> 
  emulatie, voeg dan de <e>options snd-pcm-oss dsp_map=1</e> toe aan
  <path>/etc/modules.d/alsa</path></li>
</ul>

</body>
</section>

<section>
	<title>Meer links..</title>
<body>
<p>
Deze webpagina's kan je raadplegen als je meer informatie wilt:
</p>
<p>
<ul>
<li><uri link="http://www.gentoo.org/doc/nl/desktop.xml">Gentoo Linux Desktop Configuratie Handleiding</uri></li>
<li><uri link="http://www.alsa-project.org">ALSA Project Homepagina</uri></li>
<li><uri link="http://www.alsa-project.org/documentation.php3">ALSA Gebruikers Documentatie</uri></li>
<li><uri link="http://www.djcj.org">ALSA Howto's en FAQ's</uri></li>
<li><uri link="http://tldp.org/HOWTO/Sound-HOWTO/index.html">Linux Sound HOWTO</uri></li>
<li><uri link="http://linux-sound.org/">Sound en MIDI Software voor Linux</uri></li>
</ul>
</p>
</body>
</section>
</chapter>
</guide>

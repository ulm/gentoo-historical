<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: dri-howto.xml,v 1.1 2006/10/16 10:52:24 neysx Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/id/dri-howto.xml" lang="id">

<title>Panduan Akselerasi 3D Hardware</title>

<author title="Author">
  <mail link="dberkholz@gentoo.org">Donnie Berkholz</mail>
</author>
<author title="Editor">
  <mail link="peesh@gentoo.org">Jorge Paulo</mail>
</author>
<author title="Translator">
  <mail link="kucrut.dz@gmail.com">Dzikri Aziz</mail>
</author>

<abstract>
Dokumen ini merupakan panduan untuk mendapatkan akselerasi 3D menggunakan
X11-DRM dengan Xorg di Gentoo Linux.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>1.6</version>
<date>2006-10-10</date>

<chapter>
<title>Pendahuluan</title>
<section>
<title>Apa itu akselerasi 3D hardware dan mengapa saya menginginkannya?</title>
<body>

<p>
Dengan akselerasi 3D hardware, render tiga dimensi menggunakan prosesor grafis
dari kartu video anda, bukan menggunakan CPU. Hal ini juga biasa disebut dengan
"akselerasi hardware" yang bertolak belakang dengan "akselerasi software" yang
memaksa CPU anda untuk menghasilkan gambar dengan menggunakan librari render
Mesa, yang cukup banyak memakan kekuatan prosesor. Walaupun pada dasarnya Xorg
mendukung akselerasi hardware 2D, Xorg tidak memiliki dukungan akselerasi
3D hardware. Akselerasi 3D hardware sangat bernilai pada situasi yang
membutuhkan render objek 3D seperti game, CAD 3D dan modeling.
</p>

</body>
</section>
<section>
<title>Bagaimana cara mendapatkan akselerasi 3D hardware?</title>
<body>

<p>
Pada kebanyakan kasus, tersedia driver binari dan open source. Driver open
source lebih diutamakan karena kita sedang menggunakan Linux dan open source
merupakan salah satu prinsip utamanya. Terkadang, driver binari merupakan
satu-satunya pilihan yang tersedia, seperti untuk kartu nVidia. Tersedia
driver binari x11-drivers/nvidia-drivers dan x11-drivers/nvidia-legacy-drivers
untuk kartu nVidia, dan media-video/ati-drivers untuk kartu ATi. Driver open
source lain yang tersedia adalah media-video/kyro-kernel untuk kartu KyroII,
dan media-video/ati-gatos untuk kartu ATi, yang diciptakan untuk lebih
mendukung kemampuan kartu ATi.
</p>

</body>
</section>
<section>
<title>Apa itu DRI?</title>
<body>

<p>
<uri link="http://dri.freedesktop.org/wiki/">Direct Rendering
Infrastructure</uri>, juga dikenal dengan DRI, merupakan framework untuk
mendapatkan akses langsung ke hardware grafis dengan cara yang aman dan
efisien. Hal ini termasuk juga perubahan pada server X, beberapa librari klien
dan kernel. Penggunaan utama dari DRI adalah untuk menciptakan implementasi
OpenGL yang cepat.
</p>

</body>
</section>
<section>
<title>Apa itu X11-DRM dan apa hubungannya dengan Xorg biasa?</title>
<body>

<p>
X11-DRM merupakan sebuah <c>peningkatan</c> pada Xorg yang menambahkan
akselerasi 3D pada kartu grafis dengan menambahkan modul kernel yang
diperlukan untuk direct rendering.
</p>

</body>
</section>
<section>
<title>Tujuan</title>
<body>

<p>
Panduan ini diperuntukkan bagi pengguna yang tidak bisa mendapatkan render
langsung hanya dengan Xorg. X11-DRM dapat digunakan untuk driver 3dfx, gamma,
i8x0, matrox, rage128, radeon, mach64 dan sis300. Pemilik kartu VIA tidak
boleh menggunakan <c>x11-drm</c>, tetapi DRI yang disediakan oleh kernel-kernel
baru (&gt;2.6.13). Baca <uri link="http://dri.freedesktop.org/">website
DRI </uri> untuk info dan dokumentasi lebih lanjut.
</p>

</body>
</section>
<section>
<title>Feedback</title>
<body>

<p>
Saran, pertanyaan, dll, silakan kirimkan email ke <mail
link="dberkholz@gentoo.org">Donnie Berkholz</mail>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Instal Xorg dan konfigurasi kernel</title>
<section>
<title>Instal Xorg</title>
<body>

<p>
Silakan ikuti <uri link="/doc/id/xorg-config.xml">Panduan Konfigurasi
Xorg</uri> kami untuk menginstal Xorg.
</p>

</body>
</section>
<section>
<title>Konfigurasi kernel</title>
<body>

<p>
Temukan jenis chipset anda dan aktifkan dukungan hanya untuk chipset tersebut.
</p>

<pre caption="Memeriksa chipset AGP">
# <i>emerge pciutils; lspci | grep AGP</i>
# <i>00:01.0 PCI bridge: Intel Corp. 440BX/ZX/DX - 82443BX/ZX/DX AGP bridge (rev 03)</i>
<comment>(Output anda mungkin tidak sama dengan contoh di atas jika berbeda hardware.)</comment>
</pre>

<p>
Jika chipset anda tidak didukung oleh kernel, anda mungkin dapat menambahkan
<c>agp=try_unsupported</c> sebagai parameter kernel. Opsi ini akan menggunakan
rutin umum Intel untuk dukungan AGP. Untuk menambahkan opsi ini, edit file
konfigurasi bootloader anda.
</p>

<p>
Hampir semua kernel mendukung opsi ini. Contoh ini menggunakan
gentoo-sources-2.4.20-r5.
</p>

<pre caption="Konfigurasi kernel">
# <i>ls -l /usr/src/linux </i>
lrwxrwxrwx    1 root     root           22 May 29 18:20 /usr/src/linux -> linux-2.4.20-gentoo-r5
<comment>(Pastikan agar /usr/src/linux menunjuk kernel kernel anda saat ini.)</comment>
# <i>cd /usr/src/linux</i>
# <i>make menuconfig</i>
</pre>

<pre caption="Opsi-opsi make menuconfig">
Processor type and features ---&gt;
&lt;*&gt; MTRR (Memory Type Range Register) support
Character devices ---&gt;
&lt;M&gt; /dev/agpgart (AGP Support)
[M] Intel 440LX/BX/GX and I815/I820/I830M/I830MP/I840/I845/I850/I860 support
<comment>(Aktifkan dukungan untuk chipset anda.)</comment>
&lt; &gt; Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)
</pre>

<p>
Pastikan agar Direct Rendering Manager (DRM) <e>off</e>. Paket X11-DRM
akan menyediakannya untuk anda.
</p>

</body>
</section>
<section>
<title>Kompilasi dan instalasi kernel</title>
<body>

<pre caption="Kompilasi dan instalasi kernel">
<comment>(Contoh ini untuk kernel 2.4)</comment>
# <i>make dep &amp;&amp; make clean bzImage modules modules_install</i>
# <i>mount /boot</i>
# <i>cp arch/i386/boot/bzImage /boot</i>
</pre>

<p>
Jika anda tidak ingin menamakan kernel anda bzImage, pastikan untuk menyalinnya
ke /boot/namakernel. Jangan lupa untuk men-setup grub.conf atau lilo.conf lalu
jalankan /sbin/lilo jika anda menggunakan LILO.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Instal dan konfigurasi X11-DRM untuk direct rendering</title>
<section>
<title>Instal X11-DRM</title>
<body>

<pre caption="Instalasi X11-DRM">
# <i>emerge x11-drm</i>
</pre>

</body>
</section>
<section id="configure_xorg">
<title>Konfigurasi Xorg.conf</title>
<body>

<p>
Beberapa chipset mengharuskan anda untuk membangun ulang <c>xorg-x11</c>
dengan <c>USE="insecure-drivers"</c>. Hal ini berlaku untuk chipset mach64,
unichrome, dan savage pada xorg-x11-6.8.2, dan untuk mach64 serta unichrome
pada xorg-x11-6.8.99.x. Pengguna savage tidak boleh menggunakan
xorg-x11-6.8.99.x karena dukungan untuk savage pada versi ini tidak berfungsi.
</p>

<pre caption="Bangun ulang xorg-x11">
<comment>(Tambahkan flag USE insecure-drivers jika anda menggunakan salah satu
chipset yang disebutkan)</comment>
# <i>echo "x11-base/xorg-x11 insecure-drivers" &gt;&gt; /etc/portage/package.use</i>

# <i>emerge xorg-x11</i>
</pre>

<p>
Buka <path>/etc/X11/xorg.conf</path> dengan editor kesukaan anda lalu edit
untuk mengaktifkan DRI dan GLX
</p>

<pre caption="xorg.conf">
...
Section "Module"
  Load "dri"
  Load "glx"
  ...
EndSection
...
Section "Device"
  Driver "radeon"
  ...
EndSection
...
Section "dri"
  Mode 0666
EndSection
</pre>

<p>
Jika anda menggunakan driver lain, gantikan "radeon" dengan driver anda.
</p>

</body>
</section>
<section>
<title>Perubahan pada modules.autoload.d</title>
<body>

<p>
Anda perlu menambahkan nama modul yang digunakan oleh kartu grafis anda di
<path>/etc/modules.autoload.d/kernel-2.6</path> untuk memastikan agar modul
tersebut di-load secara otomatis ketika sistem anda dinyalakan.
</p>

<pre caption="Edit /etc/modules.autoload.d/kernel-2.6">
<comment>(Ganti nama modul sesuai kebutuhan anda.)</comment>
intel-agp
</pre>

<note>
Jika anda mengkompilasi <c>agpgart</c> sebagai modul, anda juga perlu
menambahkannya di <path>/etc/modules.autoload.d/kernel-2.6</path>.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Menguji akselerasi 3D</title>
<section>
<title>Reboot ke kernel baru</title>
<body>

<p>
Reboot komputer anda agar menggunakan kernel baru dan login sebagai user biasa.
Saatnya untuk melihat apakah anda telah mendapatkan direct rendering dan se-bagus
apakah hasilnya.
</p>

<pre caption="Menguji rendering">
$ <i>startx</i>
<comment>(Anda tidak perlu me-load module untuk driver atau agpgart anda, walaupun
jika anda telah mengkompilasinya sebagai modul.)</comment>
<comment>(Semuanya akan di-load secara otomatis.)</comment>
$ <i>glxinfo | grep rendering</i>
direct rendering: Yes
<comment>(Jika outputnya "No", berarti anda tidak memiliki akselerasi 3D.)</comment>
$ <i>glxgears</i>
<comment>(Uji frames per second (FPS) anda pada ukuran default. Hasilnya harus)</comment>
<comment>(lebih besar dari sebelum instalasi x11-drm. Lakukan ini ketika CPU sedang idle.)</comment>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Menggunakan source dari CVS</title>
<section>
<body>

<warn>
Jangan lakukan ini jika paket diatas telah berfungsi dengan baik.
</warn>

</body>
</section>
<section>
<title>Apakah anda membutuhkan CVS?</title>
<body>

<p>
Pertama, periksa apakah paket x1-drm telah berfungsi. Jika tidak dan anda
telah memeriksa log anda untuk memastikan bahwa hal ini tidak disebabkan
oleh konfigurasi yang salah, maka anda perlu mempertimbangkan untuk menggunakan
source dari CVS. Terdapat juga snapshot harian jika anda tidak ingin
menggunakan full CVS.
</p>

</body>
</section>
<section>
<title>Apakah source CVS mendukung kartu anda?</title>
<body>

<p>
Periksa <uri link="http://dri.freedesktop.org/wiki/Status">daftar kartu yang
didukung</uri> DRI untuk mengetahui apakah CVS mendukung kartu anda. Jika
tidak, tetapi CVS mendukung kartu yang mirip, coba saja.
</p>

<!-- I see a couple of 8x AGP stuff on the Internet about vanilla 2.4 kernels;
     is this now available or not? I've commented it out for the time being,
     hoping that this doesn't affect us :)

<warn>
"Linux 2.4 doesn't support agp 8x, so I had to go find a backport. The backport
works .... it doesn't patch quite properly, and it requires 2.4.21 (I've only
gotten it to work with vanilla, straight from the tarball (not ebuild)). First
go get the 2.4.20-2.4.21 patch from kernel.org .... (then get the patch,) It
was on a mailing list somewhere. It doesn't patch cleanly - - one file fails,
the pci_ids.h file, but if you actually read the file and the reject list, it's
very easy to fix. But it does load, and it gives me 1600x1200 with video
(although a bit slow b/c of lack of dga) with xfree-drm." (SanityInAnarchy on
#gentoo)
</warn>

<impo>
The patch is a little tricky to work with but <uri
link="http://www.ussg.iu.edu/hypermail/linux/kernel/0302.2/att-1618/01-agp3.diff.bz2">here's
the link</uri>. If you can disable 8X AGP in your BIOS, change it to 4X and you
may not need the patch.
</impo>
-->

</body>
</section>
<section>
<title>Ikuti petunjuk-petunjuk CVS</title>
<body>

<p>
Proyek DRI memiliki dokumen tentang cara mengkompilasi source CVS. Silakan baca
<uri link="http://dri.freedesktop.org/wiki/Building">dokumen</uri> tersebut dan
ikuti petunjuk-petunjuknya sampai ke bagian <e>instalasi Xorg</e>.
</p>

</body>
</section>
<section>
<title>Instal CVS</title>
<body>

<p>
Periksa apakah modul kernel DRI untuk sistem anda telah dibangun:
</p>

<pre caption="Pemeriksaan">
# <i>cd ~/DRI-CVS/build/xc/programs/Xserver/hw/xfree86/os-support/linux/drm/kernel; ls</i>
</pre>

<p>
Untuk 3dfx Voodoo, anda seharusnya melihat <path>tdfx.o</path>. Untuk Matrox
G200/G400, anda seharusnya melihat <path>mga.o</path>. Untuk ATI Rage 128,
anda seharusnya melihat <path>r128.o</path>. Untuk ATI Radeon, anda seharusnya
melihat <path>radeon.o</path>. Untuk Intel i810, anda seharusnya melihat
<path>i810.o</path>. Jika modul kernel DRI gagal dibangun, anda harus memeriksa
apakah anda menggunakan versi kernel Linux yang sesuai. Kernel terbaru tidak
selalu didukung.
</p>

<p>
Timpa instalasi X.org anda. Anda mungkin ingin mem-backup xorg-x11.
</p>

<pre caption="Backup Xorg">
# <i>quickpkg xorg-x11</i>
<comment>(Perintah ini akan mem-backup paket xorg-x11.)</comment>
# <i>make install</i>
</pre>

<p>
Ikuti seksi "Konfigurasi Xorg" di atas.
</p>

<p>
Untuk me-load modul DRM yang diperlukan di kernel yang sedang anda gunakan,
salin modul kernel ke <path>/lib/modules/`uname -r`/kernel/drivers/char/drm/</path>
lalu jalankan <c>modules-update</c> kemudian restart server X anda. Jika anda
tidak sedang menggunakan kernel yang akan anda berikan modul tersebut, gunakan
nama kernel.
</p>

<warn>
Pastikan agar anda telah meng-unload modul kernel DRI lama yang mungkin telah
di-load. Perlu dicatat bahwa beberapa modul DRM mengharuskan modul agpgart
untuk di-load terlebih dahulu.
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Tweak performa</title>
<section>
<title>Dapatkan hasil maksimal dari direct rendering</title>
<body>

<p>
Beberapa opsi mungkin akan meningkatkan performa sampai 30 persen (atau lebih)
dari default. Set opsi-opsi ini di <path>/etc/X11/xorg.conf</path>. Tetapi,
sebelumnya anda mungkin perlu memeriksa apakah motherboard dan kartu grafis
anda  mendukung opsi-opsi ini.
</p>

<p>
Pertama, mari kita periksa apakah kartu anda dapat mendukung "fast writes".
Kita akan melakukannya dengan memeriksa output dari <c>lspci</c>. Kita akan
mencari informasi "VGA compatible controller".
</p>

<pre caption="Pemeriksaan kartu video">
# <i>lspci -vv</i>
01:00.0 VGA compatible controller: ATI Technologies Inc Radeon Mobility M6 LY (prog-if 00 [VGA])
. . .
Capabilities: [58] AGP version 2.0
    Status: RQ=48 Iso- ArqSz=0 Cal=0 SBA+ ITACoh- GART64- HTrans- 64bit- FW+ AGP3- Rate=x1,x2,x4
</pre>

<p>
Dari banyak informasi yang dihasilkan, kita hanya mencari <b>FW</b> di subseksi
"Status" dari seksi "Capabilities" AGP. Jika terdapat <b>FW+</b> pada baris
"Status", berarti kartu anda mendukung fast writes. Kita sekarang akan
memeriksa apakah motherboard anda mendukung fast writes.
</p>

<impo>
Jika anda tidak melihat <b>FW+</b>, tetapi <b>FW-</b>, anda tidak dapat
mengaktifkan fast writes di <path>xorg.conf</path>. Kartu anda tidak
mendukung fast writes.
</impo>

<p>
Sekarang mari kita pastikan apakah motherboard juga mendukung fast writes.
Sekarang, perhatikan seksi "Host bridge" pada output <c>lspci</c> anda.
</p>

<pre caption="Pemeriksaan motherboard">
# <i>lspci -vv</i>
00:00.0 Host bridge: Intel Corporation 82830 830 Chipset Host Bridge (rev 02)
. . .
Capabilities: [a0] AGP version 2.0
    Status: RQ=32 Iso- ArqSz=0 Cal=0 SBA+ ITACoh- GART64- HTrans- 64bit- FW+ AGP3- Rate=x1,x2,x4
</pre>

<p>
Lagi-lagi, periksa subseksi "Status" dari seksi "Capabilities" AGP anda. Cari
<b>FW</b>. Jika anda melihat <b>FW+</b>, berarti motherboard anda mendukung
fast writes.
</p>

<impo>
Ingat, kedua informasi dari kartu video dan motherboard anda harus menunjukkan
kapabilitas <b>FW</b> yang sama. Jika salah satunya menunjukkan <b>FW-</b> di
"Status", anda tidak dapat mengaktifkan fast writes di <path>xorg.conf</path>.
</impo>

<p>
Dengan anggapan semuanya telah berjalan dengan baik dan motherboard serta kartu
video anda mendukung fast writes, mari kita aktifkan opsi ini di
<path>/etc/X11/xorg.conf</path> dan mendapatkan performa terbaik dari hardware
anda.
</p>

<pre caption="xorg.conf">
Section "Device"
  Option     "AGPMode" "4"
  <comment>(Opsi ini meningkatkan FPS dari 609 ke 618.)</comment>
  Option     "AGPFastWrite" "True"
  <comment>(Opsi ini tidak memiliki efek yang dapat diukur, tetapi mungkin dapat menjadikan komputer anda kurang stabil.)</comment>
  <comment>(Anda juga mungkin perlu mengaktifkan opsi ini di BIOS.)</comment>
  Option     "EnablePageFlip" "True"
  <comment>(Opsi ini meningkatkan FPS dari 618 ke 702. Juga agak beresiko, tetapi hanya sedikit pengguna yang mendapatkan masalah.)</comment>
  ...
EndSection
</pre>

<warn>
Mengaktifkan <c>AGPFastWrite</c> pada chipset VIA kemungkinan besar akan
mengakibatkan komputer anda mengalami lock up. Chipset VIA tidak bisa berfungsi
baik dengan fast writes, jadi gunakan opsi ini dengan resiko sendiri.
</warn>

<note>
Ingat, jika anda ingin agar fast write berfungsi dengan benar, anda juga perlu
mengaktifkan opsi ini di BIOS.
</note>

<p>
Jika anda masih ingin mengeset fitur yang lain, silakan baca <uri
link="http://dri.freedesktop.org/wiki/FeatureMatrix">matriks fitur</uri> di
website DRI atau <uri
link="http://dri.sourceforge.net/doc/dri_driver_features.phtml">daftar
fitur</uri> di Sourceforge.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Pemecahan masalah</title>
<section>
<title>Tidak berfungsi. Saya baru saja mengkompilasi ulang kernel atau berpindah ke kernel baru.</title>
<body>

<p>
kapanpun anda mengkompilasi ulang kernel anda atau berpindah ke kernel lain,
anda perlu membangun ulang modul kernel. Anda tidak perlu membangun ulang
xorg-x11, tetapi anda perlu meng-emerge ulang x11-drm.
</p>

</body>
</section>

<section>
<title>Tidak berfungsi. Saya tidak memiliki rendering, dan tidak tahu sebabnya.</title>
<body>

<p>
Cobalah <c>insmod radeon</c> sebelum anda menjalankan server X. Juga, cobalah
untuk membangun ulang agpgart di dalam kernel, bukan sebagai modul.
</p>

</body>
</section>
<section>
<title>
  Ketika saya menjalankan startx, saya mendapatkan error ini:
  "[drm] failed to load kernel module agpgart"
</title>
<body>

<p>
Hal ini terjadi karena anda mengkompilasi agpgart di dalam kernel, bukan
sebagai modul. Biarkan saja, kecuali jika anda mendapatkan masalah.
</p>

</body>
</section>
<section>
<title>
  Direct rendering tidak berfungsi, dan di /var/log/Xorg.0.log saya mendapatkan
  error tentang versi driver yang terlalu rendah.
</title>
<body>

<p>
Anda tidak sedang menggunakan driver dari x11-drm. Periksa apakah anda telah
mengkompilasi DRM dan driver di dalam kernel; anda seharusnya tidak melakukan
ini.
</p>

</body>
</section>
<section>
<title>Saya memiliki Radeon, dan saya menginginkan TV-Out.</title>
<body>

<p>
Gunakan driver ati-gatos. <c>emerge -s gatos</c>.
</p>

</body>
</section>
<section>
<title>Tidak berfungsi. Kartu video saya masih sangat baru dan masih belum didukung.</title>
<body>

<p>
Coba gunakan driver binari. Untuk ati-drivers, terdapat sebuah daftar di
<uri>http://www.schneider-digital.de/html/download_ati.php</uri>. Jika masih
belum didukung juga, gunakan fbdev. Memang lambat, tetapi bisa berfungsi :)
</p>

</body>
</section>
<section>
<title>saya memiliki kartu video PCI dan tidak bisa berfungsi. Tolong!</title>
<body>

<p>
Pada seksi "Device" aktifkan ForcePCIMode.
</p>

<pre caption="Mengaktifkan ForcePCIMode">
Option "ForcePCIMode" "True"
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Ucapan Terima Kasih</title>
<section>
<body>

<ol>
  <li>
    Christopher Webber atas sarannya untuk menambahkan pertanyaan tentang
    mengganti atau mengkompilasi ulang kernel pada seksi pemecahan masalah.
  </li>
  <li>
    Steve, atas sarannya tentang penggunaan huruf yang konsisten pada DRI di
    XF86Config
  </li>
</ol>

</body>
</section>
</chapter>

<chapter>
<title>Sumber-sumber</title>
<section>
<body>

<ol>
  <li><uri>http://forums.gentoo.org/viewtopic.php?t=46681</uri></li>
  <li><uri>http://forums.gentoo.org/viewtopic.php?t=29264</uri></li>
  <li><uri>http://dri.freedesktop.org/</uri></li>
  <li><uri>http://www.retinalburn.net/linux/dri_status.html</uri></li>
</ol>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ro/handbook/hb-install-ppc-bootloader.xml,v 1.7 2005/04/12 17:30:55 alin Exp $ -->

<sections>

<version>2.3</version>
<date>2005-04-11</date>

<section>
<title>Alegerea</title>
<subsection>
<title>Introducere</title>
<body>

<p>
Acum, că kernel-ul este configurat si compilat si fişierele de configurarea
a sistemului sunt completate corect, este timpul să instalăm un program ce
va încărca kernel-ul când porniţi sistemul. Un astfel de program se
numeşte <e>bootloader</e>. Dar, înainte de a începe, luaţi în considerare
opţiunile...
</p>

<p>
Există mai multe aplicaţii bootloader pentru Linux/PPC. Avem <uri
link="#yaboot">yaboot</uri> (pentru noua generaţie NewWorld Apple şi maşinile
IBM) şi <uri link="#bootx">BootX</uri> (pentru generaţia anterioară OldWorld
Apple). Pegasos nu necesită bootloader. Nu puteţi utiliza Yaboot sau BootX în
acest moment. Utilizatorii Pegasos nu necesită o aplicaţie bootloader, dar am
inclus secţiunea <uri link="#bootcreator">BootCreator</uri> pentru a vă putea
crea un meniu de boot SmartFirmware.
</p>

</body>
</subsection>
</section>
<section id="yaboot">
<title>Implicit: Utilizarea yaboot</title>
<subsection>
<title>Introducere</title>
<body>

<impo>
yaboot poate fi utilizat doar pe noua generaţie NewWorld Apple şi sistemele
IBM!
</impo>

<p>
Mai întâi, trebuie să creem fişierele <path>/dev</path> în noua
noastră locaţie, necesare în timpul instalării aplicaţiei bootloader.
Aceasta poate fi efectuată prin referenţierea cu "bind" a sistemului de
fişiere <path>/dev</path> prezent pe mediul Installation CD:
</p>

<pre caption="Referenţierea prin bind a sistemului de fişiere /dev">
# <i>exit </i> # aceasta va determina ieşirea din mediul chroot
# <i>mount -o bind /dev /mnt/gentoo/dev</i>
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>/usr/sbin/env-update &amp;&amp; source /etc/profile </i>
</pre>

<p>
Există 2 moduri de configurare a yaboot pentru sistemul dvs. Puteţi
aplicaţia <c>yabootconfig</c> inclusă şi să setaţi automat yaboot.
Dacă, din anumite motive, nu doriţi să rulaţi <c>yabootconfig</c> pentru
a seta automat <path>/etc/yaboot.conf</path> sau instalaţi Gentoo pe un G5 (pe
care <c>yabootconfig</c> nu funcţionează întotdeauna), puteţi să
editaţi exemplul de fişier deja instalat pe sistemul dvs.
</p>

<note>
Este posibil să fie nevoie să editaţi fişierul yaboot.conf în cazul în care
utilizaţi genkernel. Argumentele oferite de fişierul ebuild al pachetului
genkernel trebuie adăugate ca opţiuni pentru secţiunea relativă la imaginea de
kernel. Secţiunea relevantă din yaboot.conf este exemplificată mai jos:
</note>

<pre caption="Adăugarea de argumente de boot în yaboot.conf">
<comment>#################
## Această secţiune poate fi duplicată dacă aveţi mai mult de o imagine de kernel sau
## opţiuni de boot - înlocuiţi 2.6.9 cu versiunea dvs. de kernel
#################</comment>
image=/boot/kernel-2.6.9
  label=Linux
  root=/dev/ram0		<comment># Dacă utilizaţi genkernel, aceasta este /dev/ram0</comment>
  partition=3
  sysmap=/boot/System.map-2.6.9
  append="real_root=/dev/hda3 init=/linuxrc"	<comment># Adăugaţi argumente acestei linii</comment>
  read-only
<comment>##################</comment>
</pre>

<ul>
  <li><uri link="#yabootconfig">Implicit: Utilizarea yabootconfig</uri></li>
  <li>
    <uri link="#manual_yaboot">Alternativ: Configurarea Manuală a yaboot</uri>
  </li>
</ul>

</body>
</subsection>
<subsection id="yabootconfig">
<title>Implicit: Utilizarea yabootconfig</title>
<body>

<p>
<c>yabootconfig</c> va autodetecta partiţiile de pe maşina dvs. şi va seta
combinaţii duble sau triple cu Linux, Mac OS şi Mac OS X.
</p>

<p>
Pentru a utiliza <c>yabootconfig</c>, drive-ul dvs. trebuie să conţină o
partiţie Apple_Bootstrap şi <path>/etc/fstab</path> trebuie să fie configurat
conform partiţiilor Linux. Amândouă condiţiile trebuie să se fi îndeplinit
deja în paşii anteriori. Pentru a începe, asiguraţi-vă că aveţi ultima versiune
de yaboot instalată.
</p>

<pre caption = "Instalarea yaboot cu GRP">
# <i>emerge --usepkg --update yaboot</i>
</pre>

<p>
Acum, ieşiţi din mediul chroot şi rulaţi <c>yabootconfig --chroot
/mnt/gentoo</c>. Programul va rula şi va confirma locaţia partiţiei
bootstrap. Apăsaţi <c>Y</c> dacă aceasta este corectă. Dacă nu,
verificaţi încă o dată <path>/etc/fstab</path>. Apoi, yabootconfig va
scana setările sistemului, va crea <path>/etc/yaboot.conf</path> şi va rula
<c>mkofboot</c>. <c>mkofboot</c> este utilizat pentru a formata partiţia
Apple_Bootstrap şi a instala fişierul de configurare yaboot în aceasta. După
aceasta, intraţi în mediul chroot, din nou.
</p>

<pre caption="intrarea în mediul chroot">
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>/usr/sbin/env-update &amp;&amp; source /etc/profile</i>
</pre>

<p>
Puteţi verifica conţinutul fişierului <path>/etc/yaboot.conf</path>. Dacă
modificaţi <path>/etc/yaboot.conf</path> (cum ar fi setarea sistemului de
operare implicit), trebuie să rulaţi din nou <c>ybin -v</c> pentru a aplica
modificările în partiţia Apple_Bootstrap.
</p>

<p>
Acum, puteţi continua cu secţiunea <uri link="#reboot">Repornirea
Sistemului</uri>.
</p>

</body>
</subsection>
<subsection id="manual_yaboot">
<title>Alternativ: Configurarea Manuală a yaboot</title>
<body>

<p>
Mai întâi, asiguraţi-vă că aveţi ultima versiune <c>yaboot</c>
instalată în sistemul dvs.:
</p>

<pre caption = "Instalarea yaboot">
# <i>emerge --usepkg --update yaboot</i>
</pre>

<p>
Mai jos veţi găsi un fişier <path>yaboot.conf</path> complet.
Modificaţi-l în voie. Utilizatorii G5 ar trebui să aibă în vedere că
disc-urile lor sunt Serial ATA ce sunt interpretate ca disc-uri SCSI de către
Kernel-ul Linux (deci trebuie să înlocuiţi <path>/dev/hda</path> cu
<path>/dev/sda</path>).
</p>

<pre caption = "/etc/yaboot.conf">
<comment>## /etc/yaboot.conf
##
## rulaţi: "man yaboot.conf" for details. Nu modificaţi până nu aţi consultat manualul!!
## consultaţi de asemenea: /usr/share/doc/yaboot/examples pentru exemple de configuraţii.
##
## Pentru un meniu dual-boot, adăugaţi una sau mai multe intrări dintre următoarele:
## bsd=/dev/hdaX, macos=/dev/hdaY, macosx=/dev/hdaZ

## partiţia bootstrap:</comment>

boot=/dev/hda2

<comment>## ofboot este modul openfirmware de a specifica partiţia bootstrap.
## Dacă nu este definit, yaboot nu va funcţiona pe G5 (decât dacă introduceţi
## argumentele necesare programului mkofboot/ybin).
## hd:X înseamnă /dev/sdaX (sau /dev/hdaX).
## 
## Utilizatorii G5 ar trebui să decomenteze această linie!!

#ofboot=hd:2

## hd: este reprezentarea open firmware pentru hda</comment>
device=hd:

delay=5
defaultos=macosx
timeout=30
install=/usr/lib/yaboot/yaboot
magicboot=/usr/lib/yaboot/ofboot

<comment>#################
## Această secţiune poate fi duplicat dacă aveţi mai mult de un kernel sau
## opţiuni de boot - înlocuiţi 2.6.9 cu versiunea dvs. de kernel
#################</comment>
image=/boot/kernel-2.6.9
  label=Linux
  root=/dev/hda3
  partition=3
  sysmap=/boot/System.map-2.6.9
  read-only
<comment>##################

## Utilizatorii G5 şi unii utilizatori G4 ar trebui să seteze
##   macos=hd:13
##   macosx=hd:12
## în locul valorilor exemplificate.</comment>
macos=/dev/hda13
macosx=/dev/hda12
enablecdboot
enableofboot
</pre>

<p>
Odată setat <path>yaboot.conf</path> corect, rulaţi <c>mkofboot -v</c>
pentru a instala setările în partiţia bootstrap. <e>Nu uitaţi acest
lucru!</e> Confirmaţi când <c>mkofboot</c> vă cere să introduceţi un nou
sistem de fişiere.
</p>

<p>
Dacă totul se desfăşoară corect, şi aveţi aceleaşi opţiuni ca în
exemplul de mai sus, urmatoarea acţiune de restart vă va afişa un meniu
simplu, format din 5 intrări. Dacă modificaţi configurarea yaboot
ulterior, va trebui să rulaţi doar <c>ybin -v</c> pentru a actualiza
partiţia bootstrap - <c>mkofboot</c> este utilizat doar pentru setarea
iniţială.
</p>

<p>
Pentru mai multe informaţii despre yaboot, vizitaţi <uri
link="http://penguinppc.org/projects/yaboot">proiectul yaboot</uri>.
Deocamdată, continuaţi cu secţiunea <uri link="#reboot">Repornirea
Sistemului</uri>.
</p>

</body>
</subsection>
</section>
<section id="bootx">
<title>Alternativ: BootX</title>
<body>

<impo>
BootX poate fi utilizat doar pe generaţia veche OldWorld Apple!
</impo>

<p>
Deoarece BootX boot-ează în Linux din MacOS, imaginea de kernel va trebui
copiată de pe partiţia Linux, pe partiţia MacOS. Mai întâi mount-aţi partiţia
MacOS din afara mediului chroot. Utilizaţi <c>mac-fdisk -l</c> pentru a găsi
numărul partiţiei, sda6 fiind folosit în următorul exemplu. Odată partiţia
mount-ată, vom copia imaginea de kernel în directorul sistem pentru ca BootX să
o poată găsi.
</p>

<pre caption="Copierea imaginii de kernel pe partiţia MacOS">
# <i>exit</i>
cdimage ~# <i>mkdir /mnt/mac</i>
cdimage ~# <i>mount /dev/sda6 /mnt/mac -t hfs</i>
cdimage ~# <i>cp /mnt/gentoo/usr/src/linux/vmlinux "/mnt/mac/System Folder/Linux Kernels"</i>
</pre>

<p>
Dacă utilizaţi genkernel, imaginea de kernel este localizată în alt loc şi
imaginea initrd trebuie copiată, de asemenea.
</p>

<pre caption="Copierea imaginii de kernel generate de Genkernel şi a imaginii initrd pe partiţia MacOS">
# <i>exit</i>
cdimage ~# <i>mkdir /mnt/mac</i>
cdimage ~# <i>mount /dev/sda6 /mnt/mac -t hfs</i>
cdimage ~# <i>cp /mnt/gentoo/boot/kernel-* "/mnt/mac/System Folder/Linux Kernels"</i>
cdimage ~# <i>cp /mnt/gentoo/boot/initrd-* "/mnt/mac/System Folder"</i>
</pre>

<p>
Acum, că imaginea de kernel este copiată, efectuaţi umount pentru toate
partiţiile mount-ate şi introduceţi comanda magică pe care aţi aşteptat-o:
<c>reboot</c>.
</p>

<pre caption="Demount-area tuturor partiţiilor şi repornirea">
cdimage ~# <i>cd /</i>
cdimage ~# <i>umount /mnt/gentoo/proc /mnt/gentoo /mnt/mac</i>
cdimage ~# <i>reboot</i>
</pre>

<p>
Bineînţeles, nu uitaţi să îndepărtaţi toate mediile boot-abile, pentru că MacOS
trebuie să boot-eze de data aceasta.
</p>

<p>
Acum, maşina dvs. este boot-ată în MacOS şi trebuie să porniţi interfaţa de
control BootX. Selectaţi <c>Options</c> şi debifaţi <c>Used specified RAM
disk</c> dacă nu utilizaţi genkernel. Dacă utilizaţi genkernel, asiguraţi-vă că
imaginea initrd generată de genkernel este selectată, în locul imaginii initrd
a mediului LiveCD. Dacă nu utilizaţi genkernel, există, acum, o opţiune pentru
a specifica discul şi partitia rădăcină pentru Linux. Completaţi cu valorile
corespunzătoare. În funcţie de configuraţia kernel-ului, este posibil ca unii
parametri de boot să trebuiască specificaţi.
</p>

<p>
BootX poate fi configurat să încarce Linux după boot. Dacă efectuaţi această
operaţie, sistemul va efectua boot în MacOS şi apoi, în timpul procesului de
pornire, va încărca BootX care va încărca Linux, în cele din urmă. Pentru mai
multe informaţii, consultaţi <uri
link="http://penguinppc.org/bootloaders/bootx/">Pagina oficială BootX</uri>.
</p>

<p>
Acum reporniţi din nou şi boot-aţi în Linux, apou continuaţi cu <uri
link="?part=1&amp;chap=11">Finalizarea Instalării Gentoo</uri>.
</p>

</body>
</section>
<section id="bootcreator">
<title>Alternativ: BootCreator</title>
<body>

<impo>
BootCreator va genera un meniu SmartFirmware scris în limbajul Forth pentru
Pegasos.
</impo>

<p>
Mai întâi, asiguraţi-vă că aveţi ultima versiune a aplicaţiei
<c>bootcreator</c> instalată pe sistemul dvs.:
</p>

<pre caption = "Instalarea bootcreator">
# <i>emerge --usepkg --update bootcreator</i>
</pre>

<p>
Acum, copiaţi fişierul <path>/etc/bootmenu.example</path> ca
<path>/etc/bootmenu</path> şi editaţi-l în confirmitate cu nevoile dvs.:
</p>

<pre caption = "Editarea fişierului de cofigurare al aplicaţiei bootcreator">
# <i>cp /etc/bootmenu.example /etc/bootmenu</i>
# <i>nano -w /etc/bootmenu</i>
</pre>

<p>
Mai jos veţi regăsi un fişier de configurare <path>/etc/bootmenu</path>
completat. Modificaţi-l în voie.
</p>

<pre caption = "fişier de configurare bootcreator">
<comment>#
# Exemplu de fişier de descriere pentru bootcreator 1.1
#</comment>

[VERSION]
1

[TITLE]
Boot Menu

[SETTINGS]
AbortOnKey = false
Timeout    = 9
Default    = 1

[SECTION]
Local HD -> Morphos      (Normal)
ide:0 boot2.img ramdebug edebugflags="logkprintf"

[SECTION]
Local HD -> Linux 2.6.10 (Normal)
ide:0 linux-2.6.10 video=radeonfb:1024x768@70 root=/dev/hda3

</pre>

<p>
În final, fişierul <path>bootmenu</path> trebuie transcris în Forth şi copiat
pe partiţia boot, pentru ca aplicaţia SmartFirmware să-l poată accesa. Pentru
aceasta trebuie să rulaţi <c>bootcreator</c>:
</p>

<pre caption = "Instalarea meniului de boot">
# <i>bootcreator /etc/bootmenu /boot/menu</i>
</pre>

<note>
Asiguraţi-vă că aţi analizat cu atenţie setările SmartFirmware când reporniţi,
pentru că acel fişier <path>menu</path> este cel care este încărcat implicit.
</note>

<p>
Pentru moment, continuaţi instalarea cu secţiunea despre <uri
link="#reboot">Repornirea Sistemului</uri>.
</p>

</body>
</section>
<section id="reboot">
<title>Repornirea Sistemului</title>
<subsection>
<body>

<p>
Ieşiţi din mediul chroot şi demount-aţi toate partiţiile mount-ate. Apoi
tastaţi comanda magică pe care aţi aşteptat-o: <c>reboot</c>.
</p>

<pre caption="Ieşirea din chroot, demount-area tuturor partiţiilor şi repornirea">
# <i>exit</i>
livecd ~# <i>umount /mnt/gentoo/proc /mnt/gentoo/dev /mnt/gentoo</i>
livecd ~# <i>reboot</i>
</pre>

<p>
Odată repornită instalarea Gentoo, terminaţi-o cu <uri
link="?part=1&amp;chap=11">Finalizarea Instalării Gentoo</uri>.
</p>

</body>
</subsection>
</section>
</sections>

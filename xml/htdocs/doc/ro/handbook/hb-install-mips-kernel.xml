<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/ro/handbook/hb-install-mips-kernel.xml,v 1.14 2006/01/11 12:50:15 alin Exp $ -->

<sections>

<version>1.15</version>
<date>2006-01-06</date>

<section>
<title>Zona de fus orar</title>
<body>

<p>
Trebuie, mai întâi să setaţi fusul orar, astfel încât sistemul
dumneavoastră să ştie unde se află. Uitaţi-vă după fusul orar
potrivit în <path>/usr/share/zoneinfo</path>, apoi copiaţi-l ca
<path>/etc/localtime</path>. Vă rugăm să evitaţi zonele de fus din
<path>/usr/share/zoneinfo/Etc/GMT*</path> deoarece numele acestora nu indică
zonele presupuse. Spre exemplu <path>GMT-8</path> este, de fapt, GMT+8.
</p>

<pre caption="Setarea informaţiilor referitoare la fusul orar">
<comment>(Presupunănd că doriţi să utilizaţi ora Bucureştiului)</comment>
# <i>cp /usr/share/zoneinfo/Europe/Bucharest /etc/localtime</i>
</pre>

</body>
</section>
<section>
<title>Instalarea surselor</title>

<subsection>
<title>Alegerea unui kernel</title>
<body>

<p>
Nucleul în jurul căruia sunt construite toate distribuţiile, este kernel-ul
Linux. Este nivelul dintre programe şi componentele hardware ale sistemului
dumneavoastră. Gentoo pune la dispoziţia utilizatorilor, mai multe surse de
kernel. O listă completă alături de descrierea lor, este accesibilă la <uri
link="/doc/ro/gentoo-kernel.xml">Ghidul Gentoo pentru Kernel</uri>. 
</p>

<p>
Sistemele bazate pe MIPS pot alege dintre <c>mips-sources</c> (sursele implicte
pentru această arhitectură) şi <c>mips-prepatch-sources</c> (versiune
prerelease pentru structura de kernel).
</p>

<p>
Alegeţi sursa kernel-ului şi instalaţi-o folosind <c>emerge</c>. Bineînţeles,
substituiţi cu alegerea dumneavoastră de surse, acesta fiind doar un exemplu.
<c>USE="-doc"</c> este necesar pentru a evita instalarea xorg-x11 sau a altor
dependenţe, în acest moment. <c>USE="symlink"</c> nu este necesar pentru o
instalare nouă, dar asigură crearea corectă a link-ului simbolic
<path>/usr/src/linux</path>.
</p>

<note>
Sunt necesare patch-uri speciale pentru a face un kernel funcţional pe
server-ele Cobalt. Indicatorul USE <c>cobalt</c> trebuie definit, pentru a se
putea descărca fişierele patch necesare şi a le putea aplica.
</note>

<pre caption="Instalare surse de kernel">
<comment>(Pentru maşinile SGI)</comment>
# <i>USE="-doc symlink" emerge mips-sources</i>

<comment>(Pentru maşinile Cobalt)</comment>
# <i>mkdir -p /etc/portage</i>
# <i>echo "sys-kernel/mips-sources cobalt" &gt;&gt; /etc/portage/package.use</i>
# <i>USE="-doc symlink" emerge mips-sources</i>
</pre>

<p>
Când vă veţi uita în <path>/usr/src</path> ar trebui să vedeţi un symlink numit
<path>linux</path>, ce indică spre sursa kernel-ului dvs. În acest caz,
sursele de kernel instalate indică către <c>mips-sources-2.4.24</c>.
Versiunea dvs. ar putea fi diferită, deci reţineţi acest aspect.
</p>

<pre caption="Vizualizare symlink sursă kernel">
# <i>ls -l /usr/src/linux</i>
lrwxrwxrwx    1 root     root           12 Oct 13 11:04 /usr/src/linux -&gt; linux-2.4.24
</pre>

<p>
Acum este timpul pentru a configura şi a compila sursa kernel-ului.
</p>

</body>
</subsection>
</section>
<section>
<title>Compilarea şi Instalarea Imaginii de Kernel</title>
<subsection>
<title>Introducere</title>
<body>

<p>
Anterior, am tratat configurarea manuală despre cum să instalaţi sursele de
kernel. În loc, am încărcat un număr de exemple de configuraţii pe care vă
puteţi baza configuraţia dvs. Trebuie doar să efectuaţi click pe opţiunea cea
mai apropiată ce se potriveşte sistemului dvs. şi versiunii de kernel. Puteţi
regăsi exemple de configuraţii în adresele URL menţionate mai jos.
</p>

<table>
  <tr>
    <th>Sistem</th>
    <th>Versiune de Kernel</th>
  </tr>
  <tr>
    <ti>SGI IP22 (Indy, Indigo 2, Challenge S)</ti>
    <ti>
      <uri link="http://www.longlandclan.hopto.org/~stuartl/mips-linux/sgi/ip22/config/2.4.29-mipscvs-20050130.gz">2.4.29</uri>
    </ti>
  </tr>
  <tr>
    <ti>Cobalt Qube/Raq 2800</ti>
    <ti>
      <uri link="http://dev.gentoo.org/~kumba/mips/cobalt/kernel/cobalt-2605.config">2.6.5</uri>
      <uri link="http://dev.gentoo.org/~kumba/mips/cobalt/kernel/cobalt-2606.config">2.6.6</uri>
      <uri link="http://dev.gentoo.org/~kumba/mips/cobalt/kernel/cobalt-config-2609">2.6.9</uri>
    </ti>
  </tr>
</table>

<ul>
  <li>
    Configuraţii IP22 (Indy, Indigo2, Challenge S):
    <uri link="http://www.longlandclan.hopto.org/~stuartl/mips-linux/sgi/ip22/config">
      http://www.longlandclan.hopto.org/~stuartl/mips-linux/sgi/ip22/config
    </uri>
  </li>
  <li>
    Configuraţii de Cobalt Server:
    <uri link="http://dev.gentoo.org/~kumba/mips">
      http://dev.gentoo.org/~kumba/mips
    </uri>
  </li>
</ul>

<note>
Mai multe exemple de configuraţii de kernel pot fi găsite în Baza de Date
pentru Suportul Componentelor Hardware MIPS, ce se află la adresa
<uri>http://stuartl.longlandclan.hopto.org/gentoo/mips</uri>.
</note>

<p>
După ce aţi găsit o configuraţie, descărcaţi-o în directorul sursei de kernel
şi redenumiţi-o ca <path>.config</path>. De acolo, puteţi rula <c>make
oldconfig</c> pentru a vă actualiza restul de opţiuni, şi să va permită
personalizarea configuraţiei înainte de compilare.
</p>

<pre caption="Configurarea kernel-ului">
# <i>cd /usr/src/linux</i>
# <i>cp /path/to/examplu-config .config</i>
# <i>make oldconfig</i>
<comment>(Doar apăsaţi ENTER pentru fiecare prompt pentru a accepta valorile implicite... vom personaliza ulterior)</comment>
# <i>make menuconfig</i>
</pre>

</body>
</subsection>
<subsection id="compiling">
<title>Compilare şi Instalare</title>
<body>

<p>
Acum, că kernel-ul este configurat, este timpul să îl compilaţi şi să-l
instalaţi. Ieşiţi din meniul de configurare şi să începeţi procesul de
compilare:
</p>

<pre caption="Compilarea kernel-ului">
<comment>(Pentru kernel 2.4)</comment>
# <i>make dep &amp;&amp; make vmlinux modules modules_install</i>

<comment>(Pentru kernel 2.6)</comment>
# <i>make &amp;&amp; make modules_install</i>
</pre>

<p>
Când compilarea de kernel este gata, copiaţi imaginea de kernel în directorul
<path>/boot</path>.
</p>

<note>
Pe maşinile server Cobalt, aplicaţia bootloader va căuta o imagine de kernel
compresată. Amintiţi-vă să compresaţi utilizând <c>gzip -9</c> pentru fişier,
odată aflat în <path>/boot</path>. Amintiţi-vă, de asemenea, să
înlocuiţi <path>&lt;kernel-versiune&gt;</path> cu numele şi versiunea
kernel-ului dvs.
</note>

<pre caption="Instalare kernel">
# <i>cp vmlinux /boot/&lt;kernel-versiune&lt;</i>
<comment>(Maşini Server Cobalt -- Compresarea imaginii de kernel)</comment>
# <i>gzip -9v /boot/&lt;kernel-versiune&lt;</i>
</pre>

<!--
Moot point, now that we use arcboot on SGI, and CoLo on Cobalts
<p>
Dacă sistemul dumneavoastră nu boot-ează kernel-uri ELF, compilaţi kernel-ul
folosind <c>make vmlinux.ecoff</c> în loc de <c>make vmlinux</c>. Imaginea
kernel-ului va fi salvată ca <path>arch/mips/boot/vmlinux.ecoff</path> în loc
de <path>vmlinux</path>.
</p>
-->
</body>
</subsection>
</section>
<section id="kernel_modules">
<title>Instalarea de Module Separate de Kernel</title>
<subsection>
<title>Configurarea Modulelor</title>
<body>

<p>
Va trebui să enumeraţi toate modulele, care vreţi să fie încărcate automat,
într-unul din fişierele relevante de mai jos. Puteţi, de asemenea, să adăugaţi
extra opţiuni modulelor dacă doriţi.
</p>

<ul>
  <li><path>/etc/modules.autoload.d/kernel-2.4</path> - Doar kernel 2.4</li>
  <li><path>/etc/modules.autoload.d/kernel-2.6</path> - Doar kernel 2.6</li>
  <li><path>/etc/modules.autoload</path> - Toate versiunile de kernel</li>
</ul>

<p>
Deci, dacă aveţi un modul pe care doriţi să-l încărcaţi -- ceea ce este o
practică destul de comună, atât pentru versiunea de kernel 2.4 cât şi pentru
2.6, atunci plasaţi-l în <path>/etc/modules.autoload</path>. Altfel, acesta
poate fi stocat în fişierul corespunzător.
</p>

<p>
Pentru a vizualiza toate modulele disponibile, folosiţi următoarea comandă
<c>find</c>. Nu uitaţi să înlocuiţi "&lt;versiune kernel&gt;" cu versiunea
efectivă de kernel pe care tocmai aţi compilat-o:
</p>

<pre caption="Vizualizarea tuturor modulelor disponibile">
# <i>find /lib/modules/&lt;versiune kernel&gt;/ -type f -iname '*.o' -or -iname '*.ko'</i>
</pre>

<p>
De exemplu, pentru a încărca automat modulul <c>3c59x</c>, editaţi fişierul
corespunzător şi scrieţi numele modulului în el.
</p>

<pre caption="Editarea /etc/modules.autoload.d/kernel-2.4">
# <i>nano -w /etc/modules.autoload.d/kernel-2.4</i>
</pre>

<pre caption="/etc/modules.autoload.d/kernel-2.4 sau kernel-2.6">
3c59x
</pre>

<p>
Această operaţie poate fi efectuată într-un singur pas:
</p>

<pre caption="Adăugarea unui modul -- metoda pe o singură linie">
# <i>echo '3c59x' >> /etc/modules.autoload.d/kernel-2.4</i>
<comment>(sau kernel-2.6, sau /etc/modules.autoload...)</comment>
</pre>

<p>
Continuaţi instalarea cu <uri link="?part=1&amp;chap=8">Configurarea
Sistemului</uri>.
</p>

</body>
</subsection>
</section>
</sections>

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/en/handbook/2004.2/hb-portage-tools.xml,v 1.1 2004/11/15 12:43:54 swift Exp $ -->

<sections>

<version>1.3</version>
<date>October 24, 2004</date>

<section>
<title>etc-update</title>
<body>

<p>
<c>etc-update</c> is a tool that aids in merging the
<path>._cfg0000_&lt;name&gt;</path> files. It provides an interactive merging
setup and can also auto-merge trivial changes.
<path>._cfg0000_&lt;name&gt;</path> files are generated by Portage when it wants
to store a file in a directory protected by the CONFIG_PROTECT variable.
</p>

<p>
Running <c>etc-update</c> is pretty straight-forward:
</p>

<pre caption="Running etc-update">
# <i>etc-update</i>
</pre>

<p>
After merging the straightforward changes, you will be prompted with a list of
protected files that have an update waiting. At the bottom you are greeted by
the possible options:
</p>

<pre caption="etc-update options">
Please select a file to edit by entering the corresponding number.
              (-1 to exit) (-3 to auto merge all remaining files)
                           (-5 to auto-merge AND not use 'mv -i'):
</pre>

<p>
If you enter <c>-1</c>, <c>etc-update</c> will exit without performing any
changes. If you enter <c>-3</c> or <c>-5</c>, <e>all</e> listed configuration
files will be overwritten with the newer versions. It is therefore very
important to first select the configuration files that should not be
automatically updated. This is simply a matter of entering the number listed to
the left of that configuration file.
</p>

<p>
As an example, we select the configuration file <path>/etc/pear.conf</path>:
</p>

<pre caption="Updating a specific configuration file">
Beginning of differences between /etc/pear.conf and /etc/._cfg0000_pear.conf
<comment>[...]</comment>
End of differences between /etc/pear.conf and /etc/._cfg0000_pear.conf
1) Replace original with update
2) Delete update, keeping original as is
3) Interactively merge original with update
4) Show differences again
</pre>

<p>
You can now see the differences between the two files. If you believe that the
updated configuration file can be used without problems, enter <c>1</c>. If you
believe that the updated configuration file isn't necessary, or doesn't provide
any new or useful information, enter <c>2</c>. If you want to interactively
update your current configuration file, enter <c>3</c>.
</p>

<p>
There is no point in further elaborating the interactive merging here. For
completeness sake, we will list the possible commands you can use while you are
interactively merging the two files. You are greeted with two lines (the
original one, and the proposed new one) and a prompt at which you can enter one
of the following commands: 
</p>

<pre caption="Commands available for the interactive merging">
ed:     Edit then use both versions, each decorated with a header.
eb:     Edit then use both versions.
el:     Edit then use the left version.
er:     Edit then use the right version.
e:      Edit a new version.
l:      Use the left version.
r:      Use the right version.
s:      Silently include common lines.
v:      Verbosely include common lines.
q:      Quit.
</pre>

<p>
When you have finished updating the important configuration files, you can now
automatically update all the other configuration files. <c>etc-update</c> will
exit if it doesn't find any more updateable configuration files.
</p>

</body>
</section>
<section>
<title>dispatch-conf</title>
<body>

<p>
Using <c>dispatch-conf</c> you are able to merge updates to your configuration
files while keeping track of all changes. <c>dispatch-conf</c> stores the
differences between the configuration files as patches or by using the RCS
revision system.
</p>

<p>
Like <c>etc-update</c>, you can ask to keep the configuration file as-is, use
the new configuration file, edit the current one or merge the changes
interactively. However, <c>dispatch-conf</c> also has some nice additional
features:
</p>

<ul>
  <li>
    Automatically merge configuration file updates that only contain updates to
    comments
  </li>
  <li>
    Automatically merge configuration files which only differ in the amount of
    whitespace
  </li>
</ul>

<p>
Make certain you edit <path>/etc/dispatch-conf.conf</path> first and create the
directory referenced by the archive-dir variable.
</p>

<p>
For more information, check out the <c>dispatch-conf</c> man page:
</p>

<pre caption="Reading the dispatch-conf man page">
$ <i>man dispatch-conf</i>
</pre>

</body>
</section>
<section>
<title>quickpkg</title>
<body>

<p>
With <c>quickpkg</c> you can create archives of the packages that are already
merged on your system. These archives can be used as prebuilt packages. Running
<c>quickpkg</c> is straightforward: just add the names of the packages you want
to archive.
</p>

<p>
For instance, to archive <c>curl</c>, <c>arts</c> and <c>procps</c>:
</p>

<pre caption="Example quickpkg usage">
# <i>quickpkg curl arts procps</i>
</pre>

<p>
The prebuilt packages will be stored in <path>/usr/portage/packages/All</path>.
Symbolic links pointing to these packages are placed in
<path>/usr/portage/packages/&lt;category&gt;</path>.
</p>

</body>
</section>
</sections>

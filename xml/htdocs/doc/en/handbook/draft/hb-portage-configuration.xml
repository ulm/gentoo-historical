<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/en/handbook/draft/Attic/hb-portage-configuration.xml,v 1.4 2004/09/26 19:53:11 swift Exp $ -->

<sections>
<section>
<title>Portage Configuration</title>
<subsection>
<body>

<p>
As noted previously, Portage is configurable through many variables which 
you should define in <path>/etc/make.conf</path>. Please refer to the
<path>make.conf</path> manpage for more and complete information:
</p>

<pre caption="Reading the make.conf manpage">
$ <i>man make.conf</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Build-specific Options</title>
<subsection>
<title>Configure and Compiler Options</title>
<body>

<p>
When Portage builds applications, it passes the contents of the following
variables to the compiler and configure script:
</p>

<ul>
  <li>
    CFLAGS &amp; CXXFLAGS define the desired compiler flags for C and C++
    compiling.
  </li>
  <li>
    CHOST defines the build host information for the application's configure 
    script
  </li>
  <li>
    MAKEOPTS is passed to the <c>make</c> command and is usually set to define
    the amount of parallelism used during the compilation. More information
    about the make options can be found in the make manpage.
  </li>
</ul>

<p>
The USE variable is also used during configure and compilations but has been
explained in great detail in previous chapters.
</p>

</body>
</subsection>
<subsection>
<title>Merge Options</title>
<body>

<p>
By default, Portage will remove the temporary files it used during building
after having merged the package to the filesystem. This feature is set with the
AUTOCLEAN variable which defaults to "yes". Setting this variable to "no" will
leave the files inside <path>/var/tmp/portage</path> (or any other directory
BUILD_PREFIX refers to).
</p>

<p>
When Portage has merged a newer version of a certain software title, it will
remove the obsoleted files of the older version from your system. Portage gives
the user a 5 second delay before unmerging the older version. These 5 seconds
are defined by the CLEAN_DELAY variable.
</p>

</body>
</subsection>
</section>
<section>
<title>Configuration File Protection</title>
<subsection>
<title>Portage' Protected Locations</title>
<body>

<p>
Portage overwrites files provided by newer versions of a software title if the
files aren't stored in a <e>protected</e> location. These protected locations
are defined by the CONFIG_PROTECT variable and are generally configuration file
locations. The directory listing is space-delimited.
</p>

<p>
A file that would be written in such a protected location is renamed and the
user is warned about the presence of a newer version of the (presumable) 
configuration file.
</p>

<p>
You can find out about the current CONFIG_PROTECT setting from the <c>emerge
info</c> output:
</p>

<pre caption="Getting the CONFIG_PROTECT setting">
$ <i>emerge info | grep 'CONFIG_PROTECT='</i>
</pre>

<p>
More information about Portage' Configuration File Protection is available
through <c>emerge</c>:
</p>

<pre caption="More information about Configuration File Protection">
$ <i>emerge --help config</i>
</pre>

</body>
</subsection>
<subsection>
<title>Excluding Directories</title>
<body>

<p>
To 'unprotect' certain subdirectories of protected locations you can use the
CONFIG_PROTECT_MASK variable.
</p>

</body>
</subsection>
</section>
<section>
<title>Download Options</title>
<subsection>
<title>Server Locations</title>
<body>

<p>
When the requested information or data is not available on your system, Portage
will retrieve it from the Internet. The server locations for the various
information and data channels are defined by the following variables:
</p>

<ul>
  <li>
    GENTOO_MIRRORS defines a list of server locations which
    contain source code (distfiles)
  </li>
  <li>
    PORTAGE_BINHOST defines a particular server location containing prebuilt
    packages for your system
  </li>
  <li>
    SYNC defines a particular server which Portage uses to fetch the
    Portage tree from
  </li>
</ul>

<p>
The GENTOO_MIRRORS and SYNC variables can be set automatically through the
<c>mirrorselect</c> application. For more information, see mirrorselect's online
help:
</p>

<pre caption="More information about mirrorselect">
# <i>mirrorselect --help</i>
</pre>

<p>
If your environment requires you to use a proxy server, you can use the
HTTP_PROXY, FTP_PROXY and RSYNC_PROXY variables to declare a proxy server. 
</p>


</body>
</subsection>
<subsection>
<title>Fetch Commands</title>
<body>

<p>
When Portage needs to fetch source code, it uses to <c>wget</c> by default. You
can change this through the FETCHCOMMAND variable. 
</p>

<p>
Portage is able to resume partially downloaded source code. It uses <c>wget</c>
by default, but this can be altered through the RESUMECOMMAND variable. 
</p>

<p>
Make sure that your FETCHCOMMAND and RESUMECOMMAND stores the source code 
referenced by the ${URI} variable inside ${DISTDIR}.
</p>

</body>
</subsection>
</section>
<section>
<title>Gentoo Configuration</title>
<body>

</body>
</section>
<section>
<title>Portage Behaviour</title>
<subsection>
<title>Resource Management</title>
<body>

</body>
</subsection>
<subsection>
<title>Output Behaviour</title>
<body>

</body>
</subsection>
</section>
</sections>

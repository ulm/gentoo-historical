<?xml version='1.0'?>
<?xml-stylesheet href="/xsl/guide.xsl" type="text/xsl"?>
<guide link="/doc/mirroring.html">

<title>Gentoo Linux Mirroring Guide</title>

<author title="Chief Architect">
<mail link="drobbins@gentoo.org">Daniel Robbins</mail>
</author>
<author title="Editor">
<mail link="peitolm@gentoo.org">Colin Morey</mail>
</author>

<abstract>
This document contains instructions for setting up a Gentoo Linux rsync mirror.
</abstract>

<version>1.0</version>
<date>04 May 2002</date>

<chapter>
<title>Setting up an rsync mirror</title>
<section>
<body>

<p>Right now, mirroring our Portage tree requires around 56Mb, so it isn't
space intensive; having at least 200Mb free should allow for growing room.
Setting up a Portage tree mirror is simple -- first, ensure that your mirror
has rsync installed.  Then, set up your <path>rsyncd.conf</path> file to look
something like this: </p>

<pre>
pid file = /var/run/rsyncd.pid
motd file = /etc/rsync/rsyncd.motd
syslog facility = local3
timeout = 150
[gentoo-x86-portage]
        path = /space/gentoo/rsync
        comment = Gentoo Linux Portage tree
[gentoo-portage]
        path = /space/gentoo/rsync
        comment = Gentoo Linux Portage tree 
</pre>

<p>Above, the <c>gentoo-x86-portage</c> mirror points to the same data as
<c>gentoo-portage</c>.  Although we have recently changed the official name of
our mirror to <c>gentoo-portage</c>, <c>gentoo-x86-portage</c> is still needed
for backwards compatibility, so include both entries.  Your rsync motd can
contain anything reasonable, such as information about the host providing the
Portage mirror and an administrative contact.</p>

<p>Now, you need to mirror the Gentoo Linux Portage tree.  You should use the
following command to do so:</p> <pre>rsync -rlptDvz --delete
rsync://rsync.gentoo.org/gentoo-portage/ /space/gentoo/rsync/</pre> <p>Be sure
to enable the <c>--delete</c> option so that stale ebuilds get removed from
your mirror.  Schedule a cron job to run the rsync every half-hour, on the :00
and :30.  Then, send an email to <mail link="admin_[at]_gentoo.org">The Admin Team</mail> 
and let us know that your rsync mirror is ready.  we will then set up an
official rsync[num].[countrycode].gentoo.org DNS entry and add you to our DNS
round-robin for rsync.gentoo.org and rsync.[countrycode].gentoo.org.  We'll
also set up cvs.gentoo.org's QoS so that you get "preferred" access to our
rsync server.  Shortly after you've been added to our DNS, you should start to
see rsync traffic, Then you will need to change the cron job to point to the
main mirror - rsync://rsync1.us.gentoo.org (everything else should remain the same).
-- thanks for helping out Gentoo Linux users and developers! :)</p>

</body>
</section>
</chapter>
</guide>


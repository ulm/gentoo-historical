<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fi/gentoo-x86-quickinstall.xml,v 1.10 2005/07/20 22:46:30 flammie Exp $ -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/en/gentoo-x86-quickinstall.xml">
<title>Gentoon x86-pika-asennusopas</title>

<author title="Tekijä">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Tekijä">Steven Wagner</author>
<author title="Vastuullinen kääntäjä">
  <mail link="flammie@gentoo.org">Flammie Pirinen</mail>
</author>

<abstract>
Pika-asennusopas kertoo Gentoon asennuksen hyvin tiiviissä muodossa. Gentoon
aiempi asennuskokemus on välttämättä tämän oppaan hyödyntämiseksi.
</abstract>

<license/>

<version>2.2</version>
<date>2005-07-16</date>

<chapter>
<title>Pika-asennusopas</title>
<section>
<title>Asennuslähteet</title>
<body>

<p>
Lataa CD <uri link="/main/en/mirrors.xml">peilipalvelimelta</uri>.
ISOt sijaitsevat hakemistoissa
<path>releases/&lt;arkkitehtuuri&gt;/&lt;julkaisu&gt;/installcd</path>.
<e>Minimal</e> asennus-CD:tä voi käyttää vain verkkoasennuksissa,
<e>universal</e> asennus-CD:llä voi asentaa myös ilman nettiä.
</p>

<p>
<uri link="/doc/en/faq.xml#isoburning">Polta</uri> CD ja käynnistä siltä.
<c>F2</c>:lla saa esiin käynnistysvaihtoehdot. Käynnistymisen jälkeen
PCMCIA-tuen saa päälle <c>pcmcia</c>-initskriptillä.
</p>

<p>
Asennus-CD:illä on käytössä <c>sshd</c>-palvelin, <c>irssi</c>, <c>lynx</c>
ja <c>links2</c>. Myös käyttäjien lisääminen onnistuu.
</p>

</body>
</section>
<section>
<title>Verkkoasetukset</title>
<body>

<p>
Jos verkko ei toimi, komennolla <c>net-setup</c> tehdään verkkoasetukset.
Tätä ennen saattaa pitää ladata verkkokortin ajurit <c>modprobe</c>lla. Sisäisen
ADSL:n käyttäjien pitää käynnistää <c>adsl-setup</c> ja <c>adsl-start</c>.
PPTP-käyttäjien pitää asettaa <path>/etc/ppp/chap-secrets</path>-tiedosto ja
<path>/etc/ppp/options.pptp</path> ja käynnistää <c>pptp &lt;palvelimen
ip&gt;</c>.
</p>

<p>
Langattomille verkoille käytetään komentoa <c>iwconfig</c>, jonka jälkeen
ajetaan normaalisti <c>net-setup</c> tai <c>ifconfig</c>, <c>dhcpcd</c> ja
<c>route</c>.
</p>

<p>
Jos käytössä on välityspalvelin, muista <c>export http_proxy</c>,
<c>ftp_proxy</c> ja <c>RSYNC_PROXY</c>.
</p>

</body>
</section>
<section>
<title>Levyjen valmistelu</title>
<body>

<p>
Osioinnin voi hoitaa komennolla <c>fdisk</c> tai <c>cfdisk</c>. Ainakin yksi
swappiosio (tyyppinumero 82) ja yksi Linux-osio (tyyppinumero 83) pitää luoda.
</p>

<p>
Komennoilla <c>mke2fs</c>, <c>mke2fs -j</c>, <c>mkreiserfs</c>, <c>mkfs.xfs</c>
ja <c>mkfs.jfs</c> voi luoda tiedostojärjestelmiä osioille. Swappiosio
aktivoidaan komennoin <c>mkswap</c> ja <c>swapon</c>.
</p>

<p>
Tiedostojärjestelmät liitetään hakemiston <path>/mnt/gentoo</path> alle.
Muiden liitosten liitospisteet pitää luoda käsin, jos niitä tarvitsee (esim.
<path>/mnt/gentoo/boot</path>).
</p>

</body>
</section>
<section>
<title>Stagejen asetukset</title>
<body>

<p>
Päiväys pitää asettaa oikeaksi komennolla <c>date MMDDhhmmYYYY</c>.
Sitten ladataan stage-paketti <uri
link="/main/en/mirrors.xml">peilipalvelimelta</uri> tai käytetään asennus-CD:ltä
löytyvää (<path>/mnt/cdrom/stages</path>). Siirry hakemistoon
<path>/mnt/gentoo</path> ja pura paketti:
<c>tar&nbsp;-xvjpf&nbsp;&lt;stage-paketti&gt;</c>.
</p>

<p>
Jos asennat ilman verkkoa, siirru hakemistoon  <path>/mnt/gentoo/usr</path> ja
pura Portage:
<c>tar&nbsp;-xvjf&nbsp;/mnt/cdrom/snapshots/&lt;otos&gt;</c>. Verkon
kanssa Portagen voi ladata ja asentaa samalla tapaa.
</p>

<p>
Tee asetukset tiedostoon <path>/mnt/gentoo/etc/make.conf</path> (USE-asetukset,
CFLAGS ja CXXFLAGS). Asetusten tekoon voi käyttää <c>nano</c>a.
</p>

</body>
</section>
<section>
<title>Gentoon ydinjärjestelmän asentaminen</title>
<body>

<p>
Liitä <path>/proc</path>-järjestelmä, kopioi <path>/etc/resolv.conf</path> ja
chroottaa Gentoo-järjestelmään:
</p>

<pre caption="Valmistelu chroottaus">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/etc/</i>
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i> &amp;&amp; <i>source /etc/profile</i>
</pre>

<p>
Jos käytössä on verkko, <c>emerge --sync</c> päivittää Portagepuun.
</p>

<p>
Tarkista <path>/etc/make.profile</path>. Oletusarvo on yleensä hyvä valinta:
aliprofiilit ovat erikoisytimille (kuten <path>2.4/</path> 2.4-version
Linuxeille). Profiilia vaihdetaan komennolla <c>ln -sf</c>.
</p>

<ul>
  <li>
    Bootstrappaus (vain verkkoasennuksissa) tapahtuu komennolla
    <c>scripts/bootstrap.sh</c>, joka löytyy hakemistosta
    <path>/usr/portage</path>.
  </li>
  <li>
    Järjestelmän asennus (vain verkkoasennuksissa) tehdään komennolla
    <c>emerge&nbsp;-e&nbsp;system</c> (tai <c>-N</c> jos
    CFLAGS ja CXXFLAGS).
  </li>
</ul>

<p>
Stage3:n kanssa pitää päivittää baselayout (paitsi verkottomissa asennuksissa):
</p>

<pre caption="Baselayoutin päivitys">
# <i>CONFIG_PROTECT="-*" emerge baselayout</i>
</pre>

</body>
</section>
<section>
<title>Ydinasetukset</title>
<body>

<p>
Aseta aikavyöhyke osoittamalla symbolinen linkki
<path>/etc/localtime</path> oikeaan kohteeseen hakemistossa
<path>/usr/share/zoneinfo</path> (Europe/Helsinki on ihan hyvä valinta usein).
Tämä tapahtuu komennolla <c>ln -sf</c>.
</p>

<p>
Asenna ytimen lähdekoodi (<c>gentoo-sources</c> tai <c>vanilla-sources</c>
on saatavilla verkottomissa asennuksissa) ja tee asetukset
hakemistossa <path>/usr/src/linux</path> komennolla
<c>make menuconfig</c>. Käännä komennolla
<c>make&nbsp;&amp;&amp;make&nbsp;modules_install</c> ja
kopioi <path>arch/i386/bzImage</path> hakemistoon <path>/boot</path>.
Voit myös asentaa genkernelin komennolla <c>emerge&nbsp;genkernel</c> ja
käyttää komentoa <c>genkernel&nbsp;--udev&nbsp;all</c>.
</p>

<p>
Genkerneliä varten pitää asentaa coldplug komennolla <c>emerge&nbsp;coldplug</c>
ja <c>rc-update&nbsp;add&nbsp;coldplug&nbsp;default</c>.
</p>

</body>
</section>
<section>
<title>Järjestelmäasetukset</title>
<body>

<p>
Muokkaa tiedosto <path>/etc/fstab</path>; esimerkki:
</p>

<pre caption="Fstabin muokkaus">
/dev/hda1   /boot     ext2    defaults,noatime     1 2
/dev/hda2   none      swap    sw                   0 0
/dev/hda3   /         ext3    noatime              0 1
none        /proc     proc    defaults             0 0
none        /dev/shm  tmpfs   nodev,nosuid,noexec  0 0
/dev/cdroms/cdrom0    /mnt/cdrom    auto      noauto,user    0 0
</pre>

<p>
Muokkaa tiedostot <path>/etc/conf.d/hostname</path>,
<path>/etc/conf.d/domainname</path> ja <path>/etc/conf.d/net</path>
verkkoasetuksia varten. Jos käytössä on useampi verkkokortti, linkitä ne
initskriptiin <c>net.eth0</c> ja lisää runlevelille default.
</p>

<p>
Muokkaa tiedosto <path>/etc/hosts</path>; esimerkki:
</p>

<pre caption="/etc/hostsin muokkaus">
<comment>(Staattiset IP:t)</comment>
127.0.0.1     localhost
192.168.0.5   jenny.homenetwork jenny
192.168.0.6   benny.homenetwork benny
192.168.0.7   tux.homenetwork tux

<comment>(Dynaamiset IP:t)</comment>
127.0.0.1     localhost.homenetwork tux localhost
</pre>

<p>
Asenna <c>pcmcia-cs</c> ja lisää se runlevelille default tarvittaessa.
</p>

<p>
Aseta rootin salasana komennolla <c>passwd</c>.
</p>

<p>
Aseta järjestelmäasetukset tiedostoissa <path>/etc/rc.conf</path>,
<path>/etc/conf.d/rc</path>, <path>/etc/conf.d/keymaps</path>,
<path>/etc/conf.d/clock</path>.
</p>

</body>
</section>
<section>
<title>Järjestelmätyökalujen asennus</title>
<body>

<p>
2.4-ytimien käyttäjien pitää suorittaa komennot
<c>emerge&nbsp;--unmerge&nbsp;udev</c> ja
<c>emerge&nbsp;devfsd</c>.
</p>

<p>
Asenna järjestelmäloki kuten <c>syslog-ng</c> ja lisää se runlevelille
default. Sama kannattaa tehdä cronillekin, kuten <c>vixie-cron</c>ille.
</p>

<p>
Asenna tiedostojärjestelmäsovellukset (<c>xfsprogs</c>, <c>reiserfsprogs</c>
tai <c>jfsutils</c>) ja verkkosovellukset (<c>dhcpcd</c> tai <c>rp-pppoe</c>).
</p>

</body>
</section>
<section>
<title>Käynnistyslatainten asennus</title>
<body>

<p>
Asenna <c>grub</c> tai <c>lilo</c>. Muokkaa asetustiedostoa
<path>/boot/grub/grub.conf</path> tai
<path>/etc/lilo.conf</path>. Alla on esimerkkejä:
</p>

<pre caption="grub.confin asettaminen">
default 0
timeout 30
splashimage=(hd0,0)/grub/splash.xpm.gz

<comment># genkernel</comment>
title=Gentoo Linux 2.6.11-r3
root (hd0,0)
kernel /kernel-2.6.11-gentoo-r3 root=/dev/ram0 init=/linuxrc ramdisk=8192 real_root=/dev/hda3 udev
initrd /initrd-2.6.11-gentoo-r3

<comment># ei genkerneliä</comment>
title=Gentoo Linux 2.6.11 r3
root (hd0,0)
kernel /kernel-2.6.11-gentoo-r3 root=/dev/hda3

<comment># Windows dual-booteille</comment>
title=Windows XP
root (hd0,5)
makeactive
chainloader +1
</pre>

<pre caption="lilo.confin asettaminen">
boot=/dev/hda
prompt
timeout=50
default=gentoo

<comment># Ilman genkerneliä</comment>
image=/boot/kernel-2.6.11-gentoo-r3
  label=gentoo
  read-only
  root=/dev/hda3

<comment># genkernel</comment>
image=/boot/kernel-2.6.11-gentoo-r3
  label=gentoo
  read-only
  root=/dev/ram0
  append="init=/linuxrc ramdisk=8192 real_root=/dev/hda3 udev"
  initrd=/boot/initrd-2.6.11-gentoo-r3

<comment># Dual-booteille</comment>
other=/dev/hda6
  label=windows
</pre>

<p>
GRUBin käyttäjien pitää asentaa GRUB MBR:ään komennolla
<c>grub-install&nbsp;/dev/hda</c> sen jälkeen kun
<path>/proc/mounts</path> on kopioitu <path>/etc/mtab</path>iin.
LILOn käyttäjien pitää suorittaa <c>/sbin/lilo</c>.
</p>

<p>
Poistu chrootista, poista tiedostojärjestelmäliitokset ja uudelleenkäynnistä.
</p>

</body>
</section>
<section>
<title>Asennuksen viimeistely</title>
<body>

<p>
Kirjaud <c>root</c>ina, lisää uusi käyttäjä komennolla:
<c>useradd&nbsp;-m&nbsp;-G&nbsp;&lt;ryhmät&gt;&nbsp;&lt;käyttäjänimi&gt;</c>.
</p>

<p>
Jos asennus on tehty ilman verkkoa, pitää liittää Packages CD hakemistoon
<path>/mnt/cdrom</path> ja suorittaa
<c>export&nbsp;PKGDIR="/mnt/cdrom"</c>, jonka jälkeen voi komennolla <c>emerge&nbsp;-k&nbsp;&lt;paketti&gt;</c> asentaa lisää softaa, kuten
<c>Gnome</c>n.
</p>

<p>
Kiitos!
</p>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/fi/gentoo-x86-quickinstall.xml,v 1.2 2005/02/25 03:22:42 flammie Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/en/quickinstall.xml" lang="fi">
<title>Gentoo Linuxin asennus</title>
<author title="Tekijä">Steven Wagner</author>
<author title="Toimittaja">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Vastuullinen kääntäjä">
  <mail link="flammie@gentoo.org">Flammie Pirinen</mail>
</author>
<abstract>
Tämä pika-asennusohje kertoo asennusprosessin hyvin tiiviissä muodossa. Aiempi
Gentoon asennuskokemus on välttämätöntä tätä käytettäessä.
</abstract>

<license/>

<version>1.24</version>
<date>2005-02-07</date>

<chapter>
<title>Pika-asennusohje</title>
<section>
<body>

<p>
Asennukseen tarvittavat ISOt löytyvät <uri link=
"http://www.gentoo.org/main/en/mirrors.xml">Gentoon
peilipalvelimilta</uri>. Tarkempi selvitys CD:istä löytyy
englanniksi <uri link="http://store.gentoo.org">Gentoo
Storen sivuilta</uri>. Universal LiveCD sisältää kaiken tarpeellisen
asennukseen ilman Internet-yhteyttä. Packages CD sisältää lisäksi vielä
muita ohjelmia, kuten KDE:n, Gnomen, OpenOffice.orgin,
Mozillan, Evolutionin ja niin edelleen.
</p>

<p>
Käynnistä kone Universal LiveCD:llä.
Näppäimillä &lt;F1&gt; tai &lt;F2&gt;
saa lisää tietoa mahdollisista käynnistysasetuksista. Näppäimellä &lt;ENTER&gt;
jatketaan oletusytimen latausta. Käynnistys etenee komentoriville asti.
</p>

<pre caption="Aloitusasetukset">
# <i>date</i>  (päivämäärän tarkistus, muuttaminen tapahtuu komennolla <i>date MMDDhhmmCCYY</i>)
# <i>modprobe module_name</i>  (Vaihtoehtoinen, moduulien lataaminen)
# <i>net-setup eth0</i> (Verkon asetusten teko)
# <i>fdisk /dev/hda</i> (Kovalevyn osiointi)
</pre>

<p>
Suositeltu osiointi on 64 megatavua käynnistysosiolle
ext2-tiedostojärjestelmällä, sivutustilaa kaksi kertaa RAM-muistin määrä ja
loput juuriosiolle ReiserFS-tiedostojärjestelmällä.
</p>

<p>
Osiot alustetaan komennoilla <c>mke2fs</c> (Ext2), <c>mke2fs
-j</c> (Ext3), <c>mkreiserfs</c> (ReiserFS), <c>mkfs.xfs</c> (XFS),
<c>mkfs.jfs</c> (JFS) ja <c>mkswap</c> (sivutusosio). Esimerkiksi:
<c>mke2fs -j /dev/hda3</c>.
</p>

<p>
Seuraavaksi tarvitsee liittää osiot ja purkaa stage-tiedostot
</p>

<pre caption="Asennuksen valmistelu">
(Sivutusosion aktivointi)
# <i>swapon /dev/hdax</i>
(Juuriosion liittäminen)
# <i>mount /dev/hdax /mnt/gentoo</i>
(Käynnistysosion liitospisteen luonti)
# <i>mkdir /mnt/gentoo/boot</i>
(Käynnistysosion liittäminen)
# <i>mount /dev/hdax /mnt/gentoo/boot</i>
(Liitospisteeseen siirtyminen)
# <i>cd /mnt/gentoo</i>
(Tar-paketin purku...)
# <i>tar -xvjpf /mnt/cdrom/stages/stage?-*.tar.bz2</i>
(<comment>tai</comment> viimeisimmän tarpaketin lataus...)
# <i>lynx http://www.gentoo.org/main/en/mirrors.xml</i>
(                  ... ja purkaminen)
# <i>tar -xvjpf stage*</i>
(Vaihtoehtoinen: Portage-puun purkaminen)
# <i>tar -xvjf /mnt/cdrom/snapshots/portage-*.tar.bz2 -C /mnt/gentoo/usr</i>
(Vaihtoehtoinen: distfilesin kopiointi)
# <i>cp -R /mnt/cdrom/distfiles /mnt/gentoo/usr/portage/distfiles</i>
(Peilin valinta)
# <i>mirrorselect -a -s4 -o | grep "GENTOO_MIRRORS=" \
  &gt;&gt; /mnt/gentoo/etc/make.conf</i>
(Nimipalvelun tietojen kopiointi)
# <i>cp -L /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</i>
(proc-tiedostojärjestelmän liittäminen)
# <i>mount -t proc none /mnt/gentoo/proc</i>
(Uuden järjestelmän chroot)
# <i>chroot /mnt/gentoo /bin/bash</i>
(Tarvittavien muuttujien lataus)
# <i>env-update; source /etc/profile</i>
(Verkkoyhteydellä, ei GRP:ssä: päivitys)
# <i>emerge sync</i>
</pre>

<p>
Sitten Gentoon asennus:
</p>

<pre caption = "Gentoon asennus">
(Muuta USE, CFLAGS ja CXXFLAGS. Stage1-käyttäjät voivat muuttaa myös CHOSTin)
# <i>nano -w /etc/make.conf</i>
(Stage1: bootstrap system)
# <i>cd /usr/portage; scripts/bootstrap.sh</i>
(Stage1, Stage2: järjestelmän perustan asennus)
# <i>emerge system</i>
</pre>

<p>
Seuraavaksi tehdään tarvittavat asetukset (<e>polku aikavyöhykkeeseen</e> lienee
<path>/usr/share/zoneinfo/Europe/Helsinki</path> jos olet Suomessa):
</p>

<pre caption = "Asetusten muokkaus">
(Aikavyöhykkeen asetus)
# <i>ln -sf /usr/share/zoneinfo/<comment>&lt;polku aikavyöhykkeeseen&gt;</comment> /etc/localtime</i>
(fstabin muokkaus)
# <i>nano -w /etc/fstab</i>
</pre>

<p>
Tee <path>/etc/fstab</path> seuraavan <e>mallin</e> mukaisesti (älä kopioi
tietoja sellaisenaan, täydennä):
</p>

<pre caption="/etc/fstab">
# &lt;fs&gt;                  &lt;mountpoint&gt;    &lt;type&gt;          &lt;opts&gt;              &lt;dump/pass&gt;
/dev/hdax               /boot           ext2            noauto,noatime          1 2
/dev/hdax               none            swap            sw                      0 0
/dev/hdax               /               reiserfs        noatime                 0 1
/dev/cdroms/cdrom0      /mnt/cdrom      auto            noauto,user             0 0
none                    /proc           proc            defaults                0 0
none                    /dev/shm        tmpfs           nosuid,noexec,nodev     0 0
</pre>

<p>
Seuraavaksi asennetaan Linuxin ydin(kerneli):
</p>

<pre caption="Ytimen asennus">
(Asenna ytimen lähdekoodi)
# <i>emerge <comment>&lt;ydinpaketin-nimi&gt;</comment></i>
(Aseta ytimesi genkernelillä)
# <i>emerge genkernel; genkernel --menuconfig all</i>
(<comment>tai</comment> (1) aseta ydin käsin)
    # <i>cd /usr/src/linux; make menuconfig;</i>
(   (2) Tee asetukset: VM fs, /proc fs, /dev fs,  /dev fs auto mount at boot)
(   (3) Käännä ydin)
    # <i>make dep &amp;&amp; make clean bzImage modules modules_install</i>
(   (4) Kopioi ydin)
    # <i>cp arch/i386/boot/bzImage /boot; cp System.map /boot</i>
</pre>

<p>
Asenna muita työkaluja tarpeen mukaan:
</p>

<pre caption = "Asenna tärkeitä järjestelmätyökaluja">
(Järjestelmälokin asennus; sysklogd, metalog, msyslog tai syslog-ng)
# <i>emerge syslog-ng </i>
(Järjestelmälokin lisäys käynnistykseen)
# <i>rc-update add syslog-ng default</i>
(Cron-palvelun asennus; vaihtoehdot: vixie-cron, dcron, fcron)
# <i>emerge vixie-cron</i>
(Cron-palvelun lisäys käynnistykseen)
# <i>rc-update add vixie-cron default</i>
(genkernelin käyttäjille: hotplugin asennus)
# <i>emerge hotplug</i>
(genkernelin käyttäjille: hotplugin lisäys käynnistykseen)
# <i>rc-update add hotplug default</i>
(Muille kuin ext[23]-käyttäjille; reiserfsprogs, xfsprogs, jfsutils)
# <i>emerge reiserfsprogs</i>
(Valinnaista: DHCP-asiakasohjelman asentaminen)
# <i>emerge dhcpcd</i>
(Domainnimen lisäys käynnistykseen)
# <i>rc-update add domainname default</i>
</pre>

<p>
Nyt voi asentaa muita ytimen ebuildeja:
</p>

<pre caption = "Ytimen erityisebuildien asennus">
# <i>emerge pcmcia-cs</i> (tai <i>nforce-net</i>, <i>nforce-audio</i>,
        <i>e100</i>, <i>e1000</i>, <i>ati-drivers</i>, <i>rp-pppoe</i>)
# <i>VIDEO_CARDS="vehjes" emerge xfree-drm</i>
(ATI Radeoneille 9200:aan asti, Rage128:lle, Matrox:lle,
        Voodoolle ja muille näyttökorteille)
</pre>

<p>
Viimeistellään Gentoon asennus:
</p>

<pre caption = "Asetusten viimeistely">
(Pääkäyttäjän salasanan asetus)
# <i>passwd</i>
(Käyttäjien lisäys)
# <i>useradd käyttäjä -m -G users,wheel,audio -s /bin/bash</i>
(Salasanojen asettaminen)
# <i>passwd käyttäjä</i>
(Laitenimen asetus)
# <i>echo koneeni &gt; /etc/hostname</i>
(Järjestelmän domainnimen asetus)
# <i>echo example.com &gt; /etc/dnsdomainname</i>
(hosts-tiedoston asettaminen, esim:"127.0.0.1 localhost koneeni")

# <i>nano -w /etc/hosts</i>
(Järjestelmäasetusten muokkaus: katso kommentteja)
# <i>nano -w /etc/rc.conf</i>
</pre>

<pre caption = "Verkon asennus">
(Verkon asennus, dhcp-käyttäjille iface_eth0="dhcp")
# <i>nano -w /etc/conf.d/net</i>
(Käynnistyksessä ladattavien moduulien listaus)
# <i>nano -w /etc/modules.autoload.d/kernel-<comment>&lt;versio&gt;</comment></i>
(Ei PCMCIA-käyttäjille: verkon käynnistys aloituksessa)
# <i>rc-update add net.eth0 default</i>
(Useamman verkkorajapinnan omistajille:)
   (1) Käynnistysskriptit jokaiselle rajapinnalle)
   # <i>ln -s /etc/init.d/net.eth0 /etc/init.d/net.ethx</i>
   (2) PCMCIA:n lisäys käynnistykseen)
   # <i>rc-update add net.ethx default</i>
(PCMCIA: tarkista /etc/conf.d/pcmcia ja lisää PCMCIA käynnistykseen)
# <i>rc-update add pcmcia default</i>
</pre>

<p>
Seuraavaksi asennetaan käynnistyslatain.
</p>

<pre caption="Asenna ja aseta GRUB">
# <i>emerge grub</i>
# <i>grub</i>
grub&gt; <i>root (hd0,0)</i>
grub&gt; <i>setup (hd0)</i>
grub&gt; <i>quit</i>
# <i>nano -w /boot/grub/grub.conf</i>
default 0
timeout 15
splashimage=(hd0,0)/grub/splash.xpm.gz

title=Gentoo Linux
  root (hd0,0)
  <comment># genkernelin käyttäjät:</comment>
  kernel /kernel-<comment>&lt;ydinversio&gt;</comment> root=/dev/ram0 init=/linuxrc real_root=/dev/hda3 ramdisk=8192
  initrd /initrd-<comment>&lt;ydinversio&gt;</comment>
  <comment># muut:</comment>
  kernel /kernel-<comment>&lt;ydinversio&gt;</comment> root=/dev/hda3
</pre>

<pre caption="Asenna ja aseta LILO">
# <i>emerge lilo</i>
# <i>nano -w /etc/lilo.conf</i>
boot=/dev/hda
prompt
timeout=50
default=gentoo

image=/boot/kernel-<comment>&lt;ydinversio&gt;</comment>
  label=gentoo
  read-only
  <comment># genkernel-käyttäjät:</comment>
  append="init=/linuxrc real_root=/dev/hda3 ramdisk=8192"
  root=/dev/ram0
  initrd=/boot/initrd-<comment>&lt;ydinversio&gt;</comment>
  <comment># muut:</comment>
  root=/dev/hda3

# <i>/sbin/lilo</i>
</pre>

<p>
Sitten poistetaan osioiden liitokset ja käynnistetään uusi järjestelmä:
</p>

<pre caption="Viimeistely ja graafisen käyttöliittymän asennus">
(chroot-ympäristöstä poistuminen)
# <i>exit; cd /</i>
(osioiden liitosten poisto)
# <i>umount /mnt/gentoo/boot /mnt/gentoo/proc /mnt/gentoo</i>
(Uudelleenkäynnistä, muista ottaa cd pois asemasta)
# <i>reboot</i>
(Käynnistyksen jälkeen:)
(ADSL-käyttäjät:)
# <i>adsl-setup</i>
(GRP-käyttäjät:)
(  (1) toisen cd:n liittäminen)
    # <i>mount /dev/cdrom /mnt/cdrom</i>
(  (2) pakettien kopiointi)
    # <i>cp -a /mnt/cdrom/packages/* /usr/portage/packages/</i>
(  (3) lisäohjelmiston asennus)
    # <i>USE="bindist" emerge -k xorg-x11 gnome kde mozilla openoffice-bin</i>
(  (4) X-palvelmien asetusten teko)
    # <i>/usr/X11R6/bin/xf86config</i>
</pre>

<p>
Lisätietoa on saatavilla muista <uri
link="/doc/fi/index.xml">Gentoon
dokumenteista</uri>.
</p>
</body>
</section>
</chapter>
</guide>


<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- English CVS Version: 1.106 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/de/handbook/hb-install-system.xml,v 1.53 2007/05/08 05:39:47 grahl Exp $ -->

<sections>

<abstract>
Nach der Installation und Konfiguration der stage3 steht Ihnen ein Gentoo
Basissystem zur Verfügung. Diese Kapitel beschreibt wie man zu diesem Punkt
kommen.
</abstract>

<version>8.0</version>
<date>2007-05-07</date>

<section>
<title>Chroot</title>
<subsection>
<title>Optional: Auswahl eines Mirrors</title>
<body>

<p>
Um Quellcode schnell herunterladen zu können, empfehlen wir einen schnellen
Spiegel auszuwählen. Portage schaut in <path>make.conf</path> nach einer
GENTOO_MIRRORS-Variable und benutzt die dort gelisteten Spiegel. Sie können auf
unserer <uri
link="http://www.gentoo.org/main/en/mirrors.xml">Spiegelübersicht</uri> nach
einem nahegelegenen Spiegel suchen (da diese meist auch die schnellsten sind),
wir bieten jedoch auch ein nettes Tool namens <c>mirrorselect</c> an, welches
Ihnen diesen Schritt abnimmt.
</p>

<pre caption="Nutztung von mirrorselect für die GENTOO_MIRRORS-Variable">
# <i>mirrorselect -i -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<warn>
Wählen Sie keine IPv6 Spiegel aus. Unsere Stage-Archive unterstützen zurzeit
noch kein IPv6.
</warn>

<p>
Eine zweite wichtige Konfiguration ist die SYNC-Variable in
<path>make.conf</path>. Diese Variable enthält den rsync-Server, den Sie zum
aktualisieren Ihres Portage-Trees (die Kollektion von Ebuilds, Skripte die alle
Informationen enthalten, die Portage zur Installation von Software benötigt)
verwenden wollen. Auch wenn Sie dies manuell festlegen können,
<c>mirrorselect</c> kann Ihnen auch diesen Schritt abnehmen:
</p>

<pre caption="Mit mirrorselect einen rsync Server auswählen">
# <i>mirrorselect -i -r -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<p>
Nachdem Sie <c>mirrorselect</c> ausgeführt haben, ist es ratsam die
Einstellungen in <path>/mnt/gentoo/etc/make.conf</path> sorgfältig zu
überprüfen.
</p>

</body>
</subsection>
<subsection>
<title>Kopieren der DNS-Informationen</title>
<body>

<p>
Einen Schritt müssen Sie noch machen, bevor Sie Ihre neue Umgebung betreten
können. Das ist das Kopieren der DNS-Informationen aus der
<path>/etc/resolv.conf</path> in die Chroot-Umgebung. Sie müssen diesen Schritt
ausführen, um sicherzustellen, dass Ihr Netzwerk nach dem Betreten der
Chroot-Umgebung noch funktioniert. <path>/etc/resolv.conf</path> enthält die
Nameserver für Ihr Netzwerk.
</p>

<pre caption="Kopieren der DNS-Informationen">
<comment>(Die "-L" Option wird benötigt um sicherzustellen, dass Sie keinen symbolischen Link kopieren.)</comment>
# <i>cp -L /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</i>
</pre>

</body>
</subsection>
<subsection test="not(func:keyval('arch')='IA64')">
<title>Mounten der /proc und /dev Dateisysteme</title>
<body>

<p>
Mounten Sie das <path>/proc</path> Dateisystem nach
<path>/mnt/gentoo/proc</path>, um für die Installation vom Kernel angebotene
Informationen innerhalb der chroot Umgebung nutzbar zu machen. Mounten Sie
außerdem mit Bind das <path>/dev</path> Dateisystem.
</p>

<pre caption="Mounten von /proc und /dev">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>mount -o bind /dev /mnt/gentoo/dev</i>
</pre>

</body>
</subsection>
<subsection test="func:keyval('arch')='IA64'">
<title>Mounten der /proc, /sys und /dev Dateisysteme</title>
<body>

<p>
Mounten Sie das <path>/proc</path> Dateisystem nach
<path>/mnt/gentoo/proc</path> um es der Installation zu ermöglichen die vom
Kernel bereitgestellten Informationen zu verwenden. Mounten Sie außerdem
mit Bind das <path>/dev</path> und das <path>/sys</path> Dateisystem.
</p>

<pre caption="Mounten von /proc /sys und /dev">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>mount -o bind /dev /mnt/gentoo/dev</i>
# <i>mount -o bind /sys /mnt/gentoo/sys</i>
</pre>

</body>
</subsection>
<subsection>
<title>Betreten der neuen Umgebung</title>
<body>

<p>
Nachdem nun alle Partitionen initialisiert und das Basissystem installiert
ist, können Sie nun Ihre neue Installationsumgebung betreten, indem Sie
in die Umgebung chrooten. Das bedeutet, dass Sie von der aktuellen
Installationsumgebung (die Installations-CD oder ein anderes
Installationsmedium) in Ihr zu installierendes System (nämlich das der
initialisierten Partitionen) wechseln.
</p>

<p>
Das chrooting erfolgt in 3 Schritten. Als erstes werden wir das root von
<path>/</path> (auf dem Installationsmedium) nach /mnt/gentoo (auf Ihren
Partitionen) mittels chroot wechseln. Sie müssen nun eine neue Umgebung
anlegen, indem Sie <c>env-update</c> benutzen, was hauptsächlich neue
Umgebungsvariablen anlegt. Zu guter Letzt laden Sie diese Variablen durch
den Befehl <c>source</c> in den Speicher.
</p>

<pre caption = "Chroot in die neue Umgebung">
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i>
>> Regenerating /etc/ld.so.cache...
# <i>source /etc/profile</i>
# <i>export PS1="(chroot) $PS1"</i>
</pre>

<p>
Glückwunsch! Sie sind nun in Ihrer neuen Gentoo Linux Umgebung. Natürlich sind
wir noch nicht fertig, darum gibt es auch noch einige Abschnitte in der
Anleitung denen Sie folgen müssen.
</p>

</body>
</subsection>
</section>
<section>
<title>Portage konfigurieren</title>
<subsection>
<title>Portage-Tree updaten</title>
<body>

<p>
Sie sollten nun Ihren Portage-Tree auf den aktuellsten Stand bringen. <c>emerge
--sync</c> macht dies für Sie.
</p>

<pre caption="Portage-Tree updaten">
# <i>emerge --sync</i>
<comment>(Wenn Sie ein langsames Terminal verwenden, wie einige Framebuffer
oder eine serielle Konsole, dann können Sie die --quiet Option hinzufügen um
den Vorgang zu beschleunigen)</comment>
# <i>emerge --sync --quiet</i>
</pre>

<p>
Wenn Sie sich hinter einer Firewall befinden, die rsync-Verkehr blockiert,
können Sie <c>emerge-webrsync</c> benutzen, welches einen Snapshot herunterladen
und installieren wird.
</p>

<p>
Falls Sie gewarnt werden, dass eine neue Version von Portage verfügbar ist und
Sie aktualisieren sollten, sollten Sie dies nun mit dem <c>emerge portage</c>
Befehl tun.
</p>

</body>
</subsection>
<subsection>
<title>Auswahl des richtigen Profils</title>
<body>

<p>
Zunächst ist eine kleine Defintion notwendig.
</p>

<p>
Ein Profil ist existenziell für ein Gentoo-System. Es definiert nicht nur
Standardwerte für CHOST, CFLAGS und andere wichtige Variablen, es beschränkt das
System auch auf eine definierte Masse an Paketversionen. Dies alles wird von
Gentoo Entwicklern betreut.
</p>

<p>
Bisher hatten Benutzer mit Profilen wenig zu tun. Jedoch kann es bestimmte
Umstände geben in denen ein Profilwechsel möglicherweise notwendig ist.
</p>

<p>
Sie können das aktuell verwendete Profil mit dem folgenden Befehl anzeigen:
</p>

<pre caption="Überprüfen des Systemprofils">
# <i>ls -FGg /etc/make.profile</i>
lrwxrwxrwx  1 48 Apr  8 18:51 /etc/make.profile -> ../usr/portage/profiles/default-linux/x86/2006.1/
</pre>

<p>
Das Standardprofil wird Ihnen ein 2.6-basierendes Linux-System liefern. Dies
ist der empfohlene Standard, aber Sie haben auch die Möglichkeit ein anderes
Profil zu wählen.
</p>

<p>
Es sind außerdem <c>desktop</c> und <c>server</c> Subprofile für einige
Architekturen verfügbar. Sehen Sie im <path>2007.0/</path> Profil nach um
herauszufinden ob eines für Ihre Subarchitektur verfügbar ist. Sie sollten
sich vielleicht die Zeit nehmen die <path>make.defaults</path> des
<c>desktop</c> Profils anzusehen um festzustellen, ob es zu Ihren Ansprüchen
passt.
</p>

<p>
Nachdem Sie sich die verschiedenen Profile für Ihre Architektur in
<path>/usr/portage/profiles/</path> angesehen haben, können Sie, sofern Sie dies
wünschen, ein anderes verwenden:
</p>

<pre caption="Profile wechseln">
# <i>ln -snf /usr/portage/profiles/&lt;Profilname&gt; /etc/make.profile</i>
</pre>

 <p test="func:keyval('arch')='AMD64'">
Wenn Sie eine reine 64Bit-Umgebung wünschen, ohne 32Bit-Anwendungen oder
-Bibliotheken, sollten Sie ein kein-Multilib Profil verwenden:
</p>

<pre test="func:keyval('arch')='AMD64'" caption="Auf ein kein-Multilib Profil">
# <i>ln -snf /usr/portage/profiles/default-linux/amd64/2007.0/no-multilib /etc/make.profile</i>
</pre>

</body>
</subsection>
<subsection id="configure_USE">
<title>Konfiguration der USE-Variable</title>
<body>

<p>
<c>USE</c> heißt eine der mächtigsten Variable, die Gentoo seinen Benutzern
anbietet. Viele Programme können mit oder ohne optionale Unterstützung für
bestimmte Dinge übersetzt werden. Beispielsweise können einige Programme mit
gtk Unterstützung oder mit qt Unterstützung übersetzt werden oder mit keiner
der beiden. Einige Programme können mit oder ohne SSL-Unterstützung übersetzt
werden. Einige Programme können sogar mit Framebuffer-Support (svgalib)
anstelle von X11-Support (X-server) übersetzt werden.
</p>

<p>
Die meisten Distributionen kompilieren ihre Pakete mit eingeschalteter
Unterstützung für alles, was möglich ist. Dies vergrößert die Programme,
verlängert die Startzeit und, nicht zu vergessen, erhöht die Abhängigkeiten.
Mit Gentoo können Sie selbst bestimmen, mit welchen Optionen ein Paket
übersetzt werden soll. Hier kommen die <c>USE</c>-Variable ins Spiel.
</p>

<p>
Mit der <c>USE</c>-Variable definieren Sie Schlagworte, die dann auf
Optionen beim Übersetzen abgebildet werden. Zum Beispiel wird <e>ssl</e>
zu SSL-Unterstützung führen, wenn das Programm dies unterstützt.
<e>-X</e> entfernt die X-Server-Unterstützung (beachten Sie das
Minuszeichen). <e>gnome gtk -kde -qt3 -qt4</e> führt zu übersetzten
Programmen mit Gnome- (und gtk-) Unterstützung aber ohne KDE- (und QT-)
Unterstützung, also zu einem ganz auf GNOME ausgerichteten System.
</p>

<p>
Die Standardeinstellungen für <c>USE</c> sind in der
<path>make.defaults</path> Datei in Ihrem Profil definiert.
Sie finden <path>make.defaults</path> Dateien in dem Verzeichnis, auf welches
<path>/etc/make.profile</path> zeigt und dem übergeordneten Verzeichnissen. Die
Gesamtheit aller aktivierten USE-Flags ergibt sich aus allen Angaben von
<c>USE</c> in allen <path>make.defaults</path> Dateien. Was Sie in
<path>/etc/make.conf</path> platzieren, wird zu den Standardeinstellungen
addiert. Wenn Sie der <c>USE</c>-Einstellung etwas hinzufügen, werden die
Standardvorgaben damit erweitert. Wenn Sie aus der <c>USE</c>-Einstellung
etwas entfernen (mit einem Minuszeichen davor), so wird dies
aus der Standardeinstellung entfernt (falls es überhaupt in dieser
vorhanden war). <e>Niemals</e> sollten Sie irgendwas in
<path>/etc/make.profile</path> modifizieren; dies wird beim nächsten Update von
Portage überschrieben!
</p>

<p>
Eine vollständige Beschreibung zu <c>USE</c> können Sie im zweiten Teil des
Gentoo-Handbuchs, <uri link="?part=2&amp;chap=2">USE-Flags</uri>,
lesen. Eine vollständige Beschreibung der USE-Flags finden Sie in Ihrem System
in <path>/usr/portage/profiles/use.desc</path>.
</p>

<pre caption="Verfügbare USE-Flags anschauen">
# <i>less /usr/portage/profiles/use.desc</i>
<comment>(Sie können mit den Pfeiltasten scrollen, verlassen Sie less mit 'q')</comment>
</pre>

<p>
Als Beispiel nun die <c>USE</c>-Einstellung für ein
KDE-basiertes System mit Überstützung für DVD, ALSA und
CD-Brenner.
</p>

<pre caption="/etc/make.conf öffnen">
# <i>nano -w /etc/make.conf</i>
</pre>

<pre caption="USE-Einstellung">
USE="-gtk -gnome qt3 qt4 kde dvd alsa cdr"
</pre>

</body>
</subsection>
<subsection>
<title>Optional: Glibc-Locales</title>
<body>

<p>
Sie werden vermutlich nur ein oder vielleicht zwei Locales in Ihrem System
benötigen. Sie können Locales, die Sie benötigen werden, in
<path>/etc/locale.gen</path> spezifizieren.
</p>

<pre caption="Öffnen von /etc/locale.gen">
# <i>nano -w /etc/locale.gen</i>
</pre>

<p>
Die folgenden Locales sind ein Beispiel um Englisch (Vereinigte Staaten) und
Deutsch (Deutschland) mit den passendenden Zeichensätzen (wie UTF-8) zu
erhalten.
</p>

<pre caption="Spezifizieren Ihrer Locales">
en_US ISO-8859-1
en_US.UTF-8 UTF-8
de_DE ISO-8859-1
de_DE@euro ISO-8859-15
</pre>

<p>
Der nächste Schritt ist <c>locale-gen</c> auszuführen. Es erstellt alle
Locales, die Sie in der <path>/etc/locale.gen</path> Datei spezifiziert haben.
</p>

<p>
Fahren Sie nun mit der <uri link="?part=1&amp;chap=7">Konfiguration des
Kernels</uri> fort.
</p>

</body>
</subsection>
</section>
</sections>

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- English CVS Version: 1.92 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/de/handbook/hb-install-system.xml,v 1.45 2006/03/09 01:45:27 grahl Exp $ -->

<sections>

<version>2.19</version>
<date>2006-03-06</date>

<section>
<title>Chroot</title>
<subsection>
<title>Optional: Auswahl eines Mirrors</title>
<body>

<p>
Um Quellcode schnell herunterladen zu können, empfehlen wir einen schnellen
Spiegel auszuwählen. Portage schaut in <path>make.conf</path> nach einer
GENTOO_MIRRORS-Variable und benutzt die dort gelisteten Spiegel. Sie können auf
unserer <uri 
link="http://www.gentoo.org/main/en/mirrors.xml">Spiegelübersicht</uri> nach
einem nahegelegenen Spiegel suchen (da diese meist auch die schnellsten sind),
wir bieten jedoch auch ein nettes Tool namens <c>mirrorselect</c> an, welches
Ihnen diesen Schritt abnimmt.
</p>

<pre caption="Nutztung von mirrorselect für die GENTOO_MIRRORS-Variable">
# <i>mirrorselect -i -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<warn>
Wählen Sie keine IPv6 Spiegel aus. Unsere Stage-Archive unterstützen zur Zeit
noch kein IPv6.
</warn>

<p>
Eine zweite wichtige Konfiguration ist die SYNC-Variable in
<path>make.conf</path>. Diese Variable enthält den rsync-Server, den Sie zum
aktualisieren Ihres Portage-Trees (die Kollektion von Ebuilds, Skripte die alle
Informationen enthalten, die Portage zur Installation von Software benötigt)
verwenden wollen. Auch wenn Sie dies manuell festlegen können,
<c>mirrorselect</c> kann Ihnen auch diesen Schritt abnehmen:
</p>

<pre caption="Mit mirrorselect einen rsync Server auswählen">
# <i>mirrorselect -i -r -o &gt;&gt; /mnt/gentoo/etc/make.conf</i>
</pre>

<p>
Nachdem Sie <c>mirrorselect</c> ausgeführt haben, ist es ratsam die
Einstellungen in <path>/mnt/gentoo/etc/make.conf</path> sorgfältig zu
überprüfen.
</p>

</body>
</subsection>
<subsection>
<title>Kopieren der DNS-Informationen</title>
<body>

<p>
Einen Schritt müssen Sie noch machen, bevor Sie Ihre neue Umgebung betreten
können. Das ist das Kopieren der DNS-Informationen aus der
<path>/etc/resolv.conf</path> in die Chroot-Umgebung. Sie müssen diesen Schritt
ausführen, um sicherzustellen, dass Ihr Netzwerk nach dem Betreten der 
Chroot-Umgebung noch funktioniert. <path>/etc/resolv.conf</path> enthält die Nameserver
für Ihr Netzwerk.
</p>

<pre caption="Kopieren der DNS-Informationen">
<comment>(Die "-L" Option wird benötigt um sicherzustellen, dass Sie keinen symbolischen Link kopieren</comment>
# <i>cp -L /etc/resolv.conf /mnt/gentoo/etc/resolv.conf</i>
</pre>

</body>
</subsection>
<subsection>
<title>Mounten der /proc und /dev Dateisysteme</title>
<body>

<p>
Mounten Sie das <path>/proc</path> Dateisystem nach
<path>/mnt/gentoo/proc</path>, um für die Installation vom Kernel angebotene
Informationen innerhalb der chroot Umgebung nutzbar zu machen. Mounten Sie
außerdem mit Bind das <path>/dev</path> Dateisystem.
</p>

<pre caption="Mounten von /proc und /dev">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>mount -o bind /dev /mnt/gentoo/dev</i>
</pre>

</body>
</subsection>
<subsection>
<title>Betreten der neuen Umgebung</title>
<body>

<p>
Nachdem nun alle Partitionen initialisiert und das Basissystem installiert
ist, können Sie nun Ihre neue Installationsumgebung betreten, indem Sie
in die Umgebung chrooten. Das bedeutet, dass Sie von der aktuellen
Installationsumgebung (die Installations-CD oder ein anderes
Installationsmedium) in Ihr zu installierendes System (nämlich das der
initialisierten Partitionen) wechseln.
</p>

<p>
Das chrooting erfolgt in 3 Schritten. Als erstes werden wir das root von
<path>/</path> (auf dem Installationsmedium) nach /mnt/gentoo (auf Ihren
Partitionen) mittels chroot wechseln. Sie müssen nun eine neue Umgebung
anlegen, indem Sie <c>env-update</c> benutzen, was hauptsächlich neue
Umgebungsvariablen anlegt. Zu guter Letzt laden Sie diese Variablen durch
den Befehl <c>source</c> in den Speicher.
</p>

<pre caption = "Chroot in die neue Umgebung">
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i>
>> Regenerating /etc/ld.so.cache...
# <i>source /etc/profile</i>
# <i>export PS1="(chroot) $PS1"</i>
</pre>

<p>
Glückwunsch! Sie sind nun in Ihrer neuen Gentoo Linux Umgebung. Natürlich sind
wir noch nicht fertig, darum gibt es auch noch einige Abschnitte in der
Anleitung denen Sie folgen müssen.
</p>

</body>
</subsection>
</section>
<section>
<title>Portage konfigurieren</title>
<subsection>
<title>Portage-Tree updaten</title>
<body>

<p>
Sie sollten nun Ihren Portage-Tree auf den aktuellsten Stand bringen. <c>emerge
--sync</c> macht dies für Sie.
</p>

<pre caption="Portage-Tree updaten">
# <i>emerge --sync</i>
<comment>(Wenn Sie ein langsames Terminal verwenden, wie einige Framebuffer 
oder eine serielle Konsole, dann können Sie die --quiet Option hinzufügen um 
den Vorgang zu beschleunigen)</comment>
# <i>emerge --sync --quiet</i>
</pre>

<p>
Wenn Sie sich hinter einer Firewall befinden, die rsync-Verkehr blockiert,
können Sie <c>emerge-webrsync</c> benutzen, welches einen Snapshot herunterladen
und installieren wird.
</p>

<p>
Falls Sie gewarnt werden, dass eine neue Portage-Version verfügbar ist,
sollten Sie diese Meldung ignorieren. Portage wird zu einem
späteren Zeitpunkt während der Installation für Sie aktualisiert.
</p>

</body>
</subsection>
<subsection>
<title>Auswahl des richtigen Profils</title>
<body>

<p>
Zunächst ist eine kleine Defintion notwendig.
</p>

<p>
Ein Profil ist existenziell für ein Gentoo-System. Es definiert nicht nur
Standardwerte für CHOST, CFLAGS und andere wichtige Variablen, es beschränkt das
System auch auf eine definierte Masse an Paketversionen. Dies alles wird von
Gentoo Entwicklern betreut.
</p>

<p>
Bisher hatten Gentoo Benutzer mit Profilen wenig zu tun. Jedoch können x86, 
hppa und alpha Benutzer zwischen zwei Profilen wählen. Eins für einen 2.4 
Kernel und eins für einen 2.6 Kernel. Diese Anforderung wurde eingeführt um 
die Integration des 2.6 Kernels zu verbessern. Die ppc und ppc64 Architekturen
halten auch mehrere Profile bereit, diese werden später besprochen.
</p>

<p>
Sie können das aktuell verwendete Profil mit dem folgenden Befehl anzeigen:
</p>

<pre caption="Überprüfen des Systemprofils">
# <i>ls -FGg /etc/make.profile</i>
lrwxrwxrwx  1 48 Apr  8 18:51 /etc/make.profile -> ../usr/portage/profiles/default-linux/x86/2006.0/
</pre>

<p>
Wenn Sie eine der gerade erwähnten drei Architekturen benutzen, wird das
Standardprofil Ihnen ein 2.6-basierendes Linux-System liefern. Dies ist der
empfohlene Standard, aber Sie haben auch die Möglichkeit ein anderes Profil
zu wählen.
</p>

<pre caption="Herausfinden ob weitere Profile existieren">
# <i>ls -d /usr/portage/profiles/default-linux/x86/no-nptl/2.4</i>
/usr/portage/profiles/default-linux/x86/no-nptl/2.4
</pre>

<p>
Wie Sie in obigem Beispiel sehen können, existiert ein zusätzliches 2.4 Profil
(es gab also keine Fehlermeldung über eine fehlende Datei oder ein fehlendes
Verzeichnis). Es wird empfohlen, dass Sie bei der Voreinstellung
bleiben, aber wenn Sie wechseln möchten, tun Sie dies wie folgt:
</p>

<pre caption="Auf ein 2.4-Profil wechseln">
<comment>(Stellen Sie sicher, dass Sie die richtige Architektur verwenden. Das folgende Beispiel ist für x86)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/x86/no-nptl/2.4 /etc/make.profile</i>
<comment>(Auflisten der Dateien im 2.4-Profil)</comment>
# <i>ls -FGg /etc/make.profile/</i>
total 12
-rw-r--r--  1 939 Dec 10 14:06 packages
-rw-r--r--  1 347 Dec  3  2004 parent
-rw-r--r--  1 573 Dec  3  2004 virtuals
</pre>

<p>
Für ppc gibt es eine Mehrzahl von neuen Profilen, die mit 2006.0 geliefert
werden.
</p>

<pre caption="PPC-Profile">
<comment>(Generisches PPC-Profil, für alle PPC-Rechner, Minimal)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0 /etc/make.profile</i>
<comment>(G3 Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G3 /etc/make.profile</i>
<comment>(G3 Pegasos Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G3/Pegasos/ /etc/make.profile</i>
<comment>(G4 (Altivec) Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G4 /etc/make.profile</i>
<comment>(G4 (Altivec) Pegasos Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc32/2006.0/G4/Pegasos/ /etc/make.profile</i>
</pre>

<p>
Für ppc64 gibt es eine Mehrzahl von neuen Profilen, die mit 2006.0 geliefert
werden.
</p>

<pre caption="PPC64-Profile">
<comment>(Generisches 64bit Userland PPC64 Profil, für alle PPC64 Rechner)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/64bit-userland /etc/make.profile</i>
<comment>(Generisches 32bit Userland PPC64 Profil, für alle PPC64 Rechner)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/32bit-userland /etc/make.profile</i>
<comment>(Jede Art von Userland hat folgende Subprofile; mit (userland) ersetzt durch das obig gewählte Userland)</comment>
<comment>(970 Profil für JS20)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/970 /etc/make.profile</i>
<comment>(G5 Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/970/pmac /etc/make.profile</i>
<comment>(POWER3 Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/power3 /etc/make.profile</i>
<comment>(POWER4 Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/power4 /etc/make.profile</i>
<comment>(POWER5 Profil)</comment>
# <i>ln -snf /usr/portage/profiles/default-linux/ppc/ppc64/2006.0/(userland)/power5 /etc/make.profile</i>
<comment>(Das multilib Profil ist zum Zeitpunkt dieses Releases noch nicht stabil.)</comment>
</pre>


</body>
</subsection>
<subsection id="configure_USE">
<title>Konfiguration der USE-Variable</title>
<body>

<p>
<c>USE</c> heißt eine der mächtigsten Variable, die Gentoo seinen Benutzern
anbietet. Viele Programme können mit oder ohne optionale Unterstützung für 
bestimmte Dinge übersetzt werden. Beispielsweise können einige Programme mit
gtk Unterstützung oder mit qt Unterstützung übersetzt werden oder mit keiner
der beiden. Einige Programme können mit oder ohne SSL-Unterstützung übersetzt
werden. Einige Programme können sogar mit Framebuffer-Support (svgalib) 
anstelle von X11-Support (X-server) übersetzt werden.
</p>

<p>
Die meisten Distributionen kompilieren ihre Pakete mit eingeschalteter
Unterstützung für alles, was möglich ist. Dies vergrößert die Programme,
verlängert die Startzeit und, nicht zu vergessen, erhöht die Abhängigkeiten.
Mit Gentoo können Sie selbst bestimmen, mit welchen Optionen ein Paket
übersetzt werden soll. Hier kommen die <c>USE</c>-Variable ins Spiel.
</p>

<p>
Mit der <c>USE</c>-Variable definieren Sie Schlagworte, die dann auf
Optionen beim Übersetzen abgebildet werden. Zum Beispiel wird <e>ssl</e>
zu SSL-Unterstützung führen, wenn das Programm dies unterstützt.
<e>-X</e> entfernt die X-Server-Unterstützung (beachten Sie das
Minuszeichen). <e>gnome gtk -kde -qt</e> führt zu übersetzten
Programmen mit Gnome- (und gtk-) Unterstützung aber ohne KDE- (und QT-)
Unterstützung, also zu einem ganz auf Gnome ausgerichteten System.
</p>

<p>
Die Standardeinstellungen für <c>USE</c> sind in der
<path>make.defaults</path> Datei in Ihrem Profil definiert.
Sie finden <path>make.defaults</path> Dateien in dem Verzeichnis, auf welches
<path>/etc/make.profile</path> zeigt und dem übergeordneten Verzeichnissen. Die
Gesamtheit aller aktivierten USE-Flags ergibt sich aus allen <c>USE</c>-Angaben
in allen <path>make.defaults</path> Dateien. Was Sie in 
<path>/etc/make.conf</path> platzieren, wird zu den Standardeinstellungen
addiert. Wenn Sie der <c>USE</c>-Einstellung etwas hinzufügen, werden die
Standardvorgaben damit erweitert. Wenn Sie aus der <c>USE</c>-Einstellung
etwas entfernen (mit einem Minuszeichen davor), so wird dies
aus der Standardeinstellung entfernt (falls es überhaupt in dieser
vorhanden war). <e>Niemals</e> sollten Sie irgendwas in
<path>/etc/make.profile</path> modifizieren; dies wird beim nächsten Portage-Update 
überschrieben!
</p>

<p>
Eine vollständige Beschreibung zu <c>USE</c> können Sie im zweiten Teil des
Gentoo-Handbuchs, <uri link="?part=2&amp;chap=2">USE-Flags</uri>,
lesen. Eine vollständige Beschreibung der USE-Flags finden Sie in Ihrem System
in <path>/usr/portage/profiles/use.desc</path>.
</p>

<pre caption="Verfügbare USE-Flags anschauen">
# <i>less /usr/portage/profiles/use.desc</i>
<comment>(Sie können mit den Pfeiltasten scrollen, verlassen Sie less mit 'q')</comment>
</pre>

<p>
Als Beispiel nun die <c>USE</c>-Einstellung für ein
KDE-basiertes System mit Überstützung für DVD, ALSA und
CD-Brenner.
</p>

<pre caption="/etc/make.conf Öffnen">
# <i>nano -w /etc/make.conf</i>
</pre>

<p>
Eine vollständige Beschreibung zu <c>USE</c> können Sie in unserem
<uri link="?part=2&amp;chap=2">USE-Howto</uri> finden.
Als Beispiel nun die <c>USE</c> Einstellung für ein
KDE-basiertes System mit Überstützung für DVD, ALSA und
CD-Brenner.
</p>

<pre caption="USE Einstellung">
USE="-gtk -gnome qt kde dvd alsa cdr"
</pre>

</body>
</subsection>
<subsection>
<title>Optional: GLIBC Locales</title>
<body>

<p>
Sie werden vermutlich nur ein oder vielleicht zwei Locales in Ihrem System
benötigen. Bisher wurden nach dem Kompilieren der <c>glibc</c> alle verfügbaren
Locales erstellt. Von jetzt an können Sie das <c>userlocales</c> USE-Flag
aktivieren und die Locales, die Sie benötigen, in
<path>/etc/locales.build</path> angeben. Tun Sie dies nur, wenn Sie wissen,
welche Locales Sie benötigen.
</p>

<pre caption="Aktivieren des userlocales-USE-Flags für die glibc">
# <i>mkdir -p /etc/portage</i>
# <i>echo "sys-libs/glibc userlocales" >> /etc/portage/package.use</i>
</pre>

<p>
Geben Sie nun die von Ihnen benötigten Locales an:
</p>

<pre caption="/etc/locales.build öffnen">
# <i>nano -w /etc/locales.build</i>
</pre>

<p>
Die folgenden Locales sind ein Beispiel um Englische (Vereinigte Staaten) und
Deutsche (Deutschland) Locales in den entsprechenden Charakterformaten (wie
UTF-8) zu bekommen.
</p>

<pre caption="Spezifizieren der Locales">
en_US/ISO-8859-1
en_US.UTF-8/UTF-8
de_DE/ISO-8859-1
de_DE@euro/ISO-8859-15
</pre>

<p>
Fahren Sie nun mit der <uri link="?part=1&amp;chap=7">Konfiguration des
Kernels</uri> fort.
</p>

</body>
</subsection>
</section>
</sections>

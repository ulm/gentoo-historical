<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- English CVS Version: 1.74 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/de/handbook/hb-install-stage.xml,v 1.24 2004/12/12 17:42:42 dertobi123 Exp $ -->

<sections>

<version>1.69</version>
<date>2004-12-11</date>

<section>
<title>Ein Stagearchiv installieren</title>
<subsection>
<title>Setzen von Zeit/Datum</title>
<body>

<p>
Bevor Sie fortfahren, sollten Sie Ihre Zeit/Datum Einstellung überprüfen und
gegebenenfalls anpassen. Eine falsch eingestellte Uhr kann zu merkwürdigen
Resultaten in der Zukunft führen.
</p>

<p>
Um Zeit und Datum zu überprüfen, führen Sie <c>date</c> aus:
</p>

<pre caption="Zeit/Datum überprüfen">
# <i>date</i>
Fri Oct 29 16:21:18 CEST 2004
</pre>

<p>
Wenn Zeit oder Datum falsch angezeigt wird, passen Sie die Einstellung mit der
<c>date MMDDhhmmYYYY</c> Syntax (<b>M</b>onth, <b>D</b>ay, <b>h</b>our,
<b>m</b>inute und <b>Y</b>ear) an. Um die Zeiteinstellung auf den 29. Oktober
2004, 16 Uhr 21 zu setzen, führen Sie zum Beispiel folgendes Kommando aus:
</p>

<pre caption="Setzen von Zeit/Datum">
# <i>date 102916212004</i>
</pre>

</body>
</subsection>
<subsection>
<title>Eine Wahl treffen</title>
<body>

<p>
Der nächste Schritt ist die Installation des Stage Archivs Ihrer Wahl auf Ihrem
System. Sie können den entsprechenden Tarball aus dem Internet laden oder, wenn
Sie von einer der Gentoo Universal LiveCDs gebootet haben, von einer CD
kopieren. Wenn Sie die Universal CD haben und das Stage Archiv welches Sie
nutzen möchten auf dieser CD enthalten ist, ist es eine reine
Bandbreitenverschwendung das Stage Archiv noch einmal herunterzuladen, da diese
Stages gleich sind. In den meisten Fällen hilft Ihnen das Kommando <c>uname
-m</c> die Entscheidung abzunehmen, welches Stage Archiv für Sie das geeignete
ist.
</p>

<ul>
<li><uri link="#doc_chap2">Standard: Herunterladen aus dem Internet</uri></li>
<li><uri link="#doc_chap3">Alternativ: Stagearchiv von LiveCD benutzen</uri></li>
</ul>

</body>
</subsection>
</section>
<section>
<title>Standard: Herunterladen aus dem Internet</title>
<subsection>
<title>Herunterladen des Stagearchivs</title>
<body>

<p>
Wechseln Sie nun zum Gentoo Mountpoint, jenes Verzeichnis unter dem
Sie vorhin Ihre zukünftige Gentoo Partition eingebunden haben
(wahrscheinlich <path>/mnt/gentoo</path>):
</p>

<pre caption="Wechseln zum Gentoo Mountpoint">
# <i>cd /mnt/gentoo</i>
</pre>

<p>
Abhängig vom Installationsmedium finden Sie verschiedene Programme um das
Stagearchiv herunter zu laden. Falls <c>links2</c> verfügbar ist, können Sie 
sofort die <uri link="http://www.gentoo.org/main/en/mirrors.xml">Gentoo Mirrorliste</uri> 
ansteuern und und einen Mirror in Ihrer Nähe auswählen. Wenn <c>links2</c> nicht
verfügbar ist sollte Ihnen <c>lynx</c> bereit stehen. In diesem Fall ersetzen
Sie alle vorkommenden <c>links2</c> Aufrufe durch <c>lynx</c>.
</p>

<p>
Wechseln Sie dann in das Verzeichnis <path>releases/</path>, gefolgt von Ihrer
Rechnerarchitektur (zum Beispiel <path>x86/</path>) und der Gentoo Version
(<path>2004.3</path>). In dem Verzeichnis <path>stages/</path> finden Sie die
für Ihren Rechnertypen verfügbaren Stagearchive (sie sind möglichweise in
individuellen Unterverzeichnissen abgelegt). Wählen Sie eins und starten den
Download mit der Taste <c>D</c>! Danach können Sie den Browser mit der Taste
<c>Q</c> schließen.
</p>

<pre caption="Mirrorliste mit links2 anschauen">
<comment>(Ohne Proxy)</comment>   # <i>links2 http://www.gentoo.org/main/en/mirrors.xml</i>
<comment>(Mit Proxy)</comment>    # <i>links2 -http-proxy proxy.server.com:8080 http://www.gentoo.org/main/en/mirrors.xml</i>
</pre>

<p>
Wenn Sie die Integrität des heruntergeladenen Stage Archives prüfen wollen,
benutzen Sie <c>md5sum</c> und vergleichen Sie die Ausgabe mit den MD5 Prüfsummen
auf dem Mirror. Kontrollen Sie zum Beispiell die Integrität eines x86 Stage
Archiv:
</p>

<pre caption="Integrität eines Stage Archives prüfen">
# <i>md5sum -c stage1-x86-2004.3.tar.bz2.md5</i>
stage1-x86-2004.3.tar.bz2: OK
</pre>

</body>
</subsection>
<subsection>
<title>Entpacken des Stagearchiv</title>
<body>

<p>
Nun entpackten Sie das heruntergeladene Stagearchiv auf Ihrem System.
Wir benutzen GNU <c>tar</c> dafür, weil es der direkte Weg ist:
</p>

<pre caption="Entpacken des Stage-Archivs">
# <i>tar -xvjpf stage?-*.tar.bz2</i>
</pre>

<p>
Stellen Sie sicher, dass Sie die gleichen Schalter (<c>-xvjpf</c>) verwenden.
Das <c>x</c> steht für <e>Auspacken</e> (engl. <e>Extract</e>), das <c>v</c>
für <e>Auskunftsfreudig</e> (engl. <e>Verbose</e>) (zugegeben, dies ist optional),
das <c>j</c> für <e>Dekomprimieren mit bzip2</e>, das <c>p</c> für <e>Erhalt 
der Dateirechte</e> (engl. <e>Preserve permissions</e>) und das <c>f</c> zeigt
an, dass wir eine Datei auspacken wollen und nicht die Standardeingabe
benutzen.
</p>

<p>
Wenn das Stage Archiv installiert ist, fahren Sie nun mit der
<uri link="#installing_portage">Installation von Portage</uri> fort.
</p>

</body>
</subsection>
</section>
<section>
<title>Alternativ: Stagearchiv von der LiveCD benutzen</title>
<subsection>
<title>Enpacken des Stagearchiv</title>
<body>

<p>
Die Stagearchive auf der CD liegen im Verzeichnis <path>/mnt/cdrom/stages</path>.
Um eine Auflistung zu erhalten, benutzen Sie <c>ls</c>:
</p>

<pre caption="Liste aller verfügbarer Stage Archive">
# <i>ls /mnt/cdrom/stages</i>
</pre>

<p>
Falls das System mit einem Fehler wie unten antwortet, müssen Sie die
CD-ROM mounten:
</p>

<pre caption="Mounten der CD-ROM">
# <i>ls /mnt/cdrom/stages</i>
ls: /mnt/cdrom/stages: No such file or directory
# <i>mount /dev/cdroms/cdrom0 /mnt/cdrom</i>
# <i>ls /mnt/cdrom/stages</i>
</pre>

<p>
Nun gehen Sie zu Ihrem Gentoo Mountpunkt (gewöhnlich <path>/mnt/gentoo</path>):
</p>

<pre caption="Wechseln des Verzeichnisses zu /mnt/gentoo">
# <i>cd /mnt/gentoo</i>
</pre>

<p>
Wir werden nun das von Ihnen gewählte Stage Archiv entpacken. Dies erledigt
GNU <c>tar</c>. Benutzen Sie die gleichen Schalter (<c>-xvjpf</c>)!
Beispielhaft entpacken wir das Stage Archiv
<path>stage3-&lt;Subarchitektur&gt;-2004.3.tar.bz2</path>. Ersetzen Sie den Dateinamen durch den
Ihres Stage Archivs!
</p>

<pre caption="Entpacken des Stagearchivs">
# <i>tar -xvjpf /mnt/cdrom/stages/stage3-&lt;Subarchitektur&gt;-2004.3.tar.bz2</i>
</pre>

<p>
Wenn das Stage Archiv installiert ist, fahren Sie nun mit der
<uri link="#installing_portage">Installation von Portage</uri> fort.
</p>

</body>
</subsection>
</section>
<section id="installing_portage">
<title>Installation von Portage</title>
<subsection>
<title>Einen Portage Snaphsot entpacken</title>
<body>

<p>
Sie müssen einen Snapshot des Portage Tree installieren, eine Sammlung von
Dateien, die Portage informieren, welche Porgramme installiert werden können,
welche Profile es gibt, etc.
</p>

<p>
Wenn Sie eine Universal LiveCD gebootet haben befinden sich ein Snapshot bereits
auf diese CD. Falls nicht müssen Sie einen Snapshot von einem unserer Mirror
beziehen.
</p>

<p>
Fahren Sie nun mit dem entsprechenden Abschnitt fort:
</p>

<ul>
  <li>
    <uri link="#installing_from_LiveCD">Entpacken des Snapshot von der LiveCD</uri>
  </li>
  <li>
    <uri link="#installing_from_internet">Entpacken eines heruntergeladenen
    Snapshot</uri>
  </li>
</ul>

</body>
</subsection>
<subsection id="installing_from_LiveCD">
<title>Entpacken des Snapshot von der LiveCD</title>
<body>

<p>
Um den Snapshot zu installieren werfen Sie einen Blick in
<path>/mnt/cdrom/snapshots/</path> um herauszufinden, welcher Snapshot verfügbar
ist.
</p>

<pre caption="Inhalt von /mnt/cdrom/snapshots">
# <i>ls /mnt/cdrom/snapshots</i>
</pre>

<p>
Nun entpacken Sie den Snapshot Ihrer Wahl mit folgendem Befehl.
Vergewissern Sie sich wieder, die korrekten Optionen für <c>tar</c> zu
benutzen. Achten Sie auch darauf, <c>-C</c> mit einem großen <c>C</c> und
keinem <c>c</c> zu schreiben. Im nächsten Beispiel benutzen wir
<path>portage-20041022.tar.bz2</path> als Snapshot Dateiname. Denken Sie auch
daran, den Namen an den Snapshot der LiveCD anzupassen.
</p>

<pre caption="Entpacken des Portage Schnappschuss">
# <i>tar -xvjf /mnt/cdrom/snapshots/portage-20041022.tar.bz2 -C /mnt/gentoo/usr</i>
</pre>

<p>
Fahren Sie mit <uri link="#networklessornot">Netzwerklose Installation?</uri>
fort.
</p>

</body>
</subsection>
<subsection id="installing_from_internet">
<title>Entpacken eines heruntergeladenen Snapshot</title>
<body>

<p>
Wechseln Sie zu dem Mountpoint, an den Sie Ihre Dateisystem gemountet haben
(meistens <path>/mnt/gentoo</path>):
</p>

<pre caption="Wechseln zum Mountpoint">
# <i>cd /mnt/gentoo</i>
</pre>

<p>
Starten Sie <c>links2</c> (oder <c>lynx</c>) und wechseln Sie auf die <uri
link="http://www.gentoo.org/main/en/mirrors.xml">Gentoo Mirror Liste</uri>.
Wählen Sie einen nahegelegenen Mirror aus und üffnen Sie das
<path>snapshots/</path> Verzeichnis. Laden Sie von dort den aktuellsten Snapshot
(zum Beispiel <path>portage-20041202.tar.bz2</path> herunter, indem Sie <c>D</c>
drücken.
</p>

<pre caption="Anschauend er Gentoo Mirror Liste">
# <i>links2 http://www.gentoo.org/main/en/mirrors.xml</i>
</pre>

<p>
Schliessen Sie den Browser nun mittles <c>Q</c>. Sie haben nun einen Snapshot in
<path>/mnt/gentoo</path> liegen. Im nächsten Schritt werden wir den Snapshot im
Dateisystem entpacken:
</p>

<pre caption="Einen Portage Snapshot entpacken">
# <i>tar -xvjf /mnt/gentoo/portage-20041202.tar.bz2 -C /mnt/gentoo/usr</i>
</pre>

</body>
</subsection>
<subsection id="networklessornot">
<body>

<p>
Wenn Sie eine Netzwerklose Installation durchführen müssen Sie weiterhin auch
alle Quell Archive von der Universal LiveCD auf die Festplatte kopieren. Wenn
nicht sollten Sie diesen Schritt überspringen und mit der
<uri link="#compile_options">Konfiguration der Compiler Optionen</uri>
fortfahren.
</p>

<pre caption="Kopieren des Quellcode">
# <i>mkdir /mnt/gentoo/usr/portage/distfiles</i>
# <i>cp /mnt/cdrom/distfiles/* /mnt/gentoo/usr/portage/distfiles/</i>
</pre>

</body>
</subsection>
</section>
<section id="compile_options">
<title>Konfiguration der Compiler Optionen</title>
<subsection>
<title>Einführung</title>
<body>

<p>
Um Gentoo zu optimieren, können Sie einige Variablen setzen, die Einfluss
auf das Verhalten von Portage nehmen. Alle diese Variablen können als
Umgebungsvariablen gesetzt werden (mit <c>export</c>), dies ist aber keine
dauerhafte Lösung. Um Ihre Einstellungen zu behalten, bietet Portage Ihnen
<path>/etc/make.conf</path>, eine Konfigurationsdatei für Portage. Diese Datei
werden wir nun bearbeiten.
</p>

<note>
Eine kommentierte Auflistung aller verfügbaren Variablen finden Sie in
<path>/mnt/gentoo/etc/make.conf.example</path>. Für eine erfolgreiche Gentoo
Installation müssen Sie aber nur die im folgenden beschriebenen Variablen
setzen.
</note>

<p>
Starten Sie Ihren Lieblingseditor (in diesem Leitfaden nutzen wir <c>nano</c>)
um die im Folgenden vorgestellten Optimierungsvariablen zu ändern.
</p>

<pre caption="Öffnen von /etc/make.conf">
# <i>nano -w /mnt/gentoo/etc/make.conf</i>
</pre>

<p>
Wie Sie sicher sofort bemerkt haben, schaut die Datei <path>make.conf.example</path>
wie eine typische Konfigurationsdatei aus: auskommentierte Zeilen beginnen mit
einem "#", andere Zeilen definieren Variablen mittels einer
<c>VARIABLE="content"</c> Syntax. Die <path>make.conf</path> Datei nutzt die
gleiche Syntax. Einige dieser Variablen werden nun vorgestellt.
</p>

<warn>
Führen Sie keine Änderungen an der USE Variable durch, wenn Sie eine Stage3
Installation mit GRP durchführen wollen. Sie können die USE Flags nach der
Installation nach Ihren Vorstellungen anpassen.
</warn>

</body>
</subsection>
<subsection>
<title>CHOST</title>
<body>

<warn>
Auch wenn es bei einer nicht-Stage1 Installation verlockend erscheint, sollten
Sie die <c>CHOST</c> Einstellungen in <path>make.conf</path> <e>nicht</e>
verändern! Dies könnte zu einem unbenutzbaren System führen. Nochmal: Sie
dürfen die Variable nur ändern, wenn Sie eine <e>Stage1</e> Installation
vornehmen.
</warn>

<p>
Die <c>CHOST</c> Variable bestimmt, für welche Architektur der <c>gcc</c>
die Programme übersetzt. Zur Auswahl steht:
</p>

<table>
<tr>
  <th>Architektur</th>
  <th>Unterarchitektur</th>
  <th>CHOST Einstellung</th>
</tr>
<tr>
  <ti>x86</ti>
  <ti>i386</ti>
  <ti>i386-pc-linux-gnu</ti>
</tr>
<tr>
  <ti>x86</ti>
  <ti>i486</ti>
  <ti>i486-pc-linux-gnu</ti>
</tr>
<tr>
  <ti>x86</ti>
  <ti>i586</ti>
  <ti>i586-pc-linux-gnu</ti>
</tr>
<tr>
  <ti>x86</ti>
  <ti>i686 oder höher (inkl. Athlon)</ti>
  <ti>i686-pc-linux-gnu</ti>
</tr>
<tr>
  <ti>alpha</ti>
  <ti></ti>
  <ti>alpha-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>ppc</ti>
  <ti></ti>
  <ti>powerpc-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>ppc64</ti>
  <ti></ti>
  <ti>powerpc64-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>sparc</ti>
  <ti></ti>
  <ti>sparc-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>hppa</ti>
  <ti>(generic)</ti>
  <ti>hppa-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>hppa</ti>
  <ti>pa7000</ti>
  <ti>hppa1.1-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>hppa</ti>
  <ti>pa8000 oder höher</ti>
  <ti>hppa2.0-unknown-linux-gnu</ti>
</tr>
<tr>
  <ti>mips</ti>
  <ti> </ti>
  <ti>mips-unknown-linux-gnu</ti>
</tr>
<tr>
 <ti>amd64</ti>
 <ti></ti>
  <ti>x86_64-pc-linux-gnu</ti>
  </tr>
</table>

</body>
</subsection>
<subsection>
<title>CFLAGS und CXXFLAGS</title>
<body>

<p>

Die <c>CFLAGS</c> und <c>CXXFLAGS</c> Variablen definieren die Optimierungen
beispielsweise für den <c>gcc</c> C und C++ Compiler. Obgleich wir diese hier
nur allgemein definieren, erhalten Sie die maximale Leistung nur, wenn Sie die
Flags für jedes Programm einzeln optimieren. Als Begründung sei genannt: Jedes
Programm verhält sich anders.
</p>

<p>
In <path>make.conf</path> sollten Sie die Optimierungs-Flags definieren, von
denen Sie erwarten, dass Ihr System <e>allgemein</e> am anspechbarsten ist.
Machen Sie keine Experimente bei dieser Variable; zu forsche
Optimierung kann dazu führen, dass Programme sich böswillig verhalten (Abstürze,
oder noch viel schlimmer: Fehlfunktionen).
</p>

<p>
Wir werden nicht alle möglichen Optimierungsoptionen erklären. Wenn Sie 
diese gerne komplett kennenlernen möchten, schauen Sie sich das
<uri link="http://gcc.gnu.org/onlinedocs/">GNU Online Manual</uri>
oder die <c>gcc</c> Info-Seite (<c>info gcc</c> -- geht erst auf einem
installierten System) an. Die <path>make.conf.example</path> Datei selbst
enthält weitere Beispiele und Informationen; vergessen Sie nicht, diese zu
lesen.
</p>

<p>
Die erste Einstellung ist das <c>-march=</c> Flag, dieses spezifiziert den
Namen der Zielarchitektur. Mögliche Optionen werden in <path>make.conf.example</path>
(als Kommentare) beschrieben. Als Beispiel die Einstellung für eine x86 Athlon
XP Architektur:
</p>

<pre caption="Die GCC march Einstellung">
<comment># AMD64 Benutzer die ein natives 64 Bit System nutzen möchten sollten nicht athlon-xp benutzen</comment>
-march=athlon-xp
</pre>

<p>
Die zweite ist das <c>-O</c> Flag (das ist ein grosses O, keine Null), welches
für eine <c>gcc</c> Optimierungsklasse steht.
Mögliche Klassen sind <c>s</c> (schlankes Kompilat, engl. size-optimized),
<c>0</c> (eine Null für keine Optimierung), <c>1</c>, <c>2</c> oder <c>3</c>
für auf höhere Geschwindigkeit optimierte Flags (jede Klasse erbt die Flags
der kleineren, zuzüglich ein paar Extras.) Zum Beispiel eine Klasse-2
Optimierung:
</p>

<pre caption="Die GCC O Einstellung">
-O2
</pre>

<p>
Weitere gerne benutzte Optimierungsflags sind <c>-pipe</c> (benutzt Pipes
statt temporärer Dateien für die Kommunikation zwischen den verschiedenen
Stufen des Übersetzungsvorganges)
</p>

<p>
Beachten Sie, dass die Nutzung von <c>-fomit-frame-pointer</c> (dadurch
werden die Frame Pointer für Funktionen, die diese nicht brauchen, nicht mehr
in einem Register gehalten) erhebliche Auswirkungen auf das Debuggen von
Anwendungen hat!
</p>

<p>
In <c>CFLAGS</c> und <c>CXXFLAGS</c> können Sie mehrere Optimierungsflags
kombinieren, wie das folgende Beispiel zeigt:
</p>

<pre caption="Setzen der CFLAGS und CXXFLAGS Variablen">
CFLAGS="-march=athlon-xp -pipe -O2" <comment># AMD64 Benutzer sollten nicht athlon-xp benutzen</comment>
CXXFLAGS="${CFLAGS}"
<comment># Benutze die gleichen Einstellungen für beide Variablen</comment>
</pre>

</body>
</subsection>
<subsection>
<title>MAKEOPTS</title>
<body>

<p>
Mit <c>MAKEOPTS</c> können Sie festlegen, wieviele Kompilerprozesse parallel
gestartet werden, wenn Sie ein Paket installieren. Eine gute Wahl ist die
Anzahl der CPUs in Ihrem System erhöht um Eins.
</p>

<pre caption="MAKEOPTS eines gewöhnlichen 1-CPU Systems">
MAKEOPTS="-j2"
</pre>

</body>
</subsection>
<subsection>
<title>Auf die Plätze, fertig, los!</title>
<body>

<p>
Aktualisieren Sie <path>/mnt/gentoo/etc/make.conf</path> nach Ihren
Bedürfnissen und speichern Sie die Datei (<c>nano</c> Benutzer drücken
<c>Ctrl-X</c>). Nun sind Sie bereit um mit der
<uri link="?part=1&amp;chap=6">Installation des Gentoo Basis Systems</uri>
fort zu fahren.
</p>

</body>
</subsection>
</section>
</sections>

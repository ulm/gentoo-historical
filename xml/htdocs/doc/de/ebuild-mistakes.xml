<?xml version='1.0' encoding="UTF-8"?>

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/de/Attic/ebuild-mistakes.xml,v 1.2 2004/10/16 19:45:14 vapier Exp $ -->
<!-- Original English CVS Version 1.3 -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<guide link="/doc/de/ebuild-mistakes.xml">
<title>Häufige Gentoo Ebuild-Fehler</title>
<author title="Autor">
  <mail link="liquidx@gentoo.org">Alastair Tse</mail>
</author>
<author title="Übersetzer">
  <mail link="kontakt@veller.net">Torsten Veller</mail>
</author>


<abstract>
Dieses Dokument beschreibt die von den Entwicklern und anderen Beitragenden
regelmäßig begangenen Fehler beim Schreiben und -Übermitteln von Ebuilds.
</abstract>

<license/>

<version>1.0</version>
<date>10. Februar 2004</date>

<chapter>
<title>Die üblichen Fehler beim Schreiben von Ebuilds</title>
<section>
<title>Einführung</title>
<body>

<p>
Dies hier ist eine Liste von häufiger vorkommenden Fehlern in Ebuilds, die
von Benutzern eingereicht wurden. Bitte begehen Sie diese Fehler nicht in Ihren
Ebuilds! Bevor Sie irgendein Ebuild einreichen, lesen Sie die
<uri link="http://www.gentoo.org/doc/en/policy.xml">Gentoo Development Policy</uri> und das
<uri link="http://www.gentoo.org/doc/en/gentoo-howto.xml">Gentoo Linux Entwickler HOWTO</uri>.
Weiterhin sollen Sie ein paar (d.h. mehr als eins oder zwei) Ebuilds im Portage
Baum gelesen haben, um den Stil, in dem Ebuilds geschrieben werden, kennen zu
lernen.
</p>

<p>
Hilfreich ist weiterhin, wenn Sie ein paar Ebuilds lesen, die Eclasses benutzen,
und verstehen, wie Eclasses benutzt werden, indem Sie das <uri
link="/doc/de/eclass-howto.xml">Eclass HOWTO</uri> lesen. Schlussendlich müssen
Sie die <uri link="/doc/de/ebuild-submit.xml">Anleitung zum Einreichen von
Ebuilds</uri> sorgfältig lesen bevor Sie Ebuils übmitteln.
</p>

</body>
</section>
<section>
<title>Fehlende/Ungültige/Kaputte Header</title>
<body>

<p>
Der Header Ihres übermittelten Ebuilds sollte <e>ganz genau</e> wie der von
<path>/usr/portage/skel.ebuild</path> aussehen. Es ist sehr wichtig, dass Sie
ihn in keiner Weise ändern und dass die <c>&#36;Header: &#36;</c> Zeile intakt
ist.
</p>

<p>
Die ersten drei Zeilen <e>müssen</e> wie folgt ausschauen:
</p>

<pre caption="Gültige Header">
# Copyright 1999-2004 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# &#36;Header: &#36;
</pre>

<p>
Falls Sie einen gepatchtes Ebuild oder ein Ebuild zu einem Versionssprung
erstellen, brauchen Sie die <c>&#36;Header: &#36;</c> Zeile nicht anpassen. Die
Zeile muss jedoch enthalten sein. Beim Einchecken ins CVS wird das Ebuild
bearbeitet und der Header mit geeigneten Informationen zu Version und Datum
automatisch überschrieben. Es gibt also keinen Grund dies manuell zu
bearbeiten.
</p>

</body>
</section>
<section>
<title>Fehlendes IUSE</title>
<body>

<p>
Mit Abstand am häufigsten fehlt die IUSE Variable. Sie müssen (gemäß dem
<uri link="http://www.gentoo.org/doc/en/gentoo-howto.xml">Gentoo Linux Entwickler HOWTO</uri>) die
IUSE Variable einarbeiten, selbst wenn keine USE Flags benutzt werden. Falls
keine USE Flags benutzt werden, so fügen Sie einfach folgendes ein:
</p>

<pre caption="Leeres IUSE">
IUSE=""
</pre>

</body>
</section>
<section>
<title>Umdefinierte P, PV, PN, PF</title>
<body>

<p>
Sie sollten diese Variablen niemals umdefinieren. Benutzen Sie stattdessen
MY_P, MY_PN, MY_PV, P0, usw. Schauen Sie sich die Ebuilds in Portage an, die
so vorgehen. Die meisten Ebuilds benutzen die Bash "Parameter Expansion".
Bitte lesen Sie das Bash Manual um zu verstehen, wie "Parameter Expansion"
funktioniert.
</p>

<p>
Nebenbei: Wenn Sie ein Paket finden, das Variablen umdefiniert, kopieren Sie
dieses Vorgehen nicht! Erstellen Sie einen Bugreport zu diesem Ebuild.
</p>

</body>
</section>
<section>
<title>Einfügen von Versionsnummern in SRC_URI und S</title>
<body>

<p>
Sie sollten versuchen, keine Versionsnummern in den Variablen SRC_URI und S
zu benutzen. Stattdessen sollten Sie ${PV} oder ${P} benutzen. Dies vereinfacht
die Pflege des Ebuilds. Wenn die Versionsnummer nicht der des Tarballs
übereinstimmt, können Sie MY_P benutzen. Ein Beispiel dafür ist
dev-python/pyopenal: Um einen Tarball namens PyOpenAL zu laden, wird es wie
folgt geändert:
</p>

<pre caption="Beispiel einer geänderten Version">
MY_P=${P/pyopenal/PyOpenAL}
SRC_URI="http://oomadness.tuxfamily.org/downloads/${MY_P}.tar.gz"
S=${WORKDIR}/${MY_P}
</pre>

</body>
</section>
<section>
<title>DEPEND mit syntaktischen Fehlern</title>
<body>

<p>
Es gibt verschiedene Fehlerquellen in den DEPEND und RDEPEND Feldern. Hier sind
einige wichtige Punkte, die Sie im Abhängigkeiten Abschnitt zu befolgen haben.
</p>

<ul>
  <li>
    <e>Führen Sie immer die KATEGORIE auf.</e><br />
    Benutzen sie zum Beispiel <c>&gt;=x11-libs/gtk+-2</c> und nicht
    <c>&gt;=gtk+-2</c>.
  </li>
  <li>
    <e>Bentutzen Sie keinen Asterisk(*) für &gt;= Abhängigkeiten.</e><br />
    Zum Beispiel sollte es eher <c>&gt;=x11-libs/gtk+-2</c> als
    <c>&gt;=x11-libs/gtk+-2*</c> sein.
  </li>
  <li><e>GTK spezifisch. Benutzen Sie immer =x11-libs/gtk+-1.2* für GTK+1
  Anwendungen.</e></li>
  <li>
    <e>Ein Paket hängt nicht von einem Meta-Paket ab.</e><br />
   	Ein Paket hängt also nicht von gnome-base/gnome, sondern von einer
   	speziellen Bibliothek ab wie libgnome.
  </li>
  <li>
    <e>Eine Abhängigkeit pro Zeile.</e><br />
    Führen Sie nicht mehrer Abhängigkeiten pro Zeile auf. Dies macht es
    unangenehm zu lesen und schwer zu folgen.
  </li>
</ul>

</body>
</section>
<section>
<title>DEPEND ist unvollständig</title>
<body>

<p>
Dies ist ein weiterer üblicher Fehler. Der Ebuild-Ersteller schickt ein Ebuild,
welches "einfach funktioniert" ohne zu klären, ob die Abhängigkeiten korrekt
sind. Hier sind ein paar Tipps wie man die richtigen Abhängigkeiten findet.
</p>

<ul>
  <li>
    <e>Schauen Sie in configure.in oder configure.ac</e><br />
    Suchen Sie nach Paketüberprüfungen hierin. Dinge nach denen Sie Ausschau
    halten können, sind pkg-config Checks oder AM_* Funktionen, die auf
    besondere Versionen überprüfen
  </li>
  <li>
    <e>Schauen Sie sich beigefügte .spec Dateien an</e><br />
    Eine gute Anzeige von Abhängigkeiten finden sich auch in den .spec Dateien.
    Wie auch immer: Vertrauen Sie nicht darauf, hierin eine komplete Liste
    aller Abhängigkeiten zu finden.
  </li>
  <li>
    <e>Schauen Sie sich die Webseite zur Anwendung/Bibliothek an</e><br />
    Auf der Webseite der Anwendung können Sie auch Hinweise auf mögliche
    Abhängigkeiten finden.
  </li>
  <li>
    <e>Lesen Sie README und INSTALL des Paketes</e><br />
    Sie enthalten für gewöhnlich weitere sinnvolle Informationen zum Erstellen
    und Installieren der Pakete.
  </li>
  <li>
    <e>Vergessen Sie nicht zusätzliche Abhängigkeiten wie pkg-config,
    Doku erstellende Programme, usw.</e><br />
    Für gewöhnlich braucht der Build Prozeß einige Abhängigkeiten wie
    intltool, libtool, pkg-config, doxygen, scrollkeeper, gtk-doc, usw.
    Nennen Sie diese ausdrücklich.
  </li>
</ul>

</body>
</section>
<section>
<title>Ungültige LICENSE</title>
<body>

<p>
Ein weiterer häufig gemachter Fehler ist die Benutzung einer ungültigen
Lizenz. Zum Beispiel ist <c>GPL</c> keine gültige Lizenz. Sie müssen entweder
<c>GPL-1</c> oder <c>GPL-2</c> präzisieren. Das gleiche gilt für die
<c>LGPL</c>. Stellen Sie also sicher, dass die Lizenz in Ihrem
<c>LICENSE</c> Eintrag auch in <path>/usr/portage/licenses</path> existiert.
Ein Tipp: Suchen Sie in der Datei <path>COPYING</path> im Quellpaket nach der
Lizenz. Falls ein Paket nicht genau angibt, ob es <c>GPL-1</c> oder
<c>GPL-2</c> ist, so ist es sehr wahrscheinlich <c>GPL-2</c>.
</p>

<p>
Falls die Lizenz Ihres Paketes einmalig ist und bisher nicht in
<path>/usr/portage/licenses/</path> ist, dann müssen Sie die neue Lizenz ein
einer separaten Datei übermitteln.
</p>

</body>
</section>
<section>
<title>Ungetestetes ARCH in KEYWORDS</title>
<body>

<p>
Bitte fügen Sie keine ARCHs zu den KEYWORDS hinzu solange das Ebuild nicht
auf dieser Architektur getestet wurde. Ferner sollten alle neuen Ebuilds erst
getestet werden, also z.B. in ~x86 (oder einer anderen Architektur) liegen.
Genauso sollten bei Versionssprüngen die KEYWORDS wieder zu <c>~</c>
geändert werden.
</p>

</body>
</section>
<section>
<title>SLOT fehlt</title>
<body>

<p>
Stellen Sie sicher, dass die SLOT Variable im Ebuild vorhanden ist. Falls Sie
diese nicht benutzen, entfernen Sie sie nicht, sondern:
</p>

<pre caption="Standard SLOT Variable">
SLOT="0"
</pre>

</body>
</section>
<section>
<title>Fehlerhafte DESCRIPTION oder HOMEPAGE </title>
<body>

<p>
Überprüfen Sie, ob die HOMEPAGE Variable stimmt und die Benutzer zur richtigen
Seite führt, falls diese mehr über das Paket erfahren wollen.
DESCRIPTION sollte nicht zu lang sein. Gute Beschreibungen fassen die
Hauptfunktion kurz und bündig in einem Satz zusammen.
</p>

</body>
</section>
<section>
<title>Leerzeichen anstelle von TABs</title>
<body>

<p>
Es ist kein Vergnügen, Ebuilds zeilenweise neu zu formatieren, nur weil der
Autor die Richtlinien nicht befolgt hat und Leerzeichen statt TABs benutzt hat.
Also <e>bitte</e> benutzen Sie TABs!
</p>

</body>
</section>
<section>
<title>Leerzeichem am Zeilenende</title>
<body>

<p>
Ich bekenne mich schuldig. Bitte, lassen Sie repoman über Ihre Ebuilds laufen.
Dieses teilt Ihnen mit, ob sich überflüssige Leerzeichen am Zeilenende oder in
Leerzeilen befinden.
</p>

</body>
</section>
<section>
<title>Hinzufügen eines überflüssigen S=${WORKDIR}/${P}</title>
<body>

<p>
Wenn <c>S=${WORKDIR}/${P}</c>, so sollten Sie diese nicht in Ihr Ebuild
aufnehmen. Dies ist die Voreinstellung und Sie sollten S nur hinzufügen, wenn
sie ein anderes Ziel als <c>${WORKDIR}/${P}</c> hat.
</p>

</body>
</section>
<section>
<title>Fehlende Dokumentation</title>
<body>

<p>
Falls Ihr Paket eine Dokumentation enthält, sollten Sie diese mit <c>dodoc</c>
oder direkt in <path>/usr/share/doc/${PF}</path> installieren. Vergessen Sie
nicht <c>dodoc</c>/<c>doins</c> auf Fehler zu überprüfen.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Häufige Ebuild Fehler beim Übermitteln</title>
<section>
<title>Einführung</title>
<body>

<p>
Folgen Sie den Erklärungen im <uri
link="/doc/de/ebuild-submit.xml">Ebuilds einreichen HOWTO</uri> auf der <uri
link="/doc/de/index.xml">Gentoo Dokumentation Homepage</uri> um perfekte Ebuilds
beizusteuern.
</p>

</body>
</section>
<section>
<title>Ebuild im Tarball</title>
<body>

<p>
Bitte, bitte, bitte fügen Sie die Ebuilds nicht als Tararchive an. Fügen
Sie jedes Ebuild einzeln an, so dass wir diese einfach prüfen können.
</p>

</body>
</section>
<section>
<title>Ebuilds im Kommentarfeld</title>
<body>

<p>
Bitte kopieren Sie keine Ebuilds in das Kommentarfeld von Bugzilla.
</p>

</body>
</section>
<section>
<title>Keine Erklärung wozu das Paket gut ist</title>
<body>

<p>
Bitte lassen Sie uns wissen, wofür das Paket ist und fügen Sie die URL zur
Homepage, falls eine existiert, bei.
</p>

</body>
</section>
<section>
<title>Paketaktualisierungen ohne Beschreibung der Veränderungen</title>
<body>

<p>
Wenn Sie ein Paketupdate übermitteln, beschreiben Sie, welche Veränderungen Sie
an dem Ebuild vorgenommen haben. Wenn das Paket zum Beispiel eine neue Option
oder ein neues Feature hat und Sie ein USE Flag einführen, weisen Sie in Ihrem
Bug darauf hin. Lassen Sie uns nicht nach Veränderungen suchen.
</p>

<p>
Es ist weise ein diff anstelle eines ganzen Ebuilds bei einem Paketupdate zu
übermitteln. Am Besten wird es wie folgt erstellt:
</p>

<pre caption="Erstellen eines diff">
$ <i>diff -u paket-0.1.0.ebuild paket-0.2.0.ebuild &gt; ~/paket-0.2.0.diff</i>
</pre>

</body>
</section>
<section>
<title>Übermitteln von unveränderten Ebuilds für Versionssprünge</title>
<body>

<p>
Wenn Sie eine neue Version für ein Paket aus Portage übermitteln, beachten Sie,
dass das Ebuild funktioniert und dass Veränderungen in dem neuen Ebuild
berücksichtigt werden (wie z.B. hinzugefügte Dokumentation). Falls keine
Veränderungen zur vorhergehen Version notwendig sind, dann fügen Sie kein
Anhang an. Sagen Sie im Bug-Report einfach nur, dass Sie das Ebuild kopiert
haben und dass Sie überprüft haben, dass es funktioniert und das Paket
ordentlich übersetzt.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Kommentare und Vorschläge</title>
<section>
<body>

<p>
Kommentare, Verbesserungen und Vorschläge zum Inhalt sollten an
<mail link="liquidx@gentoo.org">Alastair Tse</mail> geschickt werden.
</p>

</body>
</section>
</chapter>
</guide>

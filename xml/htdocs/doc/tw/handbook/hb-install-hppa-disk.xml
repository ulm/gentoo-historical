<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/tw/handbook/Attic/hb-install-hppa-disk.xml,v 1.4 2004/05/02 23:04:16 bennyc Exp $ -->

<!-- rev 1.1 by Benny -->

<sections>
<section>
<title>介紹區塊裝置</title>
<subsection>
<title>區塊裝置（Block Devices）</title>
<body>

<p>
我們將仔細的介紹 Gentoo Linux 和 整體的Linux 的磁碟方式，包括 Linux 檔案系統，
分割區，和區塊裝置。然後，當你了解磁碟和檔案系統，你將會學到如何為你的 Gentoo 
Linux 安裝設定分割區和檔案系統。
</p>

<p>
首先，我們將要介紹 <e>區塊裝置</e>。最有名的區塊裝置大概就是代表 Linux 系統上的
第一個 SCSI 磁碟將會是 <path>/dev/sda</path>。
</p>

<p>
以上的區塊裝置代表著磁碟的介面。使用者可以不用擔心你的磁碟是否為 IDE，SCSI
或是其他，並且使用程式來使用這些區塊裝置。這個程式可以在磁碟上寫入多個隨機的 
512 byte 區塊。
</p>

</body>
</subsection>
<subsection>
<title>分割區和 Slices</title>
<body>

<p>
理論上雖然你可以使用整個磁碟放置你的 Linux 系統，但是實務上幾乎沒有人這麼做。
整個磁碟將會被分為其他小一點的大小，並可以更好的管理。大部份的系統將叫他 
<e>分割區（partitions）</e>。其他架構使用類似的技術，叫做 <e>slices</e>。
</p>

</body>
</subsection>
</section>
<section>
<title>策劃一個分割區計畫</title>
<subsection>
<title>多少和多大？</title>
<body>

<p>
多少分割區通常是按照你的使用環境。舉例來說，如果你有很多個使用者，你就會因為安全
問題和能夠簡易備份將你的 <path>/home</path> 分開。如果你將 Gentoo 安裝為郵件伺服
器那你的 <path>/var</path>應該分開，因為郵件通常是放在 <path>/var</path>。選擇好
的檔案系統將會提昇你的效能。遊戲伺服器因為大多數的遊戲伺服器都是安裝在 
<path>/opt</path> 所以通常會將 <path>/opt</path> 分開。原因很和 
<path>/home</path> 類似：安全問題和備份。
</p>

<p>
如你所見，不同的方式是彼此相依的。不同的分割區或是容量將會有以下優點：
</p>

<ul>
<li>
  你可以選擇適合個別分割區的檔案系統提高效能
</li>
<li>
  你的系統不會因為一個分割區或是容量失效而完全終止
</li>
<li>
  如果必要，檔案系統檢查所費的時間將會減少，並且可以以平行方式進行（雖然這個優點
  比較適合多分割區）
</li>
<li>
  安全性可以因為某些分割區以分割成唯讀而加強，nosuid（setuid機會被略過），
  noexec（執行檔將會被掠過）等等。
</li>
</ul>

<p>
但是，多個分割區也有一個很大的缺點：如果沒有完好的設定，你將會看到一個分割區上的
空間不夠或是一個分割區上的空間太多。
</p>

</body>
</subsection>
</section>
<section>
<title>在 HPPA 上使用 fdisk 分割你的磁碟</title>
<body>

<p>
使用 <c>fdisk</c> 建立你想要的分割區：
</p>

<pre caption="分割磁碟">
# <i>fdisk /dev/sda</i>
</pre>

<p>
PALO 需要一個特別的分割區。你將需要建立一個最少 16Mb 大小的分割區在磁碟的頂端。
這個分割區的類別一定要是 <e>f0</e>（Linux/PA-RISC boot）。
</p>

<impo>
如果你略過這個上面的步驟，你的系統將會停止愛你然後無法開機。
</impo>

<p>
另外，如果你的磁碟是大於 2Gb，記得確認你的開機分割趨勢放在 2Gb 的前端。PALO 無法
在 2Gb 後面讀取核心。
</p>

<p>
現在你的分割區已經建立完成了，請從 <uri link="#filesystems">建立檔案系統</uri>
繼續。
</p>

</body>
</section>
<section id="filesystems">
<title>建立檔案系統</title>
<subsection>
<title>介紹</title>
<body>

<p>
現在你的分割區已經建立完成了，接下來該將檔案系統放置上去。如果你不在乎要選擇什麼
檔案系統然後滿意我們在手冊內的範例，請從 <uri link="#filesystems-apply">
將檔案系統套用到分割區</uri>。不然請繼續閱讀關於更多的檔案系統﹍
</p>

</body>
</subsection>
<subsection>
<title>檔案系統？</title>
<body>

<p>
HPPA 的架構提供多個穩定的檔案系統。如 Ext2，ext3 和 reiserfs。其他則是實驗性
</p>

<p>
<b>ext2</b> 是一個舊的 Linux 檔案系統，沒有日誌功能. 啟用的時間通常需要很久。目前有許多 <e>日誌型態</e> 的檔案系統可以以更快的速度及更好的效率完成系統啟用和檢查。
</p>

<p>
<b>ext3</b> 為 ext2 的日誌版，提供了 metadata 日誌系統 並且可以快速地使用日誌系
統復原。ext3 是個相當不錯並且可靠的檔案系統. 它有額外的 hashed b-tree 索引功能
將會開啟幾乎在任何情況內的狀態為高效能。簡單來說，ext3 是一個很棒的檔案系統。
</p>

<p>
<b>ReiserFS</b> 整體來說是個相當不錯的系統，它處理小型檔案(少於4kb)時效能會比 
ext2 和 ext3 來的好。他使用的是 B*-tree 為基礎的檔案系統. 另外也能很有效率地處理
大型檔案。Linux 核心版本 2.4.18+ 後，ReiserFS 是一個相當有值得推薦的系統, 從很少
，到很多檔案。ReiserFS 都可以處理的非常好。開機分割區並不建議使用此檔案系統。
</p>

<p>
<b>XFS</b> 是一個 metadata 日誌系統。 Gentoo Linux 也完全支援此項檔案系統。你可以
使用 <path>xfs-sources</path> 核心搭配 XFS。如果你使用高速 SCSI或是纖維的儲存裝置
，我們才推薦你使用 XFS。 如果沒有，請使用其他檔案系統。
</p>

<p>
JFS 是 IBM 發展的高效能日誌系統。目前雖然已經可以算是個完成品，關於他的穩地度並
沒有太多的優點及缺點。
</p>

</body>
</subsection>
<subsection id="filesystems-apply">
<title>Applying a Filesystem to a Partition</title>
<body>

<p>
要把檔案系統建立到一個分割區或是容量上可使用一些為個別檔案系統所設計的工具：
</p>

<table>
<tr>
  <th>檔案系統</th>
  <th>建立指令</th>
</tr>
<tr>
  <ti>ext2</ti>
  <ti><c>mke2fs</c></ti>
</tr>
<tr>
  <ti>ext3</ti>
  <ti><c>mke2fs -j</c></ti>
</tr>
<tr>
  <ti>reiserfs</ti>
  <ti><c>mkreiserfs</c></ti>
</tr>
<tr>
  <ti>xfs</ti>
  <ti><c>mkfs.xfs</c></ti>
</tr>
<tr>
  <ti>jfs</ti>
  <ti><c>mkfs.jfs</c></ti>
</tr>
</table>

<p>
以我們的範例來說，開機分割區（在我們的例子裡為 <path>/dev/sda1</path>）為 ext2 和
主分割區（在我們的例子為 <path>/dev/sda3</path>）為 ext3，你將要使用：
</p>

<pre caption="將檔案系統套用到分割區上">
# <i>mke2fs /dev/sda1</i>
# <i>mke2fs -j /dev/sda3</i>
</pre>

<p>
現在檔案系統已經建立到我們剛建立完成的分割區上了（或是logical 容量）。
</p>

</body>
</subsection>
<subsection>
<title>啟用 Swap 分割區</title>
<body>

<p>
<c>mkswap</c> 是用來起始 swap 分割區的指令：
</p>

<pre caption="建立 swap 簽名">
# <i>mkswap /dev/sda2</i>
</pre>

<p>
要啟用 swap，使用 <c>swapon</c> 指令：
</p>

<pre caption="啟動 swap">
# <i>swapon /dev/sda2</i>
</pre>

<p>
現在建立然後啟動 swap。
</p>

</body>
</subsection>
</section>
<section>
<title>掛載</title>
<body>

<p>
現在你的分割區已經起始和放置檔案系統了，接下來我們該把這些分割區掛載起來。使用
<c>mount</c> 的指令。不要忘了建立相關的掛載目錄，以我們的分割來說只掛載主分割區
和開機分割區：
</p>

<pre caption="掛載分割區">
# <i>mount /dev/sda3 /mnt/gentoo</i>
# <i>mkdir /mnt/gentoo/boot</i>
# <i>mount /dev/sda1 /mnt/gentoo/boot</i>
</pre>

<note>
如果你要將 <path>/tmp</path> 放在不同的分割區，記得掛載後將它的權限更改為：
<c>chmod 1777 /mnt/gentoo/tmp</c>。這也適用於 <path>/var/tmp</path>。
</note>

<p>
我們將需要掛載 proc 檔案系統（一個核心的虛擬介面）並且把它放在 <path>/proc</path>
。我們將要建立 <path>/mnt/gentoo/proc</path> 掛載點並且掛載起來：
</p>

<pre caption="建立 /mnt/gentoo/proc 掛載點">
# <i>mkdir /mnt/gentoo/proc</i>
# <i>mount -t proc none /mnt/gentoo/proc</i>
</pre>

<p>
現在從 <uri link="?part=1&amp;chap=5">使用安裝檔安裝 Gentoo</uri> 繼續。
</p>

</body>
</section>
</sections>

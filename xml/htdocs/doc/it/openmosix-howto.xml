<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/it/openmosix-howto.xml" lang="it">

<title>openMosix e nodi Diskless </title>
<author title="Autore">
<mail link="tantive@gentoo.org">Michael Imhof</mail>
</author>
<author title="Ricerche">
    <mail link="ma53@drexel.edu">Michael Andrews</mail>
</author>
<author title="Revisione">
    <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Traduzione">
    <mail link="stefano.lucidi@gentoo-italia.org">Stefano Lucidi</mail>
</author>

<abstract>
Questo HOWTO  Vi aiuterà a creare un cluster openMosix usando Gentoo.
</abstract>

<license/>

<version>1.3</version>
<date>20 Novembre, 2003</date>

<chapter>
<title>Introduzione</title>

<section>
<title>Circa questo HOWTO</title>
<body>

<p>
Questo HOWTO vi aiuterà a creare un cluster openMosix usando nodi <e>diskless</e> 
. Esso sarà basato sulla distribuzione Gentoo Linux.  Intendiamo renderlo il più
facile possibile e indirizzato ai newbie di Linux. Mentre un'utente esperto
può facilmente unire insieme i vari HOWTOs disponibili su openMosix, nodi diskless
e sul networking; speriamo che questo HOWTO possa facilitare la procedura anche per utenti con poca esperienza.
</p>

</body>
</section>


<section>
<title>Riguardo openMosix</title>
<body>

<p>
OpenMosix è una patch per il kernel Linux che consente a host multipli di agire come
una singola immagine di sistema (SSI).  Questo fa si che host multipli <e>appaiano</e> 
come un grande host multiprocessore.  Al tempo di questo scritto stavo usando 
l'ultima release della patch openMosix per il kernel, versione 2.4.22, e gli openMosix
user tools versione 0.3.4.  Ci sono molte informazioni su
openMosix su <uri>http://openmosix.sourceforge.net</uri>. Non è facile fare un cluster
con differenti versioni di sorgenti patchati, e abbiamo visto che molte patch non sono retro compatibili.
OpenMosix migra esplicitamente i processi pesanti quando eseguite un binario a.out o ELF
o quando un processo pesante esegue un fork.  Esso non migra i processi leggeri
come i p-threads, o i processi pesanti che usano la memria condivisa (shared memory). 
</p>

<p>
Per maggiori informazioni su openMosix visitate la loro <uri
link="http://openmosix.sourceforge.net">home page</uri>.
</p>

</body>
</section>


<section>
<title>Cluster</title>
<body>

<p>
Il nostro cluster sarà composto di singoli computer (nodes) che condividono 
le risorse computazionali per incrementare la potenza computazionale di tutti  
i nodi.  non tuttii nodi devono essere della stessa architettura ma questo renderebbe 
 più semplice metterli in cluster.
</p>

</body>
</section>

<section>
<title>Prima di inziare</title>
<body>

<p>
Dovreste avere Gentoo installata sui computer che volete aggiungere al vostro cluster
In più dovreste avere i sorgenti del kernel openMosix che è stato convenientemente
patchato da Gentoo.  
</p>

<p>
Per ottenere questi sorgenti usate  <c>emerge</c>:
</p>

<pre caption="Ottenere i sorgenti del kernel patchati">
# <i>emerge openmosix-sources</i>
</pre>

</body>
</section>

</chapter>

<chapter>
<title>Configurare il kernel</title>

<section>
<title>Riguardo i kernel</title>
<body>

<p>
Il kernel è il software che risiede tra il vostro  hardware e il resto del 
software che avete caricato nella vostra macchina, essenzialmente il cuore del kernel 
del sistema operativo.  Quando il vostro computer parte, il  BIOS esegue le 
istruzioni trovate nello spazio riservato al boot del vostro disco rigido.  Queste istruzioni 
sono tipicamente un boot loader che carica il vostro kernel.  Dopo che il vostro kernel 
è stato caricato tutti i processi sono gestiti dal kernel.  
</p>

<p>
Per maggiori informazioni sul kernel e sulla sua configurazione potreste voler guardare
<uri>http://www.tldp.org/HOWTO/Kernel-HOWTO.html</uri>.
</p>

</body>
</section>

<section>
<title>Configurare il kernel</title>
<body>

<p>
Il kernel può essere grande e personalizzato come volete
ma ci sono alcune piccole opzioni richieste dal kernel che avete bisogno di attivare. 
</p>

<impo>
E' estremamente importante che <path>/usr/src/linux</path> punti agli
openmosix-sources come mostrato sotto.
</impo>

<pre caption="Far puntare /usr/src/linux a openmosix">
# <i>cd /usr/src</i>
# <i>rm linux</i>
# <i>ln -s linux-2.4.22-openmosix linux</i>
</pre>
<p>
Then go into your kernel configuration:
</p>

<pre caption="Modificare la configurazione del kernel">
# <i>cd /usr/src/linux</i>
# <i>make menuconfig</i>
</pre>

<p>
Dovreste ottenere una GUI blu e grigia che offre una alternativa alla modifca
manuale del file <path>/usr/src/linux/.config</path>.  Se il vstro kernel funziona
bene potreste voler salvare il file di configurazione corrente 
uscendo dalla GUI e digitando:
</p>

<pre caption="Fare il backup della configurazione del kernel">
# <i>cp .config .config_working</i>
</pre>

<p>
Nella GUI, un'item del menu princpale dovrebbe dire <c>openMosix ---&gt;</c>.  Se non lo fa
dovete fare l'emerge dei sorgenti del kernel con la patch per openMosix 
(<uri link="#doc_chap1_sect4">Prima di iniziare</uri>). Andate nel seguente sottomenu
e assicuratevi che le seguenti opzioni siano selezionate come  built-in e <e>NON</e> 
come modulo.
</p>
<pre caption="Menuconfig options">
openMosix ---&gt;
    [*] openMosix process migration support
    [ ] Support clusters with a complex network topology
    [*] Stricter security on openMosix ports
    (1) Level of process-identity disclosure (0-3)
    [*] openMosix File-System
    [ ] Poll/Select exceptions on pipes
    [ ] Disable OOM Killer
    [ ] Load Limit

Code maturity level options  ---&gt;
    [*] Prompt for development and/or incomplete code/drivers

Networking options ---&gt;
    &lt;*&gt; Packet socket
    [ ]   Packet socket: mmapped IO
    &lt; &gt; Netlink device emulation
    [ ] Network packet filtering (replaces ipchains)
    [ ] Socket Filtering
    &lt;*&gt; Unix domain sockets
    [*] TCP/IP networking
    [*]   IP: multicasting

File systems ---&gt;
    [*] /proc file system support
    [*] /dev file system support (EXPERIMENTAL)
    [*]   Automatically mount at boot 
</pre>

<note>
Queste opzioni della configurazione vanno aggiunte alla vostra specifica configurazione
del sistema e non vanno intese come sostitute della vostra.
</note>

<p>
Dopo che avete riconfigurato il kernel dovete ricompilarlo digitando:
</p>

<pre caption="Ricompilare il kernel e i moduli">
# <i>make dep</i>
# <i>make clean bzImage modules modules_install</i>
<comment>(Make sure /boot is mounted before copying to it)</comment>
# <i>cp arch/i386/boot/bzImage /boot/bzImage-openmosix</i>
</pre>
<p>
Poi aggiungete una opzione per il nuovo kernel in <path>lilo.conf</path> o
<path>grub.conf</path> (Dipende da quale bootloader state usando) e mettete
il nuovo kernel come default. Ora che la nuova <path>bzImage</path> è stata
copiata in <path>/boot</path> tutto quello che dovete fare è riavviare il sistema.
</p>

</body>
</section>

<section>
<title>Opzioni mancanti</title>
<body>
<p>
Se avete delle opzioni mancanti nella vostra configurazione del kernel assicuratevi di abilitare:
</p>

<ul>
  <li>Code maturity level options ---&gt;</li>
</ul>
<ul>
    <li>Prompt for development and/or incomplete code/drivers</li>
</ul>

</body>
</section>
</chapter>
<chapter>
<title>Configurazione dei nodi openMosix</title>
<section>
<title>Installare openMosix user tools</title>
<body>
<p>
Per permettere al cluster di migrare i processi, bisogna installare dei piccoli binari in user-land.
in più, un server openMosix deve essere avviato per permettere a ogni nodo di unirsi al cluster
e fare un'uso pieno delle possibilità di openMosix. Per ottenere questi binari, usate <c>emerge</c>:
</p>

<pre caption="Installare le utility userland openMosix">
# <i>emerge openmosix-user</i>
</pre>
</body>
</section>
<section>
<title>Configurare i nodi openMosix</title>
<body>

<p>
Modificare o creare <path>/etc/openmosix.map</path> non è più necessario. La
la nuova versione delle userland utilities ha disponibile un demone che
automaticamnte trova tuti i nodi nella vostra rete.
</p>

<p>
Create una directory <path>/mfs</path> su tutti i nodi e montatela se volete usare
il filesystem openMosix (altamente raccomandato) che v permette di accedere a tutti i vostri nodi
.
</p>

<pre caption="mkdir /mfs">
# <i>mkdir /mfs</i>
</pre>

<pre caption="Esempio di /etc/fstab">
none                    /mfs            mfs             noauto,dfsa=1          0 0
</pre>


<note>
Non tutti i nodi devono essere attivi e in esecuzione per far funzionare corretamente openMosix.
</note>

</body>
</section>
<section>
<title>Avviare openMosix</title>
<body>

<p>
Avviare openMosix è molto semplice. I comandi seguenti abiliteranno le funzionalità
di openMosix nel vostro kernel e avviano l'autodiscovery daemon,che terrà traccia di
tutti i nodi disponibili.
</p>

<pre caption="Avviare openMosix">
# <i>/etc/init.d/openmosix start</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>openMosix userland utilities</title>
<section>
<title>Utility a linea di comando</title>
<body>

<p>
openMosix-user installa alcuni utili tool nel vostro sistem. per citarne alcuni:
</p>

<ul>
  <li>
    <c>mosmon</c> - openMosix monitor. Vi permette di vedere lo stato di tutti i vostri nodi
    incluso l'utilizzo della cpu , la memoria installata, memoria usata, etc.
  </li>
  <li>
    <c>mtop</c> - Versione potenziata di top che vi mostra su quale nodo stà attulamente giarando un processo.
  </li>
  <li><c>mps</c> - Versione potenziata di ps. Mostra anche il numero dei nodi.</li>
  <li>
    <c>mosctl whois</c> - Questo è molto utile come mosmon e gli altri tool vi dice
    il numero del nodo. Con <c>mosctl whois nodenumber</c> potete vedere
    l'ip o l'hostname di questo nodo.
  </li>
</ul>

<p>
openmosix stress test può essere usato per verificare che tutto funzioni come dovrebbe nel vostro cluster
e come si comporta sotto carico. Questo pacchetto è chiamato:
<c>openmosixtest</c>:
</p>

<pre caption="Emerge openmosixtest">
# <i>emerge openmosixtest</i>
</pre>

<p>
L'ebuild vi informerà su come eseguire il test.
</p>

</body>
</section>
<section>
<title>Graphical utilities</title>
<body>

<p>
Per avere una visione grafica del vostro cluster e vedere i processi che vengono migrati,
potete usare <c>openmosixview</c>.
</p>

<pre caption="Emerge openmosixview">
# <i>emerge openmosixview</i>
</pre>

<p>
Per avviare questa fantastica applicazione digitate semplicemente <c>openmosixview</c>:
</p>

<pre caption="Lanciare openmosixview">
# <i>openmosixview</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Risorse</title>
<section>
<title>openMosix</title>
<body>

<ul>
  <li><uri>http://openmosix.sf.net</uri></li>
</ul>

</body>
</section>
<section>
<title>openMosix add-ons (sono disponibili gli ebuilds )</title>
<body>

<ul>
  <li><uri link="http://www.openmosixview.com">openMosixview</uri></li>
  <li>
    <uri link="http://www.openmosixview.com/omtest">openMosix stress test</uri>
  </li>
  <li>
    <uri link="http://www.nongnu.org/gomd/">general openMosix daemon</uri>
  </li>
</ul>

</body>
</section>
</chapter>
</guide>


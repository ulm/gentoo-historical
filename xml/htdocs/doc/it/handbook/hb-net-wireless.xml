<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/it/handbook/hb-net-wireless.xml,v 1.4 2006/09/13 19:17:53 so Exp $ -->

<sections>

<version>7.0</version>
<date>2006-08-30</date>

<section>
<title>Introduzione</title>
<body>

<p>
Attualmente si supporta l'installazione wireless sia con
<c>wireless-tools</c> sia con <c>wpa_supplicant</c>. La cosa importante è
ricordare che si configura per reti wireless su basi globali e non su basi di
interfaccia.
</p>

<p>
<c>wpa_supplicant</c> è la scelta migliore, ma non supporta tutti i driver.
Per un elenco di tutti i driver supportati, <uri
link="http://hostap.epitest.fi/wpa_supplicant">leggere il sito
wpa_supplicant</uri>. Ancora, <c>wpa_supplicant</c> può essere attualmente
connesso a SSID che si è configurato.
</p>

<p>
<c>wireless-tools</c> supporta quasi tutte le schede e i driver, ma non può
connettersi a WPA solo Access Points.
</p>

<warn>
Il driver <c>linux-wlan-ng</c> non è supportato ancora da baselayout.
Questo perchè <c>linux-wlan-ng</c> ha la propria installazione e
configurazione che è differente da quella di qualsiasi altro. Gli
sviluppatori di <c>linux-wlan-ng</c> sembra che vogliono cambiare le
impostazioni a <c>wireless-tools</c> - quando accadrà si potrà usare
<c>linux-wlan-ng</c> con baselayout.
</warn>

</body>
</section>
<section>
<title>WPA Supplicant</title>
<body>

<p>
<uri link="http://hostap.epitest.fi/wpa_supplicant">WPA Supplicant</uri> è
un pacchetto che permette di connettersi a access point WPA abilitati. La sua
installazione non è fluida poichè è ancora in beta - ma comunque funziona
bene.
</p>

<pre caption="Installare wpa_supplicant">
# <i>emerge net-wireless/wpa_supplicant</i>
</pre>

<impo>
Si deve avere abilitato <c>CONFIG_PACKET</c> nel kernel per fare funzionare
<c>wpa_supplicant</c>.
</impo>

<p>
Si deve configurare <path>/etc/conf.d/net</path>, si preferisce
<c>wpa_supplicant</c> a <c>wireless-tools</c> (se entrambi sono installati,
<c>wireless-tools</c> è il default).
</p>

<pre caption="Configurazione di /etc/conf.d/net per wpa_supplicant">
<comment># Si preferisce wpa_supplicant a wireless-tools</comment>
modules=( "wpa_supplicant" )

<comment># E' importante dire a wpa_supplicant quale driver dovrebbe
# essere usato poichè non è molto bello indovinarlo</comment>
wpa_supplicant_eth0="-Dmadwifi"
</pre>

<note>
Se si sta usando il driver host-ap si deve mettere la scheda in <e>Managed
mode</e> prima che sia usata con <c>wpa_supplicant</c>. Si può usare
<c>iwconfig_eth0="mode managed"</c> per farlo, in
<path>/etc/conf.d/net</path>.
</note>

<p>
Semplice vero? C'è ancora da configurare <c>wpa_supplicant</c> che è un pò
più difficile in base a come sono sicuri gli Access Points a cui si sta
cercando di connettere. L'esempio sotto è preso e semplificato da
<path>/etc/wpa_supplicant.conf.example</path> il quale è fornito con
<c>wpa_supplicant</c>.
</p>

<pre caption="Un esempio di /etc/wpa_supplicant.conf">
<comment># La riga sotto non deve essere cambiata altrimenti non funziona</comment>
ctrl_interface=/var/run/wpa_supplicant

<comment># Assicurarsi che solo root può leggere la configurazione WPA</comment>
ctrl_interface_group=0

<comment># Lasciare che wpa_supplicant si occupi dello scanning e della
# selezione AP</comment>
ap_scan=1

<comment># Caso semplice: WPA-PSK, PSK come un ASCII passphrase, permette tutte
# cifre valide</comment>
network={
  ssid="simple"
  psk="very secret passphrase"
  <comment># Più alta è la priorità, prima c'è riconoscimento</comment>
  priority=5
}

<comment># Lo stesso del precedente, ma è richiesto lo scanning specifico per
# SSID (per AP che rigettano broadcast SSID)</comment>
network={
  ssid="second ssid"
  scan_ssid=1
  psk="very secret passphrase"
  priority=2
}

<comment># E' usato solo WPA-PSK. Qualsiasi combinazione di cifre valida è
# accettata</comment>
network={
  ssid="example"
  proto=WPA
  key_mgmt=WPA-PSK
  pairwise=CCMP TKIP
  group=CCMP TKIP WEP104 WEP40
  psk=06b4be19da289f475aa46a33cb793029d4ab3db7a23ee92382eb0106c72ac7bb
  priority=2
}

<comment># Connessione plaintext (no WPA, no IEEE 802.1X)</comment>
network={
  ssid="plaintext-test"
  key_mgmt=NONE
}

<comment># Connessione condivisa WEP key (no WPA, no IEEE 802.1X)</comment>
network={
  ssid="static-wep-test"
  key_mgmt=NONE
  wep_key0="abcde"
  wep_key1=0102030405
  wep_key2="1234567890123"
  wep_tx_keyidx=0
  priority=5
}

<comment># Connessione condivisa WEP key (no WPA, no IEEE 802.1X) usando
# autenticazione Shared Key IEEE 802.11</comment>
network={
  ssid="static-wep-test2"
  key_mgmt=NONE
  wep_key0="abcde"
  wep_key1=0102030405
  wep_key2="1234567890123"
  wep_tx_keyidx=0
  priority=5
  auth_alg=SHARED
}

<comment># Rete IBSS/ad-hoc con WPA-None/TKIP</comment>
network={
  ssid="test adhoc"
  mode=1
  proto=WPA
  key_mgmt=WPA-NONE
  pairwise=NONE
  group=TKIP
  psk="secret passphrase"
}
</pre>

</body>
</section>
<section>
<title>Wireless Tools</title>

<subsection>
<title>Impostazione iniziale e Managed Mode</title>
<body>

<p>
<uri link="http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html">
Wireless Tools</uri> forniscono un modo generico di configurare interfacce
wireless di base fino al livello di sicurezza WEP. WEP è un metodo
di sicurezza debole, è anche quello prevalente.
</p>

<p>
La configurazione Wireless Tools è controllata da un pò di variabili
principali. L'esempio di configurazione sotto dovrebbe descrivere tutto il
necessario. Una cosa da tenere in mente è che nessuna configurazione significa
"connesso al più forte non criptato Access Point" - si cerca e ci si
connette sempre a qualcosa.
</p>

<pre caption="Installare wireless-tools">
# <i>emerge net-wireless/wireless-tools</i>
</pre>

<note>
Si possono mettere le impostazioni wireless in
<path>/etc/conf.d/wireless</path>, ma questa guida raccomanda di metterle in
<path>/etc/conf.d/net</path>.
</note>

<impo>
Si <e>deve</e> consultare la guida
<uri link="?part=4&amp;chap=2#variable_name">nomi di variabili</uri>.
</impo>

<pre caption="Esempio di impostazione iwconfig in /etc/conf.d/net">
<comment># Si preferisce iwconfig a wpa_supplicant</comment>
modules=( "iwconfig" )

<comment># Configurare WEP keys per Access Points ESSID1 e ESSID2</comment>
<comment># Si potrebbe configurare a 4 WEP keys, ma solo 1 può essere attiva
# così si fornisce un index di default di [1] per impostare key [1] e in
# seguito cambiare la key attiva a [1]
# Si fa questo in caso si definiscono altri ESSID per usare WEP keys oltre 1
#
# Prefissare la key con s: significa che è ASCII key, altrimenti una HEX key
#
# enc open specificata sicurezza aperta (più sicura)
# enc restricted specificata sicurezza ristretta (meno sicura)</comment>
key_ESSID1="[1] s:yourkeyhere key [1] enc open"
key_ESSID2="[1] aaaa-bbbb-cccc-dd key [1] enc restricted"

<comment># Il seguente funziona solo quando si cerca un Access Points
# disponibile</comment>

<comment># Qualche volta più di un Access Point è visibile così si deve
# definire un ordine preferito per connettersi</comment>
preferred_aps=( "ESSID1" "ESSID2" )
</pre>

</body>
</subsection>
<subsection>
<title>Regole personalizzate per la selezione di Access Point</title>
<body>

<p>
Si possono aggiunger alcune opzioni extra per regolare la selezione di Access
Point, ma non sono richieste.
</p>

<p>
Si può decidere se ci si connette solo a Access Point preferiti o no. Di
default se ogni cosa configurata fallisce e si può connettere a un Access
Point non criptato allora va bene. Questo può essere controllato dalla
variabile <c>associate_order</c>. Ecco una tabella di valori e come essi
controllano.
</p>

<table>
<tr>
  <th>Valore</th>
  <th>Descrizione</th>
</tr>
<tr>
  <ti><c>any</c></ti>
  <ti>Comportamento di default</ti>
</tr>
<tr>
  <ti><c>preferredonly</c></ti>
  <ti>Si connette solo a AP visibili nell'elenco preferito</ti>
</tr>
<tr>
  <ti><c>forcepreferred</c></ti>
  <ti>
    Si connette a AP nell'ordine preferito se non sono trovati in uno
    scan
  </ti>
</tr>
<tr>
  <ti>forcepreferredonly</ti>
  <ti>
    Non fa lo scan per AP - invece cerca di connettere a ognuno in ordine
  </ti>
</tr>
<tr>
  <ti><c>forceany</c></ti>
  <ti>
	  Lo stesso come <c>forcepreferred</c> + connesso a ogni altro AP disponibile
	</ti>
</tr>
</table>

<p>
Alla fine si hanno alcune selezioni <c>blacklist_aps</c> e <c>unique_ap</c>.
<c>blacklist_aps</c> funziona in modo simile a <c>preferred_aps</c>.
<c>unique_ap</c> è un valore <c>yes</c> o <c>no</c> che dice se una seconda
interfaccia wireless può connettersi allo stesso Access Point come la prima
interfaccia.
</p>

<pre caption="Esempio di blacklist_aps e unique_ap">
<comment># Qualche volta non ci si vuole connettere a alcuni access point</comment>
blacklist_aps=( "ESSID3" "ESSID4" )

<comment># Se si ha più di una scheda wireless, si può volere di
# permettere a ogni scheda di associarsi allo stesso Access Point o no
# Valori sono "yes" e "no"
# Default è "yes"</comment>
unique_ap="yes"
</pre>

</body>
</subsection>
<subsection>
<title>Modi Ad-Hoc e Master</title>
<body>

<p>
Si può volere una impostazione Ad-Hoc se non si riesce a connettere a
un Access Point con managed mode.
</p>

<pre caption="Tornare al modo ad-hoc">
adhoc_essid_eth0="This Adhoc Node"
</pre>

<p>
Cosa dire sul connettersi a reti Ad-Hoc o in modo Master per
trasformarsi in un Access Point? Ecco una configurazione per questo.
Si dovrebbe specificare WEP keys come mostrato sotto.
</p>

<pre caption="Esempio di configurazione ad-hoc/master">
<comment># Impostare il modo - può essere managed (default), ad-hoc o master
# Non tutti i driver supportano tutti i modi</comment>
mode_eth0="ad-hoc"

<comment># Impostare ESSID dell'interfaccia
# Nel modo managed, questo forza l'interfaccia per cercare e connettersi
# allo specificato ESSID e niente altro</comment>
essid_eth0="This Adhoc Node"

<comment># Si usa il canale 3 se non se ne specifica uno</comment>
channel_eth0="9"
</pre>

<impo>
L'esempio sopra è preso dalla documentazione BSD che si trova nella
<uri link="http://www.netbsd.org/Documentation/network/wavelan.html">
documentazione NetBSD</uri>.
Sono possibili 14 canali; i canali 1-11 sono legali per il Nord America,
canali 1-13 per la maggior parte dell'Europa, canali 10-13 per la Francia, e
solo il canale 14 per il Giappone. Per ulteriori chiarimenti si rimanda alla
documentazione della propria scheda o dell'access point. Assicurarsi che il
canale selezionato è lo stesso canale dell'access point (o dell'altra scheda
in una rete ad-hoc). Il default per schede vendute in Nord America e nella
maggior parte dell'Europa è 3; il default per schede vendute in Francia è 11,
e il default per schede vendute in Giappone è 14.
</impo>

</body>
</subsection>
<subsection>
<title>Risoluzione di problemi con Wireless Tools</title>
<body>

<p>
Ci sono altre variabili che si possono usare per aiutare nel funzionamento
wireless e nei problemi di driver o di ambiente. Ecco una tabella in cui ci
sono altre cose che si possono provare.
</p>

<table>
<tr>
  <th>Variabile</th>
  <th>Valore di default</th>
  <th>Descrizione</th>
</tr>
<tr>
  <ti><c>iwconfig_eth0</c></ti>
  <ti/>
  <ti>
    Vedere la man page di iwconfig per dettagli su cosa è possibile indicare
    a <c>iwconfig</c>
  </ti>
</tr>
<tr>
  <ti><c>iwpriv_eth0</c></ti>
  <ti/>
  <ti>
    Vedere la man page di iwpriv per dettagli su cosa è possibile indicare a
    <c>iwpriv</c>
  </ti>
</tr>
<tr>
  <ti><c>sleep_scan_eth0</c></ti>
  <ti><c>0</c></ti>
  <ti>
    Il numero di secondi che aspetta prima di fare lo scan. E' necessario
    quando il driver/firmware ha bisogno di più tempo per attivarsi prima
    che possa essere usato.
  </ti>
</tr>
<tr>
  <ti><c>sleep_associate_eth0</c></ti>
  <ti><c>5</c></ti>
  <ti>
    Il numero di secondi che aspetta l'interfaccia per associarsi con l'Access
    Point prima di spostarsi al prossimo
  </ti>
</tr>
<tr>
  <ti><c>associate_test_eth0</c></ti>
  <ti><c>MAC</c></ti>
  <ti>
    Alcuni driver non resettano l'indirizzo MAC associato con uno invalido
    quando cercano di essere associati. Alcuni driver non resettano il
    livello di qualità quando cercano di essere associati. Impostazioni
    valide sono <c>MAC</c>, <c>quality</c> e <c>all</c>.
  </ti>
</tr>
<tr>
  <ti><c>scan_mode_eth0</c></ti>
  <ti/>
  <ti>
    Alcuni driver devono fare lo scan nel modo ad-hoc, così se lo scan
    fallisce cercano di impostare <c>ad-hoc</c> qui
  </ti>
</tr>
<tr>
  <ti><c>iwpriv_scan_pre_eth0</c></ti>
  <ti/>
  <ti>
    Manda alcuni comandi <c>iwpriv</c> alla interfaccia prima dello scanning.
    Vedere la man page di iwpriv per altre informazioni
  </ti>
</tr>
<tr>
  <ti><c>iwpriv_scan_post_eth0</c></ti>
  <ti/>
  <ti>
    Manda alcuni comandi <c>iwpriv</c> alla interfaccia dopo lo scanning.
    Vedere la man page di iwpriv per altre informazioni
  </ti>
</tr>
</table>

</body>
</subsection>
</section>
<section>
<title>Definire la configurazione di rete per ESSID</title>
<body>

<p>
Qualche volta quando ci si connette a <e>ESSID1</e> si deve avere un IP
statico e quando ci si connette a <c>ESSID2</c> si deve avere DHCP. La
maggior parte delle variabili di modulo possono essere cambiate per ESSID.
Ecco come farlo.
</p>

<note>
Funzionano se si usa WPA Supplicant o Wireless Tools.
</note>

<impo>
Si <e>deve</e> consultare la guida
<uri link="?part=4&amp;chap=2#variable_name">nomi di variabili</uri>.
</impo>

<pre caption="Sovrapporre le impostazioni di rete per ESSID">
config_ESSID1=( "192.168.0.3/24 brd 192.168.0.255" )
routes_ESSID1=( "default via 192.168.0.1" )

config_ESSID2=( "dhcp" )
fallback_ESSID2=( "192.168.3.4/24" )
fallback_route_ESSID2=( "default via 192.168.3.1" )

<comment># Si possono definire nameserver e altre cose</comment>
<comment># NOTARE: DHCP sovrappone queste impostazioni a meno che
# gli viene detto di non farlo</comment>
dns_servers_ESSID1=( "192.168.0.1" "192.168.0.2" )
dns_domain_ESSID1="some.domain"
dns_search_domains_ESSID1="search.this.domain search.that.domain"

<comment># Si sovrappone dall'indirizzo MAC dell'Access Point
# E' pratico se si va a posizioni differenti che hanno lo stesso ESSID</comment>
config_001122334455=( "dhcp" )
dhcpcd_001122334455="-t 10"
dns_servers_001122334455=( "192.168.0.1" "192.168.0.2" )
</pre>

</body>
</section>
</sections>

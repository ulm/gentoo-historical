<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<sections>
<section>
<title>Se ne può fare a meno, ma...</title>
<subsection>
<title>Chi può farne a meno?</title>
<body>

<p>
Secondo la modalità che si è scelta per installare Gentoo, si può continuare o meno senza rete (e Internet).
</p>

<p>
Generalmente è necessario installare la rete (e Internet). Tuttavia, Gentoo fornisce la possibilità di essere installato senza un collegamento di rete. Questa eccezione è possibile soltanto con le seguenti modalità di installazione:
</p>

<ul>
  <li>
    Set da 2 LiveCD Gentoo x86 di Installazione (compreso x86, i686, pentium3, pentium4 e athlon-xp)
  </li>
  <li>
    Set da 2 LiveCD Gentoo PPC di Installazione (compreso G3 e G4)
  </li>
</ul>

</body>
</subsection>
<subsection>
<title>Perchè è necessaria la rete?</title>
<body>

<p>
L'installazione di Gentoo da Internet ha come risultato un'installazione di Gentoo completamente aggiornata. Si ottiene un'installazione basata sul più recente Portage tree (che è l'insieme di pacchetti che viene fornito insieme agli strumenti per gestirli). Questo è il motivo per cui si preferisce un'installazione con la rete. Tuttavia, alcune persone non possono o non vogliono installare Gentoo su un sistema con una connessione Internet.
</p>

<p>
Se si ricade in questa situazione è necessario usare il set di 2 CD. Questi set includono il codice sorgente, un immagine del portage tree, i tool per installare un sistema base di Gentoo e molto altro. Questo metodo ha un prezzo da pagare: non si hanno gli ultimi software, sebbene le differenze siano minime.
</p>

<p>
Se si desidera eseguire un installazione senza rete è necessario usare un set di 2 CD, saltare il resto di questo capitolo e continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>. Altrimenti, continuare con la seguente sezione riguardante la configurazione di rete.
</p>

</body>
</subsection>
<subsection>
<title>Opzionale: Configurare il Proxy</title>
<body>

<p>
Se l'accesso a Internet avviene attraverso un proxy, si potrebbe aver bisogno di configurare i parametri del proxy durante l'installazione. E' molto facile definire un proxy: basta definire una variabile che contiene le informazioni del server proxy.
</p>

<p>
Nella maggior parte dei casi, si definisce la variabile usando l'hostname del server. Ad esempio, si assuma che il proxy sia chiamato <e>proxy.gentoo.org</e> e che la porta sia la 8080.
</p>

<pre caption="Definire i server proxy">
<comment>(Se il proxy filtra il traffico HTTP)</comment>
# <i>export http_proxy="http://proxy.gentoo.org:8080"</i>
<comment>(Se il proxy filtra il traffico FTP)</comment>
# <i>export ftp_proxy="ftp://proxy.gentoo.org:8080"</i>
<comment>(Se il proxy filtra il traffico RSYNC)</comment>
# <i>export rsync_proxy="rsync://proxy.gentoo.org:8080"</i>
</pre>

<p>
Se il proxy richiede una username e una password, si dovrebbe usare la seguente sintassi per la variabile:
</p>

<pre caption="Aggiungere username/password alla variabile del proxy">
http://username:password@server
</pre>

<p>
Per esempio, per una connessione HTTP con il precedente proxy server e come username "john" e come password "f00b_r" si userebbe:
</p>

<pre caption="Proxy con autenticazione">
# <i>export http_proxy="http://john:f00b_r@proxy.gentoo.org:8080"</i>
</pre>

</body>
</subsection>
<subsection>
<title>Configurazione della rete per installazioni da supporti non Gentoo</title>
<body>

<p>
La maggior parte delle informazioni in questa sezione è intesa per gli utenti che fanno il boot da un LiveCD. Tuttavia, si può installare Gentoo in molte altre modalità. Se si è in questa situazione, assicurarsi che nella modalità usata sia disponibile una connessione a Internet attiva (le informazioni disponibili su come <uri link="#doc_chap4_sect2">Usare DHCP</uri> o <uri link="#doc_chap4_sect3">Comprendere la Terminologia di Rete</uri> potrebbero essere utili) e continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>.
</p>

</body>
</subsection>
</section>
<section>
<title>Rilevazione Automatica della Rete</title>
<subsection>
<title>Potrebbe già funzionare</title>
<body>

<p>
Se il sistema è inserito in una rete Ethernet con un server DHCP, è molto probabile che la configurazione di rete è già stata fatta automaticamente. Se è così, si dovrebbe potere usufruire dei vari comandi di rete inclusi nel LiveCD come <c>ssh</c>, <c>scp</c>, <c>ping</c>, <c>irssi</c>, <c>wget</c> e <c>links</c>, e altri.
</p>

<p>
Se la rete è già stata configurata, il comando <c>/sbin/ifconfig</c> dovrebbe elencare alcune interfacce di rete come lo, e come eth0:
</p>

<pre caption="/sbin/ifconfig per una scheda di rete attiva">
# <i>/sbin/ifconfig</i>
eth0      Link encap:Ethernet  HWaddr 00:50:BA:8F:61:7A
          inet addr:192.168.0.2  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::50:ba8f:617a/10 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1498792 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1284980 errors:0 dropped:0 overruns:0 carrier:0
          collisions:1984 txqueuelen:100
          RX bytes:485691215 (463.1 Mb)  TX bytes:123951388 (118.2 Mb)
          Interrupt:11 Base address:0xe800
</pre>

</body>
</subsection>
<subsection>
<title>Testare la Rete</title>
<body>

<p>
Potrebbe essere utile fare il ping sul server DNS dell'ISP (si può trovare in <path>/etc/resolv.conf</path>) e su un sito Web a scelta, per assicurarsi che i pacchetti stiano raggiungendo la rete, che la risoluzione dei domi di dominio stia funzionando correttamente, eccetera.
</p>

<pre caption="Ulteriore test della rete">
# <i>ping -c 3 www.yahoo.com</i>
</pre>

<p>
La rete è funzionante? Se è così, si può saltare il resto di questa sezione e continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>. Se non è così, sfortunatamente, si deve proseguire in altro modo.
</p>

</body>
</subsection>
</section>
<section>
<title>Configurazione Automatica della Rete</title>
<subsection>
<body>

<p>
Se la rete non funziona immediatamente, alcune modalità di installazione permettono di usare <c>net-setup</c> (per le reti normali), <c>adsl-setup</c> (per gli utenti ADSL) o <c>pptp</c> (per gli utenti PPTP).
</p>

<p>
Se la modalità di installazione non prevede nessuno di questi tool, continuare con la <uri link="#doc_chap4">Configurazione Manuale della Rete</uri>.
</p>

<ul>
  <li>
    I normali utenti Ethernet dovrebbero continuare con <uri link="#doc_chap3_sect2">Default: Usare net-setup</uri>
  </li>
  <li>Gli utenti ADSL dovrebbero continuare con <uri link="#doc_chap3_sect3">Alternativa: Usare RP-PPPoE</uri>
  </li>
  <li>
    Gli utenti PPTP dovrebbero continuare con <uri link="#doc_chap3_sect4">Alternativa: Usare PPTP</uri>
  </li>
</ul>

</body>
</subsection>
<subsection>
<title>Default: Usare net-setup</title>
<body>

<p>
Il modo più semplice di installare la rete se non è configurata automaticamente è eseguire lo script <c>net-setup</c>:
</p>

<pre caption="Eseguire lo script net-setup">
# <i>net-setup eth0</i>
</pre>

<p>
<c>net-setup</c> pone alcune domande sull'ambiente di rete. Al termine si dovrebbe avere una connessione di rete attiva. Si verifichi il collegamento. Se i test sono positivi, congratulazioni! Si è pronti per installare Gentoo. Saltare il resto di questa sezione e continuare con la <uri
link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>.
</p>

<p>
Se la rete ancora non funziona, continuare con la <uri link="#doc_chap4">Configurazione Manuale della Rete</uri>.
</p>


</body>
</subsection>
<subsection>
<title>Alternativa: Usare RP-PPPoE</title>
<body>

<p>
Se c'è bisogno di PPPoE per connettersi a internet, il LiveCD (qualsiasi versione) rende le cose facili perchè include <c>rp-pppoe</c>. Usare lo script fornito <c>adsl-setup</c> per configurare la connessione. Viene richiesto di inserire il dispositivo Ethernet che è collegato al modem adsl, lo username e la password,  gli IP dei server DNS e se si ha bisogno un firewall di base o meno.
</p>

<pre caption="Usare rp-pppoe">
# <i>adsl-setup</i>
# <i>adsl-start</i>
</pre>

<p>
Se qualcosa andasse storto, ricontrollare di avere digitato correttamente lo username e la password controllando <path>/etc/ppp/pap-secrets</path> o <path>/etc/ppp/chap-secrets</path> e assicurarsi di stare usando il giusto dispositivo ethernet. Se il dispositivo ethernet non esiste, si dovrà caricare il modulo appropriato di rete. In questo caso si dovrebbe continuare con la <uri link="#doc_chap4">Configurazione Manuale della Rete</uri> dove si spiega come caricare l'appropriato modulo di rete.
</p>

<p>
Se funziona tutto, continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>.
</p>

</body>
</subsection>
<subsection>
<title>Alternativa: Usare PPTP</title>
<body>

<p>
Se si ha bisogno del supporto PPTP, si può usare <c>pptpclient</c> che è fornito dai LiveCD. Ma prima bisogna assicurarsi che la configurazione sia corretta. Modificare <path>/etc/ppp/pap-secrets</path> o <path>/etc/ppp/chap-secrets</path> in modo che contenga la corretta combinazione username/password:
</p>

<pre caption="Modificare /etc/ppp/chap-secrets">
# <i>nano -w /etc/ppp/chap-secrets</i>
</pre>

<p>
Modificare se necessario <path>/etc/ppp/options.pptp</path>:
</p>

<pre caption="Modificare /etc/ppp/options.pptp">
# <i>nano -w /etc/ppp/options.pptp</i>
</pre>

<p>
Quando si è finito, eseguire <c>pptp</c> (con le opzioni che non si possono impostare in <path>options.pptp</path>) per connettere il server:
</p>

<pre caption="Connessione a un server dial-in">
# <i>pptp &lt;server ip&gt;</i>
</pre>

<p>
Ora continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>.
</p>

</body>
</subsection>
</section>
<section>
<title>Configurazione Manuale della Rete</title>
<subsection>
<title>Caricare gli Appropriati Moduli di Rete</title>
<body>

<p>
Quando si effettua il boot con il Live CD, quest'ultimo prova a rilevare tutti i dispositivi hardware e carica i moduli (driver) appropriati del kernel per supportare l'hardware. Nella grande maggioranza dei casi, l'operazione ha successo. Tuttavia, in alcuni casi, potrebbe non caricare automaticamente i moduli del kernel di cui si ha bisogno.
</p>

<p>
Se <c>net-setup</c> o <c>adsl-setup</c> non dessero buoni risultati, si può di sicuro supporre che la scheda di rete non è stata trovata immediatamente. Ciò significa che è necessario caricare gli appropriati moduli del kernel manualmente.
</p>

<p>
Per scoprire quali moduli del kernel sono disponibili per la rete, usare <c>ls</c>:
</p>

<pre caption="Cercare i moduli disponibili">
# <i>ls /lib/modules/`uname -r`/kernel/drivers/net</i>
</pre>

<p>
Se si trova un driver per la scheda di rete, utilizzare <c>modprobe</c> per caricare il modulo del kernel:
</p>

<pre caption="Utilizzare modprobe per caricare un modulo del kernel">
<comment>(Come esempio, si carica il modulo pcnet32)</comment>
# <i>modprobe pcnet32</i>
</pre>

<p>
Per controllare se la scheda di rete è stata rilevata, eseguire <c>ifconfig</c>. Una scheda di rete rilevata dovrebbe produrre un risultato simile a questo:
</p>

<pre caption="Test della disponibilità della scheda di rete andato a buon fine">
# <i>ifconfig eth0</i>
eth0      Link encap:Ethernet  HWaddr FE:FD:00:00:00:00  
          BROADCAST NOARP MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)
</pre>

<p>
Se invece si riceve il seguente errore, la sheda di rete non è rilevata:
</p>

<pre caption="Test della disponibilità della scheda di rete non andato a buon fine">
# <i>ifconfig eth0</i>
eth0: error fetching interface information: Device not found
</pre>

<p>
Una volta rilevata una scheda di rete, si può eseguire di nuovo <c>net-setup</c> o <c>adsl-setup</c> (che adesso dovrebbero funzionare), ma per i puristi ecco come configurare la rete a mano.
</p>

<p>
Ci sono due possibilità. La prima è di usare un DHCP (recupero automatico dell'IP), la seconda di installare la rete usando i comandi <c>ifconfig</c> e <c>route</c>.
</p>

</body>
</subsection>
<subsection>
<title>Usare un DHCP</title>
<body>

<p>
Il DHCP (Dynamic Host Configuration Protocol) rende possibile ricevere automaticamente le informazioni sulla rete (indirizzo IP, netmask, indirizzo broadcast, gateway, nameserver ecc.). Funziona soltanto se si ha un server DHCP nella rete (o se il provider fornisce un servizio DHCP). Per avere una interfaccia di rete che riceva queste informazioni automaticamente, utilizzare <c>dhcpcd</c>:
</p>

<pre caption="Utilizzo di dhcpcd">
# <i>dhcpcd eth0</i>
</pre>

<p>
Se funziona (provare a pingare alcuni server internet, come <uri link="http://www.google.com">Google</uri>), allora è stato tutto configurato e si è pronti per continuare. Saltare il resto di questa sezione e continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>.
</p>

</body>
</subsection>
<subsection>
<title>Comprendere la Terminologia di Rete</title>
<body>

<note>
Se si conosce l'indirizzo IP, l'indirizzo broadcast, netmask e nameserver, allora si può saltare questa sottosezione e continuare con la sezione su come <uri link="#doc_chap4_sect4">Usare ifconfig e route</uri>.
</note>

<p>
Se i tentativi precedenti falliscono, è necessario configurare la rete manualmente. Non si deve aver paura, non è difficile. Ma è necessario spiegare un po' di concetti riguardanti la rete per potere essere capaci di configurarla correttamente. Questo paragrafo illustra brevemente cosa sia un <e>gateway</e>, a cosa serva la <e>netmask</e>, come sia formato un indirizzo <e>broadcast</e> e perchè ci sia bisogno dei <e>nameserver</e>.
</p>

<p>
In una rete, gli host sono identificati dai loro <e>indirizzi IP</e> (indirizzi Internet Protocol). Un indirizzo è una combinazione di 4 numeri tra 0 e 255. Almeno così lo percepiamo. In realtà, un indirizzo IP consiste di 32 bits (1 e 0). Ecco un esempio:
</p>

<pre caption="Esempio di un indirizzo IP">
IP Address (numbers):   192.168.0.2
IP Address (bits):      11000000 10101000 00000000 00000010
                        -------- -------- -------- --------
                           192      168       0        2
</pre>

<p>
Un indirizzo IP deve essere unico per ogni host perchè le reti siano accessibili (in pratica tutti gli host che si possono raggiungere devono avere un indirizzo IP unico). Per potere fare una distinzione tra host dentro una rete, e host fuori una rete, l'indirizzo IP è diviso in due parti: la parte di <e>network</e> e la parte di <e>host</e>.
</p>

<p>
La separazione è demarcata tramite la <e>netmask</e>, un insieme di 1 seguito da un insieme di 0. La parte di IP corrispondente agli 1 è la parte di network, l'altra è la parte di host. Di solito, la netmask può essere scritta come un indirizzo IP.
</p>

<pre caption="Esempio della separazione network/host">
IP-address:    192      168      0         2
            11000000 10101000 00000000 00000010
Netmask:    11111111 11111111 11111111 00000000
               255      255     255        0
           +--------------------------+--------+
                    Network              Host
</pre>

<p>
In altre parole, 192.168.0.14 fa ancora parte della rete dell'esempio, ma 192.168.1.2 no.
</p>

<p>
L'indirizzo <e>broadcast</e> è un indirizzo IP con la stessa parte di network, ma con solo una parte di host. Ogni host sulla rete ascolta questo indirizzo IP. Serve per i pacchetti di broadcast.
</p>

<pre caption="Indirizzo broadcast">
IP-address:    192      168      0         2
            11000000 10101000 00000000 00000010
Broadcast:  11000000 10101000 00000000 11111111
               192      168      0        255
           +--------------------------+--------+
                     Network             Host
</pre>

<p>
Per potere navigare su internet, è necessario sapere quale host condivida la connessione a Internet. Questo host è chiamato <e>gateway</e>. E' un normale host ed ha un normale indirizzo IP (per esempio 192.168.0.1).
</p>

<p>
In precedenza si è detto che ogni host ha il suo indirizzo IP. Per potere raggiungere questo host tramite un nome (anzichè un indirizzo IP) è necessario un servizio che traduce un nome (come <e>dev.gentoo.org</e>) in un indirizzo IP (come <e>64.5.62.82</e>). Questo servizio è chiamato name service. Per utilizzarlo si deve definire il <e>nameserver</e> in <path>/etc/resolv.conf</path>.
</p>

<p>
In alcuni casi, il gateway serve come nameserver. Altrimenti si dovrà inserire il nameserver fornito dall'ISP.
</p>

<p>
Per riassumere, si ha bisogno delle seguenti informazioni prima di continuare:
</p>

<table>
<tr>
  <th>Elemento di rete</th>
  <th>Esempio</th>
</tr>
<tr>
  <ti>Indirizzo IP</ti>
  <ti>192.168.0.2</ti>
</tr>
<tr>
  <ti>Netmask</ti>
  <ti>255.255.255.0</ti>
</tr>
<tr>
  <ti>Broadcast</ti>
  <ti>192.168.0.255</ti>
</tr>
<tr>
  <ti>Gateway</ti>
  <ti>192.168.0.1</ti>
</tr>
<tr>
  <ti>Nameserver(s)</ti>
  <ti>195.130.130.5, 195.130.130.133</ti>
</tr>
</table>

</body>
</subsection>
<subsection>
<title>Usare ifconfig e route</title>
<body>


<p>
Installare la rete consiste di tre passi. Nel primo si assegna l'indirizzo IP con <c>ifconfig</c>. Nel secondo si configura il routing verso gateway con <c>route</c>. Nel terzo infine si inserisce l'IP dei nameserver in <path>/etc/resolv.conf</path>.
</p>

<p>
Per assegnare un indirizzo IP, si avrà bisogno dell'indirizzo IP da assegnare, dell'indirizzo broadcast e della netmask. Eseguire il seguente comando, sostituendo <c>${IP_ADDR}</c> con l'indirizzo IP, <c>${BROADCAST}</c> con l'indirizzo broadcast e <c>${NETMASK}</c> con la netmask:
</p>

<pre caption="Usare ifconfig">
# <i>ifconfig eth0 ${IP_ADDR} broadcast ${BROADCAST} netmask ${NETMASK} up</i>
</pre>

<p>
Ora installare il routing con <c>route</c>. Sostituire <c>${GATEWAY}</c> con l'indirizzo IP del gateway:
</p>

<pre caption="Usare route">
# <i>route add default gw ${GATEWAY}</i>
</pre>

<p>
Aprire <path>/etc/resolv.conf</path> con un editor qualsiasi (per esempio <c>nano</c>):
</p>

<pre caption="Creare /etc/resolv.conf">
# <i>nano -w /etc/resolv.conf</i>
</pre>

<p>
Inserire i nameserver secondo il seguente esempio. Assicurarsi di sostituire <c>${NAMESERVER1}</c> e <c>${NAMESERVER2}</c> con gli appropriati indirizzi dei nameserver:
</p>

<pre caption="Esempio di /etc/resolv.conf">
nameserver ${NAMESERVER1}
nameserver ${NAMESERVER2}
</pre>

<p>
Testare la rete con il ping di alcuni server Internet (come <uri link="http://www.google.com">Google</uri>). Se funziona, congratulazioni, si è pronti per installare Gentoo. Continuare con la <uri link="?part=1&amp;chap=4">Preparazione dei Dischi</uri>.
</p>

</body>
</subsection>
</section>
</sections>


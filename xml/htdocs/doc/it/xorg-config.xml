<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/it/xorg-config.xml,v 1.21 2009/12/14 21:17:25 scen Exp $ -->
<guide lang="it">
<title>Guida alla configurazione di X server</title>

<author title="Autore">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Autore">
  <mail link="nightmorph"/>
</author>
<author title="Traduzione">
  <mail link="richard77@libero.it">Federico Della Ricca</mail>
</author>

<abstract>
Xorg è il server X Window che permette agli utenti di avere a disposizione un
ambiente grafico. Questa guida spiega cos'è Xorg, come installarlo e il
significato delle varie opzioni di configurazione.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>1.23</version>
<date>2009-12-08</date>

<chapter>
<title>Cos'è il server X Window?</title>
<section>
<title>Interfaccia grafica vs. riga di comando</title>
<body>

<p>
L'utente medio può essere intimorito al pensiero di dovere digitare i comandi.
Perché non dovrebbe essere in grado di puntare e cliccare a suo piacimento
nell'ambito della libertà tipica di Gentoo (e in generale di Linux)? Ovviamente,
questo è possibile! Linux offre una grande varietà di comode interfacce utente e
ambienti grafici che è possibile aggiungere ad un'installazione esistente.
</p>

<p>
Una delle più grandi sorprese per gli utenti è che l'interfaccia utente non è
nient'altro che un programma che viene eseguito nel sistema. <e>Non è</e> parte
del kernel di Linux né di altre parti fondamentali del sistema. Essa è un
potente mezzo per sfruttare le capacità grafiche della propria workstation.
</p>

<p>
Data l'importanza degli standard, ne esiste uno per disegnare e muovere le
finestre sullo schermo, interagire con l'utente tramite tastiera e mouse e
gestire altri importanti aspetti di base. Questo standard si chiama <e>X Window
System</e>, solitamente abbreviato in <e>X11</e> o anche solo <e>X</e>. Viene
utilizzato in Unix, Linux e in sistemi operativi tipo Unix in tutto il mondo.
</p>

<p>
L'applicazione che fornisce agli utenti Linux la capacità di eseguire interfacce
utenti grafiche e utilizza lo standard X11 è Xorg-X11, un derivato del progetto
XFree86. XFree86 ha deciso di utilizzare una licenza che potrebbe essere non
compatibile con la licenza GPL, per cui si raccomanda l'uso di Xorg. Il Portage
ufficiale non contiene più nessuna versione di XFree86.
</p>

</body>
</section>
<section>
<title>Il progetto Xorg</title>
<body>

<p>
Il progetto <uri link="http://www.x.org">X.org</uri> ha creato e mantiene una
implementazione open-source liberamente ridistribuibile dello standard X11. Esso
è un'infrastruttura desktop open-source basata su X11.
</p>

<p>
Xorg fornisce un'interfaccia fra l'hardware e il software grafico che si vuole
utilizzare. Oltre a ciò, Xorg è completamente trasparente alla rete, nel senso
che è possibile eseguire un programma su un sistema mentre lo si visualizza su
un altro.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installare Xorg</title>
<section>
<title>Configurazione del kernel</title>

<body>

<p>
Come impostazione predefinita, Xorg usa <c>evdev</c>, un driver generico per i
dispositivi di input. Il supporto per <c>evdev</c> va attivato modificando la
configurazione del kernel. (Leggere la <uri
link="/doc/it/kernel-config.xml">Guida alla configurazione del kernel Linux in
Gentoo</uri> per informazione su come configurare il proprio kernel).
</p>

<pre caption="Abilitare evdev nel kernel">
Device Drivers ---&gt;
  Input device support ---&gt;
  &lt;*&gt;  Event interface
</pre>

</body>
</section>
<section>
<title>configurazione di make.conf</title>
<body>

<p>
Prima di installare Xorg vanno configurate due importanti variabili nel file
<path>/etc/make.conf</path>.
</p>

<p>
La prima variabile è <c>VIDEO_CARDS</c>. Serve a specificare i driver video
che si vogliono usare e di solito dipende dal tipo e marca della
propria scheda video.
I valori più comuni sono <c>nvidia</c> per schede Nvidia e <c>fglrx</c> per
schede ATI Radeon. Questi sono i driver proprietari per, rispettivamente, Nvidia
e ATI. Se si preferiscono le versioni open source, usare <c>nv</c> al posto di
<c>nvidia</c> come valore per la variabile, tenendo ben presente che in questo
caso non si avrà l'accelerazione 3D. I driver liberi per ATI (<c>radeon</c> e
<c>radeonhd</c>) sono grosso modo equivalenti al driver proprietario
<c>fglrx</c>. Il driver <c>intel</c> va usato per sistemi desktop o portatili
con i diffusi chipset grafici integrati Intel. La variabile <c>VIDEO_CARDS</c>
può contenere più di un driver, in questo caso i valori nell'elenco devono
essere separati da spazi.
</p>

<p>
La seconda variabile è <c>INPUT_DEVICES</c> e serve per determinare i driver da
compilare per i dispositivi di input. Nella maggior parte dei casi il valore
<c>evdev</c> dovrebbe funzionare. Se si usano dispositivi di input ulteriori,
come ad esempio un touchpad Synaptics per un portatile, assicurarsi di
aggiungerli a <c>INPUT_DEVICES</c>.
</p>

<p>
A questo punto si devono decidere i driver da usare e modificare di conseguenza
il file <path>/etc/make.conf</path>:
</p>

<pre caption="Righe di esempio per make.conf">
<comment>(Per attivare il supporto a mouse, tastiera e touchpad Synaptic)</comment>
INPUT_DEVICES="evdev synaptics"
<comment>(Per schede Nvidia)</comment>
VIDEO_CARDS="nvidia"
<comment>(O, per schede ATI Radeon)</comment>
VIDEO_CARDS="radeon"
</pre>

<note>
Ulteriori istruzioni su come configurare le schede video nVidia e ATI si trovano
nelle guide <uri link="/doc/it/nvidia-guide.xml">Guida nVidia per Gentoo
Linux</uri> e <uri link="/doc/it/ati-faq.xml">Gentoo Linux ATI FAQ</uri>. Se
non si sa quale driver scegliere, fare riferimento a queste guide per ulteriori
informazioni.
</note>

<p>
Se i valori suggeriti non funzionano, si dovrebbe eseguire <c>emerge -pv
xorg-server</c>, controllare tutte le opzioni disponibili e scegliere quelle
attinenti al proprio sistema. L'esempio seguente si riferisce ad un sistema con
mouse, tastiera, touchpad Synaptic e scheda video Radeon.
</p>

<pre caption="Visualizzazione dei valori disponibili dei driver">
 <i>emerge -pv xorg-server</i>

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] x11-base/xorg-server-1.6.3.901-r2  USE="hal nptl xorg -debug
-dmx -ipv6 -kdrive -minimal -sdl -tslib" 0 kB
[ebuild   R   ]  x11-base/xorg-drivers-1.6  INPUT_DEVICES="evdev synaptics
-acecad -aiptek -citron -elographics -fpit -hyperpen -joystick -keyboard -mouse
-mutouch -penmount -tslib -virtualbox -vmmouse -void -wacom"
VIDEO_CARDS="radeon -apm -ark -ast -chips -cirrus -dummy -epson -fbdev -fglrx
(-geode) -glint -i128 (-i740) (-impact) (-imstt) -intel -mach64 -mga -neomagic
(-newport) -nv -nvidia -r128 -radeonhd -rendition -s3 -s3virge -savage
-siliconmotion -sis -sisusb (-sunbw2) (-suncg14) (-suncg3) (-suncg6) (-sunffb)
(-sunleo) (-suntcx) -tdfx -tga -trident -tseng -v4l (-vermilion) -vesa -via
-virtualbox -vmware (-voodoo) (-xgi)" 0 kB
</pre>

<p>
Dopo aver impostato tutte le variabili necessarie installare il pacchetto Xorg.
</p>

<pre caption="Installare Xorg">
# <i>emerge xorg-server</i>
</pre>

<note>
E' possibile installare il metapacchetto <c>xorg-x11</c> invece del più leggero
<c>xorg-server</c>. Funzionalmente i due pacchetti sono equivalenti. Tuttavia il
pacchetto <c>xorg-x11</c> installa anche molti altri pacchetti probabilemente
non richiesti, come un enorme assortimenti di caratteri (font) per un gran
numero di lingue. Questi pacchetti non sono necessari per avere un desktop
funzionante.
</note>

<p>
Quando l'installazione è terminata, sarà necessario reinizializzare alcune
variabili d'ambiente prima di continuare. Tutto ciò che è necessario fare è
eseguire il comando <c>env-update</c> seguito da <c>source /etc/profile</c> e
tutto dovrebbe andare a posto.
</p>

<pre caption="Reinizializzare le variabili d'ambiente">
# <i>env-update</i>
# <i>source /etc/profile</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Configurare Xorg</title>
<section>
<title>Usare HAL</title>
<body>

<p>
Le versioni recenti di X server sono progettate per funzionare così come sono,
senza doverne modificare manualmente i file di configurazione.
</p>

<p>
Per prima cosa, provare a <uri link="#using_startx">lanciare X</uri> senza
creare <path>/etc/X11/xorg.conf</path>.
</p>

<p>
Se Xorg non parte, (se c'è qualcosa che non va con lo schermo o con la tastiera
o il mouse), provare a risolvere il problema tramite il file di configurazione
corrispondente.
</p>

<p>
Come impostazione predefinita, Xorg fa uso di HAL (Hardware Abstraction Layer)
per trovare e configurare i dispositivi come tastiere e mouse.
</p>

<p>
HAl è fornito con molte regole preconfezionate per i disposivi, dette anche
"policy". Questi file contenenti le policy si trovano in
<path>/usr/share/hal/fdi/policy/</path>. Individuare quelli contenenti le regole
che più si avvicinano alle proprie necessità e copiarli in
<path>/etc/hal/fdi/policy/</path>.
</p>

<impo>
Non modificare i file in <path>/usr/share/hal/fdi/</path>! Copiare solo quelli
necessari, e modificarli una volta posizionati dentro alla locazione corretta in
<path>/etc</path>.
</impo>

<p>
Per esempio, per fare funzionare una normale combinazione mouse più tastiera,
si potrebbero copiare i seguenti file in <path>/etc/hal/fdi/policy/</path>:
</p>

<pre caption="Usare i file policy di HAL">
# <i>cp /usr/share/hal/fdi/policy/10osvendor/10-input-policy.fdi /etc/hal/fdi/policy</i>
# <i>cp /usr/share/hal/fdi/policy/10osvendor/10-x11-input.fdi /etc/hal/fdi/policy</i>
</pre>

<p>
Ci sono moltre altre policy per HAL in <path>/usr/share/hal/fdi/</path> che
potrebbere essere utili, come configurazioni per portatili, gestione delle
periferiche dati, gestione dell'alimentazione e altro. Basta copiare i file
delle policy in <path>/etc/hal/fdi/policy/</path>.
</p>

<p>
Si possono modificare a piacere i file in <path>/etc/hal/fdi/policy</path>.
E' possibile fare degli aggiustamenti o abilitare delle funzioni aggiuntive.
Ecco un esempio di come modificare i file di policy.
</p>

<p>
Un trucco molto utile è di chiudere completamente il server X premendo
Ctrl-Alt-Backspace. E' utile quando il server X funziona male, è bloccato, ecc.
E' una misura meno estrema rispetto a riavviare la macchina con Ctrl-Alt-Canc.
</p>

<p>
Le versioni recenti dei server X hanno questa combinazione disabilitata come
impostazione predefinita. E tuttavia possibile riabilitarla copiando
<path>10-x11-input.fdi</path> in <path>/etc/hal/fdi/policy</path> e
modificandola. Basterà aggiungere solo una linea alla sezione corretta, come
mostrato qui sotto:
</p>

<pre caption="Modificare 10-x11-input.fdi">
<comment>(Aprire il file con l'editor che si preferisce)</comment>
# <i>nano -w /etc/hal/fdi/policy/10-x11-input.fdi</i>
<comment>(Trovare la sezione "input.keys")</comment>
&lt;match key="info.capabilities" contains="input.keys"&gt;
<comment>(Aggiungere la stringa "terminate"/merge come mostrato)</comment>
&lt;match key="info.capabilities" contains="input.keys"&gt;
      &lt;merge key="input.x11_driver" type="string"&gt;keyboard&lt;/merge&gt;
      <i>&lt;merge key="input.xkb.options" type="string"&gt;terminate:ctrl_alt_bksp&lt;/merge>&gt;</i>
      &lt;match key="/org/freedesktop/Hal/devices/computer:system.kernel.name"
             string="Linux"&gt;
        &lt;merge key="input.x11_driver" type="string"&gt;evdev&lt;merge&gt;
      &lt;/match&gt;
    &lt;/match&gt;
</pre>

<p>
Ora si ha a disposizione un modo pratico di chiudere un server X che non
risponde. Ciò è utile quando i programmi sono del tutto bloccati o quando si sta
configurando o affinando il proprio ambiente X. Si presti attenzione a
chiudere X con questa combinazione, molti programmi non reagiscono bene alla
chiusura forzata, e si potrebbe perdere tutto o in parte quello su cui si stava
lavorando.
</p>

<p>
Il lavoro con i file delle policy dovrebbe essere sufficiente ad ottenere un
desktop X funzionante. Se Xorg ancora non parte, o ci sono altri problemi,
allora è necessario configurare manualmente <path>xorg.conf</path> come mostrato
nella sezione seguente.
</p>

</body>
</section>
<section>
<title>Il file xorg.conf</title>
<body>


<note>
Configurare <path>xorg.conf</path> va visto come un'opzione da "ultima
spiaggia". Se possibile, il suo uso va evitato, effettuando tutta la
configurazione tramite i file di policy di HAL. Se tuttavia non si riesce ad
ottenere una configurazione funzionante, continuare a leggere.
</note>


<p>
Il file di configurazione di Xorg è chiamato <path>xorg.conf</path> e risiede in
<path>/etc/X11/</path>. Xorg fornisce un esempio di file di configurazione in
<path>/etc/X11/xorg.conf.example</path> che può essere utilizzato per creare la
propria configurazione. Questo file di esempio è dettagliatamente commentato, ma
se è necessaria maggiore documentazione riguardo alla sintassi, è disponibile la
pagina di manuale:
</p>

<pre caption="Richiamare la pagina di manuale di xorg.conf">
# <i>man 5 xorg.conf</i>
</pre>

</body>
</section>
<section>
<title>Generazione automatica di xorg.conf</title>
<body>

<p>
Xorg stesso è in grado di ricavare la maggior parte dei parametri. Nella maggior
parte dei casi, è necessario solo cambiare alcune linee per impostare la
risoluzione voluta. Nel caso si desideri un regolazione più raffinata, leggere
attentamente i link forniti alla fine del capitolo. Per prima cosa generare un
file di configurazione per Xorg:
</p>

<pre caption="Generare un file xorg.conf">
# <i>X -configure</i>
</pre>

<p>
Leggere con attenzione le ultime linee stampate a schermo dopo che Xorg ha
finito di interrogare l'hardware. Se riporta errori di qualche tipo, sarà
necessario procedere alla scrittura manuale del file <path>xorg.conf</path>. Nel
caso in cui tutto abbia funzionato, viene stampato l'avviso che è stato creato
il file <path>/root/xorg.conf.new</path>, pronto per essere provato.
</p>

<pre caption="Provare il file xorg.conf.new">
# <i>Xorg -config /root/xorg.conf.new</i>
</pre>

<p>
Se tutto è andato a buon fine, si dovrebbe vedere un semplice schema bianco e
nero.Verificare che il mouse funzioni e che la risoluzione sia corretta. Anche
se non si riesce a dedurre la risoluzione esatta, si può lo stesso rendersi
conto se è troppo bassa. In ogni momento si può premere Ctrl-Alt-Backspace per
chiudere l'X server.
</p>

</body>
</section>
<section>
<title>Sovrascrivere xorg.conf</title>
<body>

<p>
Per prima cosa copiare il <path>xorg.conf.new</path> sul file
<path>/etc/X11/xorg.conf</path> in modo da poter utilizzare il comando
<c>startx</c> invece di <c>Xorg -config</c>.
</p>

<pre caption="Sovrascrivere il file xorg.conf">
# <i>cp /root/xorg.conf.new /etc/X11/xorg.conf</i>
</pre>

</body>
</section>

<section id="using_startx">
<title>Usare startx</title>
<body>

<p>
Eseguire l'X server, facendolo partire con il comando <c>startx</c>.
<c>startx</c> è uno script che fa partire una <c>X Session</c> (sessione di X,
NdT), ovvero esegue l'X Server e inoltre lancia alcune applicazioni grafiche che
si appoggiano all'X Server. <c>startx</c> decide che applicazioni lanciare sulla
base delle seguenti regole:
</p>

<ul>
  <li>
    Se nella home dell'utente esiste un file chiamato <path>.xinitrc</path>,
    vengono eseguiti i comandi in esso contenuti.
  </li>
  <li>
    In alternativa, viene letto il contenuto della variabile d'ambiente XSESSION
    ed eseguita la sessione corrispondente fra quelle definite nella directory
    <path>/etc/X11/Sessions/</path> (è possibile impostare il valore di XSESSION
    in <path>/etc/env.d/90xsession</path> per assegnarle un valore predefinito
    per tutti gli utenti del sistema). Per esempio, come utente root, eseguire
    <c>echo XSESSION="Xfce4" &gt; /etc/env.d/90xsession</c>. In questo modo
    verrà creato il file <path>90xsession</path> ed impostata la sessione X
    predefinita a Xfce4.
  </li>
  <li>
    Come ultima risorsa, fa partire un semplice gestore di finestre, solitamente
    <c>twm</c>.
  </li>
</ul>

<pre caption="Far partire X">
# <i>startx</i>
</pre>

<p>
Nel caso in cui venga avviato <c>twm</c> (lo si riconoscerà dall'aspetto
veramente spartano e minimale) lo si può chiudere digitando <c>exit</c> o
premendo Ctrl-D nei terminali X visualizzati. Si può anche terminare la sessione
X con la combinazione Ctrl-Alt-Backspace. Questa è una maniera però piuttosto
brutale, da non utilizzarsi abitualmente.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Modificare xorg.conf</title>
<section>
<title>Configurare la Risoluzione</title>
<body>

<p>
Se non si è soddisfatti della risoluzione, è necessario controllare due sezioni
nella propria configurazione in <path>xorg.conf</path>. Per prima cosa vi è la
sezione <e>Screen</e> in cui può essere presente l'elenco delle risoluzioni
disponibili per l'X server. Come impostazione predefinita questa sezione
potrebbe non elencare nessuna risoluzione. In questo caso, Xorg valuta le
risoluzioni sulla base delle informazioni presenti nella seconda sezione,
<e>Monitor</e>.
</p>

<p>
Xorg controlla i valori di <c>HorizSync</c> e <c>VertRefresh</c> nella sezione
<e>Monitor</e> per calcolare le risoluzioni valide. Per ora, lasciare questi
valori così come sono. Solo nel caso in cui i cambiamenti alla sezione
<e>Screen</e> (descritti più avanti) non funzionino sarà necessario consultare
le specifiche del monitor e introdurre i valori corretti.
</p>

<warn>
<b>Non</b> provare a cambiare i valori di queste due variabili riguardanti il
monitor senza consultarne le specifiche tecniche. Introdurre valori non corretti
può portare nel caso migliore a errori di sincronia, nel peggiore a danneggiare
permanentemente il monitor.
</warn>

<p>
Procedere con il cambio della risoluzione. Nell'esempio che segue da
<path>/etc/X11/xorg.conf</path> vengono aggiunte una linea <c>Modes</c> e una
con un valore per <c>DefaultDepth</c> in modo che l'X server parta in modo
predefinito con la risoluzione di 1440x900 a 24 bit. I valori riportati sono
solo di esempio e porbabilemente non sono quelli desiratati nel proprio sistema.
</p>

<pre caption="Cambiare la sezione Screen in /etc/X11/xorg.conf">
Section "Screen"
  Identifier  "Default Screen"
  Device    "RadeonHD 4550"
  Monitor   "Generic Monitor"
  <i>DefaultDepth  24</i>
  <comment># Alcune righe sono state rimosse per una maggiore
leggibilità</comment>
    Depth   24
    <i>Modes   "1440x900"</i>
  EndSubSection
EndSection
</pre>

<p>
Eseguendo X (<c>startx</c>) esso utilizza ora la risoluzione desiderata.
</p>

</body>
</section>
<section>
<title>Configurare la Tastiera</title>
<body>

<p>
Per configurare X per l'utilizzo di una tastiera internazionale (non americana,
NdT), si può copiare il contenuto di
<path>/usr/share/doc/hal-*/*/use-estonian-layout.fdi.bz2</path> in
<path>/etc/hal/fdi/policy/10-xinput-configuration.fdi</path>:
</p>

<pre caption="Uso di un file di configurazione esistente">
# <i>bzcat /usr/share/doc/hal-*/*/use-estonian-layout.fdi > /etc/hal/fdi/policy/10-xinput-configuration.fdi</i>
</pre>

<p>
Ora si può modificare il file <path>10-xinput-configuration.fdi</path> e
cambiare il layout della tastiera da estone(<c>ee</c>) al proprio, per esempio
italiano (<b>it</b>) o polacco (<b>pl</b>).
</p>

<p>
Dopo aver finito, eseguire run <c>/etc/init.d/hald restart</c> come root
per assicurarsi che HAL faccia uso dei file di configurazione così modificati.
</p>

</body>
</section>
<section>
<title>Messa a punto finale</title>
<body>

<p>
Eseguire <c>startx</c> e gioire del risultato!. Congratulazione, ora (si spera)
il proprio sistema ha un ambiente X funzionante.
Il prossimo passo è di sostituire il fin troppo minimale twm con un window
manager con più funzioni, o con un ambiente desktop come KDE o GNOME, ma
questo esula dallo scopo di questa guida.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Risorse</title>
<section>
<title>Creare e mettere a punto xorg.conf</title>
<body>

<p>
Per prima cosa, <c>man xorg.conf</c> e <c>man evdev</c> forniscono una veloce
ma completa guida sulla sintassi utilizzata da questi file di configurazione.
È opportuno averli aperti su un altro terminale mentre si modificano
i file di configurazione.
</p>

<p>
Possono essere utili le <uri link="http://www.x.org/wiki/FAQ">FAQ</uri> messe
a disposizione sul proprio sito dal progetto X.org, in aggiunta al resto della
loro documentazione (in inglese, NdT).
</p>

<p>
Ci sono molte risorse online sulla modifica del file <path>xorg.conf</path>,
utilizzare <uri link="http://www.google.com">Google</uri> per trovarle.
</p>


</body>
</section>

<section>
<title>Altre risorse</title>
<body>

<p>
Informazioni aggiuntive sull'installazione e configurazione dei vari ambienti
grafici e delle applicazioni si trovano nella sezione <uri
link="/doc/it/?catid=desktop">Documentazione Desktop Gentoo</uri> della nostra
documentazione.
</p>
<p>
Se si sta effettuando l'aggiornamento a xorg-server-1.6 da una versione
precedente, assicurarsi di leggere la corrispondente <uri
link="/proj/it/desktop/x/x11/xorg-server-1.6-upgrade-guide.xml">Guida
all'aggiornamento</uri>.
</p>

</body>
</section>
</chapter>
</guide>

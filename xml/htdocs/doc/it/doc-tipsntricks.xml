<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/it/doc-tipsntricks.xml" lang="it">
<title>Trucchi e consigli per lo sviluppo della documentazione</title>
<author title="Autore">
    <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Redattore">
    <mail link="neysx@gentoo.org">Xavier Neys</mail>
</author>
<author title="Traduttore">
    <mail link="matteo.visconti@solka.it">Matteo Visconti</mail>
</author>

<abstract>
Alcuni trucchi e consigli che possono rendere più semplice la vita di un redattore di documenti per Gentoo.
</abstract>

<license/>

<version>0.8</version>
<date>4 maggio 2004</date>

<chapter>
<title>Impostare l'ambiente locale</title>
<section>
<title>Ambiente locale per i collaboratori</title>
<body>

<p>
Creare una directory dedicata allo sviluppo della documentazione.
Si prende come esempio <path>~/work/gentoo/doc</path>. 
All'interno di questa directory, si crea una sotto-directory (per esempio, <path>en/</path>) nella quale si terrà la documentazione inglese aggiornata.
</p>

<p>
Si scarica il pacchetto con la documentazione inglese più recente:
</p>

<pre caption="Scaricare la documentazione inglese">
# <i>wget http://www.gentoo.org/dyn/doc-snapshots/docs-latest-en.tar.bz2</i>
</pre>

<p>
Si decomprime la documentazione nella directory <path>en/</path>. 
Ora si possiede un'immagine aggiornata della documentazione inglese. Ogni volta che si desidera aggiornare questa immagine, si può scaricare nuovamente il pacchetto, 
ma è anche possibile caricare la pagina del documento e aggiungere <path>?passthru=1</path> all'URL. Per esempio:
</p>

<pre caption="Aggiornare un documento inglese">
# <i>wget http://www.gentoo.org/doc/en/alsa-guide.xml?passthru=1 -O alsa-guide.xml</i>
</pre>

<p>
Nel caso si voglia aiutare nella traduzione dei documenti, si consiglia di creare una directory per la propria lingua, nella quale si terranno le traduzioni correnti:
</p>

<pre caption="Scaricare la documentazione per la propria lingua">
# <i>mkdir </i><comment>${LANG}</comment>
# <i>cd </i><comment>${LANG}</comment>
# <i>wget http://www.gentoo.org/dyn/doc-snapshots/docs-latest-</i><comment>${LANG}</comment><i>.tar.bz2</i>
# <i>tar xvjf docs-latest-*.tar.bz2</i>
</pre>

<p>
Quando si aggiorna un documento, è necessario copiarlo dalla directory <path>${LANG}/</path> a quella principale (<path>~/work/gentoo/doc</path>) e modificare la versione copiata. 
È necessario avere l'originale per creare una patch:

</p>

<pre caption="Creare una patch per un aggiornamento">
# <i>diff -uNt </i><comment>${LANG}</comment><i>/alsa-guide.xml alsa-guide.xml</i> > alsa-guide.diff
</pre>

</body>
</section>
<section>
<title>Deposito CVS online</title>
<body>

<p>
Si può richiedere il <uri link="/cgi-bin/viewcvs.cgi">deposito CVS online</uri> per ottenere le differenze tra singole versioni. 
Si può accedere al deposito inglese principale da <uri
link="/cgi-bin/viewcvs.cgi/en/?root=doc">questo link</uri> (ndT: quello italiano è reperibile a <uri link="/cgi-bin/viewcvs.cgi/it/?root=doc">questo link</uri>).
Il deposito CVS online è aggiornato ogni ora.
</p>

</body>
</section>
<section>
<title>Deposito locale per gli sviluppatori</title>
<body>

<p>
Si crea una directory dedicata a Gentoo; per esempio <path>~/work/gentoo/doc</path>.  
Poi si crea una sotto-directory chiamata <path>cvs/</path> nella quale si metterà l'immagine del CVS.
</p>

<pre caption="Ottenere l'immagine del CVS">
# <i>mkdir cvs; cd cvs/</i>
# <i>export CVSROOT=</i><comment>&lt;il proprio nick&gt;</comment><i>@cvs.gentoo.org:/home/cvsroot</i>
# <i>cvs co doc</i>
</pre>

<p>
Per aggiornare l'immagine CVS, eseguire il comando <c>cvs update -dP</c> nella directory <path>cvs/doc</path>.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Provare GuideXML</title>
<section>
<title>Provare l'ambiente</title>
<body>

<p>
Prima si crea una directory <path>test/</path> nella quale si copiano <path>guide.dtd</path>, <path>main.css</path> e alcune immagini:
</p>

<pre caption="Creare l'ambiente di prova">
# <i>mkdir test</i>
# <i>cd test</i>
# <i>mkdir dtd css images</i>
# <i>wget -P dtd/ http://www.gentoo.org/dtd/guide.dtd</i>
# <i>wget -P dtd/ http://www.gentoo.org/dtd/book.dtd</i>
# <i>wget -P css/ http://www.gentoo.org/css/main.css</i>
# <i>wget -P images/ http://www.gentoo.org/images/gbot-s.gif \
  http://www.gentoo.org/images/gridtest.gif \
  http://www.gentoo.org/images/gtop-s.jpg \
  http://www.gentoo.org/images/line.gif \
  http://www.gentoo.org/images/netraverse-gentoo.gif</i>
</pre>

<p>
Ora si scarica una versione speciale di <path>guide.xsl</path> ottenibile dal <uri
link="http://dev.gentoo.org/~swift/local/guide.xsl">sito web di SwifT</uri>. 
Questa versione è modificata per trasformare GuideXML in HTML su sistemi locali.
</p>

<pre caption="Scaricare guide.xsl">
# <i>wget http://dev.gentoo.org/~swift/local/guide.xsl</i>
</pre>

<p>
Infine, si modifica <path>/etc/xml/catalog</path> aggiungendo le linee seguenti:
</p>

<pre caption="Aggiunta di /etc/xml/catalog">
&lt;rewriteURI uriStartString="/dtd" rewritePrefix="<i>/path/to/dtddir</i>"/&gt;
</pre>

<p>
Ovviamente si deve sostituire <c>/path/to/dtddir</c> con l'indicazione della directory nella quale sono presenti i file <path>guide.dtd</path> e <path>book.dtd</path>.
</p>

</body>
</section>
<section>
<title>Provare una guida di Gentoo</title>
<body>

<p>
Per provare una guida di Gentoo, per prima cosa si controlla se utilizza una corretta sintassi XML:
</p>

<pre caption="Usare xmllint per verificare le guide">
# <i>xmllint --valid --noout alsa-guide.xml</i>
</pre>

<p>
Se <c>xmllint</c> termina senza indicare nulla, la sintassi XML del file è corretta. 
Quindi è necessario convertirlo in HTML. <c>xsltproc</c> è il programma utilizzato per fare ciò:
</p>

<pre caption="Convertire in HTML">
# <i>xsltproc --novalid test/guide.xsl alsa-guide.xml &gt; test/alsa-guide.html</i>
</pre>

<p>
Se non è indicato nessun errore, si dovrebbe essere in grado di aprire il file con il proprio browser (digitando <uri>file:///home/user/work/gentoo/doc/test/alsa-guide.html</uri> nella barra degli indirizzi, 
dove <e>user</e> è il nome del proprio utente) per visualizzare il documento. 
Se non è possibile farlo, correggere la propria guida finchè non funziona.
</p>

</body>
</section>
<section>
<title>Provare il Manuale di Gentoo</title>
<body>

<p>
Il Manuale di Gentoo è diviso in capitoli. Per trasformare in HTML un determinato capitolo, 
è necessario usare sia il file <path>handbook-x86.xml</path> sia il file <path>hb-</path> desiderato 
(per esempio, <path>hb-install-about.xml</path>). Quindi bisogna eseguire <c>xsltproc</c> dando gli stessi parametri utilizzati mentre si sfoglia online il manuale, indicando <c>part</c> e <c>chap</c>. 
Ad esempio, per verificare la validità di <path>hb-install-about.xml</path>:
</p>

<pre caption="Verificare la validità di hb-install-about.xml">
# <i>xmllint --valid --noout handbook-x86.xml</i>
# <i>xmllint --valid --noout hb-install-about.xml</i>
# <i>xsltproc --stringparam part 1 --stringparam chap 1 test/guide.xsl \
handbook-x86.xml &gt; test/hb-install-about.html</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Usare un'installazione di axkit</title>
<section>
<body>

<p>
Alcuni sviluppatori di documenti preferiscono utilizzare un'installazione di axkit simile a quella che è usata su <uri>http://www.gentoo.org</uri>. Di seguito alcune dritte per installare una configurazione simile.
</p>

<warn>
Sembra che axkit sia molto sensibile alle versioni dei pacchetti che utilizza, specialmente a quelle di libxml2. 
La configurazione descritta di seguito è correttamente funzionante. Altre combinazioni di pacchetti potrebbero non funzionare.
</warn>

<p>
Per prima cosa si installano i pacchetti richiesti:
</p>

<pre caption="Installare la versioni specifiche dei pacchetti richiesti">
<comment>(Controllare se i pacchetti sono disponibili in portage)</comment>
# <i>emerge -vp =libxml2-2.5.8 =libxslt-1.0.33 =AxKit-1.6.1 =XML-XPath-1.13 \
 =XML-LibXML-1.54-r1 =XML-LibXSLT-1.53 =XML-Parser-2.31-r1 =apache-1.3.29-r1</i>

These are the packages that I would merge, in order:

Calculating dependencies ...done!
[ebuild   R   ] dev-libs/libxml2-2.5.8  -ipv6 +python +readline  0 kB 
[ebuild   R   ] dev-libs/libxslt-1.0.33  +python  0 kB 
[ebuild   R   ] dev-perl/AxKit-1.6.1  +gnome  0 kB 
[ebuild   R   ] dev-perl/XML-XPath-1.13   0 kB 
[ebuild   R   ] dev-perl/XML-LibXML-1.54-r1   0 kB 
[ebuild   R   ] dev-perl/XML-LibXSLT-1.53   0 kB 
[ebuild   R   ] dev-perl/XML-Parser-2.31-r1   0 kB
[ebuild   R   ] net-www/apache-1.3.29-r1  +pam  0 kB

<comment>(Installare i pacchetti)</comment>
# <i>emerge -v =libxml2-2.5.8 =libxslt-1.0.33 =AxKit-1.6.1 =XML-XPath-1.13 \
 =XML-LibXML-1.54-r1 =XML-LibXSLT-1.53 =XML-Parser-2.31-r1 =apache-1.3.29-r1</i>
</pre>

<p>
Quindi si modificano i seguenti file di configurazione:
</p>

<pre caption="/etc/apache/conf/commonapache.conf">
<comment>(All'interno)</comment>
&lt;IfModule mod_dir.c&gt;
  <comment>(Aggiungere index.xml alla lista)</comment>
  <comment>(ndT: se apache dovesse dare un errore riguardo al file commonapache.conf, 
   si consiglia di porre gli argomenti di DirectoryIndex in un'unica riga)</comment>
  DirectoryIndex index.xml index.html index.php index.php3 \
  index.shtml index.cgi index.pl index.htm Default.htm default.htm
&lt;/IfModule&gt;

<comment>(Aggiungere le linee seguenti)</comment>
&lt;IfDefine PERL&gt;
  LoadModule perl_module extramodules/libperl.so
#  AddModule mod_perl.c
  PerlModule AxKit
  SetHandler perl-script
  PerlHandler Apache::AxKit::StyleChooser::PathInfo AxKit
  AddHandler axkit .xml .xsp
  AxAddPlugin Apache::AxKit::StyleChooser::QueryString
  AxAddXSPTaglib AxKit::XSP::Util
  AxAddXSPTaglib AxKit::XSP::IfParam
  AxAddXSPTaglib AxKit::XSP::Param
  AxAddStyleMap application/x-xsp Apache::AxKit::Language::XSP
  AxAddStyleMap text/xsl Apache::AxKit::Language::LibXSLT
  &lt;AxStyleName "#default"&gt;
    AxAddProcessor text/xsl /xsl/guide.xsl
  &lt;/AxStyleName&gt;
  &lt;AxStyleName printable&gt;
    AxAddProcessor text/xsl /xsl/guide-print.xsl
  &lt;/AxStyleName&gt;
&lt;/IfDefine&gt;

<comment>(All'interno)</comment>
&lt;IfModule mod_alias.c&gt;
    Alias /icons/ /var/www/localhost/icons/
<comment>(Commentare la linea seguente)</comment>
    #Alias /doc /usr/share/doc
</pre>

<pre caption="/etc/conf.d/apache">
<comment>(Aggiungere -D PERL alla lista delle opzioni)</comment>
APACHE_OPTS="-D PERL"
</pre>

<p>
Quindi si copiano i file di documentazione, includendo i file DTD e i fogli di stile, in <path>/var/www/localhost/htdocs/</path>. 
È necessario avere le directory <path>css/</path>,
<path>doc/</path>, <path>dtd/</path>, <path>images/</path> e
<path>xsl/</path>. Gli sviluppatori gentoo possono copiarli o creare un symlink alla loro copia CVS locale. 
Gli altri collaboratori devono scaricare i file dalla nostra interfaccia <uri
link="http://www.gentoo.org/cgi-bin/viewcvs.cgi/xml/htdocs/?root=gentoo">viewCVS</uri>.
</p>

<p>
Ciò che resta è far partire il server apache:
</p>

<pre caption="Eseguire apache">
# <i>/etc/init.d/apache start</i>
# <comment>(Aggiungerlo al runlevel di default se si vuole che venga eseguito automaticamente all'avvio)</comment>
# <i>rc-update add apache default</i>
</pre>

<p>
Ora è possibile collegarsi al sito <uri>http://tuo_server/doc/en/</uri> o semplicemente 
<uri>http://localhost/doc/en/</uri> se axkit è stato installato sul proprio computer.
Si può controllare il file <path>/var/log/apache/access_log</path> per gli accessi e <path>/var/log/apache/error_log</path> per gli errori.
</p>

<note>
Gli utenti dei browser Mozilla, che utilizzano axkit su localhost, potrebbero aver bisogno di impostare nella loro pagina  <uri>about:config</uri> l'opzione <c>keyword.enabled</c> in <c>false</c>.
</note>

</body>
</section>

</chapter>
</guide>

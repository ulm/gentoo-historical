<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/it/genkernel.xml,v 1.3 2004/05/01 14:12:43 mush Exp $ -->

<guide link="/doc/it/genkernel.xml" lang="it">
<title>Gentoo Linux Genkernel Guide</title>

<author title="Autore">
  <mail link="plasmaroo@gentoo.org">Tim Yamin</mail>
</author>

<author title="Traduzione">
  Dario Mèndez
</author>

<abstract>
Questa guida si propone di fornire una referenza a tutte le funzioni
fornite da Genkernel
</abstract>

<license/>

<version>1.0.0.2</version>
<date>10 Aprile 2004</date>

<chapter>
<title>Introduzione</title>
<section>
<title>Introduzione</title>
<body>

<p>
Genkernel è progettato per permettere agli utenti che non hanno mai
compilato un kernel prima d'ora di ottenere un'impostazione simile a quella usata
dal LiveCD di Gentoo, in grado di rilevare automaticamente l'hardware.
</p>

<p>
Alcuni utenti possono anche essere interessati ad usare genkernel per quel genere di hardware
che richiede un inizializzazione e un kernel funzionante prima di essere
usato. Questo perchè genkernel compila automaticamente i moduli del kernel,
permettendo così all'hardware di essere caricato con particolari parametri che ne permetteranno l'uso.
</p>

</body>
</section>
<section>
<title>Quando scegliere genkernel</title>
<body>

<p>
Genkernel è una buona scelta per coloro che non usano compilare
il proprio kernel o per chi non è sicuro della propria configurazione
hardware.
</p>

<p>
Dal momento che genkernel è stato progettato per usare una configurazione generica che
dovrebbe essere in grado di supportare la maggior parte dell'hardware in commercio - ad ogni modo, un kernel compilato manualmente è molto più snello perchè fornito esclusivamente di ciò che è necessario.
</p>

<p>
Genkernel inoltre, non supporta ancora l'avvio del sistema risiedente in partizioni configurate con
LVM2/EVMS2. Nel frattempo è consigliato usare un kernel compilato manualmente.
</p>

</body>
</section>
<section>
<title>Ottenere genkernel</title>
<body>

<p>
È possibile ottenere genkernel semplicemente eseguendo <c>emerge genkernel</c>.
Qual'ora si stiano utilizzando pacchetti binari (come nel caso della GRP) è bene utilizzare il parametro <c>-k</c> per emergere. Dal momento che i GRP sono meno aggiornati, i parametri risulteranno differenti. Per maggiori informazioni, è possibile consultare il <uri link="http://www.gentoo.org/doc/it/handbook/handbook-x86.xml?part=1&amp;chap=9">
Gentoo Handbook</uri> e l'output del comando <path>genkernel --help</path>.
</p>

</body>
</section>
<section>
<title>Piattaforme supportate</title>
<body>

<p>
La versione attuale di genkernel (3.0.2) dovrebbe supportare pienamente le seguenti piattaforme:
alpha, amd64, parisc, parisc64, ppc, ppc64, sparc, sparc64, and x86. Qual'ora si dovesse scoprire un bug nel codice di supporto, e non in genkernel, sarebbe una buona idea fare rapporto del bug nel <uri link="http://bugs.gentoo.org">Gentoo Bugzilla.</uri> 
</p>

</body>
</section>
</chapter>

<chapter>
<title>Uso di genkernel</title>
<section>
<title>Introduzione</title>
<body>

<p>
Genkernel è progettato per funzionare in tre modalità:
</p>

<ul>
  <li>modalità "all": questa modalità creerà un immagine del kernel e un initrd</li>
  <li>modalità "kernel": questa modalità crea esclusivamente l'immagine del kernel</li>
  <li>modalità "initrd": questa modalità crea esclusivamente l'initrd</li>
</ul>

<p>
Alla maggior parte degli utenti sarà sufficiente usare la modalità "all", che include
la modalità "kernel" e la modalità "initrd". <b>Nota:</b> attualmente le modalità "kernel" e "initrd" non sono altro che un alias alla modalita "all", motivo per il quale non hanno ancora alcun effetto particolare.
</p>

<p>
Nonostante genkernel sia principalmente pensato per semplificare
il processo di compilazione è comunque provvisto di diversi parametri
che permettono di personalizzare il modo in cui il kernel viene compilato
o configurato.
</p>

</body>
</section>
<section>
<title>Parametri del compilatore di genkernel</title>
<body>

<p>
Genkernel supporta i seguenti parametri, che verranno forniti
alle applicazioni competenti al momento di assemblare il kernel:
</p>

<ul>
  <li>
    <b>--kernel-as=<c>nomeAssembler</c></b>: Questo parametro specifica l'assemblatore che
    verrà usato per compilare il kernel.
  </li>
  <li>
    <b>--kernel-cc=<c>nomeCompiler</c></b>: Questo parametro specifica il compilatore che
    verrà usato per compilare il kernel.
  </li>
  <li>
    <b>--kernel-ld=<c>nomeLinker</c></b>: Questo parametro specifica il linker che
    verrà usato per compilare il kernel.
  </li>
  <li>
    <b>--kernel-make=<c>nomeMake</c></b>: Questo parametro specifica il GNU Make alternativo che
    verrà usato per compilare il kernel.
  </li>
</ul>

<ul>
  <li>
    <b>--utils-as=<c>nomeAssembler</c></b>: Questo parametro specifica l'assemblatore che
    verrà usato per compilare le utility di supporto.
  </li>
  <li>
    <b>--utils-cc=<c>someCompiler</c></b>: Questo parametro specifica un compilatore che
    verrà usato per compilare le utility di supporto.
  </li>
  <li>
    <b>--utils-ld=<c>nomeLinker</c></b>: Questo parametro specifica un linker che
    verrà usato per compilare le utility di supporto.
  </li>
  <li>
    <b>--utils-make=<c>nomeMake</c></b>: Questo parametro specifica un GNU Make alternativo che
    verrà usato per compilare le utility di supporto..
  </li>
</ul>

<ul>
  <li>
    <b>--makeopts=<c>-jJobs</c></b>: Questo parametro specifica le opzioni da fornire a GNU Make
    durante la compilazione di utility e kernel.
  </li>
</ul>

</body>
</section>
<section>
<title>Parametri per il kernel</title>
<body>

<p>
Genkernel supporta i seguenti parametri, alcuni dei quali possiedono
equivalenti <c>--<b>no-</b>opzione</c>
compilazione del kernel:
</p>

<ul>
  <li>
    <b>--callback="echo Ciao"</b>: Questa routine richiama il comando specificato come argomento dopo che il kernel e i suoi moduli sono stati compilati; ma prima che l'initrd venga costruito. Questo risulta molto utile quando è necessario installare moduli esterni nell'initrd emergendoli utilizzando la chiamata e ridefinendo il gruppo dei moduli di Genkernel.
  </li>
  <li>
    <b>--<c>no-</c>clean</b>: Questo parametro esegue <e>o non esegue</e> <c>make clean</c> prima di compilare il kernel. Questo comando comporta la rimozione di tutti i file oggetto e dipendenze.
  </li>
  <li>
    <b>--<c>no-</c>mrproper</b>: Questo parametro esegue <e>o non esegue</e> <c>make mrproper</c> prima di compilare il kernel. Questo comando comporta la rimozione di tutti i file oggetto, dipendeze e configurazione.
  </li>
</ul>

<ul>
  <li>
    <b>--kerneldir=<path>/directory/dei/sorgenti</path></b>: Questo parametro permette di specificare una posizione alternativa per i sorgenti del kernel, anzichè la directory predefinita <path>/usr/src/linux</path>.
  </li>
  <li>
    <b>--kernel-config=<path>/directory/del-file/config</path></b>: Questo parametro permette di usare un file di configurazione personale anzichè il file predefinito <path>/directory/dei/soregenti/.config</path>.
  </li>
</ul>

<ul>
  <li>
    <b>--<c>no-</c>bootsplash</b>: Questo parametro aggiunge <e>o non aggiunge</e> il supporto al bootsplash nell'initrd. Non tutte le architetture e i kernel supportano questa funzione.
  </li>
  <li>
    <b>--<c>no-</c>menuconfig</b>: Questo parametro avvia <e>o non avvia</e> la configurazione del kernel tramite un interfaccia a menu dopo che <c>make 
    oldconfig</c> è stato eseguito.
  </li>
</ul>

<ul>
  <li>
    <b>--no-initrdmodules</b>: Questo parametro disattiva la copia dei moduli compilati all'interno dell'initrd.
  </li>
  <li>
    <b>--<c>no-</c>install</b>: Questo parametro installa <e>o non installa</e> kernel, moduli e initrd una volta terminata la compilazione.
  </li>
</ul>

</body>
</section>
<section>
<title>Parametri vari di genkernel</title>
<body>

<p>
Genkernel supporta inoltre alcuni parametri che non sono classificabili all'interno
delle due categorie precedenti:
</p>

<ul>
  <li>
    <b>--arch-override=<c>nomeArchitettura</c></b>: Questo parametro permette di specificare un architettura da usare in sostituzione a quella rilevata da genkernel, qualora la rilevazione automatica fallisca (si consiglia in questo caso di fare rapporto sul bug) o si desideri effettuare un cross-compile
  </li>
</ul>

<ul>
  <li>
    <b>--busybox-config=<path>/directory/del-file/busybox-config</path></b>: Questo parametro permette di specificare un file di configurazione per busybox in sostituzione a quello predefinito.
  </li>
  <li>
    <b>--busybox-bin=<path>/directory/di/busybox-binary.tar.bz2</path></b>: L'uso di questa opzione consente di utilizzare l'archivio specificato anzichè compilare il binario busybox al momento. Si prega di notare che busybox <e>deve</e> essere compilato staticamente.
  </li>
</ul>

<ul>
  <li>
    <b>--minkernpackage=<path>/directory/di/vostrokernel.tar.bz2</path></b>: Questo parametro crea un archivio compresso del kernel, chiamato <path>kernel</path> e uno dell'initrd, chiamato <path>initrd</path>. All'interno dell'archivio non verranno contenute informazioni sulle directory o moduli.
  </li>
</ul>

</body>
</section>
<section>
<title>Esecuzione di genkernel</title>
<body>

<p>
Per avviare genkernel è sufficiente digitare genkernel e i
parametri desiderati come root. Ad esempio:
</p>

<pre caption="Eseguire genkernel">
# genkernel --menuconfig --no-clean --no-install --bootsplash all
<comment>(Produrrà un kernel, richiederà una configurazione manuale,
eviterà la rimozione dei file oggetto, abiliterà il supporto per
bootsplash ma non installerà nulla.)</comment>
</pre>

<p>
Se si desidera che genkernel installi il kernel, è necessario assicurarsi
che la partizione <path>/boot</path> sia montata - le ultime versioni di genkernel
monteranno la partizione automaticamente se la variabile MOUNTBOOT è impostata su
"yes" nel file <path>/etc/genkernel.conf</path>.
</p>

<pre caption="Montaggio manuale della partizione /boot">
<comment>(Se è presente in /etc/fstab:)</comment>
# mount /boot
<comment>(... altrimenti per montare una partizione di un disco IDE:)</comment>
# mount /dev/hda1 /boot
<comment>(... e di un disco SCSI:)</comment>
# mount /dev/sda1 /boot
</pre>

</body>
</section>
<section>
<title>Impostare genkernel per funzionare con il proprio bootloader</title>
<body>

<p>
Per permettere a genkernel di funzionare con il proprio bootloader, è necessario
effettuare qualche modifica alla configurazione di quest'ultimo.
</p>

<ol>
  <li>
    Aggiungere <c>root=/dev/ram0</c> e<c>init=/linuxrc</c> ai parametri da fornire 
    all'immagine del kernel
  </li>
  <li>
    Aggiungere <c>real_root=/dev/hda3</c>, per esempio, ai parametri da fornire 
    all'immagine del kernel se <path>/dev/hda3</path> contiene la partizione di root.
  </li>
  <li>
    Se si stà utilizzando bootplash, è necessario fornire un modalità video corretta come
    <c>vga=0x317</c> ai parametri da passare al kernel ed aggiungere
    <c>splash=verbose</c> o <c>splash=silent</c> qual'ora si voglia mostrare un bootplash in modalità sileziosa o verbosa.
  </li>
  <li>
    Aggiungere l'initrd a seconda di come il bootloader la richieda: per maggiori informazioni consultare il <uri 
    link="http://www.gentoo.org/doc/it/handbook/handbook-x86.xml?part=1&amp;chap=9">Gentoo 
    Handbook</uri>.
  </li>
</ol>

</body>
</section>
</chapter>

<chapter>
<title>Effettuare il porting genkernel</title>
<section>
<title>Introduzione</title>
<body>

<p>
Supponendo che la propria architettura abbia tutte le librerie e le utility richieste
da genkernel, che comprendono un kernel funzionante per la propria architettura, una suite
di compilatori funzionante, GNU Make, e una distribuzione di busybox funzionante, si possiedono
tutti i requisiti necessari per il funzionamento di genkernel.
</p>

<p>
Genkernel usa un file chiamato
<path>/usr/share/genkernel/nomeArchitettura</path> contenente informazioni sulla configurazione per la determinata architettura.
</p>

</body>
</section>
<section>
<title>Come funziona il bootstrap del sistema</title>
<body>

<ol>
  <li>
    Il bootloader carica l'immagine di genkernel, costruita nel modo specificato
    dal file di configurazione e l'initrd.
  </li>
  <li>
    Il kernel si avvia, e effettua l'allocazione di una piccola quantità di RAM
    dove viene caricato busybox, che "sonda" il sistema con i moduli contenuti nella lista
    modules_load di ogni architettura.
  </li>
  <li>
    Una volta terminato e determinato il parametro <c>real_root</c>, il
    dispositivo di boot per la partizione di root, il sistema viene avviato
    dal dispositivo.
  </li>
</ol>

</body>
</section>
<section>
<title>I file di configurazione</title>
<body>

<ul>
  <li>
    <path>busy-config</path>: Questo è il file di configurazione usato per la creazione di busybox.
  </li>
  <li>
    <path>config.sh</path>: Questo file è uno script per la shell che imposta alcune variabili interne. Vedere uno dei file <path>config.sh</path> per avere un idea del loro funzionamento.
  </li>
  <li>
    <path>modules_load</path>: Questo file contiene una lista di moduli separati da uno spazio caricati per ottenere il supporto per dispositiv SCSI, FireWire, ATARAID e PCMCIA.
    Se questi dispositivo non sono presenti nel vostro sistema lasciare i campi in bianco.
    Esaminare uno dei file <path>modules_load</path> per comprendere meglio il loro funzionamento.
  </li>
</ul>

<ul>
  <li>
    <path>kernel-config</path>: Una configurazione di default adatta ad ogni versione del kernel.
  </li>
  <li>
    <path>kernel-config-2.4</path>: Una configurazione di default usata per i kernel della serie 2.4.
  </li>
  <li>
    <path>kernel-config-2.6</path>: na configurazione di default usata per i kernel della serie 2.6.
  </li>
</ul>

</body>
</section>
</chapter>
</guide>

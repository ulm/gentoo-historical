<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/it/alsa-guide.xml,v 1.13 2005/04/25 12:26:57 so Exp $ -->
<guide link = "/doc/it/alsa-guide.xml" lang="it">
<title>Gentoo Linux ALSA Guide</title>

<author title="Autore"><mail link="zu@pandora.be">
	Vincent Verleye</mail>
</author>
<author title="Autore"><mail link="g2boojum@gentoo.org">
	Grant Goodyear</mail>
</author>
<author title="Autore"><mail link="agenkin@gentoo.org">
	Arcady Genkin</mail>
</author>
<author title="Autore"><mail link="eradicator@gentoo.org">
        Jeremy Huddleston</mail>
</author>
<author title="Redazione"><!-- zhen@gentoo.org -->
	John P. Davis
</author>
<author title="Redazione"><mail link="swift@gentoo.org">
    Sven Vermeulen</mail>
</author>
<author title="Redazione"><mail link="bennyc@gentoo.org">
	Benny Chuang</mail>
</author>
<author title="Redazione"><mail link="blubber@gentoo.org">
	Tiemo Kieft</mail>
</author>
<author title="Redazione"><mail link="erwin@gentoo.org">
        Erwin</mail>
</author>

<author title="Traduzione"><mail link="whitenoise@tiscali.it">
	Giorgio Vielmini</mail>
</author>

<author title="Traduzione"><mail link="sogentoo@katamail.com">
        sogentoo</mail>
</author>

<abstract>
Questa guida mostra come configurare ALSA (Advanced Linux Sound Architecture) in un sistema Gentoo Linux. Oltre alla Gentoo Linux Desktop Configuration Guide, questa guida è supposta per fornirvi più informazioni a questo proposito.
</abstract>

<license/>

<version>1.5.12</version>
<date>2005-04-24</date>

<chapter>
<title>Advanced Linux Sound Architecture</title>
<section>
	<title>Che cosa è ALSA?</title>
<body>
<p>
ALSA è <e>Advanced Linux Sound Architecture</e>, un progetto per lo sviluppo di alta qualità del sottosistema sonoro di Linux.
ALSA ha sostituito, nei kernel 2.6, OSS (<e>Open Sound System</e>) come sottosistema audio di default.
</p>

<p>
ALSA fornisce un supporto efficiente per tutti i tipi di interfacce audio, è totalmente modularizzato, è SMP e sicuro, e fornisce all'utente una libreria di alta qualità chiamata <e>alsa-lib</e>, per facilitare la programmazione delle applicazioni. Inoltre fornisce una retro-compatibilità con OSS.
</p>
 
</body>
</section>
</chapter>

<chapter>
<title>Installare ALSA</title>
<section>
<title>USE flags</title>
<body>

<p>
Gentoo fornisce una flag USE <c>alsa</c>, da impostare in <path>/etc/make.conf</path>, per permettere ad un pacchetto di essere compilato con il supporto ALSA. Se avete <c>oss</c> nella variabile USE, ALSA compilerà con la retro-compatibilità OSS.
</p>

</body>
</section>
<section>
	<title>Moduli del kernel</title>
<body>
<p>
Prima di continuare, assicuratevi che il vostro kernel ha abilitato il <e>Sound Card Support</e>. Se avete usato <c>genkernel</c> per compilare il vostro kernel, allora è già abilitato. Altrimenti riconfigurate il kernel. Assicuratevi di disabilitare <e>Open Sound System</e> nella configurazione del kernel. Se non lo si fa, il vostro sistema potrebbe usare questi driver invece di quelli alsa. Questa è molto probabilmente la ragione di quandi si vede un messaggio che avvisa che la scheda sonora non è rilevata, e invece voi siete sicuri di avere il driver corretto.
</p>
<warn>
Se usate un kernel 2.6, potete usare i driver forniti nel kernel, ma noi raccomandiamo di usare ancora media-sound/alsa-driver poichè sono più aggiornati di quelli del kernel. Se desiderate usare quelli del kernel, potete saltare il resto di questa sezione e continuare con <uri link="#alsa-utils">Installare ALSA Utils</uri>.
</warn>
<p>
Il primo passo per installare i driver sonori, è quello di sapere quale scheda sonora avete. Se non lo sapete, un semplice trucco è quello di cercare nell'output del comando <c>lspci</c>. Il comando si installa facendo <c>emerge pciutils</c>.

</p>
<pre caption="Trovare il tipo di scheda sonora">
# <i>lspci | grep -i audio</i>
Multimedia audio controller: VIA Technologies, Inc. VT82C686 AC97 Audio Controller (rev 64).
</pre>

<p>
Ora andate su <uri link="http://www.alsa-project.org/alsa-doc">ALSA Soundcard Matrix</uri> e cercate la vostra scheda. Nell'esempio sopra si dovrebbe andare a vedere "VIA". Si visualizzerà una tabella con i chipset di quella marca. Il chipset nell'esempio sopra è "via82c686"; il link "Details" informa che il driver si chiama <path>via82xx</path>. Una volta trovato quello di cui avete bisogno, potete anche saltare il resto del documento.
</p>

<p>
Da queste informazioni si può installare <c>alsa-driver</c> per la propria scheda. Per prima cosa si editi <path>/etc/make.conf</path> e si <e>aggiunga</e> una nuova opzione ALSA_CARDS. Dentro questa variabile dovete mettere il driver della vostra scheda:
</p>

<pre caption="Editare /etc/make.conf per ALSA_CARDS">
ALSA_CARDS="via82xx"
</pre>

<warn>
Se avete varie schede sonore nel vostro sistema, separatele con una virgola nella variabile ALSA_CARDS. Esempio: ALSA_CARDS="via82xx,emu10k1"
</warn>

<p>
Se desiderate la compatibilità OSS (raccomandata), dovete aggiungere 'oss' nelle flag USE in <path>/etc/make.conf</path>. Adesso siete pronti per installare <c>alsa-driver</c>:
</p>
<pre caption="Installare i driver ALSA">
# <i>emerge alsa-driver</i>
</pre>

<impo>
Ogni volta che (ri)compilate il vostro kernel, i driver ALSA dovrebbero essere cancellati. E' però consigliato fare <c>emerge alsa-driver</c> se (ri)compilate il kernel. Notate che questo compilerà i driver per il kernel in /usr/src/linux, NON il kernel che si esegue.
</impo>

</body>
</section>


<section id="alsa-utils">
	<title>Installare ALSA Utils</title>
<body>

<p>
Se la compatibilità OSS nel kernel non è sufficiente per le vostre necessità, dovrete installare <c>alsa-oss</c>. Questo fonrirà l'eseguibile 'aoss' che può essere usato così come dimostrato:
</p>

<pre caption="Altra compatibilità OSS">
# <i>emerge alsa-oss</i>
# <i>aoss mpg123 music.mp3</i>
</pre>

<p>
Installare ALSA Utils sul vostro sistema (obbligatorio):
</p>


<pre caption="Installare ALSA Utils">
# <i>emerge alsa-utils</i>
</pre>

<p>
E' il momento di configurare ALSA.
</p>
</body>
</section>
</chapter>
<chapter>
<title>Configurare ALSA</title>
<section>
<title>Caricare automaticamente i moduli del kernel</title>
<body>
<p>
Se usate un kernel modulare (come quello usato con <c>genkernel</c>), dovete modificare <path>/etc/modules.d/alsa</path> in modo da attivare i moduli necessari al boot. Per la scheda sonora che abbiamo preso ad esempio:
</p>

<pre caption="/etc/modules.d/alsa">
alias snd-card-0 snd-via82xx
<comment># La parte seguente serve solo se si desidera la compatibilità con OSS</comment>
alias sound-slot-0 snd-via82xx
alias /dev/mixer snd-mixer-oss
alias /dev/dsp snd-pcm-oss
alias /dev/midi snd-seq-oss
</pre>


<p>
Eseguite <c>modules-update</c> per salvare i cambiamenti fatti al file <path>alsa</path> in <path>/etc/modules.conf</path>:
</p>
<pre caption="Eseguire modules-update">
# <i>modules-update</i>
</pre>

</body>
</section>
<section>
<title>Verificare i Device Files</title>
<body>

<p>
Dovrebbe essere fatto automaticamnte su installazioni recenti, ma se incontrate problemi, controllate che i dispositivi ALSA e i permessi siano correttamente registrati dal vostro /dev manager. Se usate DevFS, controllate <path>/etc/devfsd.conf</path>.
</p>
<pre caption="/etc/devfsd.conf">
# ALSA/OSS stuff
# Comment/change these if you want to change the permissions on
# the audio devices
LOOKUP          snd          MODLOAD ACTION snd
LOOKUP          dsp          MODLOAD
LOOKUP          mixer        MODLOAD
LOOKUP          midi         MODLOAD
REGISTER        sound/.*     PERMISSIONS root.audio 660
REGISTER        snd/.*       PERMISSIONS root.audio 660
</pre>

</body>
</section>

<section>
	<title>Attivare ALSA al boot</title>
<body>
<p>
Per attivare ALSA al boot, aggiungere l'init script <c>alsasound</c> al runlevel boot:
</p>
<pre caption="Aggiungere alsasound al runlevel boot">
# <i>rc-update add alsasound boot</i>
# <i>/etc/init.d/alsasound start</i>
</pre>

</body>
</section>
<section>
	<title>Attivare i canali</title>
<body>
<p>
Di default tutti i canali sonori sono muti. Usiamo <c>amixer</c> per risolvere questa situazione:
</p>
<pre caption="Eseguire amixer">
# <i>amixer</i>
</pre>

<p>
Se <c>amixer</c> funziona, potete attivare i canali. Se ricevete un errore, ricontrollate che il modulo della scheda audio sia partito.
</p>

<p>
Adesso attivare i canali <e>Master</e> e <e>PCM</e>. Se non è sufficiente, attivare anche i canali <e>Center</e> e <e>Surround</e>. Non attivare i canali in cui non potete cambiare il volume; potrebbe risultare il sonoro di ALSA non funzionante.
</p>

<pre caption="Attivazione dei canali sonori">
<comment>(Se preferite un metodo basato su ncurses:)</comment>
# <i>alsamixer</i>
<comment>(o)</comment>

# <i>amixer set Master 100% unmute</i>
# <i>amixer set PCM 100% unmute</i>
<comment>(Solo se quanto fatto non è sufficiente:)</comment>
# <i>amixer set Center 100% unmute</i>
# <i>amixer set Surround 100% unmute</i>
# <i>amixer set Headphone 100% unmute</i>
</pre>

<p>
Per controllare se il suono funziona, ascoltate un file wave (con <c>aplay</c>), mp3 (con <c>mpg123</c> o <c>mplayer</c>) e qualsiasi altro file musicale.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Attivare il supporto MIDI</title>
<section>
<title>Installare i pacchetti necessari</title>
<body>

<p>
Alcune schede sonore hanno un sintetizzatore MIDI. Per poterlo usare, si deve installare il pacchetto <c>awesfx</c>:
</p>

<pre caption="Installare il pacchetto awesfx">
# <i>emerge awesfx</i>
</pre>

<p>
Se avete i font audio, dovete metterli in <path>/usr/share/sfbank/</path>. Per esempio, la SBLive ha un file di font audio chiamato <path>8MBGMSFX.SF2</path> o <path>CT4GMSFX.SF2</path>.
</p>

<p>
Dopo aver copiato il font audio, selezionatelo per poterlo utilizzare con <c>asfxload</c>:.
</p>

<pre caption="Caricare il font audio">
# <i>asfxload /usr/share/sfbank/8MBGMSFX.SF2</i>
</pre>

<p>
Se volete che questo comando si esegua ogni volta all'avvio, è consigliato aggiungerlo in <path>/etc/conf.d/local.start</path>.
</p>
<p>
Se non trovate i font audio nel CD driver della vostra scheda sonora, potete scaricarne alcuni su <uri>http://www.parabola.demon.co.uk/alsa/awe64.html</uri>.
</p>

</body>
</section>
<section>
<title>Sintetizzatore virtuale Timidity++</title>
<body>

<p>
Se la vostra scheda sonora non ha un sintetizzatore hardware (o non volete usarlo), potete utilizzare <c>timidity++</c>, che fornisce un sintetizzatore virtuale. Fate l'emerge di questo pacchetto:
</p>

<pre caption="Installare Timidity++">
# <i>emerge timidity++</i>
</pre>

<p>
C'è bisogno di un font audio per far funzionare timidity. Se non l'avete, installate <c>timidity-eawpatches</c> o <c>timidity-shompatches</c>, ve ne darà alcuni. Si possono avere varie configurazioni di font audio installate, e potete mettere la vostra in <path>/usr/share/timidity/</path>. Per passare da una configurazione ad un'altra, si dovrebbe usare <e>timidity-update</e> fornito nel pacchetto timidity++.
</p>

<pre caption="Installare font audio">
# <i>emerge timidity-eawpatches</i>
# <i>timidity-update -g -s eawpatches</i>

<comment>(o)</comment>

# <i>emerge timidity-shompatches</i>
# <i>timidity-update -g -s shompatches</i>
</pre>

<p>
Non dimenticatevi di aggiungere <c>timidity</c> al runlevel di default.
</p>

<pre caption="Aggiungere timidity al runlevel di default">
# <i>rc-update add timidity default</i>
# <i>/etc/init.d/timidity start</i>
</pre>


</body>
</section>
<section>
<title>Testare il supporto MIDI</title>
<body>

<p>
Potete usare <c>aplaymidi</c> dagli ALSA Utils per testare la vostra configurazione MIDI.
</p>

<p>
Per vedere quali porte MIDI sono disponibili sul vostro sistema, usate l'opzione <c>-l</c>:
</p>

<pre caption="Vedere le porte MIDI">
# <i>aplaymidi -l</i>
</pre>

<p>
Se tutto va bene, cercate di ascoltare un file MIDI e assicuratevi che tutto funziona. Con l'opzione <c>-p</c> si determina quale porte MIDI si desidera usare.
</p>

<pre caption="Ascoltare un file MIDI">
# <i>aplaymidi -p 65:0 "Final Fantasy 7 - Aerith' Theme.mid"</i>
</pre>

</body>
</section>
</chapter>
<chapter>
<title>Osservazioni finali</title>
<section>
	<title>Tool e firmware</title>
<body>
<p>
Alcune schede audio possono beneficiare di alcuni tool forniti dai pacchetti <c>alsa-tools</c> e <c>alsa-firmware</c>. Se avete bisogno di <c>alsa-tools</c>, definite la variabile ALSA_TOOLS in <path>/etc/make.conf</path>, con il tool che volete. Per esempio:
</p>

<pre caption="Selezionare ALSA Tools in /etc/make.conf">
ALSA_TOOLS="as10k1 ac3dec"</pre>


<p>
Poi installate i pacchetti <c>alsa-tools</c> (e/o <c>alsa-firmware</c>):
</p>

<pre caption="Installare ALSA Tools">
# <i>emerge alsa-tools</i>
</pre>

</body>
</section>
<section>
<title>Attivare il supporto Joystick</title>
<body>

<p>
Se la vostra scheda sonora ha una presa per il Joystick, potreste essere interessati nell'attivare il supporto per il joystick. Se così, cominciate con il verificare se il driver della vostra scheda sonora ha un parametro per il joystick. Potete verificarlo facendo <c>modinfo</c> nel modulo del kernel. Per esempio, per <c>snd-via82xx</c>:
</p>

<pre caption="Eseguire modinfo">
# <i>modinfo snd-via82xx</i>
filename:    /lib/modules/2.4.22-ck2/snd-via82xx.o
description: "VIA VT82xx audio"
author:      "Jaroslav Kysela &lt;perex@suse.cz&gt;"
license:     "GPL"
parm:        index int array (min = 1, max = 8), description "Index value for
             VIA 82xx bridge."
parm:        id string array (min = 1, max = 8), description "ID string for VIA
             82xx bridge."
parm:        enable int array (min = 1, max = 8), description "Enable audio part
             of VIA 82xx bridge."
parm:        mpu_port long array (min = 1, max = 8), description "MPU-401 port.
             (VT82C686x only)"
<i>parm:        joystick int array (min = 1, max = 8), description "Enable
             joystick. (VT82C686x only)"</i>
parm:        ac97_clock int array (min = 1, max = 8), description "AC'97 codec 
             clock (default 48000Hz)."
parm:        dxs_support int array (min = 1, max = 8), description "Support for  
             DXS channels (0 = auto, 1 = enable, 2 = disable, 3 = 48k only, 4 = 
             no VRA)
</pre>

<p>
Se ha il parametro per il <c>joystick</c>, collegate <c>joystick=1</c> alla riga <c>options</c> in <path>/etc/modules.d/alsa</path>. Per esempio:
</p>

<pre caption="Aggiungere il parametro joystick">
alias snd-card-0 snd-via82xx
options snd-via82xx joystick=1
</pre>

</body>
</section>
<section>
	<title>Risorse</title>
<body>

<ul>
<li><uri link="http://www.alsa-project.org">The ALSA Project</uri></li>
<li><uri link="http://www.djcj.org">ALSA Howto's and FAQs</uri></li>
<li><uri link="http://linux-sound.org">Linux Sound/MIDI Software</uri></li>
</ul>

</body>
</section>
</chapter>
</guide>

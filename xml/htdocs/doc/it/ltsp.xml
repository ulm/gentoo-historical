<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/it/Attic/ltsp.xml,v 1.14 2007/05/03 22:09:40 scen Exp $ -->

<guide link="/doc/it/ltsp.xml" lang="it">
<title>Gentoo - Guida LTSP</title>

<author title="Autore">
  <mail link="lanius@gentoo.org">Heinrich Wendel</mail>
</author>
<author title="Autore">
  <mail link="josiah@ritchietribe.net">Josiah Ritchie</mail>
</author>
<author title="Redazione">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Traduzione">
  <mail link="bernardo@linux.it">Bernardo Damele</mail>
</author>
<author title="Traduzione">
  <mail link="siggy@gentoo.org">Luca Mercuri</mail>
</author>
<author title="Traduzione">
  <mail link="scen@gentoo.org">Davide Cendron</mail>
</author>

<abstract>
Questa guida mostra come configurare un server LTSP con Gentoo.
</abstract>

<license/>

<version>1.13</version>
<date>2007-05-02</date>

<chapter>
<title>Introduzione</title>
<section>
<title>Che cosa è LTSP?</title>
<body>

<p>
LTSP è l'abbreviazione di "Linux Terminal Server Project". Installato su un
server può fornire molte workstation (chiamate anche thin-client) dello stesso
ambiente. Tutte le applicazioni vengono eseguite sul server e grazie a questo
possono essere usati vecchi PC e trasformati in Xterminal.  Questo riduce costi
e mantenimento specialmente in realtà dove c'è la necessità di avere un ambiente
di lavoro uniforme su ogni computer, per esempio in scuole o aziende.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Installazione</title>
<section>
<title>Preliminari</title>
<body>

<p>
Tutti gli esempi in questo documento prevedono che il proprio server abbia un IP
192.168.0.254, che il proprio dominio sia yourdomain.com e che la propria rete
sia 192.168.0.0/24.
</p>

</body>
</section>
<section>
<title>Installazione</title>
<body>

<p>
Prima di tutto, bisogna avere un sistema Gentoo funzionante. Leggere i manuali
di installazione Gentoo per la propria archittettura su <uri
link="http://www.gentoo.org/doc/it/index.xml">Documentazione Gentoo</uri>.
</p>

<p>
Cominciare con un semplice passo, installando il pacchetto ltsp:
</p>

<pre caption="Emerge LTSP">
# <i>emerge ltsp</i>
</pre>

<p>
Questo installerà i seguenti pacchetti come dipendenze:
</p>

<ul>
  <li><b>XFree</b>: Sono chiamati XTerminal</li>
  <li>
    <b>DHCP</b>: DHCP è il protocollo per la configurazione automatica di
    computer che usano TCP/IP, è utilizzato da ltsp per la distribuzione di IP
    alle workstation.
  </li>
  <li>
    <b>NFS</b>: NFS è un protocollo che permette l'accesso al disco rigido
    attraverso la rete, è utilizzato da ltsp per caricare un sistema di base per
    le workstation.
  </li>
  <li>
    <b>TFTP</b>: TFTP è un semplice protocollo di trasferimento, è utilizzato da
    ltsp per trasferire il kernel alle workstation.
  </li>
  <li>
    <b>XINETD</b>: Xinetd è un potente rifacimento di inetd, con funzionalità
    avanzate, utilizzato da ltsp per far partire tftp.
  </li>
</ul>

<note>
Se le flag USE kde/gnome sono impostate, verrà installato anche un sistema
completo kde/gnome.
</note>

</body>
</section>
</chapter>
<chapter>
<title>Configurazione</title>
<section>
<body>

<p>
Dopo che il processo di emerge sarà completato tutti i servizi dovranno essere
configurati:
</p>

</body>
</section>
<section>
<title>Logger di sistema</title>
<body>

<p>
Per analizzare in modo semplice i problemi, il logger di sistema deve essere
configurato per accettare connessioni remote. Per avere istruzioni in
merito leggere la documentazione del proprio logger per. Ad esempio, se si
utilizza sysklogd basta modificare il file <path>/etc/conf.d/sysklogd</path> ed
aggiungere "-r" alla linea SYSLOGD:
</p>

<pre caption="/etc/conf.d/sysklogd">
SYSLOGD="-m 0 -r"
KLOGD="-c 3 -2"
</pre>

</body>
</section>
<section>
<title>NFS</title>
<body>

<p>
Il prossimo passo è la modifica del file <path>/etc/exports</path>, in modo da
permettere alle workstation di caricare il filesystem root. Per ottenere questo
bisogna aggiungere queste due righe alla fine:
</p>

<pre caption="/etc/exports">
/opt/ltsp-4.1/i386            192.168.0.0/255.255.255.0(ro,no_root_squash,async)
/var/opt/ltsp/swapfiles  	  192.168.0.0/255.255.255.0(rw,no_root_squash,async)
</pre>

<note>
Modificare il network/netmask inserendo i dati della vostra rete.
</note>

<p>
A questo punto avviare NFS.
</p>

<pre caption="Avviare nfs">
# <i>rc-update add nfs default</i>
# <i>/etc/init.d/nfs start</i>
</pre>

</body>
</section>

<section>
<title>xinetd/tftp</title>
<body>

<p>
TFTP richiede un pò di configurazione per funzionare bene. Prima di tutto
modificare il file <path>/etc/conf.d/in.tftpd</path> per impostare le opzioni e
il percorso del demone tftp:
</p>

<pre caption="/etc/conf.d/in.tftpd">
INTFTPD_PATH="/tftpboot"
INTFTPD_OPTS="-s ${INTFTPD_PATH}"
</pre>

<p>
La flag -s specifica che TFTP verrà caricato in chroot mode (raccomandato).
Questo significa che non ci sarà bisogno di includere il percorso
<path>/tftpboot</path> per esempio nella configurazione di DHCP.
</p>

<p>
Poi configurare xinetd per far partire TFTP e abilitare le connessioni da
remoto. Come impostazione predefinita TFPT non sarà caricato da xinetd, per cui
modificare <path>/etc/xinetd.d/tftp</path> e sostituire <c>disable=yes</c> con
<c>disable=no</c>. Se il file non esiste crearlo con i contenuti sotto indicati.
</p>

<pre caption="/etc/xinetd.d/tftp">
service tftp
{
        disable = no
        socket_type = dgram
        protocol = udp
        wait = yes
        user = root
        server = /usr/sbin/in.tftpd
        server_args = -s /tftpboot
}
</pre>

<p>
Modificare <path>/etc/xinetd.conf</path> e commentare la linea <c>only_from =
localhost</c> anteponendoci un <c>#</c>. Infine avviare xinetd.
</p>

<pre caption="Avviare xinetd">
# <i>rc-update add xinetd default</i>
# <i>/etc/init.d/xinetd start</i>
</pre>

</body>
</section>
<section>
<title>Risoluzione dei nomi</title>
<body>

<p>
Per fare in modo che le workstation trovino tutte le risorse, una corretta
risoluzione dei nomi deve essere disponibile. Ci sono alcuni modi per ottenere
ciò. Uno è di configurare un server DNS per la rete locale, un altro (e molto
più semplice) è di avere lo stesso file <path>/etc/hosts</path> su tutti i
sistemi. Utilizzare quest'ultimo metodo.
</p>

<p>
Tutte le workstation devono essere inserite in <path>/etc/hosts</path>. Guardare
questo esempio:
</p>

<pre caption="/etc/hosts">
127.0.0.1        localhost
192.168.0.254    server      server.yourdomain.com
192.168.0.1      ws001       ws001.yourdomain.com
</pre>

</body>
</section>
<section>
<title>Configurazione DHCP</title>
<body>

<p>
Questo è il passo più complicato in cui bisogna creare un file di configurazione
valido (<path>/etc/dhcp/dhcpd.conf</path>) per DHCP. Questo è un esempio:
</p>

<pre caption = "dhcpd.conf">
<comment>(Qualche opzione generale)</comment>
default-lease-time            21600;
max-lease-time                21600;
use-host-decl-names           on;
ddns-update-style             ad-hoc;

<comment>(Opzioni di Bootp)</comment>
allow booting;
allow bootp;

<comment>(Opzioni di rete)</comment>
option subnet-mask            255.255.255.0;
option broadcast-address      192.168.0.255;
option routers                192.168.0.254;
option domain-name-servers    192.168.0.254;
option log-servers            192.168.0.254;
option domain-name            "yourdomain.com";

<comment>(Opzioni di path di LTSP)</comment>
option root-path              "192.168.0.254:/opt/ltsp-4.1/i386";
filename                      "/lts/vmlinuz-2.4.26-ltsp-2";
<comment>Indirizzo del server tftp da cui scaricare il file ltsp)</comment>
next-server                   192.168.0.254;

<comment>(Se le vostre workstation hanno una scheda ISA NIC decommentate)</comment>
<comment>(le seguenti linee e adattate il driver e l'IO)</comment>
#option option-128 code 128 = string;
#option option-129 code 129 = text;
#option option-128 e4:45:74:68:00:00;
#option option-129 "NIC=ne IO=0x300";

shared-network WORKSTATIONS {
  subnet 192.168.0.0 netmask 255.255.255.0 {
    <comment>(Distribuisce IP dinamici alle workstation)</comment>
    range dynamic-bootp 192.168.0.1 192.168.0.16;
    <comment>(Specifica la configurazione per le workstation con PXE)</comment>
    #host ws001 {
    #  hardware ethernet     00:E0:06:E8:00:84;
    #  fixed-address         192.168.0.1;
    #}
  }
}
</pre>

<p>
Se le vostre workstation supportano PXE, bisognerebbe elencarle tutte come è
stato fatto con <e>host ws001</e> (non dimenticare di decommentarla). Non dare
loro un indirizzo nel range dinamico, altrimenti potrebbe succedere che più
workstation abbiano lo stesso indirizzo IP (il che è un problema). Ricordarsi
di rimpiazzare ogni commento "//" con "##", se si fa copia-incolla del
precedente esempio, altrimenti dhcp fallirà all'avvio.
</p>

<p>
Per maggiore documentazione su questo punto leggere il "manuale ufficiale dhcp":
<uri>http://www.dhcp-handbook.com/</uri>
</p>

<p>
Avviare DHCP com'è stato fatto con NFS e xinetd:
</p>

<pre caption="Avviare dhcp">
# <i>rc-update add dhcp default</i>
# <i>/etc/init.d/dhcp start</i>
</pre>

<note>
Il DHCPD ha bisogno del CONFIG_PACKET e CONFIG_FILTER attivati nel kernel per
funzionare.
</note>

</body>
</section>

<section>
<title>Configurazione LTSP</title>
<body>

<p>
Ci sono molte opzioni per configurare le proprie workstation, visitare
<uri>http://ltsp.mirrors.tds.net/pub/ltsp/docs/ltsp-4.1-en.html#AEN1190</uri>
per una completa descrizione di <path>/opt/ltsp/i386/etc/lts.conf</path>.
</p>

<p>
Come suggerimento per iniziare, si può voler copiare
<path>/opt/ltsp/i386/etc/lts.conf.example</path> su
<path>/opt/ltsp/i386/etc/lts.conf</path> e modificarlo da lì. Si può quindi
provare a cambiare l'opzione <c>SCREEN_01</c> per leggere <c>SCREEN_01
= startx</c>.  Per usare un mouse USB su un client remoto, aggiungere le
seguenti linee e cambiare il valore di X_MOUSE_* come segue:
</p>

<pre caption="/opt/ltsp/i386/etc/lts.conf">
MODULE_01          = usb-uhci
MODULE_02          = mousedev
MODULE_03          = usbmouse
X_MOUSE_PROTOCOL   = "IMPS/2"
X_MOUSE_DEVICE     = "/dev/input/mice"
</pre>

</body>
</section>

<section>
<title>Display Manager</title>
<body>

<p>
Ora bisogna modificare la configurazione del proprio display manager per
accettare anche connessioni remote.
</p>

<p>
Per prima cosa modificare il file <path>/etc/X11/xdm/Xaccess</path>,
decommentando la seguente riga:
</p>

<pre caption="/etc/X11/xdm/Xaccess">
#*		#qualsiasi host può ottenere la finestra di login
</pre>


<p>
Modificate quindi la configurazione del display manager utilizzato:
</p>


<p>
<b>XDM</b>: In <path>/etc/X11/xdm/xdm-config</path> decommentare
<c>DisplayManager.requestPort: 0</c>
</p>

<p>
<b>KDM</b>: In <path>/usr/kde/3.1/share/config/kdm/kdmrc</path> cercare la
sezione  <c>[Xdmcp]</c> e cambiare <c>Enable = false</c> in <c>Enable =
true</c>.
</p>

<p>
<b>GDM</b>: In <path>/etc/X11/gdm/gdm.conf</path> cercare la sezione
<c>[xdmcp]</c> e cambiare <c>Enable = false</c> in <c>Enable = True</c>.
</p>

<p>
Ora si può far partire il display manager:
</p>

<pre caption="Avviare xdm">
# <i>rc-update add xdm default</i>
# <i>/etc/init.d/xdm start</i>
</pre>

<warn>
Al momento ci sono dei problemi con XDM e GDM. L'autore usa KDM per risolvere
questi problemi.
</warn>

<p>
Ricordarsi che se il proprio display manager è già in esecuzione, riavviando l'X
server via CTRL-ALT-BACKSPACE non verrà riavviato il display manager.
</p>

</body>
</section>

<section>
<title>Creare un floppy d'avvio</title>
<body>

<p>
Se le proprie workstation non supportano il boot via PXE, allora si può creare
un floppy d'avvio che può essere utilizzato per avviare le workstation e
connetterle al terminal server. Andare al l'indirizzo
<uri>http://www.rom-o-matic.net/</uri>, selezionare l'ultima versione,
selezionare il proprio NIC, premere <e>Get ROM</e> e scrivere l'immagine sul
floppy:
</p>

<pre caption="Scrivere l'immagine del floppy">
# <i>cat nicfile.zdsk > /dev/fd0</i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Risoluzione dei problemi</title>
<section>
<body>

<p>
Ci sono un pò di cose che possono essere fonte di problemi, ma ci sono anche
altre risorse che possono aiutare a risolverli:
</p>

<ul>
  <li>
    La documentazione ufficiale:
    <uri>http://wiki.ltsp.org/twiki/bin/view/Ltsp/Documentation</uri>,
    specialmente la <uri
    link="http://wiki.ltsp.org/twiki/bin/view/Ltsp/TroubleShooting">sezione
    Troubleshooting</uri>.
  </li>
  <li>Il canale IRC gentoo: irc.freenode.org #gentoo</li>
  <li>Il canale IRC ltsp: irc.freenode.org #ltsp</li>
  <li>
    La mailing list ltsp <uri>http://marc.info/?l=ltsp-discuss</uri> che è piena
    di buone informazioni.
  </li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Domande frequenti</title>
<section>
<body>

<p>
<b>D:</b> La mia workstation ha una CPU Pentium II, ma il mio server è
compilato con <c>march=athlon-xp</c>, può funzionare lo stesso?
</p>

<p>
<b>R:</b> Questo non è un problema, perchè tutte le applicazioni vengono
caricate sul server.
</p>

<p>
<b>D:</b> Quale CPU e quanta RAM dovrebbe avere il server?
</p>

<p>
<b>R:</b> C'è un buon documento con alcuni suggerimenti a
<uri>http://wiki.ltsp.org/twiki/bin/view/Ltsp/ServerSizing</uri>.
</p>

<p>
<b>D:</b> Hai maggiori informazioni riguardo il supporto PXE?
</p>

<p>
<b>R:</b> Sì, date un'occhiata a
<uri>http://wiki.ltsp.org/twiki/bin/view/Ltsp/PXE</uri>.
</p>

<p>
<b>D:</b> E’ possibile utilizzare software con Accelerazione 3D sulle
workstation?
</p>

<p>
<b>R:</b> Se state utilizzando schede NVidia date un'occhiata qui
<uri>http://wiki.ltsp.org/twiki/bin/view/Ltsp/NvidiaLtsp411</uri>.
</p>

<p>
<b>D:</b> In alcune applicazioni il font si vede male, cosa succede?
</p>

<p>
<b>R:</b> Bisogna configurare l'XFontServer, aggiungete <c>USE_XFS=Y</c> al
vostro <path>lts.conf</path>, modificate <path>/etc/X11/fs/config</path> e
commentate <c>no-listen: tcp</c>, modificate <c>XFS_PORT="-1"</c> con
<c>XFS_PORT="7100"</c> in <path>/etc/conf.d/xfs</path> e fate partire xfs:
<c>/etc/init.d/xfs start</c>. Ora assicuratevi che
<path>/etc/X11/XF86Config</path> (o <path>/etc/X11/xorg.conf</path>) contenga
<c>FontPath "unix/:7100"</c> nella sezione Files.
</p>

<p>
<b>D:</b> Posso utilizzare la scheda audio della mia workstation?
</p>

<p>
<b>R:</b> E’ presente un pacchetto ltsp-sound in Gentoo, per maggiori
informazioni leggete il file incluso <path>README</path>.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Glossario</title>
<section>
<body>

<p>
<b><uri link="http://www.ltsp.org">LTSP</uri></b>
"LTSP fornisce un semplice modo per utilizzare workstation a basso costo come
terminali a caratteri o grafici su un server GNU/Linux."
</p>

<p>
<b><uri link="http://www.webopedia.com/TERM/P/PXE.html">PXE</uri></b>
"Abbreviazione per Pre-Boot Execution Environment. Si pronuncia 'pixie', PXE è
uno dei componenti delle spefiche di Intel WfM. Questo permette alle workstation
di fare il boot da un server su una rete con maggiore priorità del boot del
sistema operativo sul disco rigido locale. Una workstation PXE-enabled connette
il suo NIC alla LAN attraverso un jumper, e rimane connesso alla rete fino a che
non viene tolta energia."
</p>

</body>
</section>
</chapter>
</guide>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/it/macos-guide.xml,v 1.2 2004/09/20 21:53:49 mush Exp $ -->

<guide link="/doc/it/macos-guide.xml" lang="it">

<title>Guida all'installazione ed all'uso di Gentoo per Mac OS X</title>

<author title="Autore">
  <mail link="alexander@gentoo.org">Alexander Plank</mail>
</author>
<author title="Autore">
  <mail link="gongloo@gentoo.org">Hasan Khalil</mail>
</author>
<author title="Autore">
  <mail link="pat2man@comcast.net">Patrick Tescher</mail>
</author>
<author title="Autore">
  <mail link="clement@varaldi.org">Clément Varaldi</mail>
</author>
<author title="Traduzione">
    <mail link="micron@madlab.it">Flavio Castelli</mail>
</author>

<abstract>
Questa guida illustra i passaggi necessari all'installazione ed all'uso del portage all'interno di Mac OS X.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->
<license/>

<version>1.0</version>
<date>13 Agosto 2004</date>

<chapter>
<title>Installazione</title>
<section>
<title>Requisiti di sistema</title>
<body>

<p>
Per installare Gentoo per Mac OS X si richiesti i seguenti programmi:
</p>

<ul>
  <li>Mac OS 10.2 o seguenti</li>
  <li>XCode Tools 1.2 o seguenti</li>
</ul>

<note>
Il programma XCode Tools può essere scaricato dall'<uri link="https://connect.apple.com">Apple Developer Connection</uri>, previa registrazione gratuita.
</note>

<impo>
Si consiglia <e>caldamente</e> d'installare l'X11 SDK contenuto in XCode.
</impo>

</body>
</section>
<section>
<title>Il programma d'installazione</title>
<body>

<p>
Per prima cosa è necessario scaricare il <uri
link="http://www.metadistribution.org/macos">programma d'installazione di Gentoo per Mac OS X</uri>. Una volta terminato il download si dovrà fare doppio clic sull'icona del file dmg appena scaricato. In questo modo i suoi contenuti saranno mostrati all'interno di una finestra di finder e sarà visibile l'icona del programma d'installazione. Cliccare quindi sull'icona del programma d'installazione e seguire le istruzioni che compariranno sullo schermo.
</p>

</body>
</section>
<section>
<title>Terminal.app</title>
<body>

<p>
Dopo che il programma d'installazione avrà completato il suo lavoro è necessario eseguire il programma Terminal.app (o un qualsiasi emulatore di terminale). Se Terminal.app è già in esecuzione sarà opportuno aprire una nuova shell/finestra affinchè siano trovati i programmi appena installati.
</p>

<warn>
L'uso di una shell diversa dalla bash non è attualmente supportato, molto probabilemente essa non funzionerà. Per cambiare la shell predefinita usata da Terminal.app è necessario seguire il seguente percorso: Terminal->Preferences (nella barra del menu), selezionare l'opzione "Execute this command" e impostare come valore <c>/bin/bash</c>.
</warn>

</body>
</section>
<section>
<title>Aggiornare il Portage</title>
<body>

<p>
E' indispensabile mantenere aggiornate le informazioni relative ai programmi forniti dal portage; esse sono contenute all'interno di una struttura (chiamata portage-tree) posta all'interno della directory <path>/usr/portage</path>. Queste informazioni indicano al portage i programmi disponibili e le loro modalità d'installazione. Per essere sempre aggiornati sugli ultimi programmi disponibili è quindi importante mantenere sincronizzato il portage-tree.
</p>

<p>
Per continuare l'installazione è necessario ottenere i privilegi di root.
Per farlo basta essere un amministratore del computer ed eseguire sudo.
</p>

<pre caption="Acquisire i privilegi di root">
$ <i>sudo su</i>
Password:
</pre>

<p>
Per essere sicuri d'avere le ultime informazioni sui programmi disponibili sarà necessario sincronizzare il portage-tree con quello messo a disposizione da uno dei server di gentoo.
</p>

<pre caption="Aggiornamento del portage">
# <i>emerge sync</i>
</pre>

</body>
</section>
<section>
<title>Configurazione</title>
<body>

<p>
Per prima cosa si deve indicare al portage la versione di OSX che è in uso. Il portage usa i file contenuti in <path>/etc/make.profile</path> per determinare quali programmi siano già forniti da Mac OS X, quali siano masked per la versione di OSX in esecuzione e per conoscere le opzioni di configurazione di default. Basterà scegliere uno dei profili forniti dal programma d'installazione creando il collegamento simbolico <path>/etc/make.profile</path> che punterà ad un profilo pre-costruito.
Per farlo si digiti il seguente comando, precisando il profilo che più si adatta al sistema.
</p>

<pre caption="Creare un link simbolico al profilo per Jaguar/Panther">
# <i>ln -s /usr/portage/profiles/default-macos-10.3 /etc/make.profile</i>
</pre>

<pre caption="Creare un link simbolico al profilo per Tiger">
# <i>ln -s /usr/portage/profiles/default-macos-10.4 /etc/make.profile</i>
</pre>

<note>
Degli utenti esperti possono anche azzardarsi a configurare ulteriormente il portage modificando le opzioni contenute in <path>/etc/make.conf</path>. Tutto ciò è altamente sconsigliato per gli utenti di livello medio.
</note>

</body>
</section>
<section>
<title>Installare i programmi di sistema</title>
<body>

<p>
A questo punto è necessario fare un emerge dei programmi di sistema. In questo modo saranno installati i programmi che permetteranno al portage di funzionare correttamente.
</p>

<pre caption="Installare il sistema">
# <i>emerge system</i>
</pre>

<p>
Ora Gentoo per Mac OS X dovrebbe essere pronto per l'uso.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Installare applicazioni usando il Portage</title>

<section>
<title>Installare applicazioni</title>
<body>

<p>
Per installare un programma presente nel portage si deve semplicemente fare il suo  emerge.
Il portage si preoccuperà di risolvere tutte le dipendenze richieste dal programma. In conclusione l'unica cosa da sapere è il nome del programma.
</p>

<pre caption="Installare Lynx">
# <i>emerge lynx</i>
</pre>

</body>
</section>
<section>
<title>Pacchetti masked</title>
<body>

<p>
Sarà possibile installare una qualsiasi combinazione di programmi che siano già stati testati ed aggiornati per macos. Attualmente solo un piccolo numero di programmi non sono masked. Se l'ebuild di un programma non ha ancora la parola chiave macos aggiunta si otterrà un messaggio simile a questo:
</p>

<pre caption="Esempio di un programma masked">
# <i>emerge -p cowsay</i>

 These are the packages that I would merge, in order:
 
 Calculating dependencies
 !! all ebuilds that could satisfy "cowsay" have been masked.
 !! possible candidates are:
 - games-misc/cowsay-3.03 (masked by: missing keyword)
</pre>

</body>
</section>
<section>
<title>Testare dei programmi</title>
<body>

<p>
E' possibile ignorare lo stato di masked di un programma, controllando di persona se è in grado di funzionare. Si sconsiglia agli utenti medi di eseguire queste operazioni, sono invece raccomandate alle persone che intendono aiutare gli sviluppatori testando personalmente dei programmi masked.
Per farlo si deve semplicemente aggiungere la parola chiave "macos" all'interno dell'ebuild del programma. Per aggiungere la parola chiave "macos" ad un ebuild basta usare il comando 'ekeyword', fornito all'iterno del pacchetto 'gentoolkit-dev'.
</p>

<pre caption="Installare gentoolkit-dev">
# <i>emerge gentoolkit-dev</i>
</pre>

<pre caption="Aggiungere la parola chiave macos a un ebuild">
# <i>cd /usr/portage/games-misc/cowsay</i>
# <i>ekeyword macos cowsay-3.03.ebuild</i>
</pre>

<p>
Se il programma si compila e funziona correttamente è buona norma segnalarlo su <uri link="http://bugs.gentoo.org">Gentoo Bugzilla</uri> (previa registrazione gratuita). La procedura consiste nell'apertura di un bug, assegnandolo al <mail link="osx@gentoo.org">team di sviluppo di Gentoo per Mac OS X</mail>. Nel caso in cui il programma non funzionasse si consiglia comunque di seguire la medesima procedura, specificando gli errori riscontrati (solitamente si ottengono molti messaggi d'errore, si consiglia di copiare tutto il testo a partire dalla prima segnalazione d'errore).
</p>

<p>
Per la maggior parte dei programmi il cui funzionamento richiede X11 è necessario installare il pacchetto di sviluppo di X11. Se non lo si vuole installare durante la procedura d'installazione di XCode si può comunque effettuare l'operazione in seguito: esso è infatti installabile facendo doppio clic sul file <path>X11SDK.pkg</path> contenuto nella directory <path>Packages</path> del cdrom di XCode. Non è ancora possibile fare un emerge del portage usando il relativo ebuild. Per l'installazione di programmi che dipendono dal portage (come gentoolkit) è presente un <uri link="#doc_chap6_sect4">metodo</uri> per aggirare il problema.
</p>

</body>
</section>
<section>
<title>Programmi già installati</title>
<body>

<p>
Nel caso sia trovato un programmi già installato da Mac OS X si consiglia di segnalare il fatto aprendo un bug su <uri link="http://bugs.gentoo.org">Gentoo Bugzilla</uri> (previa registrazione gratuita). Sul proprio sistema è possibile aggiungere il nome del programma a <path>/etc/portage/package.provided</path>, in questo modo il portage realizza che il programma è già installato.
</p>

<pre caption="Aggiungere un programma a package.provided">
# <i>echo cat-name/package-x.y.z >> /etc/portage/package.provided</i>
</pre>

<note>
Per vedere un elenco dei programmi che sono già installati dalla propria versione di Mac OS X si può consultare il file <path>/etc/make.profile/package.provided</path>.
</note>

<warn>
La modifica di <path>/etc/make.profile/package.provided</path> non è consigliata, dato che il file è sovrascritto ogni volta che si aggiorna il portage-tree (usando il comando 'emerge sync').
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Usare il CVS</title>
<section>
<title>Problemi con i file system HFS</title>
<body>

<p>
Gli script nel CVS hanno problemi con i file system che non fanno distinzioni tra maiuscole e minuscole (detti quindi case insensive, l'opposto del case sensity). Si consiglia quindi di creare un file immagine con un file system case sentity in cui provare il portage tree del CVS (si consiglia di riservagli almeno 750 Mb di spazio). Per creare questa immagine di file system si può usare uno dei seguenti comandi:
</p>

<pre caption="Creazione di un file immagine con file system UFS case-sensitive">
<comment>(Sostituire 'gentoo-cvs.dmg' con il nome del file desiderato,</comment>
<comment>e 'Gentoo-CVS' con il nome del volume desiderato.)</comment>
$ <i>hdiutil create -size 750m gentoo-cvs.dmg -volname Gentoo-CVS -fs UFS</i>
</pre>

<pre caption="Creazione di un file immagine con file system  HFS+ case-sensitive">
<comment>(Sostituire 'gentoo-cvs.dmg' con il nome del file desiderato,</comment>
<comment>e 'Gentoo-CVS' con il nome del volume desiderato.)</comment>
$ <i>hdiutil create -size 750m gentoo-cvs.dmg -volname Gentoo-CVS -fs HFSX</i>
</pre>

<warn>
Per gli sviluppatori: repoman non funzionerà se ci sono degli spazi ne percorso del portage tree, non è consigliato l'uso di spazi nel nome del volume dell'immagine del CVS.
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Disinstallazione</title>

<section>
<title>Script di disinstallazione</title>
<body>

<p>
Per disinstallare Gentoo per Mac OS X si può usare uno <uri link="http://dev.gentoo.org/~alexander/files/uninstall.pl">script di disinstallazione</uri> che permette di scegliere se rimuovere o meno i programmi installati con il portage di Gentoo per MacOs.
</p>

<pre caption="Uninstalling Gentoo for Mac OS X">
# <i>sudo perl uninstall.pl</i>
</pre>

<note>
Per eseguire lo script di disinstallazione sono richiesti i privilegi di root.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Programmi disponibili</title>

<section>
<title>Panoramica</title>
<body>

<p>
Ci sono molti modi per vedere la lista dei programmi che sono stati marcati con la parola chiave 'macos', e che sono quindi considerati stabili su Mac OS X. Dato che lo sviluppo del portage per Mac OS X è molto attivo si consiglia di controllare frequentemente questa lista.
</p>

</body>
</section>
<section>
<title>Ebuild recenti per Gentoo Mac OS X</title>
<body>

<p>
Presso il sito <uri link="http://packages.gentoo.org/archs/macos/stable/">Gentoo Linux
Fresh Mac OS X Ebuilds</uri> (che è fa parte del sito ufficiale <uri link="http://packages.gentoo.org">Fresh Gentoo Ebuilds</uri>) si possono trovare svariate informazioni. Sono infatti disponibili, oltre alle informazioni di ogni ebuild, uno strumento di ricerca (con vari filtri applicabili) ed un <uri link="http://packages.gentoo.org/archs/macos/stable/gentoo_simple.rss">servizio RSS</uri> che riporta gli ultimi ebuild disponibili (una lista dei possibili file RSS è disponibile presso <uri link="http://packages.gentoo.org/feeds">Fresh Gentoo Ebuilds Feeds List</uri>). 
</p>

</body>
</section>
<section>
<title>Gentoo-Portage.com</title>
<body>

<p>
<uri link="http://www.gentoo-portage.com">Gentoo-Portage.com</uri> è un sito non ufficiale che fornisce informazioni relative al portage tree (proprio come <uri link="http://packages.gentoo.org">Fresh Gentoo Ebuilds</uri>), ma soprattutto mostra informazioni ancora più dettagliate per ogni pacchetto (come tutte le sue dipendenze).
</p>

</body>
</section>
</chapter>

<chapter>
<title>Caratteristiche avanzate e problematiche</title>

<section>
<title>Protezione delle collisioni</title>
<body>

<p>
Gentoo per Mac OS X fornisce automaticamente una protezione dalle collisioni che evita al portage di sovrascrivere i file che non ha creato. Questa caratteristica può essere disattivata con la variabile d'ambiente <c>FEATURES="-collision-protect"</c>.
</p>

<pre caption="Consentire al portage di sovrascrivere file appartenenti a Mac OS X">
# <i>FEATURES="-collision-protect" emerge autoconf</i>
</pre>

<warn>
Disattivare la protezione alle collisioni è <e>molto pericoloso</e> e può portare al non funzionamento dell'intero sistema.
</warn>

</body>
</section>
<section>
<title>emerge: command not found</title>
<body>

<p>
Il programma d'installazione di Gentoo per Mac OS X aggiorna il file <path>/etc/profile</path> aggiungendo <path>/usr/lib/portage/bin</path> alla variabile d'ambiente <c>PATH</c>. Per potere digitare <c>emerge ...</c> è necessario digitare  <path>source /etc/profile</path> oppure, più semplicemente, uscire dalla shell e rientrarvi. Solo in questi modi sarà possibile eseguire tutti i programmi basilari del portage.
</p>

</body>
</section>
<section>
<title>Errori con &lt;library&gt;.a</title>
<body>

<p>
Mentre si installano i file di <path>&lt;library&gt;.a</path>, è eseguito runlib per garantire che tutti i riferimenti alla libreria siano nel percorso appropriato. Quando un ebuild esegue il <c>make install</c>, tutti i files sono installati in <path>/var/tmp/portage&lt;package&gt;/image</path> piuttosto che nel file system principale (livefs). Questo significa che le librerie installate da un programma fanno riferimento a dei percorsi sbagliati. Questo problema sussiste solo con il kernel darwin e con i sui file <path>&lt;library&gt;.a</path>, attualmente il team di Gentoo per Mac OS X sta cercando una soluzione al problema.
</p>

<p>
Secondo la politica di sviluppo di Gentoo per Mac OS X, gli ebuild che installano librerie devono essere analizzati accuratamente prima di ricevere la parola chiave 'macos'. La maggior parte delle volte se una libreria non funziona ciò è dovuto a dei percorsi di riferimento errati. Per gli utenti più esperti ed intraprendenti c'è un piccolo trucco che risolve il problema: il comando <c>ranlib</c>. Esso infatti si preoccupa di sistemare, tra le altre cose, anche i riferimenti errati illustrati precedentemente.
</p>

<pre caption="Usare ranlib per fare funzionare una libreria corrotta">
<comment>(Sostituire '/usr/lib/libjpeg.a' con la libreria corrotta)</comment>
# <i>ranlib /usr/lib/libjpeg.a</i>
</pre>

</body>
</section>
<section>
<title>Le dipendenze del portage</title>
<body>

<p>
Alcuni programmi per essere installati richiedono la presenza del portage. Attualmente c'è un problema che impedisce al portage di riconoscersi come programma installato. Mentre il team di sviluppo di Gentoo per Mac OS X lavora per risolvere questo problema, c'è una soluzione temporanea. Infatti è possibile fare l'emerge di un programma senza installare le sue dipendenze; questo permette quindi di risolvere il problema indicato precedentemente. Si tratta però di un'operazione sconsigliata per qualsiasi altra dipendenza che non sia il portage.
</p>

<pre caption="Ignorare le dipendenze durante un emerge">
# <i>emerge --nodeps gentoolkit</i>
</pre>

</body>
</section>
</chapter>
</guide>

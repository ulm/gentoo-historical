<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/cs/handbook/hb-install-config.xml,v 1.12 2005/08/20 12:26:10 jkt Exp $ -->

<sections>

<version>2.13</version>
<date>2005-08-15</date>

<section>
<title>Informace o souborových systémech</title>
<subsection>
<title>Co je to fstab?</title>
<body>

<p>
Pod Linuxem musí být všechny používané oddíly zapsány v&nbsp;souboru
<path>/etc/fstab</path>, který obsahuje informace o přiřazení přípojných bodů
jednotlivým diskovým oddílům a různé další informace (například zda připojovat
automaticky, zda je může připojit běžný uživatel atd.).
</p>

</body>
</subsection>
<subsection>
<title>Vytvoření /etc/fstab</title>
<body>

<p>
<path>/etc/fstab</path> má speciální skladbu - každý řádek sestává ze&nbsp;šesti
polí oddělených nějakým druhem mezery (jedna či více obyčejných mezer,
tabulátor,...). Každé políčko má vlastní význam:
</p>

<ul>
<li>
  První pole specifikuje <b>oddíl</b> - cestu k&nbsp;blokovému zařízení, na
  kterém je souborový systém uložen.
</li>
<li>
  Druhé pole určuje <b>přípojný bod</b> - místo, kam se má filesystém připojit.
</li>
<li>
  Jako třetí je specifikován <b>typ</b> souborového systému.
</li>
<li>
  Čtvrté pole je určeno pro <b>volby</b> používané programem <c>mount</c> pro
  připojování oddílu. Každý typ souborového systému má své vlastní povolené
  parametry, pro jejich přehled použijte <c>man mount</c> (zobrazení manuálové
  stránky). Jednotlivé volby se oddělují čárkami.
</li>
<li>
  Páté pole je používáno programem <c>dump</c> pro určení, zda má být tento
  oddíl tímto způsobem zálohován. Políčku můžete klidně ponechat
  hodnotu&nbsp;<c>0</c>&nbsp;(nula).
</li>
<li>
  Šesté pole používá program <c>fsck</c> pro určení pořadí, ve&nbsp;kterém
  se bude provádět <b>kontrola</b> souborových systémů v&nbsp;případě, že
  systém nebyl řádně ukončen. Kořenový filesystém by zde měl mít uvedeno
  <c>1</c>, ostatní <c>2</c> (případně <c>0</c>, nevyžadují-li kontrolu).
</li>
</ul>

<p>
Výchozí <path>/etc/fstab</path>, který je obsažen v&nbsp;Gentoo, <e>není
přímo použitelný</e>, takže spusťte svůj oblíbený editor (použijeme
<c>nano</c>), abyste mohli nastavení upravit podle svého systému:
</p>

<pre caption="Otevření /etc/fstab">
# <i>nano -w /etc/fstab</i>
</pre>

<p>
Pojďme se podívat, jak zapsat volby pro oddíl <path>/boot</path>. Je to pouze
příklad, takže pokud Vaše architektura nevyžaduje oddělený <path>/boot</path>
(jako například <b>PPC</b>), neberte instrukce doslovně.
</p>

<p>
V&nbsp;našem výchozím rozdělení je <path>/boot</path> umístěn na oddílu
<path>/dev/hda1</path> a je použit systém souborů <c>ext2</c>. Během spouštění
systému je navíc požadovaná jeho kontrola, napíšeme tedy:
</p>

<pre caption="Ukázkový řádek o /boot v /etc/fstab">
/dev/hda1   /boot     ext2    defaults        1 2
</pre>

<p>
Někteří uživatelé nechtějí mít z&nbsp;bezpečnostních důvodů automaticky připojen
<path>/boot</path>, dosáhneme toho tím, že položku <c>defaults</c> nahradíme
klíčovým slovem <c>noauto</c>. Učiníte-li tak, budete muset tento oddíl
připojit vždy, když ho budete chtít použít.
</p>

<p>
Abychom zlepšili výkon, přidejme volbu <c>noatime</c>. Dosáhneme tím
rychlejšího souborového systému, protože se nebudou muset aktualizovat
informace o času posledního přístupu k&nbsp;souborům, které většinou ani nejsou
potřeba:
</p>

<pre caption="Vylepšený řádek pro /boot v /etc/fstab">
/dev/hda1   /boot     ext2    defaults,noatime    1 2
</pre>

<p>
Budeme-li pokračovat, měli bychom dostat následující tři řádky (pro
<path>/boot</path>, <path>/</path> a oddíl pro swap):
</p>

<pre caption="Tři řádky v /etc/fstab">
/dev/hda1   /boot     ext2    defaults,noatime  1 2
/dev/hda2   none      swap    sw                0 0
/dev/hda3   /         ext3    noatime           0 1
</pre>

<p>
Nakonec přidáme pravidla pro <path>/proc</path>, <c>tmpfs</c> (vyžadováno pro
chod systému) a pro CD-ROM mechaniku, a samozřejmě pokud máte další disky nebo
oddíly, tak i pro ně:
</p>

<pre caption="Kompletní příklad /etc/fstab">
/dev/hda1   /boot     ext2    defaults,noatime     1 2
/dev/hda2   none      swap    sw                   0 0
/dev/hda3   /         ext3    noatime              0 1

none        /proc     proc    defaults             0 0
none        /dev/shm  tmpfs   nodev,nosuid,noexec  0 0

/dev/cdroms/cdrom0    /mnt/cdrom    auto      noauto,user    0 0
</pre>

<p>
Volba <c>auto</c> říká programu <c>mount</c>, aby se snažil uhádnout použitý
systém souborů; hodí se to pro výměnná média, kde se můžete setkat s&nbsp;více
možnostmi. Volba <c>user</c> umožňuje připojit CD i pro obyčejné uživatele.
</p>

<p>
Použijte výše uvedený příklad pro vytvoření svého souboru
<path>/etc/fstab</path>. Používáte-li <b>SPARC</b>, měli byste navíc přidat i
tento řádek:
</p>

<pre caption="Přidání filesystému openprom do /etc/fstab">
none        /proc/openprom  openpromfs    defaults      0 0
</pre>

<p>
Soubor po sobě překontrolujte, uložte a ukončete editor.
</p>

</body>
</subsection>
</section>
<section>
<title>Informace o síti</title>
<subsection>
<title>Jméno počítače, domény,...</title>
<body>

<p>
Další z&nbsp;voleb, kterou musí uživatel podstoupit, je pojmenování svého
stroje. Zdá se to jednoduché, ale ve skutečnosti má <e>mnoho</e> uživatelů
problémy s&nbsp;výběrem správného jména. Nebojte se, naštěstí jde kdykoliv
změnit. Dále budeme používat jméno <c>tux</c> a doménu <c>domacisit</c>. Nejprve
nastavíme jméno počítače, <e>hostname</e>:
</p>

<pre caption="Nastavení hostname">
# <i>nano -w /etc/conf.d/hostname</i>

<comment>(Nastavte proměnnou HOSTNAME na jméno stroje)</comment>
HOSTNAME="<i>tux</i>"
</pre>

<p>
Nyní jméno domény:
</p>

<pre caption="Natavení jména domény">
# <i>nano -w /etc/conf.d/domainname</i>

<comment>(Nastavte proměnnou DNSDOMAIN na jméno domény)</comment>
DNSDOMAIN="<i>domacisit</i>"
</pre>

<p>
Máte-li NIS doménu (pokud nevíte, co to je, tak ji nemáte), nastavte ji:
</p>

<pre caption="Nastavení jména NIS domény">
# <i>nano -w /etc/conf.d/domainname</i>

<comment>(Nastavte proměnnou NISDOMAIN na jméno NIS domény)</comment>
NISDOMAIN="<i>my-nisdomain</i>"
</pre>

<p>
Nyní přidejte skript <c>domainname</c> do výchozího runlevelu:
</p>

<pre caption="Přidání domainname do výchozího runlevelu">
# <i>rc-update add domainname default</i>
</pre>

</body>
</subsection>
<subsection>
<title>Nastavení sítě</title>
<body>

<p>
Předtím, než podlehnete pocitu "ale to už jsme přece udělali", měli byste si
uvědomit, že nastavení sítě provedené před instalací bylo pouze dočasné pro
její potřeby; nyní nakonfigurujete síť nastálo.
</p>

<note>
Detailnější informace o nastavení sítí včetně pokročilých oblastí jako bonding,
bridging, 802.1Q VLANy nebo bezdrátové sítě najdete v&nbsp;části <uri
link="?part=4">Konfigurace sítě v&nbsp;Gentoo</uri>.
</note>

<p>
Všechny potřebné informace jsou shromážděny v&nbsp;souboru
<path>/etc/conf.d/net</path>. Jeho formát je vcelku přímočarý, avšak nevíte-li,
jak nastavit síť ručně, nemusí Vám připadat zrovna intuitivní. Ale nebojte se,
všechno si vysvětlíme :-). Ukázkovou konfiguraci doplněnou mnoha komentáři
naleznete v&nbsp;souboru <path>/etc/conf.d/net.example</path>.
</p>

<p>
Výchozí volba je nastavení přes DHCP, pokud jej tedy používáte, nemusíte nic
konfigurovat.
</p>

<p>
Potřebujete-li nakonfigurovat Vaše síťové připojení (například kvůli dalšímu
nastavení DHCP nebo pro ruční konfiguraci), otevřete
<path>/etc/conf.d/net</path> ve&nbsp;svém oblíbeném editoru (v&nbsp;tomto
příkladu použijeme <c>nano</c>):
</p>

<pre caption="Editace /etc/conf.d/net">
# <i>nano -w /etc/conf.d/net</i>
</pre>

<p>
Uvidíte toto:
</p>

<pre caption="Výchozí /etc/conf.d/net">
# This blank configuration will automatically use DHCP for any net.*
# scripts in /etc/init.d.  To create a more complete configuration,
# please review /etc/conf.d/net.example and save your configuration
# in /etc/conf.d/net (this file :]!).
</pre>

<p>
Pro zadání vlastní IP adresy, masky sítě a brány potřebujete nastavit
<c>config_eth0</c> a <c>routes_eth0</c>:
</p>

<pre caption="Ruční nastavení IP adresy pro eth0">
config_eth0=( "192.168.0.2 netmask 255.255.255.0" )
routes_eth0=( "default gw 192.168.0.1" )
</pre>

<p>
Chcete-li použít DHCP a ovlivnit jeho chování, definujte proměnné
<c>config_eth0</c> a <c>dhcp_eth0</c>:
</p>

<pre caption="Automatické získání IP adresy pro eth0">
config_eth0=( "dhcp" )
dhcp_eth0="nodns nontp nonis"
</pre>

<p>
Pro přehled všech dostupných voleb se prosím podívejte do souboru
<path>/etc/conf.d/net.example</path>.
</p>

<p>
Máte-li více síťových rozhraní, aplikujte výše uvedený postup na
<c>config_eth1</c>, <c>config_eth2</c>, atd.
</p>

<p>
Nyní uložte konfiguraci a ukončete editor.
</p>

</body>
</subsection>
<subsection>
<title>Automatické spouštění sítě při startu</title>
<body>

<p>
Aby byla Vaše síťová rozhraní spuštěna během bootu systému, musíte přidat
skript do výchozího runlevelu. Máte-li PCMCIA rozhraní, měli byste tento krok
přeskočit, protože taková rozhraní jsou spouštěna init skriptem pro PCMCIA.
</p>

<pre caption="Přidání net.eth0 do výchozího runlevelu">
# <i>rc-update add net.eth0 default</i>
</pre>

<p>
Máte-li více síťových rozhraní, musíte vytvořit odpovídající initskripty
<path>net.eth1</path>, <path>net.eth2</path>,... Můžete pro to použít
příkaz <c>ln</c>:
</p>

<pre caption="Vytvoření dalších initskriptů">
# <i>cd /etc/init.d</i>
# <i>ln -s net.eth0 net.eth1</i>
# <i>rc-update add net.eth1 default</i>
</pre>

</body>
</subsection>
<subsection>
<title>Informace o síti</title>
<body>

<p>
Dále budete muset systému sdělit některé informace o síti. Pro převod
(resolving) jmen strojů na IP adresy se jako doplněk služby DNS používá soubor
<path>/etc/hosts</path>. Máte-li například ve své síti tři počítače pojmenované
<c>janicka</c> (192.168.0.5), <c>barborka</c> (192.168.0.6) a <c>tux</c>
(192.168.0.7 - tento systém), Váš soubor <path>/etc/hosts</path> by měl vypadat
přibližně takto:
</p>

<pre caption="Otevření souboru /etc/hosts">
# <i>nano -w /etc/hosts</i>
</pre>

<pre caption="Vyplnění informací o síti">
127.0.0.1     localhost
192.168.0.5   janicka.domacisit janicka
192.168.0.6   barborka.domacisit barborka
192.168.0.7   tux.domacisit tux
</pre>

<p>
Je-li Váš systém v&nbsp;síti samotný nebo pokud Vaše nameservery umí
vše převádět, stačí jeden řádek. Budete-li například říkat svému systému
<c>tux</c>:
</p>

<pre caption="/etc/hosts pro osamělý a nebo zcela integrovaný stroj">
127.0.0.1     localhost tux
</pre>

<p>
Změny uložte a ukončete editor.
</p>

<p>
Nemáte-li ve svém systému PCMCIA, můžete nyní pokračovat <uri
link="#doc_chap3">systémovými informacemi</uri>, jinak čtěte dále.
</p>

</body>
</subsection>
<subsection>
<title>Volitelně: zprovoznění PCMCIA</title>
<body>

<note>
pcmcia-cs je dostupná pouze na platformách x86, amd64 a ppc.
</note>

<p>
Uživatelé PCMCIA by měli nejprve nainstalovat balíček <c>pcmcia-cs</c>. Platí
to i pro ty, kdo budou pracovat s&nbsp;jádrem řady 2.6 (i když nebudou používat
ovladače z tohoto balíčku, ale přímo z&nbsp;jádra). Použití proměnné
<c>USE="-X"</c> je nezbytné, jinak by se nyní začalo instalovat <c>xorg-x11</c>:
</p>

<pre caption="Instalace pcmcia-cs">
# <i>USE="-X" emerge pcmcia-cs</i>
</pre>

<p>
Až se balíček nainstaluje, přidejte <c>pcmcia</c> do <e>výchozího (default)</e>
runlevelu:
</p>

<pre caption="Přidání pcmcia do runlevelu default">
# <i>rc-update add pcmcia default</i>
</pre>

</body>
</subsection>
</section>
<section>
<title>Systémové informace</title>
<subsection>
<title>Heslo superuživatele root</title>
<body>

<p>
Nejprve nastavíme rootovské heslo:
</p>

<pre caption="Nastavení rootovského hesla">
# <i>passwd</i>
</pre>

<p>
Přejete-li si, aby se mohl root přihlašovat i přes sériovou konzoli, přidejte
<c>tts/0</c> do souboru <path>/etc/securetty</path>:
</p>

<pre caption="Přidání tts/0 do /etc/securetty">
# <i>echo "tts/0" &gt;&gt; /etc/securetty</i>
</pre>

</body>
</subsection>
<subsection>
<title>Systémové informace</title>
<body>

<p>
Pro všeobecnou konfiguraci systému používá Gentoo soubor
<path>/etc/rc.conf</path>. Otevřete jej a užijte si jeho přehlednou dokumentaci
v&nbsp;podobě komentářů :-)
</p>

<pre caption="Otevření /etc/rc.conf">
# <i>nano -w /etc/rc.conf</i>
</pre>

<p>
Až provedete potřebné změny, soubor <path>/etc/rc.conf</path> uložte a ukončete
editor.
</p>

<p>
Jak vidíte, soubor je velmi dobře okomentován, což by Vám mělo pomoci
s&nbsp;nastavením nezbytných proměnných. Určíte, zda má systém používat
Unicode a nastavíte výchozí editor a display manager (grafické přihlašování,
například gdm nebo kdm).
</p>

<p>
Klávesové mapy se v&nbsp;Gentoo nastavují pomocí souboru
<path>/etc/conf.d/keymaps</path>.
</p>

<pre caption="Editace /etc/conf.d/keymaps">
# <i>nano -w /etc/conf.d/keymaps</i>
</pre>

<p>
Dejte pozor na správnou hodnotu <c>KEYMAP</c>, jinak může psaní na klávesnici
dopadnout podivně.
</p>

<note>
Uživatelé systémů <b>SPARC</b> (a jeho klonů) založených na USB možná budou
muset vybrat klávesovou mapu i386 (například "us") místo "sunkeymap". <b>PPC</b>
používá na většině systémů klávesové mapy x86. Uživatelé, kteří
chtějí používat klávesové mapy ADB, musí povolit ADB posílání klávesových kódů
v&nbsp;jádře a v&nbsp;souboru <path>/etc/conf.d/keymaps</path> nastavit
klávesovou mapu mac/ppc.
</note>

<p>
Až dokončíte konfiguraci souboru <path>/etc/conf.d/keymaps</path>, uložte
jej a ukončete editor.
</p>

<p>
Nastavení voleb ovlivňujících hodiny je v&nbsp;souboru
<path>/etc/conf.d/clock</path>; změňte jej podle Vašich potřeb.
</p>

<pre caption="Editace /etc/conf.d/clock">
# <i>nano -w /etc/conf.d/clock</i>
</pre>

<p>
Neběží-li Vaše hardwarové hodiny v&nbsp;UTC, je potřeba navíc přidat řádek
<c>CLOCK="local"</c>, jinak mohou být posunuté.
</p>

<p>
Až budete hotovi s&nbsp;konfigurací souboru <path>/etc/conf.d/clock</path>, uložte
jej a ukončete editor.
</p>

<p>
Pokud neinstalujete na systému typu IBM PPC64, pokračujte
<uri link="?part=1&amp;chap=9">instalací nezbytných systémových nástrojů</uri>.
</p>

</body>
</subsection>
<subsection>
<title>Konfigurace konzole</title>
<body>

<note>
Tato sekce se vztahuje k&nbsp;platformám IBM PPC64.
</note>

<p>
Provozujete-li Gentoo na systému typu IBM PPC64 spolu s&nbsp;virtuální konzolí,
musíte odkomentovat příslušný řádek v&nbsp;souboru <path>/etc/inittab</path>, aby
se na ní zobrazil dialog pro přihlášení:
</p>

<pre caption="Podpora hvc či hvsi v /etc/inittab">
hvc0:12345:respawn:/sbin/agetty -L 9600 hvc0
hvsi:12345:respawn:/sbin/agetty -L 19200 hvsi0
</pre>

<p>
Také byste měli ověřit, zda je tato konzole zaznamenána
v&nbsp;<path>/etc/securetty</path>.
</p>

<p>
Nyní můžete pokračovat <uri link="?part=1&amp;chap=9">instalací nezbytných
systémových nástrojů</uri>.
</p>

</body>
</subsection>
</section>
</sections>

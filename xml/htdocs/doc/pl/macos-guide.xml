<?xml version="1.0" encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/pl/macos-guide.xml,v 1.3 2005/09/29 01:14:30 rane Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<!-- Orig revision: 1.8 -->
<!-- Translator: edi15ta <edi15ta@gazeta.pl> -->
<!-- Status: Finished -->

<!-- $Id: macos-guide.xml,v 1.3 2005/09/29 01:14:30 rane Exp $ -->

<guide link="/doc/pl/macos-guide.xml" lang="pl">

<title>Instalacja oraz praca z Gentoo pod Mac OS X</title>

<author title="Autor, Redaktor">
  <mail link="alexander@gentoo.org">Alexander Plank</mail>
</author>
<author title="Autor, Redaktor">
  <mail link="gongloo@gentoo.org">Hasan Khalil</mail>
</author>
<author title="Autor">
  <mail link="pat2man@comcast.net">Patrick Tescher</mail>
</author>
<author title="Autor">
  <mail link="clement@varaldi.org">Clément Varaldi</mail>
</author>
<author title="Redaktor">
    <mail link="robin.perkins@internode.on.net">Robin Perkins</mail>
</author>
<author title="Tłumaczenie">
  Mateusz Kotyrba
</author>

<abstract>
Ten przewodnik ma na celu przeprowadzenie zwykłego użytkownika poprzez
instalację oraz używanie narzędzia portage na Mac OS X.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>1.6</version>
<date>2005-06-20</date>

<chapter>
<title>Instalacja</title>
<section>
<title>Wymagania</title>
<body>

<p>
Aby zainstalować Gentoo pod Mac OS X należy mieć zainstalowane następujące
oprogramowanie:
</p>

<ul>
  <li>Mac OS w wersji 10.3 lub nowszy</li>
  <li>XCode Tools w wersji 1.2 lub nowsze</li>
</ul>

<note>
XCode Tools można ściągnąć bezpłatnie ze strony <uri
link="https://connect.apple.com">Apple Developer Connection</uri> (wymagana
bezpłatna rejestracja).
</note>

<impo>
<e>Bardzo</e> polecane jest, aby XCode był zainstalowany wraz z X11 SDK.
</impo>

</body>
</section>
<section>
<title>Instalator</title>
<body>

<p>
Zaczynamy od ściągnięcia <uri
link="http://www.metadistribution.org/macos">obrazu dysku instalacyjnego Gentoo
pod Mac OS X (dmg)</uri>. Po zamontowaniu obrazu (poprzez dwukrotne kliknięcie),
jego zawartość powinna zostać wyświetlona na ekranie w oknie wyszukiwarki. Ikona
instalatora powinna już być widoczna. Należy uruchomić instalator, a następnie
podążać za wskazówkami pojawiającymi się na ekranie.
</p>

</body>
</section>
<section>
<title>Terminal.app</title>
<body>

<p>
Po zakończeniu pracy instalatora otwieramy Terminal.app (lub inny emulator
terminala). Kiedy już mamy otwarte Terminal.app, musimy otworzyć nową powłokę
lub okno, aby nowo zainstalowane oprogramowanie było rozpoznawane przez sesję
terminala.
</p>

<warn>
Inne powłoki niż bash są obecnie niewspierane i najprawdopodobniej nie będą
działać, dlatego należy zmienić domyślną powłokę w Terminal.app poprzez
kliknięcie na Terminal-&gt;Preferences (w pasku menu) i wybranie opcji "Execute
this command", a następnie wpisać <c>/bin/bash</c>.
</warn>

</body>
</section>
<section>
<title>Uaktualnianie drzewa Portage</title>
<body>

<p>
Posiadanie aktualnej bazy danych informacji o pakietach Portage (powszechnie
nazywane "drzewem portage"), jest bardzo ważne. Baza ta na ogół znajduje się w
katalogu <path>/usr/portage</path>. Drzewo Portage utrzymuje informacje o każdym
pakiecie, dzięki którym portage wie jak go zainstalować. Ważne, abyśmy teraz
uaktualnili nasze drzewo do najświeższej wersji po to, dzięki czemu na naszym
dysku znajdą się najnowsze informacje o dostępnych pakietach.
</p>

<p>
Podczas pracy w konsoli potrzebne będą uprawnienia użytkownika root.  Bardzo
przydatne jest tu polecenie <c>sudo</c>.
</p>

<pre caption="Uzyskiwanie przywilejów użytkownika root">
$ <i>sudo su</i>
Password:
</pre>

<p>
Aby się upewnić, że mamy najnowsze dostępne poprawki oraz informacje o
pakietach, uaktualnimy teraz drzewo portage.
</p>

<pre caption="Uaktualnianie drzewa portage">
# <i>emerge --sync</i>
</pre>

</body>
</section>
<section>
<title>Konfiguracja</title>
<body>

<p>
Teraz musimy poinformować portage o wersji naszego systemu OSX. Portage używa
plików z katalogu <path>/etc/make.profile</path>, aby ustalić które pakiety już
zostały zainstalowane przez Mac OS X, które pakiety są zamaskowane dla naszej
wersji Mac OS X oraz domyślne opcje konfiguracyjne. Powinniśmy użyć jednego z
dostarczonych profili i zaopatrzyć system w alias <path>/etc/make.profile</path>
prowadzący do odpowiedniego profilu. Dla większości użytkowników wykonanie tej
operacji jest tak proste jak wykonanie skryptu konfiguracyjnego bootstrap
</p>

<pre caption="Uruchamianie skryptu konfiguracyjnego bootstrap">
# <i>sh /usr/portage/scripts/bootstrap-macos.sh</i>
</pre>

<p>
Jeśli konieczne jest wykonanie dowiązania teraz, należy wykonać jedno z
poniższych poleceń, w zależności od posiadanego systemu.
</p>

<pre caption="Tworzenie aliasu domyślnego profilu w Jaguar lub Panther">
# <i>ln -s /usr/portage/profiles/default-darwin/macos/10.3 /etc/make.profile</i>
</pre>

<pre caption="Tworzenie aliasu domyślnego profilu w Tiger">
# <i>ln -s /usr/portage/profiles/default-darwin/macos/10.4 /etc/make.profile</i>
</pre>

<note>
Zaawansowani użytkownicy zaawansowani mogą także skonfigurować portage poprzez
wpisanie odpowiednich opcji w pliku <path>/etc/make.conf</path>. Nie jest to
zalecane dla mniej doświadczonych osób.
</note>

</body>
</section>
<section>
<title>Instacja pakietów sytemowych</title>
<body>

<p>
Następny krok to instalacja wszystkich niezbędnych do prawidłowego
funkcjonowania systemu pakietów za pomocą polecenia <c>emerge</c>:
</p>

<pre caption="Instalowanie systemu podstawowego">
# <i>emerge system</i>
</pre>

<p>
Gratulacje! Nasza nowa instalacja Gentoo spod Mac OS X powinna być gotowa do
uruchomienia.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Instalacja oprogramowania przy pomocy Portage</title>
<section>
<title>Instalacja oprogramowania</title>
<body>

<p>
Wszystko czego potrzebujemy, aby zainstalować pakiet, który znajduje się w
portage, to polecenie <c>emerge</c>. Portage zajmie się wszystkimi zależnościami
pakietu. Instalacja pakietu jest łatwa, o ile wiemy jak się nazywa to czego
potrzebujemy.
</p>

<pre caption="Instalacja programu Lynx">
# <i>emerge lynx</i>
</pre>

</body>
</section>
<section>
<title>Pakiety zamaskowane</title>
<body>

<p>
Można zainstalować każdą kombinację pakietów, które zostały przetestowane oraz
przystosowane do pracy z systemem Mac OS. Obecnie, bardzo mała liczba pakietów
nie jest zamaskowana. Jeśli ebuild nie ma dodanego słowa kluczowego ppc-macos,
wtedy zostanie wyświetlony podobny komunikat do poniższego.
</p>

<pre caption="Przykład zamaskowanego pakietu">
# <i>emerge -p cowsay</i>

 These are the packages that I would merge, in order:
 
 Calculating dependencies
 !! all ebuilds that could satisfy "cowsay" have been masked.
 !! possible candidates are:
 - games-misc/cowsay-3.03 (masked by: missing keyword)
</pre>

</body>
</section>
<section>
<title>Testowanie pakietów</title>
<body>

<p>
Można sprawdzić samodzielnie czy jakiś pakiet działa, bez względu na to czy
pakiet jest zamaskowany czy nie. Użytkownicy, którzy chcą pomóc deweloperom przy
testowaniu pakietów mogą je odmaskować i przetestować na swoim komputerze.
Nie polecamy tego mniej doświadczonym osobom. Tę operację można wykonać poprzez
dodanie słowa kluczowego ppc-macos do pliku informacyjnego lub do ebuildu. Aby
dodać słowo kluczowe do ebuildu należy użyć programu 'ekeyword', który jest
częścią pakietu gentoolkit-dev.
</p>

<pre caption="Instalowanie pakietu gentoolkit-dev">
# <i>emerge gentoolkit-dev</i>
</pre>

<pre caption="Dodawanie słowa kluczowego do pakietu">
# <i>cd /usr/portage/games-misc/cowsay</i>
# <i>ekeyword ppc-macos cowsay-3.03.ebuild</i>
# <i>ebuild cowsay-3.03.ebuild digest</i>
</pre>

<p>
Jeśli pakiet kompiluje się z powodzeniem oraz działa poprawnie, należy
zgłosić ten fakt na <uri link="http://bugs.gentoo.org">Bugzillę Gentoo</uri>
(wymagana bezpłatna rejestracja). Można również wysłać takie zgłoszenie
bezpośrednio na adres <mail link="osx@gentoo.org">osx@gentoo.org</mail>. Jeśli
pojawią się błędy, także należy je zgłaszać w ten sposób, doklejając do
informacji wszystkie linie komunikatu o błędzie od momentu jego wystąpienia aż
do końca.
</p>

<p>
Dla większości pakietów wymagających X11 konieczna jest instalacja
pakietu deweloperskiego X11. Można go zainstalować razem z XCode lub później za
pomocą pliku <path>X11SDK.pkg</path> z katalogu <path>Packages</path> na płycie
CD Xcode 1.2 (do instalacji wystarczy dwukrotne kliknięcie pliku). Niewskazane
jest instalowanie pakietu portage z ebuildów. Dla pakietów, które wymagają
portage (takich jak gentoolkit) można skorzystać z pewnego <uri
link="#portage-dep">rozwiązania tymczasowego</uri>.
</p>

<warn>
Słowo kluczowe "macos" jest przestarzałe i nie powinno być już używane.
</warn>

</body>
</section>
<section>
<title>Już zainstalowane pakiety</title>
<body>

<p>
Jeśli znajdziemy pakiet, który jest już zainstalowany przez Mac OS X, powinniśmy
wysłać błąd na <uri link="http://bugs.gentoo.org">Bugzillę Gentoo</uri>
(wymagana bezpłatna rejestracja). Natomiast w naszym systemie możemy dodać go do
pliku <path>/etc/portage package.provided</path>, aby portage wiedział, że
pakiet jest już zainstalowany.
</p>

<pre caption="Dodawanie pakietu do pliku package.provided">
# <i>mkdir -p /etc/portage/profile/</i>
# <i>echo cat-name/package-x.y.z >> /etc/portage/package.provided</i>
</pre>

<note>
Lista pakietów, które są instalowane domyślnie przez Apple w konkretnej wersji
systemu Mac OS, znajduje się w pliku
<path>/etc/make.profile/package.provided</path>.
</note>

<warn>
Nie należy modyfikować pliku <path>/etc/make.profile/package.provided</path>.
Wszelkie dokonane w nim zmiany zostaną usunięte po wydaniu polecenia <c>emerge
--sync</c>.
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Używanie CVS</title>
<section>
<title>Problemy z rozróżnianiem małych i dużych liter</title>
<body>

<p>
Skrypty CVS mają problem z systemami plików, które nie odróżniają małych i
dużych liter - takimi jak np. HFS(+), więc konieczne będzie stworzenie obrazu
systemu plików z rozróżnianiem małych i dużych liter (zalecany rozmiar to co
najmniej 750MB), za pomocą którego będziemy mogli pobrać drzewo portage z CVS.
Dowolne z poniższych poleceń może być użyte do stworzenia takiego obrazu systemu
plików: 
</p>

<pre caption="Tworzenie obrazu UFS z rozróżnianiem małych i dużych liter">
<comment>(Należy zastąpić nazwę 'gentoo-cvs.dmg' docelową nazwą pliku,</comment>
<comment>oraz 'Gentoo-CVS' docelową nazwą woluminu)</comment>
$ <i>hdiutil create -size 750m gentoo-cvs.dmg -volname Gentoo-CVS -fs UFS</i>
</pre>

<pre caption="Tworzenie obrazu HFS+ z rozróżnianiem małych i dużych liter">
<comment>(Należy zastąpić nazwę 'gentoo-cvs.dmg' docelową nazwą pliku,</comment>
<comment>oraz 'Gentoo-CVS' docelową nazwą woluminu)</comment>
$ <i>hdiutil create -size 750m gentoo-cvs.dmg -volname Gentoo-CVS -fs HFSX</i>
</pre>

<warn>
Dla deweloperów: program repoman nie działa jeśli w ścieżce dostępu do głównego
katalogu portage wystąpią spacje. Nie należy z nich korzystać w ścieżce dostępu
do obrazu.
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Odinstalowywanie</title>
<section>
<title>Skrypt odinstalowujący</title>
<body>

<p>
Do odinstalowania Gentoo pod Mac OS można należy użyć <uri
link="http://dev.gentoo.org/~alexander/files/uninstall.pl">skryptu
odinstalowującego</uri>, który pozwoli nam wybrać czy usunąć pakiety
zainstalowane wraz z Gentoo pod MacOS.
</p>

<pre caption="Usuwanie Gentoo pod Mac OS X">
# <i>sudo perl uninstall.pl</i>
</pre>

<note>
Kasowanie musi zostać wykonywane z uprawnieniami użytkownika root.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Dostępne pakiety</title>
<section>
<title>Omówienie</title>
<body>

<p>
Istnieje kilka możliwości, dzięki którym można zobaczyć listę pakietów, które
zostały oznaczone słowem kluczowym 'ppc-macos', a zatem zostały oznaczone jako
stabilne na Mac OS X. Ponieważ nowe pakiety są szybko oznaczane jako stabilne
dla Gentoo pod Mac OS X, zalecamy częste przeględanie listy.
</p>

</body>
</section>
<section>
<title>Świeże ebuildy dla Gentoo pod Mac OS X</title>
<body>

<p>
Strona <uri link="http://packages.gentoo.org/archs/ppc-macos/stable/">Gentoo
Linux Fresh Mac OS X Ebuilds</uri>, która jest częścią oficjalnej witryny <uri
link="http://packages.gentoo.org">Fresh Gentoo Ebuilds</uri>, nie tylko pokazuje
obecny stan informacji o ebuildach, lecz także pozwala na przeszukiwanie ich
bazy oraz oferuje nawet bardziej popularną opcję kanały RSS (nawet na podstawie
słów kluczowych). Istnieje <uri
link="http://packages.gentoo.org/archs/ppc-macos/stable/gentoo_simple.rss">
kanał RSS dla najnowszych ebuildów ze słowem kluczowym 'ppc-macos'</uri>
dostępnych na stronie <uri link="http://packages.gentoo.org/feeds">Fresh Gentoo
Ebuilds Feeds List</uri>.
</p>

</body>
</section>
<section>
<title>Gentoo-Portage.com</title>
<body>

<p>
<uri link="http://www.gentoo-portage.com">Gentoo-Portage.com</uri> jest
nieoficjalnym źródłem informacji o drzewie portage, podobnie jak <uri
link="http://packages.gentoo.org">Fresh Gentoo Ebuilds</uri>, lecz oferuje
więcej opcji, opartych na informacjach zawartych w ebuildzie, takich jak
odwrotne zależności dla danego pakietu itd.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Zaawansowana konfiguracja i rozwiązywanie problemów</title>
<section>
<title>Zabezpieczenie przed konfliktem</title>
<body>

<p>
Gentoo pod MacOS posiada automatyczne zabezpieczenie przed konfliktem, które nie
pozwala narzędziu portage nadpisywać plików, które nie zostały przez nie
utworzone. Może to być wyłączone poprzez zmienną
<c>FEATURES="-collision-protect"</c>.
</p>

<pre caption="Pozwalenie portage na nadpisywanie plików systemu Mac OS X">
# <i>FEATURES="-collision-protect" emerge autoconf</i>
</pre>

<warn>
Wyłączenie zabezpieczenia przed konliktem jest <e>bardzo</e> niebezpieczne i
może zepsuć system.
</warn>

</body>
</section>
<section>
<title>emerge: command not found</title>
<body>

<p>
Instalator Gentoo pod Mac OSX uaktualnia plik <path>/etc/profile</path> poprzez
dodanie katalogu <path>/usr/lib/portage/bin</path> do zmiennej środowiskowej
<c>PATH</c>. Aby po prostu uruchomić <c>emerge ...</c>, należy się 
przelogować lub wykonać polecenie <c>source /etc/profile</c>, dzięki czemu nie
trzeba wpisywać całej ścieżki do poleceń
(<path>/usr/lib/portage/bin/&lt;nazwa&gt;</path>).
</p>

</body>
</section>
<section>
<title>Błędy z &lt;biblioteka&gt;.a</title>
<body>

<p>
Podczas instalacji plików <path>&lt;biblioteka&gt;.a</path>, uruchamiany jest
ranlib, co zapewnia, że dana biblioteka odnosi się do odpowiednich ścieżek.
Kiedy jest wykonywane polecenie <c>make install</c> w ebuildzie, pliki w
rzeczywistości są zapisywane do
<path>/var/tmp/portage&lt;pakiet&gt;/image</path> zamiast do czynnego systemu
plików. Oznacza to tyle, że biblioteki instalowane przez ebuild odnoszą się do
niewłaściwych ścieżek. Ten problem istnieje tylko na jądrze darwin z jego
plikami <path>&lt;biblioteka&gt;.a</path>, a pracuje nad nim zespół Gentoo pod
Mac OS X.
</p>

<p>
Według polityki Gentoo pod Mac OS X, przed dopisaniem słowa kluczowego 'ppc-macos'
ebuildy, które instalują biblioteki muszą być sprawdzone to be in working order.
Większość bibliotek po prostu odnosi się do złych ścieżek, co sprawia, że po
prostu nie działają. Dla użytkowników lubiących przygody jest prosty sposób,
aby to obejść. Polecenie <c>ranlib</c> naprawia, pośród innych rzeczy, odnośniki
w bibliotekach do złych ścieżek.
</p>

<pre caption="Użycie polecenia ranlib do naprawy zapsutych bibliotek">
<comment>(Należy zastąpić '/usr/lib/libjpeg.a' nazwą zepsutej biblioteki)</comment>
# <i>ranlib /usr/lib/libjpeg.a</i>
</pre>

</body>
</section>
<section id="portage-dep">
<title>Zależność portage</title>
<body>

<p>
Niektóre pakiety zależą od pakietu portage i wymagają, aby był on zainstalowany.
Obecnie jest więc problem z narzędziem portage, który nie wie, że istotnie jest
on zainstalowany. Podczas gdy zespół Gentoo pod OS X pracuje nad tym błędem,
istnieje proste obejście tego problemu. Jest możliwa instalacja pakietu bez
instalowania jego zależności. To może być wykorzystane, aby obejść zależność
portage, lecz nigdy nie powinno być wykorzystywane do żadnej innej zależności.
</p>

<pre caption="Zlekceważenie zależności podczas instalacji">
# <i>emerge --nodeps gentoolkit</i>
</pre>

</body>
</section>
</chapter>
</guide>

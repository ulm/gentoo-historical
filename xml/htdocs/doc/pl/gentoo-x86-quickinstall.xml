<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/pl/gentoo-x86-quickinstall.xml,v 1.6 2005/08/20 15:54:45 rane Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/pl/gentoo-x86-quickinstall.xml" lang="pl">
<title>Szybka instalacja Gentoo na x86</title>

<author title="Autor">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Autor">
  Steven Wagner
</author>
<author title="Tłumaczenie">
  <mail link="edi15ta@gazeta.pl">Mateusz Kotyrba</mail>
</author>

<abstract>
Ten tekst to bardzo skrócony opis opis instalacji Gentoo na architekturze x86.
Użytkownicy korzystający podczas instalacji Gentoo z tego dokumentu powinni już
mieć doświadczenie w przeprowadzaniu tego procesu.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>2.7</version>
<date>2005-08-20</date>

<chapter>
<title>Krótki opis instalacji</title>
<section>
<title>Nośnik instalacyjny</title>
<body>

<p>
Należy ściągnąć płytę CD, która znajduje się na jednym z <uri
link="/main/en/mirrors.xml">serwerów lustrzanych</uri>. Obrazy ISO znajdują się
w katalogu <path>releases/&lt;architektura&gt;/&lt;wydanie&gt;/installcd</path>.
Płyta instalacji <e>minimalnej</e> jest użyteczna tylko w przypadku instalacji
bazujących na połączeniu internetowym, natomiast jeśli posiada się płytę
instalacji <e>uniwersalnej</e> nie jest konieczne połączenie z Internetem.
</p>

<p>
Ładujemy system za pomocą <uri link="/doc/pl/faq.xml#isoburning">nagranej</uri>
płyty CD. Po wciśnięciu <c>F2</c>, w ekranie startowym, dowiemy się jakich
możemy użyć opcji ładowania. Jeśli potrzebujemy wsparcia dla PCMCIA, to po
załadowaniu systemu uruchamiamy skrypt inicjujący <c>pcmcia</c>.
</p>

<p>
Płyty instalacyjne pozwalają na uruchomienie serwera <c>sshd</c>, dodanie kont
użytkowników, uruchomienie <c>irssi</c> (klienta IRC w trybie tekstowym) oraz
przeglądanie sieci przy pomocy programów <c>lynx</c> i <c>links2</c>.
</p>

</body>
</section>
<section>
<title>Konfiguracja sieci</title>
<body>

<p>
Do konfiguracji sieci używamy polecenia <c>net-setup</c>. Przed przystąpieniem
do konfiguracji należy, przy pomocy <c>modprobe</c>, załadować moduł karty
sieciowej. Jeśli posiadamy łącze ADSL, używamy poleceń <c>adsl-setup</c> i
<c>adsl-start</c>. Wsparcie dla PPTP załączamy edytując pliki
<path>/etc/ppp/chap-secrets</path> i <path>/etc/ppp/options.pptp</path>, a
następnie wykonujemy <c>pptp &lt;serwer ip&gt;</c>.
</p>

<p>
Jeśli korzystamy z bezprzewodowego dostępu do sieci, powinniśmy wykorzystać
<c>iwconfig</c> do ustawienia parametrów połączenia, a następnie wykonujemy
ponownie polecenie <c>net-setup</c> lub uruchamiamy ręcznie <c>ifconfig</c>,
<c>dhcpcd</c> i/lub <c>route</c>.
</p>

<p>
Posiadacze proxy nie mogą zapomnieć o załadowaniu systemu używając <c>export
http_proxy</c>, <c>ftp_proxy</c> i <c>RSYNC_PROXY</c>.
</p>

</body>
</section>
<section>
<title>Przygotowywanie dysków</title>
<body>

<p>
Dyski dzielimy na partycje za pomocą <c>fdisk</c> lub <c>cfdisk</c>. Potrzebne
są przynajmniej jedna partycja linuksowa (typ 83) oraz partycja swap (typ 82).
</p>

<p>
Aby utworzyć systemy plików na partycjach linuksowych posługujemy się
poleceniami <c>mke2fs</c>, <c>mke2fs -j</c>, <c>mkreiserfs</c>, <c>mkfs.xfs</c>
oraz <c>mkfs.jfs</c>. Partycję swap inicjujemy używając <c>mkswap</c> oraz
<c>swapon</c>.
</p>

<p>
Następnie montujemy stworzone systemy plików w <path>/mnt/gentoo</path>. W miarę
potrzeb tworzymy katalogi dla innych punktów montowania (chociażby
<path>/mnt/gentoo/boot</path>).
</p>

</body>
</section>
<section>
<title>Rozpakowywanie pliku "stage"</title>
<body>

<p>
Po pierwsze powinniśmy ustawić poprawną datę używając <c>date MMDDhhmmYYYY</c>.
Następnie ściągamy plik "stage" z jednego z <uri
link="/main/en/mirrors.xml">serwerów lustrzanych</uri> lub używamy załączonego
pliku na płycie instalacyjnej, który znajduje się w katalogu
<path>/mnt/cdrom/stages</path>. Przechodzimy do katalogu
<path>/mnt/gentoo</path> po czym rozpakowujemy plik "stage" używając polecenia
<c>tar -xvjpf &lt;stage tarball&gt;</c>.
</p>

<p>
Instalując Gentoo bez dostępu do Internetu należy zainstalować obraz drzewa
Portage. Przechodzimy do <path>/mnt/gentoo/usr</path>, po czym uruchamiamy
<c>tar -xvjf /mnt/cdrom/snapshots/&lt;obraz&gt;</c>. Podobnie przebiega
instalacja drzewa Portage, jeśli ściągniemy je z Internetu.
</p>

<p>
Jeśli jest to instalacja bez dostępu do sieci, należy przekopiować wszystkie
kody źródłowe z katalogu <path>/mnt/cdrom/distfiles/</path> do
<path>/mnt/gentoo/usr/portage/distfiles/</path>.
</p>

<p>
Dostosowujemy plik <path>/mnt/gentoo/etc/make.conf</path> do naszych potrzeb
(zmieniamy flagi USE, CFLAGS i CXXFLAGS). W tym celu możemy użyć edytora
<c>nano</c>.
</p>

</body>
</section>
<section>
<title>Instalacja podstaw systemu Gentoo</title>
<body>

<p>
Najpierw montujemy system plików <path>/proc</path>, po czym kopiujemy plik
<path>/etc/resolv.conf</path>, a następnie przechodzimy do środowiska chroot.
</p>

<pre caption="Przygotowanie systemu oraz chrootowanie">
# <i>mount -t proc none /mnt/gentoo/proc</i>
# <i>cp /etc/resolv.conf /mnt/gentoo/etc/</i>
# <i>chroot /mnt/gentoo /bin/bash</i>
# <i>env-update</i> &amp;&amp; <i>source /etc/profile</i>
</pre>

<p>
Jeśli jesteśmy połączeni z Internetem, to możemy uaktualnić drzewo Portage za
pomocą polecenia <c>emerge --sync</c>.
</p>

<p>
Następnie upewniamy się, że <path>/etc/make.profile</path> jest dowiązany do
odpowiedniego profilu. Profil domyślny pownien zadowolić większość użytkowników.
Dla różnych jąder istnieją również podprofile (chociażby <path>2.4/</path> dla
profili opartych na jądrze 2.4). Profil zmieniamy używając polecenia <c>ln -sf</c>.
</p>

<ul>
  <li>
    Bootstrap (niedostępny podczas instalacji bez dostępu do Internetu) wykonamy
    uruchamiając skrypt <c>scripts/bootstrap.sh</c> w katalogu
    <path>/usr/portage</path>.
  </li>
  <li>
    Instalację systemu podstawowego (niedostępna podczas instalacji bez dostępu
    do Internetu) wykonujemy przy pomocy <c>emerge -e system</c> (lub dodatkowo
    <c>-N</c> jeśli nie zmieniliśmy domyślnych flag CFLAGS lub CXXFLAGS).
  </li>
</ul>

</body>
</section>
<section>
<title>Konfiguracja jądra</title>
<body>

<p>
Strefę czasową ustawiamy poprzez zmianę dowiązania symbolicznego
<path>/etc/localtime</path> do poprawnego miejsca w katalogu
<path>/usr/share/zoneinfo</path> używając polecenia <c>ln -sf</c>.
</p>

<p>
Instalujemy źródła jądra (w przypadku instalacji bez dostępu do Internetu
dostępne są tylko jądra <c>gentoo-sources</c> oraz <c>vanilla-sources</c>).
Następnie będąc w katalogu <path>/usr/src/linux</path> konfigurujemy go używając
<c>make menuconfig</c>, po czym wykonujemy <c>make &amp;&amp;make
modules_install</c>. Kopiujemy plik <path>arch/i386/boot/bzImage</path> do
katalogu <path>/boot</path>. Zamiast tego możemy także zainstalować genkernel
używając <c>emerge genkernel</c> i wykonać <c>genkernel --udev all</c>.
</p>

<p>
Wybierając genkernel należy pamiętać o wykonaniu poleceń <c>emerge coldplug</c>
i <c>rc-update add coldplug default</c>.
</p>

</body>
</section>
<section>
<title>Konfiguracja systemu</title>
<body>

<p>
Edytujemy plik <path>/etc/fstab</path>, według poniższego przykładu:
</p>

<pre caption="Przykład pliku fstab">
/dev/hda1   /boot     ext2    defaults,noatime     1 2
/dev/hda2   none      swap    sw                   0 0
/dev/hda3   /         ext3    noatime              0 1
none        /proc     proc    defaults             0 0
none        /dev/shm  tmpfs   nodev,nosuid,noexec  0 0
/dev/cdroms/cdrom0    /mnt/cdrom    auto      noauto,user    0 0
</pre>

<p>
Edytujemy <path>/etc/conf.d/hostname</path> i
<path>/etc/conf.d/domainname</path>, a następnie uruchamiamy <c>rc-update add
domainname default</c> i edytujemy <path>/etc/conf.d/net</path>, aby
skonfigurować sieć. Potem dodajemy skrypt inicjujący <c>net.eth0</c> do
domyślnego poziomu uruchamiania. Jeśli posiadamy kilka kart sieciowych, to
tworzymy dowiązania symboliczne do skryptu inicjującego <c>net.eth0</c> i
również dodajemy je do domyślnego poziomu uruchamiania.
</p>

<p>
Edytujemy plik <path>/etc/hosts</path> według poniższego przykładu:
</p>

<pre caption="Przykładowy /etc/hosts">
<comment>(Dla statycznego IP)</comment>
127.0.0.1     localhost
192.168.0.5   jenny.homenetwork jenny
192.168.0.6   benny.homenetwork benny
192.168.0.7   tux.homenetwork tux

<comment>(Dla dynamicznego IP)</comment>
127.0.0.1     localhost.homenetwork tux localhost
</pre>

<p>
W miarę potrzeb emergujemy <c>pcmcia-cs</c> i dodajemy go do domyślnego poziomu
uruchamiania.
</p>

<p>
Ustawiamy hasło roota używając <c>passwd</c>.
</p>

<p>
Wymaganą konfigurację systemu ustawiamy w plikach <path>/etc/rc.conf</path>,
<path>/etc/conf.d/rc</path>, <path>/etc/conf.d/keymaps</path>,
<path>/etc/conf.d/clock</path>.
</p>

</body>
</section>
<section>
<title>Instalacja narzędzi systemowych</title>
<body>

<p>
Użytkownicy jądra 2.4 powinni wykonać <c>emerge --unmerge udev</c> i <c>emerge
devfsd</c>.
</p>

<p>
Instalujemy program logujący (chociażby <c>syslog-ng</c>) i dodajemy go do
domyślnego poziomu uruchamiania. Opcjonalnie te same czynności wykonujemy dla
demona cron (przykładowo <c>vixie-cron</c>).
</p>

<p>
Instalujemy niezbędne narzędzia systemu plików (<c>xfsprogs</c>,
<c>reiserfsprogs</c> lub <c>jfsutils</c>) i narzędzia sieciowe (<c>dhcpcd</c>
lub <c>rp-pppoe</c>).
</p>

</body>
</section>
<section>
<title>Konfiguracja programu ładującego</title>
<body>

<p>
Emergujemy <c>gruba</c> lub <c>lilo</c>. Po czym dostosowujemy plik
<path>/boot/grub/grub.conf</path> lub <path>/etc/lilo.conf</path> do naszych
upodobań. Poniżej znajdują się przykłady poszczególnych plików.
</p>

<pre caption="Przykład grub.conf">
default 0
timeout 30
splashimage=(hd0,0)/grub/splash.xpm.gz

<comment>#Użytkownicy genkernela</comment>
title=Gentoo Linux 2.6.11-r3
root (hd0,0)
kernel /kernel-genkernel-x86-2.6.11-gentoo-r3 root=/dev/ram0 init=/linuxrc ramdisk=8192 real_root=/dev/hda3 udev
initrd /initramfs-genkernel-x86-2.6.11-gentoo-r3

<comment>#Pozostali</comment>
title=Gentoo Linux 2.6.11 r3
root (hd0,0)
kernel /kernel-2.6.11-gentoo-r3 root=/dev/hda3

<comment>#Tylko w przypadku, gdy chcemy ładować system Windows</comment>
title=Windows XP
root (hd0,5)
makeactive
chainloader +1
</pre>

<pre caption="Przykład lilo.conf">
boot=/dev/hda
prompt
timeout=50
default=gentoo

<comment>#Użytkownicy genkernela</comment>
image=/boot/kernel-genkernel-x86-2.6.11-gentoo-r3  
  label=gentoo
  read-only
  root=/dev/ram0
  append="init=/linuxrc ramdisk=8192 real_root=/dev/hda3 udev"
  initrd=/boot/initramfs-genkernel-x86-2.6.11-gentoo-r3

<comment>#Pozostali</comment>
image=/boot/kernel-2.6.11-gentoo-r3
  label=gentoo
  read-only
  root=/dev/hda3

<comment>#Tylko w przypadku, gdy chcemy ładować system Windows</comment>
other=/dev/hda6
  label=windows
</pre>

<p>
Użytkownicy GRUB-a, po skopiowaniu <path>/proc/mounts</path> do
<path>/etc/mtab</path>, dodatkowo powinni zainstalować go w MBR za pomocą
polecenia <c>grub-install /dev/hda</c>. Natomiast posiadajacze LILO powinni
wykonać polecenie <c>/sbin/lilo</c>.
</p>

<p>
Wychodzimy ze środowiska chroot, odmontowujemy wszystkie partycje i uruchamiamy
ponownie system.
</p>

</body>
</section>
<section>
<title>Kończenie instalacji</title>
<body>

<p>
Logujemy się jako <c>root</c>, a następnie dodajemy konta użytkowników do
codziennego użytku przy pomocy <c>useradd -m -G &lt;grupy&gt;
&lt;nazwa_użytkownika&gt;</c>.
</p>

<p>
Jeśli wykonywaliśmy instalację bez dostępu do Internetu, montujemy płytę CD z
dodatkowymi pakietami w katalogu <path>/mnt/cdrom</path> i wykonujemy polecenie
<c>export PKGDIR="/mnt/cdrom"</c>, po czym możemy wykonać <c>emerge -k
&lt;pakiet&gt;</c>, aby zainstalować dodatkowe oprogramowanie (chociażby
<c>kde</c>).
</p>

<p>
Dziękujemy za zainstalowanie Gentoo!
</p>

</body>
</section>
</chapter>
</guide>

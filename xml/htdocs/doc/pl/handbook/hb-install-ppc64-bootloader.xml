<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/pl/handbook/hb-install-ppc64-bootloader.xml,v 1.2 2004/12/31 17:14:15 swift Exp $ -->

<sections>

<version>1.6</version>
<date>2004-12-22</date>

<section>
<title>Podejmowanie decyzji.</title>
<subsection>
<title>Wprowadzenie.</title>
<body>

<p>
Gdy skonfigurowałeś jądro i zmodyfikowałeś odpowiednio niezbędne systemowe
pliki konfiguracyjne nadeszła pora na zainstalowanie programu, który uruchomi jądro
w momencie startu systemu. Taki program nazywa się <e>bootloader</e>.
</p>

<p>
Jedynym działającym na Linux/PPC64 jest yaBoot. W przyszłości będzie także dostępny grub2.
</p>

</body>
</subsection>
</section>
<section id="yaboot">
<title>Używanie yaBoot.</title>
<subsection>
<title>Wprowadzenie.</title>
<body>

<impo>
Musisz używać yaboot-static zamiast yaboot (bo yaboot nie skompiluje się on na
PPC64).
</impo>

<p>
Są dwa sposoby konfiguracji yaBoot. Możesz wykonać konfigurację
yaboot automatycznie za pomocą nowego i poprawionego narzędzia
<c>yabootconfig</c> zawartego w wersji <path>yaboot-1.3.8-r1</path>
i nowszych. Jeśli z jakiegoś powodu nie chcesz uruchamiać
<c>yabootconfig</c> do automatycznego tworzenia <path>/etc/yaboot.conf</path>
lub instalujesz Gentoo na G5 (na którym <c>yabootconfig</c> nie zawsze chce działać),
możesz najzwyczajniej w świecie wyedytować wzorcowy plik już zainstalowany w systemie.
</p>

<impo>
yabootconfig/ybin nie działa na IBM. Musisz go zainstalować w inny sposób:
<uri link="#yaboot-ibm">Używanie yaboot na IBM</uri>
</impo>

<ul>
  <li><uri link="#yabootconfig">Domyślnie: Użycie yabootconfig</uri></li>
  <li>
    <uri link="#manual_yaboot">Alternatywnie: Ręczna konfiguracja yaBoot</uri>
  </li>
</ul>

</body>
</subsection>
<subsection id="yabootconfig">
<title>Domyślnie: Użycie yabootaconfig.</title>
<body>

<p>
<c>yabootconfig</c> automatycznie wykryje partycje na Twoim komputerze
i umożliwi uruchamianie wybranego z dwóch lub trzech systemów, którymi mogą
być Linux, Mac OS oraz Mac OS X.
</p>

<p>
Przed użyciem <c>yabootconfig</c>, musisz mieć na dysku partycję bootstrap
oraz odpowiednie wpisy dotyczące partycji Linuksa w <path>/etc/fstab</path>.
Obydwa warunki powinny być już spełnione, wszystko opisaliśmy w poprzednich
rozdziałach. Upewnij się, że masz zainstalowaną najnowszą wersję yaboot
wykonując polecenie <c>emerge --update yaboot</c>. Jest to wymagane, gdyż aktualna
wersja bedzie dostępna poprzez Portage, ale może jej jeszcze nie być w plikach
stage.
</p>

<pre caption = "Instalacja yaboot-static">
# <i>emerge --update yaboot-static</i>
</pre>

<p>
Następnie wykonaj polecenie <c>yabootconfig</c>. Uruchomi się program
i potwierdzi lokalizację partycji bootstrap. Wciśnij <c>Y</c> jeśli wszystko
się zgadza. Jeżeli jest inaczej dokładnie sprawdź  <path>/etc/fstab</path>.
yabootconfig przeskanuje Twoje ustawienia, utworzy
<path>/etc/yaboot.conf</path> i uruchomi <c>mkofboot</c>.
<c>mkofboot</c> służy do formatowania partycji bootstrap i umieszczania
na niej pliku konfiguracyjnego yaboot.
</p>

<p>
Zweryfikuj zawartość <path>/etc/yaboot.conf</path>. Jeśli zmienisz
<path>/etc/yaboot.conf</path> (choćby ustawienia domyślnie startującego
OS) uruchom <c>ybin -v</c> aby zmiany odniosły skutek na partycji bootstrap.
</p>

<p>
Kiedy skończysz przejdź do paragrafu <uri link="#reboot">Ponownege uruchomienie
systemu</uri>.
</p>

</body>
</subsection>
<subsection id="manual_yaboot">
<title>Alternatywnie: Ręczna konfiguracja yaBoot.</title>
<body>

<p>
Po pierwsze upewnij się, że masz zainstalowaną aktualną wersję <c>yaboot-static</c>
</p>

<pre caption = "Instalacja yaboot">
# <i>emerge --update yaboot-static</i>
</pre>

<p>
Poniżej znajdziesz kompletny plik <path>yaboot.conf</path>.
Dostosuj go do swojej konfiguracji.
</p>

<pre caption = "/etc/yaboot.conf">
<comment>## /etc/yaboot.conf
##
## uruchom: "man yaboot.conf" by poznać szczegóły. Nie zmieniaj nic jeśli nie musisz!!
## dodatkowe przykłady możesz obejrzeć w: /usr/share/doc/yaboot/examples
##
## W celu uruchamiania innych systemów, dodaj jedną lub więcej pozycji spośród:
## bsd=/dev/hdaX, macos=/dev/hdaY, macosx=/dev/hdaZ

## nasza partycja bootstrap:</comment>

boot=/dev/sda2


<comment>## ofboot w openfirmware służy do wyboru partycji startowej.
## Jeśli tego parametru nie będzie, yaboot nie zadziała na G5 i na niektórych G4
## (dopóki nie przekażesz odpowiednich opcji do programu mkofboot/ybin).
## hd:X oznacza /dev/sdaX (lub /dev/hdaX).</comment>

ofboot=hd:2

<comment>##hd: w terminologii open firmware oznacza sda</comment>
device=hd:
partition=4

delay=5
defaultos=macosx
timeout=30
install=/usr/lib/yaboot/yaboot
magicboot=/usr/lib/yaboot/ofboot

<comment>#################
## Ta część może być powielona, jeśli masz więcej niż jeden kernel lub zestaw
## parametrów startowych - podmień 2.6.9 na wersję Twojego jądra
#################</comment>
image=/boot/kernel-2.6.9
  label=Linux
  root=/dev/sda3
  sysmap=/boot/System.map-2.6.9
  read-only

macos=hd:13
macosx=hd:12
enablecdboot
enableofboot
</pre>

<p>
Gdy <path>yaboot.conf</path> jest ustawiony w sposób, który Cię zadowala,
uruchom <c>mkofboot -v</c> by zmiany odniosły skutek na partycji bootstrap.
<e>Nie zapomnij o tym!</e>. Odpowiedź twierdząco, jeżeli <c>mkofboot</c> zapyta Cię o stworzenie nowego systemu plików.
</p>

<p>
Jeśli wszystko poszło po myśli i wprowadziłeś takie
same opcje jak w przykładzie powyżej po restarcie ujrzysz proste menu z pięcioma
pozycjami. Dokonując w przyszlości poprawek uruchom tylko <c>ybin -v</c>
by zaktualizować partycję bootstrap - <c>mkofboot</c> używa się tylko
za pierwszym razem.
</p>

<p>
Więcej informacji o programie yaboot, uzyskasz na stronie
<uri link="http://penguinppc.org/projects/yaboot">projektu yaboot</uri>.
Tymczasem przejdź do paragrafu <uri link="#reboot">Ponownego uruchomienie
systemu</uri>.
</p>

</body>
</subsection>
</section>
<section id="yaboot-ibm">
<title>Używanie yaboot na IBM.</title>
<body>

<p>
Na komputerach IBM nie możesz używać yabootconfig ani ybin. Musisz wykonać kilka
następujących czynności:
</p>

<ul>
  <li>Zainstaluj yaboot-static</li>
  <li>Uruchom 'dd if=/usr/lib/yaboot/yaboot.chrp of=/dev/sdXX' (Zamień XX
  na nazwę Twojego dysku oraz partycji dla partycji RPeP; w naszym przykładzie był to /dev/sda1)</li>
  <li>Następnie stwórz swoją wersję pliku yaboot.conf i umieść go w /etc.
  (Możesz wesprzeć się plikiem konfiguracyjnym przedstawionym powyżej lub
  zajrzeć na stronę man yaboot.conf)</li>
  <li>Zakładając, że Twóje urządzenie startowe w OF wskazuje na dysk, na którym 
  przygotowałeś partycję startową to wszystko powinno po prostu działać, inaczej 
  w czasie IPL wejdź do menu multiboot i ustaw urządzenie startowe na to, gdzie 
  znajduje się przygotowana przez Ciebie partycja startowa.</li>
  <li>To Wszystko!</li>
</ul>

</body>
</section>
<section id="reboot">
<title>Ponowne uruchamianie komputera.</title>
<subsection>
<body>

<p>
Po pierwsze opuść chroot, a następnie odmontuj wszystkie zamontowane partycje.
Wreszcie wpisz komendę <c>reboot</c>.
</p>

<pre caption="Opuszczanie chroota, odmontowywanie partycji i rebootowanie">
# <i>exit</i>
livecd ~# <i>cd</i>
livecd ~# <i>umount /mnt/gentoo/boot /mnt/gentoo/proc /mnt/gentoo/dev /mnt/gentoo</i>
livecd ~# <i>reboot</i>
</pre>

<p>
Nie zapomnij o wyjęciu LiveCD z napędu, bo zabootujesz system z płyty zamiast
swojego nowego Gentoo.
</p>

<p>
Po ponownym uruchomieniu komputera w celu dokończenia instalacji Gentoo przejdź
do rozdziału <uri link="?part=1&amp;chap=11">Finalizowanie instalacji
Gentoo</uri>.
</p>

</body>
</subsection>
</section>
</sections>


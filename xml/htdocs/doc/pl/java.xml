<?xml version="1.0" encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/pl/java.xml,v 1.13 2006/07/25 08:14:06 rane Exp $ -->
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/pl/java.xml" lang="pl">
<title>Java w Gentoo</title>

<author title="Autor">
 <mail link="karltk@gentoo.org">Karl Trygve Kalleberg</mail>
</author>
<author title="Redaktor">
 <mail link="nichoj@gentoo.org">Joshua Nichols</mail>
</author>
<author title="Redaktor">
 <mail link="nightmorph@gentoo.org">Joshua Saddler</mail>
</author>
<author title="Tłumacz">
 <mail link="muchar@gentoo.org">Robert Muchacki</mail>
</author>

<abstract>
Tekst o konfiguracji i pracy z Javą w Gentoo.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>0.5</version>
<date>2006-07-24</date>

<chapter>
<title>Co to jest Java?</title>
<section>
<title>Ogólny przegląd</title>
<body>

<p>
Java to język programowania opracowany przez inżynierów z laboratoriów Sun
Microsystems. Jest to zorientowany obiektowo język, który może być uruchamiany
na wielu platformach bez konieczności rekompilacji kodu dla każdej z platform
osobno. Pomimo, że Java może być kompilowana do zwykłego programu, to jej
największą popularność powoduje fakt, że jest bardzo przenośna oraz
posiada możliwość łatwego pozbywania się śmieci z kodu. Aby osiągnąć taki
stopień przenośności kompilatory Java kompilują kod do postaci "Java bytecode",
który można uruchomić w JRE (Java Runtime Envirnoment - środowisko
uruchomieniowe Java) a nie bezpośrednio w systemie operacyjnym.
</p>

<p>
Aby uruchomić program napisany w Javie, należy mieć zainstalowany JRE (Java
Runtime Environment - środowisko uruchomieniowe Java). JRE instaluje główne
biblioteki, maszynę wirtualną Java, wtyczki do przeglądarek, etc. JDK (Java
Development Kit) dodaje narzędzia programistyczne, jak na przykład kompilator
kodu Java czy debugger.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Instalacja środowiska JRE/JDK</title>
<section>
<title>Wybory</title>
<body>

<p>
W Gentoo dostępne jest kilka rodzajów zarówno JRE jak i JDK.
</p>

<table>
 <tr>
   <th>Twórcy</th>
   <th>JDK</th>
   <th>JRE</th>
 </tr>
 <tr>
   <ti>The Blackdown Java Kit</ti>
   <ti>dev-java/blackdown-jdk</ti>
   <ti>dev-java/blackdown-jre</ti>
 </tr>
 <tr>
   <ti>Sun's Java Kit</ti>
   <ti>dev-java/sun-jdk</ti>
   <ti>dev-java/sun-jre-bin</ti>
 </tr>
 <tr>
   <ti>The IBM Java Kit</ti>
   <ti>dev-java/ibm-jdk-bin</ti>
   <ti>dev-java/ibm-jre-bin</ti>
 </tr>
 <tr>
   <ti>The Compaq Java Kit dla Alpha/Linux/GNU</ti>
   <ti>dev-java/compaq-jdk</ti>
   <ti>dev-java/compaq-jre</ti>
 </tr>
 <tr>
   <ti>BEA WebLogic's J2SE Development Kit</ti>
  <ti>dev-java/jrockit-jdk-bin</ti>
 </tr>
</table>

<!--
TODO: list free implmentations?
note about not drop-in replacemenets
kaffe/sablevm/gcj/jamvm
-->

<p>
Domyślnym jest para JRE/JDK z Blackdown, jako że jej instalacja nie wiąże się z
koniecznością dokonywania jakiejkolwiek rejestracji.
</p>

<p>
Zarówno Sun jak i IBM są zdecydowanie szybsze, niemniej jednak,
zdobycie ich wymaga nieco więcej pracy, gdyż należy przeczytać i zaakceptować
ich licencję przed pobraniem plików z sieci (IBM dodatkowo wymaga rejestracji).
</p>

<p>
Ebuildy dla Sun oraz IBM JRE/JDK powiadomią o tym, skąd można pobrać
odpowiednie pliki.
</p>

</body>
</section>

<section>
<title>Instalowanie JRE/JDK</title>
<body>

<p>
Aby zainstalować domyślne dla wykorzystywanego profilu JDK, należy uruchomić
<c>emerge virtual/jdk</c>, natomiast by zainstalować domyślne JRE - <c>emerge
virtual/jre</c>.
</p>

<note>
JDK zawiera w sobie JRE, więc jeżeli zainstalujemy JDK, nie powinniśmy
dodatkowo instalować JRE.
</note>

</body>
</section>
<section>
<title>Instalacja Sun/IBM JRE/JDK</title>
<body>

<p>
Gdy uruchomimy <c>emerge dev-java/sun-jdk</c> lub <c>emerge
dev-java/ibm-jdk-bin</c>, zostaniemy poinformowani, że musimy ściągnąć dodatkowe
pliki na własną rękę. Dzieje się tak ze względu na restrykcyjne licencje dla
JRE/JDK firmy Sun oraz konieczność rejestracji w przypadku IBM JRE/JDK.
</p>

<p>
Wszystkie wskazane pliki należy umieścić w katalogu
<path>/usr/portage/distfiles</path>. Dopiero potem można ponownie uruchomić
polecenie emerge, aby dane JRE/JDK zostały poprawnie zainstalowane.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Konfiguracja JRE/JDK</title>
<section>
<title>Przegląd</title>
<body>

<p>
Gentoo posiada możliwość bezkonfliktowego zainstalowania wielu JDK oraz JRE
równocześnie.
</p>

<p>
Używając z konta roota narzędzia <c>java-config</c>, można ustawić domyślne
środowisko dla całego systemu. Użytkownicy mogą użyć <c>java-config</c>, aby
ustawić własne domyślne środowisko, które może być inne niż to określone w
systemie.
</p>

<note>
Środowisko dla systemu oraz maszynę wirtualną możemy zmienić również używajac
narzędzia <e>eselect</e>. Polecenie <c>eselect java-vm help</c> wyświetli
więcej informacji na ten temat.
</note>

</body>
</section>
<section>
<title>Ustawianie domyślnego środowiska JRE/JDK</title>
<body>

<p>
Uruchamiając polecenie <c>java-config --list-available-vms</c>, wyświetlona
zostanie lista dostępnych JRE oraz JDK na danym systemie. Poniżej przedstawiamy
przykład takiej listy:
</p>

<pre caption="Wyświetlanie dostępnych maszyn wirtualnych">
# <i>java-config --list-available-vms</i>
1) Blackdown JDK 1.3.1 [blackdown-jdk-1.3] (/etc/env.d/java/20blackdown-jdk-1.3)
2) Blackdown JDK 1.4.2.02 [blackdown-jdk-1.4] (/etc/env.d/java/20blackdown-jdk-1.4)
3) Blackdown JRE 1.4.2.02 [blackdown-jre-1.4] (/etc/env.d/java/20blackdown-jre-1.4)
4) IBM JDK 1.4.2 [ibm-jdk-bin-1.4] (/etc/env.d/java/20ibm-jdk-bin-1.4)
5) IBM JRE 1.4.2 [ibm-jre-bin-1.4] (/etc/env.d/java/20ibm-jre-bin-1.4)
6) WebLogic JRockit 1.4.2.05 [jrockit-jdk-bin-1.4] (/etc/env.d/java/20jrockit-jdk-bin-1.4)
7) WebLogic JRockit 1.5.0.03 [jrockit-jdk-bin-1.5] (/etc/env.d/java/20jrockit-jdk-bin-1.5)
8) Sun JDK 1.3.1.13 [sun-jdk-1.3] (/etc/env.d/java/20sun-jdk-1.3)
9) Sun JDK 1.4.2.09 [sun-jdk-1.4] (/etc/env.d/java/20sun-jdk-1.4)
*) Sun JDK 1.5.0.04 [sun-jdk-1.5] (/etc/env.d/java/20sun-jdk-1.5)
11) Sun JRE 1.4.2.09 [sun-jre-bin-1.4] (/etc/env.d/java/20sun-jre-bin-1.4)
12) Sun JRE 1.5.0.04 [sun-jre-bin-1.5] (/etc/env.d/java/20sun-jre-bin-1.5)
</pre>

<p>
Znak <e>*</e> (gwiazdka) informuje nas o aktualnie aktywnej maszynie wirtualnej
(systemowej lub wybranej przez użytkownika, jeżeli taka jest). Nazwy w
nawiasach (<path>"[]"</path>) to wskaźnik lub identyfikator dla konkretnej
maszyny wirtualnej. Przekazując tę wartość (lub numer) do <c>java-config
--set-system-vm</c> ustawia się wskazaną maszynę wirtualną jako domyślną.
Poniżej znajduje się przykład takiej czynności:
</p>

<pre caption="Ustawianie domyślnej maszyny wirtualnej dla systemu">
<comment>(Poprzez wartość z nawiasów (zalecane))</comment>
# <i>java-config --set-system-vm blackdown-jdk-1.4</i>
<comment>(Poprzez numer maszyny)</comment>
# <i>java-config --set-system-vm 2</i>
</pre>

<p>
Jako zwykły użytkownik możemy użyć <c>java-config --set-user-vm</c>
</p>

<note>
Nie musimy wykonywać <c>source</c> profilu w celu aktualizacji maszyny
wirtualnej systemowej lub użytkownika.
</note>

</body>
</section>
<section id="preferred-vm">
<title>Preferowana maszyna wirtualna</title>
<body>

<p>
Podczas instalowania pakietów Javy, wirtualna maszyna może być - i będzie
zmieniona - w razie potrzeby.
</p>

<p>
Ponieważ istnieje dużo różnych wirtualnych maszyn Javy, nie jesteśmy w stanie
przetestować działania każdego pakietu na każdej z nich. Aby się upewnić, że
każdy z nich został zainstalowany poprawnie, wybraliśmy listę
<e>domyślnych/wspieranych maszyn wirtualnych</e> dla każdej architektury.
Możemy znaleźć je w
<path>/usr/share/java-config/config-jdk-defaults.conf</path>. Kiedy instalujemy
pakiety w Javie, a w systemie zostanie wykryta chociaż jedna maszyna zgodna z
tym plikiem, zostanie ona automatycznie użyta zamiast maszyny systemowej.
</p>

<p>
Zmiana maszyny wirtualnej podczas instalacji jest potrzebna również w przypadku,
gdy maszyna systemowa ma wersję 1.4 natomiast instalowany pakiet wymaga wersji
1.5. Podczas instalacji zostanie ona zmieniona na 1.5, pozostawiając maszynę
systemową nietkniętą.
</p>

<p>
Oczywiście, w Gentoo wszystko zależy od nas, więc możemy ominąć te domyślne
ustawienia w <path>/etc/java-config-2/build/jdk.conf</path> i mieć pełną
kontrolę nad tym jaka maszyna wirtualna jest używana w naszym systemie.
Kilka przykładów:
</p>

<pre caption="Przykład /etc/java-config-2/build/jdk.conf">
<comment>(Zawsze będzie korzystać z sun-jdk, np. sun-jdk-1.4 for 1.4, sun-jdk-1.5 for 1.5, etc)</comment>
*=sun-jdk
</pre>

<pre caption="Przykład /etc/java-config-2/build/jdk.conf">
<comment>(Będzie korzystać sun-jdk-1.5 kiedy tylko jest to możliwe, poza przypadkami gdzie użycie 1.3 lub 1.4 jest konieczne)</comment>
*=sun-jdk-1.5
</pre>

<pre caption="Przykład /etc/java-config-2/build/jdk.conf">
<comment># Dla 1.3 preferujemy sun-jdk 1.4, a gdy niedostępne ibm-jdk-bin,
# Dla 1.4 użyjemy blackdown-jdk, a dla 1.5 sun-jdk</comment>
1.3=sun-jdk-1.4 ibm-jdk-bin
1.4=blackdown-jdk
1.5=sun-jdk
</pre>

<warn>
Nie musimy edytować tego pliku. Jeżeli chcemy zmienić te opcje w celu użycia
nie wspieranej maszyny wirtualnej, prawdopodobnie zakończy się to błędem.
Zgłoszone błędy z użyciem niewspieranych maszyn wirtualnych będą miały niższy
priorytet niż te ze wspieranymi.
</warn>

</body>
</section>
</chapter>

<chapter>
<title>Kompilatory</title>
<section>
<body>

<p>
Standardowym kompilatorem Java używanym do budowania jest javac, który wchodzi w
skład każdego JDK. Podobnie jak wybieraliśmy maszynę wirtualną, możemy również
wybrać, którego kompilatora chcemy użyć. W pliku
<path>/etc/java-config-2/build/compilers.conf</path> zdefiniujemy listę
ustawień, w których zdecydujemy jakiego kompilatora chcemy użyć.
</p>

<pre caption="/etc/java-config-2/build/compilers.conf">
# If the ebuild supports it
# it will chceck the COMPILERS var front to back and
# use the first compiler that is installed

COMPILERS="ecj-3.1 jikes javac"
</pre>

<p>
Niektóre kompilatory nie wspierają wszystkich argumentów -target i -source.
Dlatego każdy kompilator z powyższej listy jest sprawdzany pod kątem wspierania
danego -source/-target. javac będzie działać we wszystkich przypadkach, więc
jeżeli żaden kompilator z listy nie będzie spełniał wymagań, zostanie użyty
javac.
</p>

<p>
Więcej informacji n/t kompilatorów znajdziemy poniżej:
</p>

<table>
 <tr>
   <th>Nazwa</th>
   <th>Identyfikator</th>
   <th>Pakiet</th>
   <th>Opis</th>
 </tr>
 <tr>
   <ti>javac</ti>
   <ti>javac</ti>
   <ti>N/A</ti>
   <ti>
     Jest to domyślny kompilator, wchodzący w skład wszystkich JDK.
   </ti>
 </tr>
 <tr>
   <ti>jikes</ti>
   <ti>jikes</ti>
   <ti>dev-java/jikes</ti>
   <ti>
    Jikes był początkowo tworzony przez IBM. Najśmieszniejsze jest to, że
    jest on ogólnie szybszy od javac. Należy jednak zauważyć, że jest on
    bardziej pedantyczny i będzie wyświetlał błędy w przypadkach, w których
    javac nie ma problemów. Dodatkowo, jikes nie wspiera Javy w wersji 1.5
  </ti>
 </tr>
 <tr>
   <ti>Eclipse Compiler dla Java</ti>
   <ti>ecj-3.1</ti>
   <ti>=dev-java/eclipse-ecj-3.1*</ti>
   <ti>
     ECJ jest kompilatorem używanym przez środowisko Eclipse. Zawiera on bardzo
     dużo udogodnień i jest w miarę szybki. Wspiera składnię Java 1.5
   </ti>
 </tr>
</table>

</body>
</section>
</chapter>

<chapter>
<title>Ustawianie domyślnej CLASSPATH</title>
<section>
<body>

<warn>
Opcje objaśnione w tym akapicie, nie powinny zostać stosowane pochopnie i być
może zostaną usunięte w przyszłości. Nie polecamy ich używania, chociażby ze
względu na to, że nasze projekty lub aplikacje w Java mogą dosokonale zarządzać
swoimi zmiennymi CLASSPATH. Jeżeli zdecydujemy się na ustawienie domyślnej
wartości CLASSPATH, niektóre aplikacje mogą zachowywać się w nieprzewidziany
sposób, ponieważ natrafią na znajdujące się w CLASSPATH nieznane klasy.
</warn>

<p>
<c>java-config</c> możemy użyć zarówno do ustawienia systemowej CLASSPATH, jak i
oddzielnej dla każdego użytkownika
</p>

<p>
Po pierwsze powinniśmy wylistować dostępne biblioteki Java zainstalowane w
naszym systemie, które możemy włożyć do CLASSPATH. Poniżej znajduje się
przykładowe wyjście programu:
</p>

<pre caption="Lista klas">
# <i>java-config --list-available-packages</i>
[xerces-2] The next generation of high performance, fully compliant XML parsers in the Apache Xerces family (/usr/share/xerces-2/package.env)
[junit] Simple framework to write repeatable tests (/usr/share/junit/package.env)
[bsh] BeanShell: A small embeddable Java source interpreter (/usr/share/bsh/package.env)
[bcel] The Byte Code Engineering Library: analyze, create, manipulate Java class files (/usr/share/bcel/package.env)
[log4j] A low-overhead robust logging package for Java (/usr/share/log4j/package.env)
...
</pre>

<p>
Znów, nazwy w nawiasach (<e>[]</e>) są identyfikatorem, który musimy wpisać w
<c>java-config --set-system-classpath</c> tak jak pokazano poniżej:
</p>

<pre caption="Ustawianie ścieżek dla klas">
# <i>java-config --set-system-classpath log4j,xerces-2</i>
</pre>

<note>
Obecny katalog (<path>.</path>) nie będzie należał do systemowego classpath,
katalog ten powinien zostać dodany przez systemowy profil logowania.
</note>

<p>
Teraz powinniśmy zauktualizować nasze środowisko, poprzez przelogowanie lub
wykonanie polecenia <e>source /etc/profile</e>.
</p>

<p>
Jeśli chodzi o użytkowników, <c>java-config --set-user-classpath</c> stworzy
<path>~/.gentoo/java-env-classpath</path>, który powinien być teraz wczytywany
przez plik konfiguracyjny powłoki.
</p>

<pre caption="Wczytywanie własnych classpath">
<i>if [[ -f "${HOME}/.gentoo/java-env-classpath" ]]; then
       source ${HOME}/.gentoo/java-env-classpath
   fi</i>
</pre>

<p>
Jeżeli bardzo chcemy zmienić systemową, lub domyślną dla użytkownika classpath,
możemy dodać coś takiego do pliku konfiguracyjnego powłoki (jednak dalej nie
polecamy tego rozwiązania):
</p>

<pre caption="Ustawianie classpath">
# <i>export CLASSPATH="${CLASSPATH}:$(java-config --classpath log4j,xerces-2)"</i>
</pre>


</body>
</section>
</chapter>

<chapter>
<title>Flagi USE których można użyć z Javą</title>
<section>
<title>Ustawianie flag USE</title>
<body>

<p>
Aby uzyskać więcej informacji dotyczących flag USE, należy odwołać sie do
rozdziału opisującego <uri
link="/doc/pl/handbook/handbook-x86.xml?part=2&amp;chap=2">flagi USE</uri> w
Podręczniku Gentoo.
</p>

</body>
</section>
<section>
<title>Flagi</title>
<body>

<ul>
  <li>Flaga <b>java</b> dodaje obsługę dla Javy w wielu programach</li>
  <li>
    Flaga <b>nsplugin</b> dodaje obsługę java dla przeglądarek z rodziny
    Mozilli (włączając w to Firefox). Flaga ta jest niezbędna gdy zechcemy
    przeglądać aplikacje java w przeglądarce z tej rodziny.
  </li>
  <li>
    Flaga <b>doc</b> po prostu zainstaluje dokumentację dla API, wygenerowaną
    przez javadoc.
  </li>
  <li>
    Flaga <b>source</b> zainstaluje spakowane wersje kodów źródłowych pakietów.
    Jest to najczęściej używane w celu dostarczenia IDE razem z kodem źródłowym
    pakietu.
  </li>
</ul>

</body>
</section>
</chapter>

<chapter>
<title>Dodatkowe zasoby</title>
<section>
<title>Zasoby poza siecią</title>
<body>

<ul>
  <li>Strona man java-config</li>
  <li><c>java-config --help</c></li>
</ul>

</body>
</section>
<section>
<title>Zasoby w sieci</title>
<body>

<ul>
  <li>
    Strona <uri link="http://www.gentoo.org/proj/en/java/">Gentoo Java
    Project</uri>
  </li>
  <li>
    Archiwa list <uri
    link="http://news.gmane.org/gmane.linux.gentoo.java">gentoo-java</uri>,
    <uri link="http://news.gmane.org/gmane.linux.gentoo.devel">gentoo-dev</uri>
    i <uri
    link="http://news.gmane.org/gmane.linux.gentoo.user">gentoo-user</uri>
  </li>
  <li>Kanały #gentoo oraz #gentoo-java w sieci irc.freenode.net</li>
  <li>
    <uri link="http://en.wikipedia.org/wiki/Java_programming_language">Strona
    Wikipedii o Java</uri>
  </li>
</ul>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/pl/printing-howto.xml,v 1.1 2004/11/25 14:20:45 neysx Exp $ -->

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/doc/pl/printing-howto.xml" lang="pl"> 

<title>Przewodnik po drukowaniu w Gentoo</title> 

<author title="Autor"><!-- zhen@gentoo.org -->
  John P. Davis
</author>
<author title="Redaktor">
  <mail link="wleggette@gate.net">Wesley Leggette</mail>
</author>
<author title="Redaktor">
  <mail link="carl@gentoo.org">Carl Anderson</mail>
</author>
<author title="Redaktor">
  <mail link="lanius@gentoo.org">Heinrich Wendel</mail>
</author>
<author title="Redaktor">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Redaktor">
  <mail link="phil@thenexusproject.org">Phil Bordelon</mail>
</author>
<author title="Tłumacz">
  <mail link="rofrol@gmail.com">Roman Frołow</mail>
</author>

<abstract>
Pełny przewodnik pod drukowaniu w Gentoo Linux. Ten dokument opisuje zarówno
lokalne jak i sieciowe drukowanie.
</abstract> 

<license/>

<version>1.20</version>
<date>2004-10-25</date>

<chapter> 
<title>Instalowanie CUPS i foomatic</title> 
<section>
<body> 

<p>
Ustawianie drukowania w Gentoo Linux jest względnie bezbolesnym zadaniem dzięki
kilku wspaniałym programom takim jak CUPS (the Common Unix Printing System) i
foomatic. Obydwa programy są aktualnie w drzewie Portage i są bardzo łatwe do
ustawienia dla końcowego użytkownika.
</p> 


<p>
Bądź świadom, że cups jest międzydesktopowy, np. możesz kierować się tymi
wskazówkami, aby uzyskać drukowanie pod GNOME i KDE. Są inne sposoby, takie jak
ustawienie drukowania w KDE, ale wierzę, że CUPS jest najłatwiejszy do
ustawienia, i najbardziej skalowalny.
</p>

<p>
Przed emergowaniem CUPS, dobrze jest dodać kilka niezbędnych flag USE do
<path>/etc/make.conf</path>.
</p>


<pre caption="Edytowanie /etc/make.conf">
<comment>dodaj cups, foomaticdb, ppds i usb (jeśli używasz USB do
podłączenia drukarki) do swojej listy zmiennych USE. </comment>
USE="cups foomaticdb ppds usb other_var1 other_var2"
</pre>

<p>
Po więcej informacji o zmiennych USE, zobacz rozdział <uri
link="/doc/en/handbook/handbook-x86.xml?part=2&amp;chap=2">USE flags</uri> w
Podręczniku Gentoo.
</p>

<pre caption="Emergowanie niezbędnych pakietów">
# <i>emerge cups</i>
# <i>emerge foomatic </i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Ustawianie Modułów Jądra</title> 
<section>
<title>General</title>
<body>

<p>
Teraz, kiedy niezbędne pakiety są zainstalowane, nadszedł czas instalacji
drukarki.
</p>

<p>
W zależności jakiego typu podłączenia drukarki będziesz używał, niebędne będzie
włączenie portu równoległego lub portu USB.
</p>

<note>
To jest potrzebe tylko do drukowania lokalnego, jeśli chcesz drukować przez
sambę, omiń tą sekcję.
</note>

<note>
Jeśli nie jesteś pewien, jak skompilować jądro, szczegółowe instrukcje można
znaleźć w <uri link="http://www.tldp.org/HOWTO/Kernel-HOWTO.html">Kernel
Howto</uri> (obecnie niedostępne z powodu przeglądu). Upewnij się, że będziesz
wiedział jak skompilować i zainstalować nowe moduły bez przekompilowania jądra
i restartu komputera. To bardzo oszczędza czas.
</note>

</body>
</section>
<section>
<title>Moduły USB</title>
<body>

<p>
Aby włączyć wsparcie dla drukarki USB, przejdź do <c>USB support</c> i włącz
<c>Support for USB</c> oraz <c>USB Printer support</c>. Włączenie ich obu jako
moduły zainstaluje usbcore.o i printer.o w katalogu modułów. Sugeruję użycie
modułów, ponieważ nie będziesz musiał restartować komputera. Użytkownicy jądra
2.6 znajdą te opcje pod <c>Device Drivers</c>.
</p>

<p>
Po zbudowaniu jądra i restarcie komputera, nadszedł czas na załadowanie
niebędnych modułów:
</p>

<pre caption="Ładowania modułów USB">
# <i>modprobe usbcore</i> 

<comment>(For 2.4 kernel users:)</comment>
# <i>modprobe printer</i>
<comment>(For 2.6 kernel users:)</comment>
# <i>modprobe usblp</i>
</pre> 

<p>
Po pomyślnym załadowaniu modułów, podłącz drukarkę i sprawdź <c>dmesg</c>, aby
zobaczyć, czy została wykryta.
</p> 

<pre caption="Sprawdzanie Komunikatów Jądra">
# <i>dmesg | tail</i>
</pre> 

<p>
Powinieneś zobaczyć coś takiego:
</p>

<pre caption="Dane wyjściowe dmesg">
hub.c: USB new device connect on bus2/2, assigned device number 2 
printer.c: usblp0: USB bidirectional printer dev 2 if 0 alt 1 proto 2 vid 0x03F0 pid 0x1104
</pre>

</body>
</section> 
<section>
<title>Moduły Portu Równoległego</title>
<body>

<p>
Aby włączyć wsparcie dla portu równoległego, przejdź do <c>Parallel port
support</c> i włącz <c>Parallel port support</c> oraz <c>PC-style hardware</c>.
Zależnie od twojej drukarki musisz również aktywować <c>Multi-IO cards
(parallel and serial)</c>, <c>Support for foreign hardware</c> oraz <c>IEEE
1284 transfer mode</c>. Potem przejdź do <c>Character devices</c> i włącz
<c>Parallel Printer Support</c>. Użytkownicy jąder 2.6 znajdą te opcje pod
<c>Device Drivers</c>.
</p>

<p>
Po zbudowaniu jądra, upewnij się, że drukarka jest podłączona i wtedy
zrestartuj komputer. Teraz nadszedł czas, aby załadować niezbędne moduły:
</p>

<pre caption="Ładowanie modułów Portu Równoległego">
# <i>modprobe lp</i> <comment>(Tylko dla użytkowników jądra 2.6)</comment>
# <i>modprobe parport</i> 
# <i>modprobe parport_pc</i>
</pre> 

<p>
Po pomyślnym załadowaniu modułów, sprawdź
<path>/var/log/messages</path>, aby zobaczyć czy drukarka została wykryta.
</p> 

<note>
Jeśli używasz czegoś innego niż sysklogd, plik zdarzeń jądra będzie inny.
</note>

<pre caption="Sprawdzanie Komunikatów Jądra">
# <i>tail /var/log/messages</i>
</pre> 

<p>
Powinieneś zobaczyć coś takiego:
</p>

<pre caption="Dane wyjściowe /var/log/messages">
lp0: using parport0 (polling).
</pre>

</body>
</section>
<section>
<title>Testowanie niskopoziomowe</title>
<body>

<p>
Przed ustawieniem drukarki do pracy z CUPS możemy przetestować ją kilkoma
prostymi niskopoziomowymi poleceniami.
</p>

<note>
Niektóre drukarki (szczególnie te <uri
link="http://pnm2ppa.sourceforge.net">oparte na PPA</uri> jak serie 720, 820 i
1000  firmy HP) nie akceptują podawania ASCII. Jeśli posiadasz taką, pamiętaj,
że ten test się nie powiedzie, nawet jeśli drukarka działa.
</note> 

<note>
Niektóre drukarki (np. kilka HP LaserJets) potrzebują ^L (Control-L) na końcu
pliku, aby zacząć drukowanie. Bez ^L polecenie cat się uda, ale drukarka
pochłonie dane, potem zastopuje i nic nie będzie robiła.
</note>

<pre caption="Testowanie Drukarki Używając cat">
# <i>touch test.txt</i>
# <i>echo "Hello World" > test.txt</i>
# <i>cat test.txt > /dev/usb/lp0 </i>

<comment> Zastępczo, dla drukarek na porcie równoległym: </comment>
# <i>cat test.txt > /dev/lp0 </i>
</pre>

</body>
</section>
</chapter>			

<chapter>
<title>Specjalne Sterowniki Drukarek</title> 
<section>
<body> 

<p>
Zanim użyjesz foomatic, aby wygenerować plik PPD, niezbędne może się okazać
zlokalizowanie sterowników strony trzeciej dla twojej drukaki. Na przykład,
Epson udostępnia <uri
link="http://www.epkowa.co.jp/english/linux_e/linux.html">kilka sterowników
drukarek</uri> dla systemów operacyjnych open source. Jakkolwiek wiele tych
specjalnych sterowników nie ma otwartych źródeł, tak jak te od Epsona.
</p>

<p>
The following printing drivers are available as ebuilds in Portage: gimp-print,
omni, hpijs, pnm2ppa.
</p>

<p>
Dla większości drukarek oprócz tych HP Inkjet, będziesz mógł użyć standardowych
sterowników drukarek Linuksa. Odwiedź <uri
link="http://www.linuxprinting.org/printer_list.cgi">bazę danych wsparcia dla
drukarek linuxprinting.org</uri>, aby znaleźć informację o konkretnej drukarce.
Nie zapomnij przeczytać dokumentację udostępnianą z każdym sterownikiem, który
pobierzesz do instalacji oraz informację licencyjną.
</p>

<p>
Jeśli używasz drukarki HP Inkjet, niezbędne bedzie emergowanie sterownika
drukarki <c>hpijs</c>. Ten sterownik obsługuje wszystkie wersje Postscriptu
niezbędne, aby drukarka HP działała. Sterownik <c>hpijs</c> jest tylko dla
drukarek HP Inkjet, ale jest dostępny przez Portage dla twojej wygody.
Dokumentacja od HP dla sterownika <c>hpijs</c> będzie umieszczona w
<path>/usr/share/doc/hpijs-&lt;wersja&gt;</path>. Autor <e>bardzo</e> zaleca
przeczytanie jej.
</p>

<p>
Jeśli używasz drukarki opartej na PPA, niezbędne jest emergowanie sterownika
drukarki <c>pnm2ppa</c>.
</p>

<pre caption="Emergowanie hpijs">
# <i>emerge hpijs</i>
</pre>

<note>
Jeśli używasz HP Laserjet, wsparcie może już być dostępne przez system wydruku
GNOME. Jeśli nie używasz drukarki HP Inkjet, nie musisz instalować tego
specyficznego sterownika drukarki.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Konfiguracja Pliku PPD</title>
<section>
<body>

<p>
Nadszedł czas skonfigurowania drukarki i CUPS. Aby twoja drukarka właściwie
rozumiała Postscript, CUPS potrzebuje plik PPD (Printer Postscript Definition -
Definicja Postscriptu Drukarki). Najłatwiejszy sposób wygenerowania PPD to
użycie foomatic.
</p>

<note>
Inny sposób to ściągnięcie pliku PPD z <uri
link="http://www.linuxprinting.org">LinuxPrinting.org</uri> i umieszczenie go w
<path>/usr/share/cups/model</path>. Jeśli wybierzesz tę metodę, możesz ominąć
resztę tej sekcji i kontynuować na <uri link="#doc_chap5">Konfiguracji
CUPS</uri>.
</note>

<p>
Trzy informacje są niezbędne, aby poniższe polecenia zadziałały; potrzebujesz
numer identyfikacyjny drukarki, urządzenie drukujące i sterownik do twojej
drukarki (to byłby hpijs, jeśli potrzebowałeś zainstalować specyficzny
sterownik powyżej). Numer identyfikacyjny drukarki i sterownik może być
<c>zgrepowany</c> z bazy danych programu foomatic, a urządzenie drukujące to
węzeł urządzenia, do którego twoja drukarka jest podłączona (np.
<path>file:/dev/lp0</path>, <path>file:/dev/usb/lp0</path> lub dla drukarek
samba <path>smb://user:password@server/share</path>).
</p>

<p>
Przed użyciem <c>foomatic-configure</c>, pamiętaj, aby uruchomić <c>cupsd</c>.
</p>

<pre caption="Uruchomienie cupsd">
# <i>/etc/init.d/cupsd start</i>
</pre>

<pre caption="Ogólne Użycie foomatic">
<comment>(Wstaw model drukarki w $printer_model, a numer identyfikacyjny drukarki w $printer_ID)</comment>
<comment>(Użyj dwóch pierwszych danych wyjściowych z grepa, aby wstawić w ostatnim poleceniu foomatic-configure)</comment>
# <i>grep $printer_model /usr/share/foomatic/db/source/printer/* </i>
# <i>grep $printer_ID /usr/share/foomatic/db/source/driver/* </i>
# <i>foomatic-configure -s cups -p $printer_model_number -c file:$print_device_path -n queue name -d driver </i>
</pre>

<p>
Jeśli grepowanie sterownika nie działa, możesz znaleźć swoją drukarkę na <uri
link="http://www.linuxprinting.org">LinuxPrinting.org</uri> i sprawdzić, z
którym sterownikiem wiadomo że działa. Wtedy pobierz jeden z tych sterowników i
zainstaluj:
</p>

<pre caption="Instalowanie sterownika PPD">
<comment>(Jeśli masz więcej niż jedną drukarkę, użyj odzielnych jednoliniowych nazw.
Możesz także użyć łatwą-do-zapamiętania jednoliniową nazwę, taką jak "default")</comment>
# <i>foomatic-configure -s cups -p &lt;printer model&gt; -c file:&lt;printer device&gt; -n &lt;queue name&gt; -d &lt;driver&gt;</i>
</pre>

<p>
Teraz bardziej specyficzny przykład. Następujący kod zakłada, że masz Epson
Stylus Color 980. Oczywiście powinieneś to zmienić na model twojej obecnej
drukarki.
</p>

<pre caption="Specyficzne użycie foomatic z Stylus Color 980">
# <i>grep "Stylus Color 980" /usr/share/foomatic/db/source/printer/* </i>
<comment> Teraz spojrzyj na linię, która wygląda tak: </comment>
/usr/share/foomatic/db/source/printer/Epson-Stylus_Color_980.xml:   &lt;model&gt;Stylus Color 980&lt;/model&gt;
<comment> Epson-Stylus_Color_980 jest numerem identyfikacyjnym twojej drukarki. </comment>

# <i>grep Epson-Stylus_Color_980 /usr/share/foomatic/db/source/driver/* </i>
/usr/share/foomatic/db/source/driver/gimp-print-ijs.xml:  &lt;printer&gt;&lt;id&gt;printer/Epson-Stylus_Color_980&lt;/id&gt;&lt;/printer&gt;
<comment> Tutaj sterownikiem twojej drukarki jest gimp-print-ijs.</comment>

# <i>foomatic-configure -s cups -p Epson-Stylus_Color_980 -c file:/dev/lp0 -n Epson -d gimp-print-ijs </i>
</pre>

</body> 
</section>
</chapter> 

<chapter> 
<title>Konfiguracja CUPS</title> 
<section>
<body> 

<p>
Kiedy sama drukarka jest już skonfigurowana, musimy ustawić CUPS, aby
obsługiwał kolejkowanie drukarki. Dostęp do CUPS możemy uzyskać przez
przeglądarkę internetową na porcie 631 serwera wydruku.
</p>

<p>
CUPS ma wbudowany plik konfiguracyjny dla demona, który powinien być zmieniony,
aby umożliwić przynajmniej nazewnictwo urządzeń typu URI. Otwórz
<path>/etc/cups/cupsd.conf</path> swoim ulubionym edytorem i ustaw
<c>FileDevice</c> na <c>Yes</c>:
</p>

<pre caption="Zmienianie FileDevice na Yes">
# <i>nano -w /etc/cups/cupsd.conf</i>
<comment>(Ustaw FileDevice na Yes)</comment>
</pre>

<p>
Ci, którzy chcą ustawić klientów używając nowego serwera wydruku, proszeni są o
zajrzenie do <path>/etc/cupsd/client.conf</path> na maszynie klienta i
ustawienie parametru <c>ServerName</c> na nazwę sieciową serwera wydruku.
</p>

<pre caption="Dodawanie CUPS do domyślnego poziomu startowego i restartowanie CUPS">
# <i>rc-update add cupsd default</i>
# <i>/etc/init.d/cupsd restart</i>
</pre>

<p>
Demon CUPS powinien już działać, więc otwórz swoją ulubioną przeglądarkę, ustaw
adres na <uri>http://localhost:631</uri> i kliknij na <c>Manage Printer</c>.
Tutaj możesz znaleźć swoją nowo zainstalowaną drukarkę, skonfigurować ją lub
wydrukować stronę testową. Upewnij się, że ustawiłeś domyślny rozmiar strony na
rozmiar strony, który używasz (np. A4 zamiast listu).
</p> 

<note>
Jeśli drukarka nie działa z jakiegoś powodu, przejdź do katalogu, o którym
poinformowano Cię, że będą w nim zbierane dzienniki zdarzeń CUPS, i przejrzyj
<c>error_log</c>.
</note>

</body> 
</section>
</chapter>

<chapter>
<title>Konfigurowanie programów, aby używały CUPS do druku</title>
<section>
<title>General</title>
<body>

<p>
Większość programów posiada dzisiaj rdzenny interfejs cups, więc nie
potrzebujesz zmieniać czegokolwiek, po prostu spróbuj wydrukować w jakimś
programie.
</p>

</body>
</section>
<section>
<title>GIMP</title>
<body>

<p>
Aby móc drukować dokumenty używając Gimpa, musisz zainstalować/przeinstalować
pakiet <c>gimp</c> z włączoną flagą USE "gimpprint". To zainstaluje
<c>gimp-print</c>, jeśli jeszcze jest w systemie.
</p>

<pre caption="Emergowanie Gimpa z możliwościami druku">
<comment>(Upewnij się, że masz ustawione USE="gimpprint")</comment>
# <i>emerge gimp</i>
</pre>

<p>
Teraz otwórz Gimpa, otwórz jakiś obraz lub wybierz nowy, to na prawdę nie jest
ważne, ponieważ potrzebujemy tylko menu <c>Plik</c>. Kliknij prawym przyciskiem
na obrazie i przejdź do <c>Plik/Drukuj</c>. Powinno się pojawić okno dialogowe
wydruku, wtedy kliknij na nowa drukarka. Jeśli twoja drukarka nie jest na
liście, wpisz nazwę swojej drukarki, potem wybierz typ drukarki. Dobrze, masz
wszystko ustawione, aby drukować z Gimpa. Pobaw się ustawieniami i ciesz się.
</p>

</body>
</section>
</chapter>

<chapter>
<title>Używanie Linuksa jako Kompatybilnego z Windowsem Serwera Wydruku</title>
<section>
<body>

<p>
Linux może być wspaniałym serwerem wydruku, a nawet wspaniałym serwerem do
wszystkiego. Najpierw wyedytujmy <path>/etc/samba/smb.conf</path>, aby
dopasować Twoje ustawienia. Plik <path>smb.conf</path> zawiera wszystkie
ustawienia, które sprawią, że twoje pudełko z Linuksem będzie wyglądało jak
serwer Windows NT dla każdej maszyny z Windowsem. Załączyłem poniżej bardzo
użyteczny przykład <path>smb.conf</path>. Zmień go, aby dopasować do twojego
środowiska sieciowego.
</p>

<pre caption="Próbka smb.conf">
[global]

workgroup = YOUR_WORKGROUP
server string = Gentoo Linux Server
encrypt passwords = True
security = user
smb passwd file = /etc/samba/private/smbpasswd
log file = /var/log/samba/log.%m
socket options = IPTOS_LOWDELAY TCP_NODELAY
domain master = Yes
local master = Yes
preferred master = Yes
os level = 65
dns proxy = No
name resolve order = lmhosts host bcast
bind interfaces only = True
interfaces = eth0
hosts deny = ALL
hosts allow = 192.168.1.4 127.0.0.1 (list of allow hosts here) 
debug level = 1
create mask = 0644
directory mask = 0755
level2 oplocks = True
read raw = no
write cache size = 262144

[printers]
comment = All Printer
path = /var/spool/samba
browseable = no
</pre>

<p>
Większość sterowników windowsowych to sterowniki PCL. Zadania przesłane z
Windowsa powinny być interpretowane przez CUPS jako
<c>application/octet-stream</c> i wydrukowane jako surowy plik. Jeśli więc
używasz CUPS, otwórz <path>/etc/cups/mime.types</path> i odkomentuj następującą
linię:
</p>

<pre caption="Odkomentuj linię w /etc/cups/mime.types">
application/octet-stream
</pre>

<p>
Zrób to samo dla następującej linii w <path>/etc/cups/mime.convs</path>:
</p>

<pre caption="Odkomentuj linię w /etc/cups/mime.convs">
application/octet-stream application/vnd.cups-raw   0 -
</pre>

<p>
Teraz SAMBA jest skonfigurowana, zrestartuj ją, przejdź do swojej maszyny z
Windowsem i zainstaluj drukarkę sieciową. Bułka z masłem, czyż nie?
</p>

</body>
</section>
</chapter>
</guide>

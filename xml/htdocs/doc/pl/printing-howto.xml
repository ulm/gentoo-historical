<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<!-- Orig revision: 1.48 -->
<!-- Translator: rofro <rofro@none.none> -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/doc/pl/printing-howto.xml,v 1.3 2005/06/26 15:35:00 neysx Exp $ -->

<guide link="/doc/pl/printing-howto.xml" lang="pl"> 

<title>Przewodnik drukowania w Gentoo</title> 

<author title="Autor"><!-- zhen@gentoo.org -->
  John P. Davis
</author>
<author title="Redaktor">
  <mail link="wleggette@gate.net">Wesley Leggette</mail>
</author>
<author title="Redaktor">
  <mail link="carl@gentoo.org">Carl Anderson</mail>
</author>
<author title="Redaktor">
  <mail link="lanius@gentoo.org">Heinrich Wendel</mail>
</author>
<author title="Redaktor">
  <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>
<author title="Redaktor">
  <mail link="phil@thenexusproject.org">Phil Bordelon</mail>
</author>
<author title="Tłumacz">
  Roman Frołow
</author>

<abstract>
Pełny przewodnik po drukowaniu w Gentoo Linux. Dokument ten opisuje zarówno
drukowanie na drukarce lokalnej jak i sieciowej.
</abstract> 

<license/>

<version>1.23</version>
<date>2005-05-23</date>

<chapter> 
<title>Instalacja CUPS i foomatic.</title> 
<section>
<body> 

<p>
Ustawianie drukowania w Gentoo Linux jest zadaniem względnie bezproblemowym
dzięki wspaniałym programom: CUPS (the Common Unix Printing System) i
foomatic. Obydwa są aktualnie w drzewie Portage i są bardzo łatwe do
ustawienia dla przeciętnego użytkownika.
</p> 


<p>
Należy być świadomym, że cups jest niezależny od używanego systemu okienek.
Kierując się tymi wskazówkami można ustawić drukowanie zarówno w GNOME jak i
KDE. Istnieją również inne metody, jak np. drukowanie KDE, ale wierzymy, że
CUPS jest rozwiązaniem najłatwiejszym i najlepiej skalowalnym.
</p>

<p>
Przed emergowaniem CUPS, dobrze jest dodać kilka niezbędnych flag USE do
<path>/etc/make.conf</path>.
</p>


<pre caption="Edycja /etc/make.conf">
<comment>dodaj cups, foomaticdb, ppds i usb (jeśli używasz drukarki USB) do
swojej listy zmiennych USE. </comment>
USE="cups foomaticdb ppds usb inna_zmienna1 inna_zmienna2"
</pre>

<p>
Więcej informacji o zmiennych USE można znaleźć w rozdziale <uri
link="/doc/pl/handbook/handbook-x86.xml?part=2&amp;chap=2">USE flags</uri>
Podręcznika Gentoo.
</p>

<pre caption="Emergowanie niezbędnych pakietów">
# <i>emerge cups</i>
# <i>emerge foomatic </i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Ustawianie modułów jądra.</title> 
<section>
<title>Ogólne.</title>
<body>

<p>
Aktualnie zostały już zainstalowane wszystkie niezbędne pakiety, zatem można
przystąpić do instalacji drukarki.
</p>

<p>
Niezbędne jest włączenie obsługi portu równoległego lub portu USB w jądrze,
w zależności od typu połączenia drukarki z komputerem, 
</p>

<note>
Informacje te odnoszą się tylko do drukowania na drukarce lokalnej. W
przypadku konfiguracji drukarki sieciowej (z wykorzystaniem samby) można tą
sekcję pominąć. 
</note>

<note>
Użytkownicy nie zaznajomieni z kompilacją jądra szczegółowe instrukcje mogą
znaleźć w <uri link="http://www.tldp.org/HOWTO/Kernel-HOWTO.html">Kernel
Howto</uri> (obecnie niedostępne z powodu przeglądu). Szczególnie wiedza o
kompilacji i instalacji nowych modułów bez rekompilacji całego jądra i
restartu komputera może bardzo oszczędzić czas.
</note>

</body>
</section>
<section>
<title>Moduły USB.</title>
<body>

<p>
Wsparcie dla drukarek USB włączane jest w sekcji <c>USB support</c>. Należy
włączyć <c>Support for USB</c> i <c>USB Printer support</c>. Uaktywnienie
tych opcji jako modułów spowoduje zainstalowanie usbcore.o i printer.o w
katalogu modułów. Sugerowane jest użycie modułów ponieważ nie będzie
konieczne ponowne uruchamianie komputera. Użytkownicy jądra serii 2.6 opcje
te odnajdą w sekcji <c>Device Drivers</c>.
</p>

<p>
Po zbudowaniu jądra i restarcie komputera, nadszedł czas na załadowanie
niezbędnych modułów:
</p>

<pre caption="Ładowania modułów USB">
# <i>modprobe usbcore</i> 

<comment>(Dla użytkowników jądra serii 2.4:)</comment>
# <i>modprobe printer</i>
<comment>(Dla użytkowników jądra serii  2.6:)</comment>
# <i>modprobe usblp</i>
</pre> 

<p>
Po pomyślnym załadowaniu modułów, należy podłączyć drukarkę. Następnie
komendą <c>dmesg</c> można sprawdzić czy została ona poprawnie wykryta.
</p> 

<pre caption="Sprawdzanie Komunikatów Jądra">
# <i>dmesg | tail</i>
</pre> 

<p>
Dane wyjściowe powinny być podobne do poniższych:
</p>

<pre caption="Dane wyjściowe dmesg">
hub.c: USB new device connect on bus2/2, assigned device number 2 
printer.c: usblp0: USB bidirectional printer dev 2 if 0 alt 1 proto 2 vid 0x03F0 pid 0x1104
</pre>

</body>
</section> 
<section>
<title>Moduły portu równoległego.</title>
<body>

<p>
Aby włączyć wsparcie dla portu równoległego, należy w <c>Parallel port
support</c> włączyć <c>Parallel port support</c> oraz <c>PC-style
hardware</c>. W zależności od drukarki należy aktywować <c>Multi-IO cards
(parallel and serial)</c>, <c>Support for foreign hardware</c> oraz
<c>IEEE 1284 transfer mode</c>. W sekcji <c>Character devices</c> należy
włączyć <c>Parallel Printer Support</c>. Użytkownicy jądra serii 2.6 opcje
te odnajdą w sekcji <c>Device Drivers</c>.
</p>

<p>
Po zbudowaniu jądra i upewnieniu się, że drukarka jest podłączona należy
uruchomić ponownie komputer. Kolejną czynnością jest załadowanie niezbędnych
modułów:
</p>

<pre caption="Ładowanie modułów portu równoległego">
# <i>modprobe lp</i> <comment>(Tylko dla użytkowników jądra serii 2.6)</comment>
# <i>modprobe parport</i> 
# <i>modprobe parport_pc</i>
</pre> 

<p>
Po pomyślnym załadowaniu modułów należy sprawdzić,
<path>/var/log/messages</path> czy drukarka została pomyślnie wykryta.
</p> 

<note>
Jeżeli używanym demonem logowania nie jest sysklogd plik zdarzeń może mieć
inną nazwę.
</note>

<pre caption="Sprawdzanie komunikatów jądra">
# <i>tail /var/log/messages</i>
</pre> 

<p>
Dane wyjściowe powinny być podobne do poniższych:
</p>

<pre caption="Dane wyjściowe /var/log/messages">
lp0: using parport0 (polling).
</pre>

</body>
</section>
<section>
<title>Testowanie niskopoziomowe.</title>
<body>

<p>
Przed ustawieniem drukarki w CUPS można ją przetestować za pomocą kilku
niskopoziomowych poleceń.
</p>

<note>
Niektóre drukarki (szczególnie te <uri
link="http://pnm2ppa.sourceforge.net">oparte na PPA</uri> jak serie 720,
820 i 1000  firmy HP) nie akceptują bezpośrednio ASCII. Jeżeli konfigurowana
jest właśnie taka drukarka należy pamiętać, że test ten się nie powiedzie,
nawet jeśli drukarka działa. 
</note> 

<note>
Niektóre drukarki (np. kilka HP LaserJets) potrzebują ^L (Control-L) na
końcu pliku, aby rozpocząć drukowanie. Bez ^L polecenie cat się powiedzie, 
ale drukarka po pobraniu danych nic nie będzie robić.
</note>

<pre caption="Testowanie drukarki używając cat">
# <i>touch test.txt</i>
# <i>echo "Witaj świecie!" > test.txt</i>
# <i>cat test.txt > /dev/usb/lp0 </i>

<comment> Dla drukarek na porcie równoległym: </comment>
# <i>cat test.txt > /dev/lp0 </i>
</pre>

</body>
</section>
</chapter>

<chapter>
<title>Specjalne sterowniki drukarek.</title> 
<section>
<body> 

<p>
Przed użyciem foomatic do wygenerowania pliku PPD, niezbędnym może się
okazać znalezienie sterowników dla drukarki.  Na przykład, Epson udostępnia
<uri link="http://www.epkowa.co.jp/english/linux_e/linux.html">kilka
sterowników drukarek</uri> dla systemów operacyjnych open source.
Jakkolwiek wiele tych specjalnych sterowników tak jak sterowniki Epsona nie
są open source.
</p>

<p>
Następujące sterowniki są dostępne jako ebuilds w Portage: gimp-print, omni,
hpijs, pnm2ppa.
</p>

<p>
Dla większości drukarek, poza HP Inkjet, można użyć standardowych
sterowników drukarek Linuksa. Na stronie <uri
link="http://www.linuxprinting.org/printer_list.cgi">linuxprinting.org</uri>
znajduje się baza danych wsparcia dla drukarek. Można tam znaleźć informacje
o konkretnej drukarce. Nie można zapomnieć o zapoznaniu się z dokumentacją
udostępnianą z każdym pobranym sterownikiem oraz z informacją licencyjną.
</p>

<p>
Jeżeli używaną drukarką jest HP Inkjet, niezbędne będzie emergowanie
sterownika drukarki <c>hpijs</c>. Sterownik ten obsługuje wszystkie wersje
Postscriptu niezbędne, aby drukarka HP działała. Sterownik <c>hpijs</c> jest
wyłącznie dla drukarek HP Inkjet. Jest dostępny w Portage dla wygody
użytkowników. Dokumentacja sterownika <c>hpijs</c> będzie umieszczona w
<path>/usr/share/doc/hpijs-&lt;wersja&gt;</path>. Autor <e>bardzo</e> zaleca
przeczytanie jej.
</p>

<p>
W przypadku używania drukarki opartej na PPA, niezbędne jest emergowanie
sterownika drukarki <c>pnm2ppa</c>.
</p>

<pre caption="Emergowanie hpijs">
# <i>emerge hpijs</i>
</pre>

<note>
Jeżeli używaną drukarką jest HP Laserjet, może być już dostępne wsparcie dla
niej poprzez system wydruku GNOME. W takim przypadku nie trzeba instalować
tego specyficznego sterownika.
</note>

</body>
</section>
</chapter>

<chapter>
<title>Konfiguracja pliku PPD.</title>
<section>
<body>

<p>
Nadszedł czas konfiguracji drukarki i CUPS. Aby drukarka właściwie rozumiała
Postscript, CUPS potrzebuje plik PPD (Printer Postscript Definition -
Definicja Postscriptu Drukarki). Najprostszy sposób wygenerowania PPD to
użycie foomatic.
</p>

<note>
Inny sposób to ściągnięcie pliku PPD z <uri
link="http://www.linuxprinting.org">LinuxPrinting.org</uri> i umieszczenie
go w <path>/usr/share/cups/model</path>. W przypadku wybrania tej metody
można ominąć tą sekcję i kontynuować w <uri link="#doc_chap5">Konfiguracji
CUPS</uri>.
</note>

<p>
Niezbędne są trzy informacje, aby  poniższe polecenia zadziałały; potrzebny
jest numer identyfikacyjny drukarki, urządzenie drukujące i sterownik do
drukarki (hpijs, jeśli zainstalowano specyficzny sterownik powyżej).  Numer
identyfikacyjny drukarki i sterownik może być <c>zgrepowany</c> z bazy
danych programu foomatic, a urządzenie drukujące to plik urządzenia, do
którego podłączona jest drukarka (np.  <path>file:/dev/lp0</path>,
<path>file:/dev/usb/lp0</path> lub dla drukarek samba
<path>smb://user:password@server/share</path>).
</p>

<p>
Przed użyciem <c>foomatic-configure</c>, należy uruchomić <c>cupsd</c>.
</p>

<pre caption="Uruchomienie cupsd">
# <i>/etc/init.d/cupsd start</i>
</pre>

<pre caption="Ogólne użycie foomatic">
<comment>(Za $printer_model należy podstawić model
drukarki, a za $printer_ID numer identyfikacyjny)</comment>
<comment>(Dwie pierwsze dane wyjściowe z grep, należy wstawić w ostatnim poleceniu foomatic-configure)</comment>
# <i>grep $printer_model /usr/share/foomatic/db/source/printer/* </i>
# <i>grep $printer_ID /usr/share/foomatic/db/source/driver/* </i>
# <i>foomatic-configure -s cups -p $printer_model_number -c file:$print_device_path -n queue name -d driver </i>
</pre>

<p>
Jeśli grepowanie sterownika nie działa, można znaleźć drukarkę na <uri
link="http://www.linuxprinting.org">LinuxPrinting.org</uri> i sprawdzić, z
którym sterownikiem wiadomo że działa. Należy wtedy pobrać jeden z tych
sterowników i zainstalować go:
</p>

<pre caption="Instalacja sterownika PPD">
<comment>(W przypadku posiadania więcej niż jedną drukarkę należy użyć dla
każdej z nich osobnych jedno liniowych nazw. Można również użyć łatwą do
zapamiętania nazwę typu "domyslna".) </comment>
# <i>foomatic-configure -s cups -p &lt;printer model&gt; -c file:&lt;printer device&gt; -n &lt;queue name&gt; -d &lt;driver&gt;</i>
</pre>

<p>
Teraz bardziej specyficzny przykład. Następujący kod zakłada, iż instalowaną
drukarką jest Epson Stylus Color 980. Oczywiście w należy to zmienić na
model instalowanej drukarki.
</p>

<pre caption="Użycie foomatic dla drukarki Stylus Color 980">
# <i>grep "Stylus Color 980" /usr/share/foomatic/db/source/printer/* </i>
<comment> Należy szukać linii wyglądającej jak poniższa:</comment>
/usr/share/foomatic/db/source/printer/Epson-Stylus_Color_980.xml:   &lt;model&gt;Stylus Color 980&lt;/model&gt;
<comment> Epson-Stylus_Color_980 jest numerem identyfikacyjnym drukarki. </comment>

# <i>grep Epson-Stylus_Color_980 /usr/share/foomatic/db/source/driver/* </i>
/usr/share/foomatic/db/source/driver/gimp-print-ijs.xml:  &lt;printer&gt;&lt;id&gt;printer/Epson-Stylus_Color_980&lt;/id&gt;&lt;/printer&gt;
<comment> W tym przypadku sterownikiem drukarki jest gimp-print-ijs.</comment>

# <i>foomatic-configure -s cups -p Epson-Stylus_Color_980 -c file:/dev/lp0 -n Epson -d gimp-print-ijs </i>
</pre>

</body> 
</section>
</chapter> 

<chapter> 
<title>Konfiguracja CUPS.</title> 
<section>
<body> 

<p>
Gdy drukarka została skonfigurowana, należy ustawić CUPS, aby obsługiwał
kolejkowanie wydruków. Dostęp do konfiguracji CUPS można uzyskać poprzez
przeglądarkę internetową na porcie 631 serwera wydruku.
</p>

<p>
CUPS ma wbudowany plik konfiguracyjny dla demona, który powinien być
zmieniony, aby umożliwić przynajmniej nazewnictwo urządzeń typu URI. Za
pomocą swojego ulubionego edytora należy edytować plik
<path>/etc/cups/cupsd.conf</path> i ustawić <c>FileDevice</c> na <c>Yes</c>:
</p>

<pre caption="Zmiana FileDevice na Yes">
# <i>nano -w /etc/cups/cupsd.conf</i>
<comment>(Ustawienie FileDevice na Yes)</comment>
</pre>

<p>
Następnie, jeżeli chce się ograniczyć dostęp do drukarki komputerom w sieci
(na przykład gdy system jest bezpośrednio połączony z internetem), należy
poszukać wpisu <c>Port 631</c> i zastąpić go wpisem <c>Listen
127.0.0.1:631</c>.
</p>

<p>
Użytkownicy chcący ustawić klientów nowego serwera wydruku, proszeni są o
zajrzenie do <path>/etc/cupsd/client.conf</path> na komputerze klienta i
ustawienie parametru <c>ServerName</c> na nazwę sieciową serwera wydruku.
</p>

<pre caption="Dodawanie CUPS do domyślnego poziomu startowego i restartowanie CUPS">
# <i>rc-update add cupsd default</i>
# <i>/etc/init.d/cupsd restart</i>
</pre>

<p>
Demon CUPS powinien już działać.  W ulubionej przeglądarce należy podać
adres <uri>http://localhost:631</uri> i kliknąć na <c>Manage Printer</c>.
Tutaj można znaleźć nowo zainstalowaną drukarkę, skonfigurować ją lub
wydrukować stronę testową.  Upewnij się, że domyślny rozmiar strony został
ustawiony na aktualnie używany (np. A4 zamiast letter).
</p> 

<note>
Jeżeli drukarka z jakiegoś powodu nie działa, należy przejść do katalogu o
którym informowano, że będą w nim zbierane dzienniki zdarzeń CUPS i przejrzeć
<c>error_log</c>.
</note>

</body> 
</section>
</chapter>

<chapter>
<title>Konfigurowanie programów, aby używały CUPS do druku.</title>
<section>
<title>Ogólne.</title>
<body>

<p>
Większość programów posiada dzisiaj rdzenny interfejs cups, więc nie trzeba
czegokolwiek zmieniać. Po prostu należy spróbować wydrukować coś w jakimś
programie.
</p>

</body>
</section>
<section>
<title>GIMP</title>
<body>

<p>
Aby móc drukować dokumenty używając Gimpa, należy
zainstalować/przeinstalować pakiet <c>gimp</c> z włączoną flagą USE
"gimpprint". Dzięki temu zostanie zainstalowany <c>gimp-print</c>, jeżeli
jeszcze nie ma go w systemie.
</p>

<pre caption="Emergowanie Gimpa z możliwościami druku">
<comment>(Należy upewnić się, że flaga USE="gimpprint" jest ustawiona.)</comment>
# <i>emerge gimp</i>
</pre>

<p>
Należy otworzyć Gimpa i otworzyć jakiś obraz lub wybrać nowy. Nie jest
istotne co dokładnie zostanie wybrane, ponieważ jedynie potrzebny jest
dostęp do menu <c>Plik</c>. Po kliknięciu prawym przyciskiem myszy na
obrazie należy przejść do menu <c>Plik/Drukuj</c>. Powinno pojawić się okno
dialogowe wydruku. Należy kliknąć na nową drukarkę. Jeżeli instalowana
drukarka nie znajduje się na liście należy ją wpisać i następnie wybrać typ
drukarki. Teraz powinno być wszystko ustawione, aby drukować z Gimpa. Można
popróbować różne ustawienia aby sprawdzić uzyskiwane efekty.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Konfiguracja systemu Windows do używania drukarki CUPS.</title>
<section>
<title>Instalacja wymaganego wsparcia.</title>
<body>

<p>
Aby Windows był w stanie używać CUPS należy zainstalować wsparcie dla IPP.
Windows 2000 i XP powinny mieć to wsparcie zainstalowane standardowo,
użytkownicy Windows 98 i ME muszą posłużyć się  <uri
link="http://support.microsoft.com/default.aspx?scid=kb;en-us;294439">tym
adresem</uri>.
</p>

</body>
</section>
<section>
<title>Instalacja drukarki CUPS.
</title>
<body>

<p>
Należy uruchomić kreatora <c>Dodaj nową drukarkę</c> i wybrać 
<c>Drukarkę sieciową</c>. Gdy będzie trzeba podać URL drukarki
należy podać dokładny URL tak jak był ustawiony wcześniej.
</p>

<pre caption="Przykładowy URL drukarki.">
<comment>(To jest tylko przykład.)</comment>
http://192.168.1.1:631/printers/Epson
</pre>

<p>
To wszystko!
</p>

</body>
</section>
</chapter>

<chapter>
<title>Używanie Linuksa jako serwera wydruku kompatybilnego z Windowsem.</title>
<section>
<body>

<p>
Linux może być wspaniałym serwerem wydruku, właściwie może być wspaniałym
serwerem do wszystkiego. Jeżeli chcemy, aby drukarka była widoczna jako
drukarka udostępniana w sieci Windows, należy edytować plik
<path>/etc/samba/smb.conf</path> aby dopasować ustawienia do własnych
potrzeb.  Plik <path>smb.conf</path> zawiera wszystkie informacje które
sprawią, że Linux będzie wyglądał jak serwer Windows NT dla każdego
komputera z Windowsem.  Poniżej został załączony przykładowy
<path>smb.conf</path>. W razie potrzeby należy edytować ten plik aby
dopasować go do środowiska sieciowego.
</p>

<pre caption="Przykładowy smb.conf">
[global]

workgroup = YOUR_WORKGROUP
server string = Gentoo Linux Server
encrypt passwords = True
security = user
smb passwd file = /etc/samba/private/smbpasswd
log file = /var/log/samba/log.%m
socket options = IPTOS_LOWDELAY TCP_NODELAY
domain master = Yes
local master = Yes
preferred master = Yes
os level = 65
dns proxy = No
name resolve order = lmhosts host bcast
bind interfaces only = True
interfaces = eth0
hosts deny = ALL
hosts allow = 192.168.1.4 127.0.0.1 (list of allow hosts here) 
debug level = 1
create mask = 0644
directory mask = 0755
level2 oplocks = True
read raw = no
write cache size = 262144

[printers]
comment = All Printer
path = /var/spool/samba
browseable = no
</pre>

<p>
Większość sterowników windowsowych to sterowniki PCL. Zadania przesłane z
Windowsa powinny być interpretowane przez CUPS jako
<c>application/octet-stream</c> i wydrukowane jako surowy plik. Jeżeli
używane jest CUPS należy otworzyć <path>/etc/cups/mime.types</path> i
odkomentować następującą linię:
</p>

<pre caption="Odkomentowanie linii w /etc/cups/mime.types">
application/octet-stream
</pre>

<p>
To samo należy powtórzyć dla pliku <path>/etc/cups/mime.convs</path>:
</p>

<pre caption="Odkomentowanie linii w /etc/cups/mime.convs">
application/octet-stream application/vnd.cups-raw   0 -
</pre>

<p>
Teraz SAMBA jest skonfigurowana. Należy ją zrestartować. Przejdź do
komputera z Windowsem i zainstaluj drukarkę sieciową. Proste, nieprawdaż?
</p>

</body>
</section>
</chapter>
</guide>

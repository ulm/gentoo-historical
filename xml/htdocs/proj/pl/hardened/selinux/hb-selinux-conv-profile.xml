<?xml version='1.0' encoding="utf-8"?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->
 
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/pl/hardened/selinux/hb-selinux-conv-profile.xml,v 1.3 2006/05/01 00:20:13 rane Exp $ -->

<sections>
<section>
<title>Zmiana profilu</title>
<subsection>
<body>

<warn>
Obsługa SELinux jest obecnie przewidziana jedynie dla serwerów. Obsługa stacji
roboczych zostanie wprowadzona w przyszłości.
</warn>

<warn>
SELinux obsługuje jedynie systemy plików ext2/3, XFS oraz JFS. Inne systemy
plików nie posiadają pełnego wsparcia dla potrzebnych rozszerzonych atrybutów. W
przyszłości powinno się to zmienić.
</warn>

<warn>
Użytkownicy AMD64 powinni konwertować system do selinux z profilu 2005.0
lub nowszego.
</warn>

<impo>
Jak zawsze, należy mieć przygotowane LiveCD, w razie gdyby coś poszło nie
tak jak powinno.
</impo>

<p>
Najpierw należy zmienić profil systemu na profil SELinux dla posiadanej
architektury:
</p>

<pre caption="Zmiana profilu na SELinux">
# <i>rm -f /etc/make.profile</i>

<comment>x86:</comment>
# <i>ln -sf /usr/portage/profiles/selinux/2005.1/x86 /etc/make.profile</i>
<comment>x86 Hardened (PIE-SSP):</comment>
# <i>ln -sf /usr/portage/profiles/selinux/2005.1/x86/hardened /etc/make.profile</i>
<comment>PPC:</comment>
# <i>ln -sf /usr/portage/profiles/selinux/2005.1/ppc /etc/make.profile</i>
<comment>SPARC:</comment>
# <i>ln -sf /usr/portage/profiles/selinux/2005.1/sparc64 /etc/make.profile</i>
<comment>AMD64:</comment>
# <i>ln -sf /usr/portage/profiles/selinux/2005.1/amd64 /etc/make.profile</i>
</pre>

<impo>
Profil SELinuksa posiada mniej flag USE niż domyślny profil. Polecenie <c>emerge
info</c> wskaże czy są jakieś flagi, które należy dołączyć do make.conf.
</impo>

<note>
Nie jest konieczne dodawanie flagi selinux do flag USE w make.conf. Profil
SELinux już tego dokonał.
</note>

<note>
Jeżeli pojawi się komunikat "!!! SELinux module not found. Please verify that
it was installed.", nie należy się przejmować. Jest to normalne i zostanie
naprawione później w trakcie procesu konwersji.
</note>

</body>
</subsection>
</section>

<section>
<title>Uaktualnienie nagłówków jądra</title>
<subsection>
<body>

<p>
Należy rozpocząć od uaktualnienia najważniejszych pakietów. Najpierw należy
sprawdzić wersję zainstalowanych nagłówków jądra (ang. linux-headers).
</p>

<pre caption="Sprawdzenie wersji linux-headers">
# <i>emerge -s linux-headers</i>
<comment>lub jeśli jest zainstalowany gentoolkit:</comment>
# <i>equery list -i linux-headers</i>
</pre>

<p>
Jeśli nagłówki jądra są starsze niż 2.4.20, konieczne jest zainstalowanie
nowszych.
</p>

<pre caption="Instalacja nowych nagłówków">
# <i>emerge \>=sys-kernel/linux-headers-2.4.20</i>
</pre>

</body>
</subsection>
</section>

<section>
<title>Uaktualnienie Glibc</title>
<subsection>
<body>

<p>
Po instalacji nowych nagłówków jądra (oraz gdy nie mamy pewności, czy wcześniej
były one przeinstalowywane), konieczne jest przekompilowanie glibc.
</p>

<pre caption="Rekompilowanie glibc">
# <i>emerge glibc</i>
</pre>

<impo>
Przekompilowanie glibc z nowymi nagłówkami jądra to bardzo ważna czynność. Jeśli
tego nie zrobimy, niektóre operacje będą źle wykonywane.
</impo>

</body>
</subsection>
</section>
</sections>

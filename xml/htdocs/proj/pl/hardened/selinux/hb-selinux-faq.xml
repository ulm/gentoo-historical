<?xml version='1.0' encoding="utf-8"?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/pl/hardened/selinux/hb-selinux-faq.xml,v 1.3 2006/04/07 21:31:43 shadoww Exp $ -->

<sections>
<section>
<title>Brakuje modułu SELinux podczas instalacji</title>
<subsection>
<title>"Otrzymuję ten błąd podczas instalacji:"</title>
<body>

<pre caption="Możliwy błąd podczas instalacji SELinux">
!!! SELinux module not found. Please verify that it was installed.
</pre>

<p>
Oznacza to że brakuje modułu SELinux w portage lub jest on uszkodzony. Również
python mógł być uaktualniony do nowej wersji, co oznacza, iż należy
przekompilować python-selinux. Przeinstalowanie dev-python/python-selinux
powinno pomóc. Również poszczególne pakiety mogły być zainstalowane bez
odpowiednich oznakowań, więc przydałoby się dokonać takiego oznakowania.
</p>

</body>
</subsection>
</section>

<section>
<title>Błąd podczas rejestrowania modułu w jądrze</title>
<subsection>
<title>"Mam ten błąd jądra podczas uruchamiania:"</title>
<body>

<pre caption="Możliwy błąd kernela w czasie startu systemu">
There is already a security framework initialized, register_security failed.
Failure registering capabilities with the kernel
selinux_register_security:  Registering secondary module capability
Capability LSM initialized
</pre>

<p>
Oznacza to że moduł Capability LSM nie może zostać zarejestrowany jako pierwszy
moduł, gdyż na tej pozycji jest już SELinux. Trzeci komunikat oznacza, że moduł
SELinux zostaje zarejestrowany jako drugi. Jest to normalne zachowanie.
</p>

</body>
</subsection>
</section>

<section>
<title>Zły kontekst plików podczas ich oznakowywania</title>
<subsection>
<title>"Podczas oznakowywania plików, dostaję błąd o nieprawidłowych
kontekstach."</title>
<body>

<pre caption="Przykładowy błąd nieprawidłowych kontekstów">
# make relabel
/usr/sbin/setfiles file_contexts/file_contexts `mount | awk '/(ext[23]| xfs).*rw/{print $3}'`
/usr/sbin/setfiles:  read 559 specifications
/usr/sbin/setfiles:  invalid context system_u:object_r:default_t on line number 39
/usr/sbin/setfiles:  invalid context system_u:object_r:urandom_device_t on line number 120
/usr/sbin/setfiles:  invalid context system_u:object_r:fonts_t on line number 377
/usr/sbin/setfiles:  invalid context system_u:object_r:fonts_t on line number 378
/usr/sbin/setfiles:  invalid context system_u:object_r:krb5_conf_t on line number 445
/usr/sbin/setfiles:  invalid context system_u:object_r:system_cron_spool_t on line number 478
/usr/sbin/setfiles:  invalid context system_u:object_r:system_cron_spool_t on line number 479
/usr/sbin/setfiles:  invalid context system_u:object_r:system_cron_spool_t on line number 492
/usr/sbin/setfiles:  invalid context system_u:object_r:system_cron_spool_t on line number 493
/usr/sbin/setfiles:  invalid context system_u:object_r:system_cron_spool_t on line number 494
Exiting after 10 errors.
make: *** [relabel] Error 1
</pre>

<p>
Na początku należy upewnić się, że odbyło się montowanie w
<c>/selinux</c>. Jeśli selinuxfs nie jest zamontowane, <c>setfiles</c> nie
potrafi sprawdzić kontekstów, co powoduje, iż uznaje, że wszystkie konteksty są
nieprawidłowe. Jeśli <c>/selinux</c> jest zamontowane, to najprawdopodobniej
istnieje nowa polityka, która jeszcze nie została zamontowana, co oznacza, że
obecne konteksty są postrzegane przez system jako nieprawidłowe.
</p>

</body>
</subsection>
</section>

</sections>

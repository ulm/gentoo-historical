<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/en/hardened/selinux/modules/Attic/ldap.xml,v 1.1 2011/07/16 20:36:41 zorry Exp $ -->

<guide link="/proj/en/hardened/selinux/modules/ldap.xml" lang="en">
<title>SELinux LDAP Module</title>
<author title="Author">
  <mail link="sven.vermeulen@siphos.be">Sven Vermeulen</mail>
</author>

<abstract>
Within SELinux, the ldap module is responsible for defining the openldap
domains and interactions.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>1</version>
<date>2011-07-09</date>

<chapter>
<title>Structure</title>
<section>
<title>Domains</title>
<body>

<figure link="./images/ldapdomain.png" short="General LDAP domain overview"
caption="General LDAP domain overview" />

<p>
The <c>slapd</c> daemon runs within the <c>slapd_t</c> domain and can only be
transitioned towards through the <c>sysadm_t</c> (general system administrative
domain) or <c>initrc_t</c> (init script launched) domains.
</p>

</body>
</section>
<section>
<title>File Types/Labels</title>
<body>

<p>
The following table lists the file type/labels defined in the <c>ldap</c>
module.
</p>

<table>
<tr>
  <th>Type</th>
  <th>Function</th>
  <th>Description</th>
</tr>
<tr>
  <ti>slapd_exec_t</ti>
  <ti>Entrypoint</ti>
  <ti>Executable entry point for the slapd daemon binaries</ti>
</tr>
<tr>
  <ti>slapd_etc_t</ti>
  <ti>Configuration</ti>
  <ti>Label for OpenLDAP configuration files</ti>
</tr>
<tr>
  <ti>slapd_cert_t</ti>
  <ti>Configuration</ti>
  <ti>Label for certificate keystores used by OpenLDAP</ti>
</tr>
<tr>
  <ti>slapd_db_t</ti>
  <ti>Configuration</ti>
  <ti>Label for the OpenLDAP database files (backend content)</ti>
</tr>
<tr>
  <ti>slapd_replog_t</ti>
  <ti>Configuration</ti>
  <ti>Label for the slurpd replication log location</ti>
</tr>
<tr>
  <ti>slapd_lock_t</ti>
  <ti></ti>
  <ti>Label for the lock files (runtime)</ti>
</tr>
<tr>
  <ti>slapd_tmp_t</ti>
  <ti></ti>
  <ti>Label for the temporary files</ti>
</tr>
<tr>
  <ti>slapd_var_run_t</ti>
  <ti></ti>
  <ti>Label for the runtime variable data</ti>
</tr>
<tr>
  <ti>slapd_initrc_exec_t</ti>
  <ti></ti>
  <ti>Label for non-Gentoo init script</ti>
</tr>
</table>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/proj/en/gdp/tipsntricks.xml">
<title>Documentation Development Tips &amp; Tricks</title>
<author title="Author">
    <mail link="swift@gentoo.org">Sven Vermeulen</mail>
</author>

<abstract>
Some tips &amp; tricks that make the life for a Gentoo Developer easier (or more
miserable :)
</abstract>

<version>0.4</version>

<date>February 8, 2004</date>

<license/>
<chapter>
<title>Setting up your local environment</title>
<section>
<title>Local environment for contributors</title>
<body>

<p>
Create a dedicated directory for the sole purpose of developing documentation.
As an example we take <path>~/work/gentoo/doc</path>. Inside this directory,
create a subdirectory in which you will keep the (up to date) English
documentation (for instance, <path>en/</path>).
</p>

<p>
Download the tarball with the most recent English documentation:
</p>

<pre caption="Downloading the English documentation">
# <i>wget http://www.gentoo.org/dyn/doc-snapshots/docs-latest-en.tar.bz2</i>
</pre>

<p>
Unpack the documentation in the <path>en/</path> directory. You now have an
up to date snapshot of the English documentation. Every time you want to update
your snapshot, you can download the tarball again, but you can also surf to the
document and add <path>?passthru=1</path> to the URL. For instance:
</p>

<pre caption="Updating an English document">
# <i>wget http://www.gentoo.org/doc/en/alsa-guide.xml?passthru=1 -O alsa-guide.xml</i>
</pre>

<p>
In case you want to help translating documents, create a directory for your 
language in which you keep the at that time current translations:
</p>

<pre caption="Downloading the snapshot for your language">
# <i>mkdir </i><comment>${LANG}</comment>
# <i>cd </i><comment>${LANG}</comment>
# <i>wget http://www.gentoo.org/dyn/doc-snapshots/docs-latest-</i><comment>${LANG}</comment><i>.tar.bz2</i>
# <i>tar xvjf docs-latest-*.tar.bz2</i>
</pre>

<p>
When you update a document, always copy your document from
<path>${LANG}/</path> to the root dir (<path>~/work/gentoo/doc</path>) first,
then adjust the copied version. You need to keep the original one to create a
patch:
</p>

<pre caption="Creating a patch for an update">
# <i>diff -uNt </i><comment>${LANG}</comment><i>/alsa-guide.xml alsa-guide.xml</i> > alsa-guide.diff
</pre>

</body>
</section>
<section>
<title>Online CVS Repository</title>
<body>

<p>
You can request our <uri link="/cgi-bin/viewcvs.cgi">Online CVS Repository</uri>
to provide the differences between individual versions. The main English
repository is <uri link="/cgi-bin/viewcvs.cgi/gentoo/xml/htdocs/doc/en/?sortby=date">fully available</uri>.
Also, the online CVS repository is updated every hour.
</p>

</body>
</section>
<section>
<title>Local repository for developers</title>
<body>

<p>
Create a working directory dedicated to Gentoo; for instance
<path>~/work/gentoo/doc</path>. Then create a subdir called <path>cvs/</path> in
which you will place the CVS snapshot:
</p>

<pre caption="Getting the CVS snapshot">
# <i>mkdir cvs; cd cvs/</i>
# <i>export CVSROOT=</i><comment>&lt;your nick&gt;</comment><i>@cvs.gentoo.org:/home/cvsroot</i>
# <i>cvs co htdocs</i>
</pre>

<p>
To update the CVS snapshot, run <c>cvs update -dP</c> in the
<path>cvs/htdocs</path> directory.
</p>

</body>
</section>
</chapter>
<chapter>
<title>Testing GuideXML</title>
<section>
<title>Testing Environment</title>
<body>

<p>
First create a <path>test/</path> directory in which you place the
<path>guide.dtd</path>, <path>main.css</path> and some images:
</p>

<pre caption="Creating the test environment">
# <i>mkdir test</i>
# <i>cd test</i>
# <i>mkdir dtd css images</i>
# <i>wget -P dtd/ http://www.gentoo.org/dtd/guide.dtd</i>
# <i>wget -P css/ http://www.gentoo.org/css/main.css</i>
# <i>wget -P images/ http://www.gentoo.org/images/gbot-s.gif \
  http://www.gentoo.org/images/gridtest.gif \
  http://www.gentoo.org/images/gtop-s.jpg \
  http://www.gentoo.org/images/line.gif \
  http://www.gentoo.org/images/netraverse-gentoo.gif</i>
</pre>

<p>
Now download a special version of <path>guide.xsl</path> available on <uri
link="http://dev.gentoo.org/~swift/local/guide.xsl">SwifT's webspace</uri>. This
version is adapted to transform GuideXML to HTML on local systems.
</p>

<pre caption="Downloading guide.xsl">
# <i>wget http://dev.gentoo.org/~swift/local/guide.xsl</i>
</pre>

</body>
</section>
<section>
<title>Test a Gentoo Guide</title>
<body>

<p>
To test a Gentoo Guide, first check if it uses correct XML:
</p>

<pre caption="Using xmllint to verify guides">
# <i>xmllint alsa-guide.xml</i>
</pre>

<p>
If <c>xmllint</c> returns the contents of the file, then the file is error-free
(or at least concerning XML-tags). Next you need to convert it to HTML.
<c>xsltproc</c> is the tool needed for that:
</p>

<pre caption="Converting to HTML">
# <i>xsltproc --novalid test/guide.xsl alsa-guide.xml &gt; test/alsa-guide.html</i>
</pre>

<p>
If no errors are displayed, you should be able to point your browser to
<uri>file:///home/user/work/gentoo/doc/test/alsa-guide.html</uri> to view the
resulting document. If not, fix your guide until it works.
</p>

</body>
</section>
<section>
<title>Test the Gentoo Handbook</title>
<body>

<p>
The Gentoo Handbook is divided in chapters. To process a certain chapter, you
must use both the <path>handbook.xml</path> file as the required
<path>hb-</path> file (such as <path>hb-install-about.xml</path>). Then you must
pass <c>xsltproc</c> the same parameters as are used while browsing the online
handbook, namely <c>part</c> and <c>chap</c>. For instance, to validate
<path>hb-install-about.xml</path>:
</p>

<pre caption="Validating hb-install-about.xml">
# <i>xmllint handbook.xml</i>
# <i>xmllint hb-install-about.xml</i>
# <i>xsltproc --stringparam part 1 --stringparam chap 1 test/guide.xsl handbook.xml &gt; test/hb-install-about.html</i>
</pre>

</body>
</section>
</chapter>
</guide>

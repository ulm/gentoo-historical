<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link="/proj/en/devrel/new-dev-training.xml">
<title>Instructions for new developers</title>

<author title="Author">
<mail link="avenj@gentoo.org">Jon Portnoy</mail>
</author>
<author title="Author">
<mail link="jforman@gentoo.org">Jeffrey Forman</mail>
</author>
<author title="Editor">
<mail link="curtis119@gentoo.org">Curtis Napier</mail>
</author>

<abstract>Instructions for new developers</abstract>

<version>1.0.2</version>
<date>24 April 2005</date>

<chapter>
<title>Using CVS</title>
<section>
<title>Introduction</title>
<body>		

<p>
This guide is not intended to be a manual on using CVS; for that, take a look at
the CVS info page or <uri>http://www.gentoo.org/doc/en/cvs-tutorial.xml</uri>.
Instead, this guide focuses specifically on using CVS and Repoman in Gentoo's
ebuild tree.
</p>

</body>
</section>
<section>
<title>Configuration</title>
<body>

<p>
Typically, you'll want something along these lines in your <path>~/.cvsrc</path>:
</p>

<pre caption="~/.cvsrc">
cvs -q -z0
diff -u -b -B
checkout -P
update -d -P
</pre>

<p>
In order to make sure digests are correct, please put <c>cvs</c> in your
<c>FEATURES</c> setting.
</p>

<p>
Finally, many people using CVS like to use compression (-z#). We ask that
developers who are not on dialup connections please use -z0 - with the contents
of our CVS repository and the load on our CVS server, you actually experience a 
speed _increase_ without compression.
</p>

</body>
</section>
<section>
<title>Checking out</title>
<body>

<p>
There are a few useful modules in Gentoo's CVS repository. Ebuilds are kept in
the <path>gentoo-x86</path> module. <path>gentoo-src</path> contains various
projects - some useful, some inactive. <path>gentoo</path> contains the XML
for the website, documentation, developer directories, developer pictures,
and so on.
</p>

<pre caption="Checking out gentoo-x86">
# cvs -d username@cvs.gentoo.org:/var/cvsroot co gentoo-x86
</pre>

<p>
Before working in the tree at any time, it's always a good idea to do an update
to check for changes and prevent conflicts. You can update in any subdirectory
of the tree if you don't want to want for a tree-wide update, but from time to
time it's a good idea to update your entire tree:
</p>
		
<pre caption="Updating in gentoo-x86">
# cd gentoo-x86
# cvs update
</pre>

</body>
</section>
<section>
<title>Adding/Removing</title>
<body>

<p>
Say you're ready to add a brand new package, <c>foo</c>, in app-misc:
</p>

<pre caption="add new package">
# cd CVSROOT/app-misc <comment>(Replace CVSROOT with the location of your checked-out CVS tree.)</comment>
# cvs update <comment>(Always update before working in part of the tree!)</comment>
# mkdir foo
# cvs add foo <comment>(Here, we add the package directory foo to the CVS repository.)</comment>
# cd foo
# cp /path/to/foo-1.0.ebuild ./ <comment>(It's better to keep in-progress ebuilds in an overlay outside of your CVS tree.)</comment>
<comment>(Don't forget to create a ChangeLog - see the man page for echangelog.)</comment>
# ebuild foo-1.0.ebuild digest <comment>(Make sure PORTDIR_OVERLAY is set to the CVS directory when creating digests.)</comment>
# cvs add foo-1.0.ebuild ChangeLog files
# cvs add files/digest-foo-1.0 <comment>(FEATURES=autoaddcvs will do this for you.)</comment>
</pre>

<p>
Remember to also add a metadata.xml file with maintainer information. See the
<uri link="/proj/en/devrel/handbook/handbook.xml?part=2&amp;chap=4">metadata guide</uri>
for more information.
</p>

<p>
At this point, you're ready to commit (see the section on Commits below). But
what if you want to remove foo-1.0 when foo-1.1 is out?
</p>

<pre caption="commiting">
# cd CVSROOT/app-misc/foo
# cvs update
# rm foo-1.0.ebuild files/digest-foo-1.0 <comment>(Files should be deleted first.)</comment>
# cvs remove foo-1.0.ebuild files/digest-foo-1.0
</pre>

<p>
And now you're ready to commit (see the section on Commits below).
</p>
		
</body>
</section>
<section>
<title>Commits</title>
<body>

<p>
Always use <c>repoman commit</c> rather than <c>cvs commit</c>. Repoman is a
quality assurance (QA) tool that performs basic checks and creates Manifests.
If any part of repoman's output is unclear, please see <c>man repoman</c>. Additionally,
you may tire of entering your key passphrase repeatedly; keychain
(<uri>http://www.gentoo.org/proj/en/keychain.xml</uri>) can help you.
</p>
		
<pre caption="repoman commit">
<comment>(Make sure there are no root-owned files present prior to running repoman.)</comment>
# repoman scan <comment>("scan" scans the current directory for QA issues. "full" is more complete.)</comment>
# repoman commit <comment>("commit" does a scan, then commits, while also updating digests. Make sure to use a verbose and useful cvs changelog message.)</comment>
</pre>

</body>
</section>

</chapter>

<chapter>
<title>Miscellaneous</title>
<section>
<title>Putting files on mirrors</title>
<body>

<p>
Distfiles are automatically fetched by the Gentoo Mirror System. You only need to
monitor your distfiles for fetch errors. Please see the
<uri link="/proj/en/infrastructure/mirrors/overview-distfile.xml">Distfiles Overview Guide</uri>
for comprehensive instructions.
</p>

</body>
</section>

<section>
<title>Mail</title>
<body>

<p>
Our infrastructure allows developers to manage their own mail.
<uri>http://www.gentoo.org/proj/en/infrastructure/dev-email.xml</uri>
contains instructions on configuring your @gentoo.org mail.
</p>

</body>
</section>
<section>
<title>Vacations</title>
<body>

<p>Often Gentoo developers go away on vacation, have to take a
short leave for university exams or even go on a honeymoon. Although
we applaud you for having a life outside Gentoo, we'd like to know
you're gone and when you'll be back. When you leave, alert your
immediate development group, whether that is
gentoo-releng@gentoo.org or sparc@gentoo.org. Let them know
you've gone and who can be contacted in your absence if packages
need to be updated.
</p>

<pre caption=".away">
<comment>(When you leave, in your home directory:)</comment>
# touch ~/.away
# echo "I've gone to the mountains, will be away from June 29 - Aug 4th, \
contact zhen, cshields, or klieber in my absence." > ~/.away
<comment>(What this does is alert our script at http://dev.gentoo.org/devaway
of your absence. It's updated once an hour.)</comment>

<comment>(When you return:)</comment>
# rm ~/.away
</pre>

</body>
</section>
</chapter>
</guide>

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/en/devrel/handbook/Attic/hb-guide-metadata.xml,v 1.9 2007/07/31 18:00:22 phreak Exp $-->

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- This document was last synced to:
     cvs://gentoo/gentoo/xml/htdocs/doc/en/metadata.xml :: R1.4.
-->

<sections>
<version>1.0.4</version>
<date>2007-07-31</date>

<section>
<title>Why the need for metadata.xml?</title>
<subsection>
<body>

<p>
The <c>metadata.xml</c> file has as its purpose to give extra information about
ebuilds. The <c>metadata.xml</c> file should exist in every package directory.
A skel file can be found as <c>skel.metadata.xml</c> in the portage tree.
</p>

<note>
Please run <c>xmllint --valid metadata.xml</c> before committing a
<c>metadata.xml</c> file.  We hope to add support for <c>metadata.xml</c> to 
repoman soon.
</note>

</body>
</subsection>
</section>

<section>
<title>Metadata Structure</title>
<subsection>
<body>

<p>
A <c>metadata.xml</c> file can contain a number of tags:
</p>

<table>
<tr>
  <th>tag</th>
  <th>description</th>
</tr>
<tr>
  <ti>
    <brite>&lt;pkgmetadata&gt;</brite>
  </ti>
  <ti>
    This is the root element of the metadata.xml file for packages. It has 
    no attributes. Its required subtag is: <brite>&lt;herd&gt;</brite>. 
    Furthermore, the following subtags are allowed: <brite>&lt;email&gt;</brite> 
    for a general herd email address, <brite>&lt;maintainer&gt;</brite>, and 
    <brite>&lt;longdescription&gt;</brite>.
  </ti>
</tr>
<tr>
  <ti>
    <brite>&lt;catmetadata&gt;</brite>
  </ti>
  <ti>
    This is the root element of the metadata.xml file for categories as per 
    <uri link="/proj/en/glep/glep-0034.html">GLEP 34</uri>. It has 
    no attributes. It contains a number of 
    <brite>&lt;longdescription&gt;</brite> tags, each for a different 
    language.
  </ti>
</tr>
<tr>
  <ti>
    <brite>&lt;herd&gt;</brite>
  </ti>
  <ti>
    There must at least be one herd subtag. The contents of this tag must be
	the name of a herd as specified in the <uri 
    link="http://sources.gentoo.org/viewcvs.py/*checkout*/gentoo/xml/htdocs/proj/en/metastructure/herds/herds.xml?content-type=text/plain&amp;rev=HEAD">herds.xml</uri>
    file or the "no-herd" herd. It must occur at least once.
  </ti>
</tr>
<tr>
  <ti>
    <brite>&lt;maintainer&gt;</brite>
  </ti>
  <ti>
    Besides being member of a herd, a package can also be maintained directly. 
    The maintainers of a package can be specified with the 
    <brite>&lt;maintainer&gt;</brite> tag. This tag has one required subtag: 
    <brite>&lt;email&gt;</brite>. It has two optional subtags:
    <brite>&lt;name&gt;</brite>, and <brite>&lt;description&gt;</brite>.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;email&gt;</brite></ti>
  <ti>
    This contains the e-mail address of the maintainer. It is required.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;name&gt;</brite></ti>
  <ti>
    This contains freetext with the name of the maintainer. It is optional.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;description&gt;</brite></ti>
  <ti>
    The description tag contains a description of the maintainership, or for 
    example a remark that someone interested can take over the maintainership. 
    It is optional.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;longdescription&gt;</brite></ti>
  <ti>
    This tag contains a description of the package. This is to augment the 
    DESCRIPTION field in the ebuilds themselves.
  </ti>
</tr>
</table>

<p>
There are also some attributes that can be used with these tags. They are all
optional:
</p>

<table>
<tr>
  <th>attribute</th>
  <th>tags</th>
  <th>description</th>
</tr>
<tr>
  <ti>lang</ti>
  <ti>
    <brite>&lt;description&gt;</brite>, <brite>&lt;longdescription&gt;</brite>
  </ti>
  <ti>
    In every case where a description is required, there must be at
    <e>least</e> an english description.  If an additional description in
    another language is given, this attribute is used to specify the language
    used.  The format is the two-character language code as defined by the <uri
    link="http://www.w3.org/WAI/ER/IG/ert/iso639.htm#2letter">ISO-639-1</uri>
    norm.
  </ti>
</tr>
<tr>
  <ti>restrict</ti>
  <ti>
    <brite>&lt;herd&gt;</brite>, <brite>&lt;maintainer&gt;</brite>, 
    <brite>&lt;longdescription&gt;</brite>
  </ti>
  <ti>
    The restrict attribute allows to restrict the application of certain tags 
    to certain versions of a package. When this attribute is used, a tag 
    without this attribute must also exist. That tag without the restrict 
    attribute will serve as the default. The format of the restrict attribute 
    is that of the DEPEND flag, except that "&lt;" and 
    "&gt;" need to be specified by &amp;lt; and &amp;gt;.<br />
    <br />
    For example in the db package 
    <c>restrict="&amp;gt;=sys-libs/db-3.2.9-r5"</c> 
    on the maintainer tag shows that I'm currently maintaining all versions 
    bigger then 3.2.9-r5.
  </ti>
</tr>
</table>

</body>
</subsection>
</section>

<section>
<title>Metadata Examples</title>
<subsection>
<title>First Example</title>
<body>

<p>
In this first example we provide you with the <path>metadata.xml</path> for 
OpenOffice of which the ebuilds are completely managed by a herd called
<c>openoffice</c>:
</p>

<pre caption="Herd-managed package">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd"&gt;
&lt;pkgmetadata&gt;
  &lt;herd&gt;openoffice&lt;/herd&gt;
  &lt;longdescription&gt;
    OpenOffice is the  opensource version of staroffice.
    This ebuild allows you to compile it yourself. Unfortunately this
    compilation can take up to a day depending on the speed of your
    computer. It will however make a snappier openoffice than the binary
    version.
  &lt;/longdescription&gt;
&lt;/pkgmetadata&gt;
</pre>

<p>
The <c>openoffice</c> herd is defined in <path>herds.xml</path> by the
<uri link="/proj/en/metastructure">Gentoo Metastructure Project</uri>:
</p>

<note>
This example may be outdated when you read it. It's just an example!
</note>

<pre caption="OpenOffice Herd Example">
&lt;herd&gt;
  &lt;name&gt;openoffice&lt;/name&gt;
  &lt;email&gt;openoffice@gentoo.org&lt;/email&gt;
  &lt;description&gt;openoffice related packages&lt;/description&gt;
  &lt;maintainer&gt;&lt;email&gt;pauldv@gentoo.org&lt;/email&gt;&lt;/maintainer&gt;
  &lt;maintainer&gt;&lt;email&gt;brad@gentoo.org&lt;/email&gt;&lt;/maintainer&gt;
&lt;/herd&gt;
</pre>

<p>
If you want to add (or remove) yourself from a herd, edit <path>herds.xml</path>
located in <path>[gentoo]/xml/htdocs/proj/en/metastructure/herds</path> in Gentoo's CVS repository. Make sure you
know the e-mail alias the herd listens to (for instance the "sound" herd has
<mail link="sound@gentoo.org">sound@gentoo.org</mail>) and add yourself to the
alias (by editing <path>/var/mail/alias/misc/&lt;alias name&gt;</path> on 
dev.gentoo.org).
</p>

</body>
</subsection>
<subsection>
<title>Second Example</title>
<body>

<p>
As second example we view the <path>metadata.xml</path> of <c>mirrorselect</c>.
This ebuild is maintained by the <c>tools-portage</c> herd, but has a separate
maintainer.
</p>

<pre caption="Herd &amp; individually maintained package">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd"&gt;
&lt;pkgmetadata&gt;
  &lt;herd&gt;tools-portage&lt;/herd&gt;
  &lt;maintainer&gt;
    &lt;email&gt;johnm@gentoo.org&lt;/email&gt;
    &lt;name&gt;John Mylchreest&lt;/name&gt;
  &lt;/maintainer&gt;
  &lt;longdescription&gt;
    This utility is used to select the fastest mirror (distfiles) and provide a
    nicer front-end for mirror selection (both rsync + distfiles) to a user.
  &lt;/longdescription&gt;
&lt;/pkgmetadata&gt;
</pre>

</body>
</subsection>
</section>
</sections>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/en/desktop/kde/kde4-guide.xml,v 1.106 2012/08/30 17:16:58 dilfridge Exp $ -->

<guide>
<title>Gentoo KDE Guide</title>

<author title="Author">
  <mail link="tampakrap"/>
</author>
<author title="Author">
  <mail link="dilfridge"/>
</author>
<author title="Author">
  <mail link="scarabeus"/>
</author>
<author title="Author">
  <mail link="jmbsvicetto"/>
</author>
<author title="Author">
  <mail link="johu"/>
</author>
<author title="Author">
  <mail link="cryos"/>
</author>
<author title="Editor">
  <mail link="keytoaster"/>
</author>
<author title="Editor">
  <mail link="nightmorph"/>
</author>

<abstract>
This guide demonstrates how to setup KDE SC using the ebuilds in the tree. Some
tools from the KDE team's git overlay (kde) may be used.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>3.22</version>
<date>2012-08-26</date>

<chapter>
<title>KDE SC 4</title>
<section>
<title>Introduction</title>
<body>

<note>
This guide is being migrated step by step to the Gentoo wiki. All information
about installing the KDE versions available in the main Portage tree has already
been moved.
<uri link="http://wiki.gentoo.org/wiki/KDE">Visit the wiki page</uri> for more
information.
</note>
</body>
</section>
</chapter>

<chapter id="kde_overlay">
<title>Installing KDE SC snapshots and live ebuilds from Overlay</title>
<section id="kde_overlay_prerequisites">
<title>Prerequisites</title>
<body>
<p>
Installing snapshots and live ebuilds are only available through <c>kde</c> overlay, so first
thing is to install it:
</p>

<pre caption="Installing kde overlay">
# <i>layman -f -a kde</i>
<comment>For more information regarding overlays, please read the <uri
link="http://www.gentoo.org/proj/en/overlays/userguide.xml">Overlay Guide</uri></comment>
</pre>

<impo>
The <c>kde overlay</c> uses the thin manifest layout. For this
<c>sys-apps/portage-2.1.10.18</c> or greater is required. Otherwise you will
get missing manifest errors.
</impo> 

</body>
</section>

<section id="snapshots">
<title>Installing KDE SC snapshots</title>
<body>

<p>
During testing phases KDE upstream provides <uri link="ftp://ftp.kde.org/pub/kde/unstable">
snapshots</uri> taken from the git source repositories. Beta and Release Candidate KDE
releases are following the snapshot model below:
</p>

<table>
  <tr>
    <th>KDE SC Version</th>
    <th>Release Name</th>
  </tr>
  <tr>
    <ti>4.x.80</ti>
    <ti>Beta 1</ti>
  </tr>
  <tr>
    <ti>4.x.90</ti>
    <ti>Beta 2</ti>
  </tr>
  <tr>
    <ti>4.x.95</ti>
    <ti>Release Candidate 1</ti>
  </tr>
  <tr>
    <ti>4.x.97</ti>
    <ti>Release Candidate 2</ti>
  </tr>
</table>

<note>
Currently there are no snapshots available.
</note>

<!-- Enable this if first KDE SC 4.10 Snapshot is in overlay available -->
<!--
<p>
Users with stable systems have to keyword the packages to proceed. We provide a
package.keyword file in <c>kde</c> overlay. Due to masked depedencies, KDE SC
4.9.80 should also be masked. We should symlink the files:
</p>

<pre caption="Creating symlink of the keywords file">
# <i>ln -s /path/to/overlay/kde/Documentation/package.keywords/kde-4.10.keywords /etc/portage/package.keywords/</i>
# <i>ln -s /path/to/overlay/kde/Documentation/package.unmask/kde-4.10 /etc/portage/package.unmask/</i>
</pre>

<p>
The installation can be done either by using the meta packages or by using
sets.
</p>

<pre caption="Installation using meta packages">
# <i>emerge -av kde-meta</i> <comment>(contains all of KDE modules)</comment>
# <i>emerge -av kdebase-meta kdegames-meta</i> <comment>(installation of chosen modules only)</comment>
</pre>

<pre caption="Installation using sets">
<comment>(For KDE SC 4.10 Snapshots)</comment>
# <i>emerge -av @kde-4.10</i> <comment>(contains all of KDE modules)</comment>
# <i>emerge -av @kdebase-4.10 @kdegames-4.10</i> <comment>(installation of chosen modules only)</comment>
</pre>
-->

</body>
</section>
<section id="live">
<title>Installing KDE SC live ebuilds</title>
<body>

<p>
KDE SC is Open Source, with its code being available for browsing through <uri
link="http://quickgit.kde.org">KDE QuickGit</uri>, and for public checkout. 
Gentoo, as a source based distro, has the ability to provide live ebuilds that 
checkout the code either from the latest branch or from trunk. Currently, we 
provide 4.9.49.9999 ebuilds from 4.9 branch and 9999 ebuilds from trunk.
</p>

<table>
  <tr>
    <th>Ebuilds Version</th>
    <th>KDE SC Version</th>
  </tr>
  <tr>
    <ti>4.9.49.9999</ti>
    <ti>KDE 4.9 Branch</ti>
  </tr>
  <tr>
    <ti>9999</ti>
    <ti>KDE 4 Trunk</ti>
  </tr>
</table>

<p>
Users with stable systems have to keyword the packages to proceed.  We provide a
package.keyword file in <c>kde</c> overlay, which we'll have to symlink
to our package.keywords directory:
</p>

<pre caption="Creating symlink of the keywords file">
# <i>cd /etc/portage/package.keywords</i>
# <i>ln -s /path/to/overlay/kde/Documentation/package.keywords/kde-4.9.49.9999.keywords .</i><comment>(for 4.9 Branch)</comment>
# <i>ln -s /path/to/overlay/kde/Documentation/package.keywords/kde-live.keywords .</i><comment>(for KDE Trunk)</comment>
</pre>

<p>
The installation can be done either by using the meta packages or by using
sets.
</p>

<pre caption="Installation using meta packages">
# <i>emerge -av kde-meta</i> <comment>(contains all of KDE modules)</comment>
# <i>emerge -av kdebase-meta kdegames-meta</i> <comment>(installation of chosen modules only)</comment>
</pre>

<pre caption="Installation using sets">
<comment>(For KDE SC 4.9 Branch)</comment>
# <i>emerge -av @kde-4.9</i> <comment>(contains all of KDE modules)</comment>
# <i>emerge -av @kdebase-4.9 @kdegames-4.9</i> <comment>(installation of chosen modules only)</comment>
<comment>(For KDE SC Trunk)</comment>
# <i>emerge -av @kde-live</i> <comment>(contains all of KDE modules)</comment>
# <i>emerge -av @kdebase-live @kdegames-live</i> <comment>(installation of chosen modules only)</comment>

<comment>See the <uri link="#sets">Using Sets</uri> section for more information.</comment>
</pre>

</body>
</section>
</chapter>
<chapter>
<title>Additional Installation/Removal Information</title>
<section id="sets">
<title>Using Sets</title>
<body>

<p>
One of the new features provided by Portage 2.2 is sets, which can be used
as replacement for the metapackages. In general this is not recommended, 
however it may provide advantages if you are using live ebuilds. Sets for the kde
packages can be obtained from the
<c>kde</c> overlay <uri
link="http://git.overlays.gentoo.org/gitweb/?p=proj/kde.git;a=tree;f=sets">sets
directory</uri> or grab them as a <uri
link="http://git.overlays.gentoo.org/gitweb/?p=proj/kde.git;a=snapshot;h=5b2fc54fa5d1c8aeddaeb05f044bf28754bb18be;sf=tbz2">
tar.bz2 archive</uri> and put the ones you like in <path>/etc/portage/sets</path> --
you can browse the list of sets provided by the KDE team in the overlay
by using the first link.
</p>

<note>
If you are using the kde overlay you can use sets directly
instead of copying them to <path>/etc/portage/sets</path>.
</note>

<p>
Amongst others, there are sets for each KDE tarball - @kdeaccessibility,
@kdeadmin, @kdeartwork, @kdebase, @kdeedu, @kdegames, @kdegraphics,
@kdemultimedia, @kdenetwork, @kdepim, @kdesdk, @kdetoys, and @kdeutils. There is
also a set of sets (the equivalent to the old kde-meta package) @kde, and the
same for specific versions @kde-3.5 and @kde-4x, a set for KDE deps @kdedeps, a
set for optional packages @kdeoptional and a set for the split qt packages
@qt-split.
</p>

<p>
One can install the complete KDE by running <c>emerge -av @kde</c>. The specific
version equivalents are very useful to uninstall an old version, e.g. <c>emerge
-C @kde-3.5</c>, or to reinstall all packages from a specific version, e.g.
<c>emerge -av1 @kde-4x</c>. 
</p>

</body>
</section>
<section id="cleanup">
<title>Cleaning Up KDE</title>
<body>

<p>
In order to minimize issues, it is best to begin with a clean environment. This
is recommended for the following cases:
</p>

<ul>
 <li>Moving from <c>+kdeprefix</c> to <c>-kdeprefix</c> (and vice versa)</li>
 <li>
   Downgrading KDE (eg. from snapshots/live ebuilds to the Portage version)
 </li>
 <li>Fully upgrading from KDE 3 to KDE 4 (and vice versa)</li>
 <li>Moving from an old overlay</li>
</ul>

<p>
A possible way of completely removing an old KDE installation in this case is:
</p>

<pre caption="Unmerging command">
# <i>emerge -ac kde-base/kdelibs $(qlist -IC 'kde-base/*') \
             $(for name in $(qlist -IC|grep -v '^kde-base/') ; do (  qdepends -C $name | grep -q kdelibs )  &amp;&amp; echo $name  ; done)</i>
</pre>

<p>
Note that this will remove not just kde but also all other packages depending on it, 
as e.g. libreoffice[kde].
</p>

<p>
Using portage-2.2 you can also do the following:
</p>

<pre caption="Unmerging command using sets (i.e. portage-2.2)">
# <i>emerge -C @kde-4.X @kdebase-4.X @kde-3.5</i>(using the typical sets)
</pre>

<p>
As a final step you should remove any old overlay so that there are no conflicts
with the KDE ebuilds. You should remove the old unmask and/or keyword data, too.
</p>

<note>
Don't forget to run <c>emerge --depclean</c> in order to uninstall any
now unneeded dependencies.
</note>

</body>
</section>

<section>
<title>Localization/Internationalization</title>
<body>

<p>
With new KDE there is new translators effort in Localization instead of
Internationalization. This cause some confusion, but don't worry; just the name
has been changed.
</p>

<pre caption="Getting the translations">
<comment>For KDE 4 and Calligra:</comment>
# <i>emerge kde-l10n</i>
# <i>emerge calligra-l10n</i>
</pre>

</body>
</section>
</chapter>

</guide>

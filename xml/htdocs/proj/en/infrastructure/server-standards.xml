<?xml version='1.0' encoding="UTF-8"?>
<?xml-stylesheet href="/xsl/guide.xsl" type="text/xsl"?>

<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">

<guide link = "/proj/en/infrastructure/server-standards.xml">
<title>Server Standards for the Gentoo Infrastructure project</title>
<author title="Author">
    <mail link="klieber@gentoo.org">Kurt Lieber</mail>
</author>
<abstract>
This guide documents the various standards, packages and requirements that the Gentoo Infrastructure team has set for its servers.
</abstract>
<version>0.9</version>
<date>04 July, 2003</date>

<chapter>
<title>Gentoo Infrastructure Server Standards and Guidelines</title>
<section>
<title>Common packages across all servers</title>
<body>
<p>
The following packages are required to be emerged on all Gentoo infrastructure servers:
</p>
<ul>
	<li><c>dev-libs/openssl</c></li>
	<li><c>net-firewall/iptables</c></li>
	<li><c>net-misc/cfengine</c></li>
	<li><c>sys-apps/vcron</c></li>
	<li><c>app-admin/sysklogd</c></li>
	<li><c>app-admin/sudo</c></li>
	<li><c>net-dns/bind-tools</c></li>
	<li><c>net-misc/ntp</c></li>
	<li><c>app-admin/gentoolkit</c></li>
	<li><c>net-misc/keychain</c></li>
</ul>
</body>
</section>
<section>
<title>Common services across all servers</title>
<body>
<p>
The following services are required to be configured and operational on all Gentoo infrastructure servers.  Click on a link to learn more about requirements and sample configuration files for each service: 
</p>
<ul>
	<li><uri link="/proj/en/infrastructure/config-ntp.xml">NTP</uri> - network time protocol</li>
	<li>cfengine - system administration tool and language</li>
	<li><uri link="/proj/en/infrastructure/config-ssh.xml">SSH</uri> - secure shell</li>
	<li><uri link="/proj/en/infrastructure/firewall/server-firewall.xml">iptables</uri> - linux firewall</li>
</ul>
<note>The Gentoo Infrastructure project is currently in the process of migrating to cfengine.  As such, existing servers may not have these services installed or configured.</note>
</body>
</section>
<section>
<title>Forbidden services across all servers</title>
<body>
<p>
The following services may never be installed and/or running on any Gentoo Infrastructure server without prior approval by the Gentoo Infrastructure project manager: 
</p>
<ul>
	<li>telnetd</li>
	<li>pop3</li>
	<li>imap</li>
	<li>ssh protocol &lt; 2</li>
	<li>fingerd</li>
	<li>identd</li>
	<li>rsh</li>
</ul>
<note>The above list is not all-inclusive and only documents the most common forbidden services.  In general, any network daemon which transmits data in an unencrypted or insecure fashion, or is otherwise considered a security risk, is forbidden from running on any Gentoo Infrastructure servers unless explicitly authorized.  The one exception to this rule is HTTP using apache.</note>
</body>
</section>
<section>
<title>Settings in /etc/make.conf</title>
<body>
<p>
Servers should be configured to use the following settings in /etc/make.conf:
</p>
<ul>
<li><c>USE="-* ncurses ssl crypt berkdb tcpd pam xml perl python mmx snmp"</c></li>
<li><c>CFLAGS="-march=athlon-xp -O2 -pipe"</c> (for Athlon XP servers)</li>
<li><c>CFLAGS="-march=pentium3 -O2 -pipe"</c> (for Pentium III and IV servers)</li>
</ul>
<note>USE flags may be adjusted as necessary depending on the requirements of the individual server.  Care should always be taken to ensure a minimal set of USE flags are used on all servers.</note>
<note>At the moment, Gentoo does not use any Pentium II or Athlon/Duron servers</note>
<p>
Because of the marginal difference between -O2 and -O3, we have elected to choose stability over performance when selecting CFLAGS.  Also, to assist with debugging, -fomit-frame-pointer should not be used.
</p>
</body>
</section>
<section>
<title>Settings in /etc/fstab</title>
<body>
<p>
Servers should use either ext3 or reiserfs for all partitions, with the exception of /boot, which may use ext2.  Additionally, the / partition <b>must</b> be mounted with <c>atime</c> <b>enabled</b>.  This means you need to remove <c>noatime</c> from the / entry. 
</p>
</body>
</section>
<section>
<title>Miscellaneous Settings</title>
<body>
<p>
Gentoo Infrastructure servers should have the following settings applied:
</p>
<pre caption="/etc/sysctl.conf">
net.ipv4.tcp_ecn = 0
kernel.hostname = &lt;hostname&gt; 
kernel.domainname = gentoo.org
</pre>
<pre caption="All servers should be set to UTC time">
ln -sf /usr/share/zoneinfo/UTC /etc/localtime
</pre>
<impo>
Ensure that the hardware clock on the server is set to the correct time in UTC format as well.  Use <c>hwclock</c> to adjust.
</impo>
</body>
</section>
</chapter>
</guide>

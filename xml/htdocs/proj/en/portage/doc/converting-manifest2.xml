<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<guide link="/proj/en/portage/doc/manifest221.xml">
<title>Converting Manifest2 to Manifest1</title>
<author>
  <mail link="zmedico@gentoo.org">Zac Medico</mail>
</author>

<abstract>
This document attempts to help people upgrade from portage-2.0.x after
Manifest1 has been dropped from the tree.
</abstract>

<license/>

<version>0.1</version>
<date>15 Jan 2008</date>

<chapter>
<title>Converting Manifest2 to Manifest1</title>

<section>
<title>Purpose</title>
<body>
<p>
This procedure is intended for use as an upgrade path for systems that have a
2.0.x version of sys-apps/portage installed. It will convert a portage tree
from Manifest2 format to Manifest1 format so that it is suitable for use by
2.0.x versions of sys-apps/portage. It is only necessary to perform this
procedure if a <e>!!! No package digest file found</e>
error occurs when attempting to install any and all packages.
</p>
</body>
</section>

<section>
<title>Running manifest221</title>
<body>
<p>
A script named <c>manifest221</c> is located in the files directory of the
sys-apps/portage package. In order to run the script, type
<c>python /usr/portage/sys-apps/portage/files/manifest221</c> where
<path>/usr/portage</path> is substituted with the real location of the portage
tree if it is somewhere other than <path>/usr/portage</path>. The script will take a
few minutes to run and it is normal for it to produce some 'aux_get' error
messages that can be ignored as long as they do not apply to packages that are
needed to upgrade portage.
</p>
</body>
</section>

<section>
<title>Updating</title>
<body>
<p>
If your currently installed version of python is less than 2.3.6-r2 then there
is a python-updater <uri link="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?full=1#blocked">
blocker</uri> that complicates the update procedure (see
<uri link="http://bugs.gentoo.org/show_bug.cgi?id=178490">bug 178490</uri>).
The recommended way to get around this blocker is to force installation
of python-2.3.6-r2 by using the <c>--nodeps</c> option. This package does
not have stable keywords so you may need to run
<c>echo dev-lang/python-2.3.6-r2 >> /etc/portage/package.keywords</c> in
order to unmask it. After that, run <c>emerge -p =python-2.3.6-r2</c> and
you should see the blocker from bug 178490. Newer versions of portage will
automatically resolve this blocker, but you will have to use the
<c>--nodeps</c> option
to override the blocker since you have an old version of portage. Run
<c>emerge --oneshot --nodeps =python-2.3.6-r2</c> and python should update
successfully. After that, run <c>emerge portage</c> to update to a newer
version of portage (including it's dependencies).
</p>
</body>
</section>

</chapter>

</guide>

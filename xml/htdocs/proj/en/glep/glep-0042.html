<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/peps/pep-0001.html for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Docutils 0.3.9: http://docutils.sourceforge.net/" />
  <title>GLEP 42 -- Critical News Reporting</title>
  <link rel="stylesheet" href="tools/glep.css" type="text/css" />
</head>
<body bgcolor="white">
<table class="navigation" cellpadding="0" cellspacing="0"
       width="100%" border="0">
<tr><td class="navicon" width="150" height="35">
<a href="http://www.gentoo.org/" title="Gentoo Linux Home Page">
<img src="http://www.gentoo.org/images/gentoo-new.gif" alt="[Gentoo]"
 border="0" width="150" height="35" /></a></td>
<td class="textlinks" align="left">
[<b><a href="http://www.gentoo.org/">Gentoo Linux Home</a></b>]
[<b><a href="http://www.gentoo.org/proj/en/glep">GLEP Index</a></b>]
[<b><a href="./glep-0042.txt">GLEP Source</a></b>]
</td></tr></table>
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">GLEP:</th><td class="field-body">42</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">Critical News Reporting</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">$Revision: 1.4 $</td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Ciaran McCreesh &lt;ciaranm&#32;&#97;t&#32;gentoo.org&gt;</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference" href="http://www.gentoo.org/cgi-bin/viewcvs/xml/htdocs/proj/en/glep/glep-0042.txt?cvsroot=gentoo">$Date: 2005/12/11 01:38:18 $</a></td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Draft</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference" href="http://www.python.org/peps/glep-0012.html">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">31-Oct-2005</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">1-Nov-2005, 5-Nov-2005, 7-Nov-2005, 11-Dec-2005</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic" id="contents">
<p class="topic-title first"><a name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#abstract" id="id20" name="id20">Abstract</a></li>
<li><a class="reference" href="#motivation" id="id21" name="id21">Motivation</a></li>
<li><a class="reference" href="#requirements" id="id22" name="id22">Requirements</a></li>
<li><a class="reference" href="#specification" id="id23" name="id23">Specification</a><ul>
<li><a class="reference" href="#overview" id="id24" name="id24">Overview</a></li>
<li><a class="reference" href="#news-item-identities" id="id25" name="id25">News Item Identities</a></li>
<li><a class="reference" href="#news-item-directories" id="id26" name="id26">News Item Directories</a></li>
<li><a class="reference" href="#news-item-files" id="id27" name="id27">News Item Files</a><ul>
<li><a class="reference" href="#news-item-headers" id="id28" name="id28">News Item Headers</a></li>
<li><a class="reference" href="#news-item-body" id="id29" name="id29">News Item Body</a></li>
<li><a class="reference" href="#example-news-item" id="id30" name="id30">Example News Item</a></li>
</ul>
</li>
<li><a class="reference" href="#news-item-quality-control" id="id31" name="id31">News Item Quality Control</a></li>
<li><a class="reference" href="#news-item-distribution" id="id32" name="id32">News Item Distribution</a><ul>
<li><a class="reference" href="#server-side" id="id33" name="id33">Server Side</a></li>
<li><a class="reference" href="#client-side" id="id34" name="id34">Client Side</a></li>
</ul>
</li>
<li><a class="reference" href="#news-item-clients" id="id35" name="id35">News Item Clients</a></li>
<li><a class="reference" href="#news-item-removal" id="id36" name="id36">News Item Removal</a></li>
</ul>
</li>
<li><a class="reference" href="#integration-with-existing-systems" id="id37" name="id37">Integration with Existing Systems</a></li>
<li><a class="reference" href="#backwards-compatibility" id="id38" name="id38">Backwards Compatibility</a></li>
<li><a class="reference" href="#reference-implementation" id="id39" name="id39">Reference Implementation</a><ul>
<li><a class="reference" href="#portage-code" id="id40" name="id40">Portage Code</a></li>
<li><a class="reference" href="#simple-eselect-news-client" id="id41" name="id41">Simple <tt class="docutils literal"><span class="pre">eselect</span></tt> News Client</a></li>
<li><a class="reference" href="#simple-news-to-mail-forwarder" id="id42" name="id42">Simple News to Mail Forwarder</a></li>
</ul>
</li>
<li><a class="reference" href="#credits" id="id43" name="id43">Credits</a></li>
<li><a class="reference" href="#example-files" id="id44" name="id44">Example Files</a></li>
<li><a class="reference" href="#references" id="id45" name="id45">References</a></li>
<li><a class="reference" href="#copyright" id="id46" name="id46">Copyright</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h1><a class="toc-backref" href="#id20" name="abstract">Abstract</a></h1>
<p>This GLEP proposes a new way of informing users about important updates and news
regarding tree-related items.</p>
</div>
<div class="section" id="motivation">
<h1><a class="toc-backref" href="#id21" name="motivation">Motivation</a></h1>
<p>Although most package updates are clean and require little user action,
occasionally an upgrade requires user intervention during the upgrade process.
Recent examples of the latter include the <tt class="docutils literal"><span class="pre">gcc-3.4</span></tt> stabilisation on <tt class="docutils literal"><span class="pre">x86</span></tt>
and the <tt class="docutils literal"><span class="pre">mysql-5</span></tt> database format changes.</p>
<p>There are currently several ways of delivering important news items to our
users, none of them particularly effective:</p>
<ul class="simple">
<li>Gentoo Weekly News</li>
<li>The <tt class="docutils literal"><span class="pre">gentoo-announce</span></tt>, <tt class="docutils literal"><span class="pre">gentoo-user</span></tt> and <tt class="docutils literal"><span class="pre">gentoo-dev</span></tt> mailing lists</li>
<li>The Gentoo Forums</li>
<li>The main Gentoo website</li>
<li>RSS feeds of Gentoo news</li>
</ul>
<p>A more reliable way of getting news of critical updates out to users is required
to avoid repeats of the various recent upgrade debacles. This GLEP proposes a
solution based around pushing news items out to the user via the <tt class="docutils literal"><span class="pre">rsync</span></tt> tree.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">This GLEP does not seek to replace or modify <tt class="docutils literal"><span class="pre">einfo</span></tt> messages
which are displayed post-install. That is a separate issue which is handled
by <tt class="docutils literal"><span class="pre">elog</span></tt> <a class="footnote-reference" href="#bug-11359" id="id1" name="id1">[1]</a>.</p>
</div>
</div>
<div class="section" id="requirements">
<h1><a class="toc-backref" href="#id22" name="requirements">Requirements</a></h1>
<p>An adequate solution must meet all of the following requirements:</p>
<dl class="docutils">
<dt>Preemptive</dt>
<dd>Users should be told of changes <em>before</em> they break a system, not after the
damage has already been done. Ideally, the system administrator would be
given ample warning to plan difficult upgrades and changes, rather than only
being told just before action is necessary.</dd>
<dt>No user subscription required</dt>
<dd>It has already been demonstrated <a class="footnote-reference" href="#forums-apache2" id="id2" name="id2">[5]</a> that many users do not
read the <tt class="docutils literal"><span class="pre">gentoo-announce</span></tt> mailing list or <tt class="docutils literal"><span class="pre">RSS</span></tt> feeds. A solution which
requires subscription has no advantage over current methods.</dd>
<dt>No user monitoring required</dt>
<dd>It has already been demonstrated <a class="footnote-reference" href="#forums-apache2" id="id3" name="id3">[5]</a> that many users do not
read news items posted to the Gentoo website, or do not read news items
until it is too late. A solution that relies upon active monitoring of a
particular source has no advantage over current methods.</dd>
<dt>Relevant</dt>
<dd>System administrators who do not use a particular package should not have to
read news items which affect purely that package. Some news items may be of
relevance to most or all users, but those that are not should not be forced
upon users unnecessarily.</dd>
<dt>Lightweight</dt>
<dd>It is not reasonable to expect all users to have an MTA, web browser, email
client, cron daemon or text processing suite available on their system.
Users must not be forced to install unreasonable extra software to be able
to read news items.</dd>
<dt>No privacy violations</dt>
<dd>Users of the solution should not be required to provide information about
their systems (for example, IP addresses or installed packages).</dd>
<dt>Multiple delivery method support</dt>
<dd>Some users may wish to view news items via email, some via a terminal and
some via a web browser. A solution should either support all of these
methods or (better still) make it simple to write clients for displaying
news items in different ways.</dd>
</dl>
<p>The following characteristics would be desirable:</p>
<dl class="docutils">
<dt>Internationalisable</dt>
<dd>Being able to provide messages in multiple languages may be beneficial.</dd>
<dt>Quality control</dt>
<dd>There should be some way to ensure that badly written or irrelevant messages
are not sent out, for example by inexperienced developers or those whose
English language skills are below par.</dd>
<dt>Simple for developers</dt>
<dd>Posting news items should be as simple as is reasonably possible.</dd>
<dt>Simple for users</dt>
<dd>Reading relevant news items should be as simple as is reasonably possible.</dd>
<dt>Compatibility with existing and future news sources</dt>
<dd>A news system would ideally be able to be integrated with existing news
sources (for example, Forums, GWN, the main Gentoo website) without
excessive difficulty. Similarly, easy interoperation with any future news
sources should not be precluded.</dd>
</dl>
</div>
<div class="section" id="specification">
<h1><a class="toc-backref" href="#id23" name="specification">Specification</a></h1>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id24" name="overview">Overview</a></h2>
<p>News items are published and delivered to users as follows:</p>
<ol class="arabic simple">
<li>A news item is written. The format to be used is described below.</li>
<li>The news item is reviewed, following the process described in
<a class="reference" href="#news-item-quality-control">News Item Quality Control</a>.</li>
<li>The news item is committed to a CVS (or Subversion <a class="footnote-reference" href="#glep-36" id="id4" name="id4">[10]</a>) repository.
From here, it is merged with the rsync tree. This is described in <a class="reference" href="#news-item-distribution">News Item
Distribution</a>.</li>
<li>Users fetch the news item when they sync. This ensures that the news items in
question are pushed to the user before the user accidentally makes an
unwanted change. No changes to the existing rsync process are required by
this GLEP.</li>
<li>The package manager filters the news item and, if it is relevant, marks the
news item for reading. The package manager should also display a notice
informing the user that there are unread news items.</li>
<li>The news item is handled by the user's choice of news item reader. See <a class="reference" href="#news-item-clients">News
Item Clients</a>.</li>
</ol>
</div>
<div class="section" id="news-item-identities">
<h2><a class="toc-backref" href="#id25" name="news-item-identities">News Item Identities</a></h2>
<p>Each news item will have a unique identifier. This identifier will be in the
form <tt class="docutils literal"><span class="pre">yyyy-mm-dd-short-name</span></tt>, where <tt class="docutils literal"><span class="pre">yyyy</span></tt> is the year (e.g. <tt class="docutils literal"><span class="pre">2005</span></tt>),
<tt class="docutils literal"><span class="pre">mm</span></tt> is the month (<tt class="docutils literal"><span class="pre">01</span></tt> through <tt class="docutils literal"><span class="pre">12</span></tt>) and dd is the day of the month
(<tt class="docutils literal"><span class="pre">01</span></tt> through <tt class="docutils literal"><span class="pre">31</span></tt>). The <tt class="docutils literal"><span class="pre">short-name</span></tt> is a very short name describing the
news item (e.g. <tt class="docutils literal"><span class="pre">yoursql-updates</span></tt>), consisting only of the characters <tt class="docutils literal"><span class="pre">a-z</span></tt>,
<tt class="docutils literal"><span class="pre">0-9</span></tt> and <tt class="docutils literal"><span class="pre">-</span></tt> (hyphen).</p>
</div>
<div class="section" id="news-item-directories">
<h2><a class="toc-backref" href="#id26" name="news-item-directories">News Item Directories</a></h2>
<p>Each news item will be represented by a directory whose name is the same as the
news item's identifier.</p>
<p>The directory will contain a file named <tt class="docutils literal"><span class="pre">yyyy-mm-dd-short-name.en.txt</span></tt>, which
contains the text of the news item, in English, in the format described below.</p>
<p>If a news item is translated, other files named <tt class="docutils literal"><span class="pre">yyyy-mm-dd-short-name.xx.txt</span></tt>
(where <tt class="docutils literal"><span class="pre">xx</span></tt> is the ISO 639 <a class="footnote-reference" href="#iso-639" id="id5" name="id5">[11]</a> two letter country code) will also be
provided. However, only the English version of a news item is authoritative.
This anglocentricity is justified by precedent <a class="footnote-reference" href="#glep-34" id="id6" name="id6">[9]</a>.</p>
</div>
<div class="section" id="news-item-files">
<h2><a class="toc-backref" href="#id27" name="news-item-files">News Item Files</a></h2>
<p>A news item file is a text file, encoded using UTF-8 <a class="footnote-reference" href="#rfc-3629" id="id7" name="id7">[14]</a> for
compatibility with and for the same reasons as existing Gentoo documentation
<a class="footnote-reference" href="#docs-policy" id="id8" name="id8">[2]</a> and the tree <a class="footnote-reference" href="#glep-31" id="id9" name="id9">[8]</a>.</p>
<p>News items should be signed with a detached GPG signature:</p>
<pre class="literal-block">
gpg --armour --detach-sign ????-??-??-*.??.txt
</pre>
<p>A news item file's content will consist of an <a class="reference" href="http://www.faqs.org/rfcs/rfc822.html">RFC 822</a> style header <a class="footnote-reference" href="#rfc-822" id="id10" name="id10">[13]</a>
followed by the main body of the message as plain text. This GLEP defines
various optional and mandatory headers. Future GLEPs may propose new headers —
tools handling these news items must ignore any unrecognised header.</p>
<div class="section" id="news-item-headers">
<h3><a class="toc-backref" href="#id28" name="news-item-headers">News Item Headers</a></h3>
<p>The following headers describe the purpose and format of the news item:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">Title:</span></tt></dt>
<dd>A short (maximum 44 characters) descriptive title. Mandatory.</dd>
<dt><tt class="docutils literal"><span class="pre">Author:</span></tt></dt>
<dd>Author's name and email address, in the form <tt class="docutils literal"><span class="pre">Real</span> <span class="pre">Name</span> <span class="pre">&lt;email&#64;address&gt;</span></tt>.
Mandatory; multiple author headers may be specified if appropriate.</dd>
<dt><tt class="docutils literal"><span class="pre">Translator:</span></tt></dt>
<dd>For translated news items, the translator's name and email address. Multiple
translator headers may be specified if appropriate.</dd>
<dt><tt class="docutils literal"><span class="pre">Content-Type:</span></tt></dt>
<dd>Must be <tt class="docutils literal"><span class="pre">text/plain</span></tt>. Mandatory.</dd>
<dt><tt class="docutils literal"><span class="pre">Posted:</span></tt></dt>
<dd>Date of posting, in <tt class="docutils literal"><span class="pre">dd-mmm-yyyy</span></tt> format (e.g. 14-Aug-2001) for
compatibility with GLEP 1 <a class="footnote-reference" href="#glep-1" id="id11" name="id11">[6]</a>. UTC time in <tt class="docutils literal"><span class="pre">hh-mm-ss</span> <span class="pre">+0000</span></tt> format
may also be included. Mandatory.</dd>
<dt><tt class="docutils literal"><span class="pre">Revision:</span></tt></dt>
<dd>Initially 1. Incremented every time a non-trivial change is made.  Changes
which require a re-read of the news item should instead use a new news item
file. Mandatory.</dd>
<dt><tt class="docutils literal"><span class="pre">News-Item-Format:</span></tt></dt>
<dd>Must be <tt class="docutils literal"><span class="pre">1.0</span></tt>. Future revisions to the format may increment the minor
number for backwards-compatible changes, or the major number for major
changes.</dd>
</dl>
<p>The following headers are used for filtering:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">Display-If-Installed:</span></tt></dt>
<dd>A dependency atom or simple package name (for example,
<tt class="docutils literal"><span class="pre">&lt;dev-lang/php-5_alpha</span></tt> or <tt class="docutils literal"><span class="pre">net-www/apache</span></tt>). If the user has the
package specified installed, the news item should be displayed.</dd>
<dt><tt class="docutils literal"><span class="pre">Display-If-Keyword:</span></tt></dt>
<dd>A keyword <a class="footnote-reference" href="#glep-22" id="id12" name="id12">[7]</a> name, for example <tt class="docutils literal"><span class="pre">mips</span></tt> or <tt class="docutils literal"><span class="pre">x86-fbsd</span></tt>. If the
user is on the keyword in question, the news item should be displayed.</dd>
<dt><tt class="docutils literal"><span class="pre">Display-If-Profile:</span></tt></dt>
<dd>A profile path, for example <tt class="docutils literal"><span class="pre">default-linux/sparc/sparc64/server</span></tt>. Standard
shell GLOB wildcards may be used. If the user is using the exact profile in
question, the news item should be displayed. This header may be used to
replace <tt class="docutils literal"><span class="pre">deprecated</span></tt> files in the future.</dd>
</dl>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">When performing package moves, developers must also update any
relevant <tt class="docutils literal"><span class="pre">Display-If-Installed</span></tt> headers in news files.</p>
</div>
<p>The algorithm used to determine whether a news item is 'relevant' is as
follows:</p>
<ul class="simple">
<li>For each <tt class="docutils literal"><span class="pre">Display-If-</span></tt> header type which occurs at least once:<ul>
<li>The news item is not relevant if none of the headers of this type are
successfully matched.</li>
</ul>
</li>
<li>Otherwise the news item is relevant.</li>
</ul>
<p>In particular, if no <tt class="docutils literal"><span class="pre">Display-If-</span></tt> header is specified, a news item will be
relevant for all users.</p>
<p>This algorithm was chosen because it makes conditions like &quot;display this news
item for <tt class="docutils literal"><span class="pre">YourSQL</span></tt> users who are on <tt class="docutils literal"><span class="pre">sparc</span></tt> or <tt class="docutils literal"><span class="pre">x86-obsd</span></tt> relatively
simple to specify — it is believed that these kinds of condition are far more
likely to occur than &quot;display this news item for people using <tt class="docutils literal"><span class="pre">YourSQL</span></tt>, or
for people on <tt class="docutils literal"><span class="pre">sparc</span></tt> or <tt class="docutils literal"><span class="pre">x86-obsd</span></tt>&quot; or &quot;display these news items for
people who use <tt class="docutils literal"><span class="pre">YourSQL</span></tt> and who are on both <tt class="docutils literal"><span class="pre">sparc</span></tt> and <tt class="docutils literal"><span class="pre">x86-obsd</span></tt>&quot;.</p>
</div>
<div class="section" id="news-item-body">
<h3><a class="toc-backref" href="#id29" name="news-item-body">News Item Body</a></h3>
<p>The header section must be followed by a blank line, then the main body of the
text.</p>
<p>The text body should be wrapped at 72 characters. No fancy formatting or tab
characters should be used — the news item may be being displayed directly to a
terminal. Paragraphs should be separated by a blank line.</p>
<p>Hyperlinks may be used to refer to further information (for example, an upgrade
guide). However, the main body of the news item should be descriptive and not
simply a &quot;read this link&quot; text. It is assumed that the user will have access to
a web browser <em>somewhere</em>, but not necessarily on the box which is being
administrated — this will be the case on may servers and routers, for example.</p>
</div>
<div class="section" id="example-news-item">
<h3><a class="toc-backref" href="#id30" name="example-news-item">Example News Item</a></h3>
<p><a class="reference" href="glep-0042-extras/example-news-item.txt">This hypothetical news item</a> <a class="footnote-reference" href="#id18" id="id19" name="id19">[16]</a> could be used for an upgrade to the
<tt class="docutils literal"><span class="pre">YourSQL</span></tt> database format which breaks forward compatibility.</p>
</div>
</div>
<div class="section" id="news-item-quality-control">
<h2><a class="toc-backref" href="#id31" name="news-item-quality-control">News Item Quality Control</a></h2>
<p>There have been complaints regarding the comprehensibility of some upgrade
notices and news items in the past. This is understandable — not every Gentoo
developer speaks English as a first language. However, for the sake of clarity,
professionalism and avoiding making us look like prats, it is important that any
language problems be corrected before inflicting a news item upon end users.</p>
<p>Thus, at least 72 hours before a proposed news item is committed, it must be
posted to the <tt class="docutils literal"><span class="pre">gentoo-dev</span></tt> mailing list and <tt class="docutils literal"><span class="pre">Cc:</span></tt>ed to <tt class="docutils literal"><span class="pre">pr&#64;gentoo.org</span></tt>
(exceptions may be made in exceptional circumstances). Any complaints — for
example regarding wording, clarity or accuracy — <strong>must</strong> be addressed before
the news item goes live.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">A previous draft of this GLEP allowed news items to be sent to
<tt class="docutils literal"><span class="pre">gentoo-core</span></tt> instead of <tt class="docutils literal"><span class="pre">gentoo-dev</span></tt>. It is possible that a situation
may arise where this will be necessary (for example, a security update which
must break backwards compatibility and which cannot be revealed to the public
before a given date).</p>
</div>
<p>News items must only be for <strong>important</strong> changes that may cause serious upgrade
or compatibility problems. Ordinary upgrade messages and non-critical news items
should remain in <tt class="docutils literal"><span class="pre">einfo</span></tt> notices. The importance of the message to its
intended audience should be justified with the proposal.</p>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">The filtering system means that it is appropriate to send out
news items which are aimed at users of an uncommon package or architecture.
Thus, the justification should be in the form &quot;this message is important to
YourSQL users because ...&quot;, not &quot;YourSQL is important because ...&quot;.</p>
</div>
</div>
<div class="section" id="news-item-distribution">
<h2><a class="toc-backref" href="#id32" name="news-item-distribution">News Item Distribution</a></h2>
<div class="section" id="server-side">
<h3><a class="toc-backref" href="#id33" name="server-side">Server Side</a></h3>
<p>News items are to be made available via the standard rsync tree. This removes
any need for polling of a remote source.</p>
<p>A new repository will be created for news items. The type (CVS or Subversion),
location and access controls on this repository are beyond the scope of this
GLEP.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">A previous draft of this GLEP instead used the main <tt class="docutils literal"><span class="pre">gentoo-x86</span></tt>
tree. This was changed following advice from Infrastructure
<a class="footnote-reference" href="#ramereth-repo" id="id14" name="id14">[12]</a>. Both solutions have the same end result.</p>
</div>
<p>This repository will contain directories named <tt class="docutils literal"><span class="pre">yyyy/mm/</span></tt>, where <tt class="docutils literal"><span class="pre">yyyy</span></tt> is
the current year and <tt class="docutils literal"><span class="pre">mm</span></tt> is the current month number (01 for January through
12 for December). This separation will help keep news items more manageable.</p>
<p>The contents of this repository will automatically be merged with the main rsync
tree, placing the items in a <tt class="docutils literal"><span class="pre">metadata/news/</span></tt> directory. The method used for
merging these items is beyond the scope of this GLEP — a similar setup is
already used for merging GLSAs into the rsync tree.</p>
<p>The main rsync tree will <strong>not</strong> use the <tt class="docutils literal"><span class="pre">yyyy/mm/</span></tt> subdirectory layout.</p>
</div>
<div class="section" id="client-side">
<h3><a class="toc-backref" href="#id34" name="client-side">Client Side</a></h3>
<p>Whenever relevant unread news items are found, the package manager will create a
file named <tt class="docutils literal"><span class="pre">/var/lib/portage/news/news.unread</span></tt> (if it does not already exist)
and append the news item identifier (eg <tt class="docutils literal"><span class="pre">2005-11-01-yoursql-updates</span></tt>) on a new
line.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">Future changes to Portage involving support for multiple repositories
may require one news list per repository. Assuming repositories have some
kind of unique identifier, this file could be named <tt class="docutils literal"><span class="pre">news-repoid.unread</span></tt>.</p>
</div>
<p>Notification that new relevant news items will be displayed via the
<tt class="docutils literal"><span class="pre">emerge</span></tt> tool in a similar way to the existing &quot;configuration files need
updating&quot; messages:</p>
<pre class="literal-block">
* Important: there are 5 unread news items.
* Type emerge --help news to learn how to read news files.
</pre>
<p>Checks for new news messages should be displayed:</p>
<ul class="simple">
<li>After an <tt class="docutils literal"><span class="pre">emerge</span> <span class="pre">sync</span></tt></li>
<li>After an <tt class="docutils literal"><span class="pre">emerge</span> <span class="pre">--pretend</span></tt></li>
<li>Before an <tt class="docutils literal"><span class="pre">emerge</span> <span class="pre">&lt;target&gt;</span></tt> (which may also include a red warning message)</li>
</ul>
<p>The package manager may use a timestamp check file to avoid having to process
news items unnecessarily.</p>
<p>The package manager must keep track of news items that have already been added
to the unread list to avoid repeatedly marking a deleted news item. This could
be handled via a <tt class="docutils literal"><span class="pre">news.skip</span></tt> file, but implementation is not specified by this
GLEP.</p>
<p>Users who really don't care about news items can use <tt class="docutils literal"><span class="pre">rsync_excludes</span></tt> to
filter out the <tt class="docutils literal"><span class="pre">metadata/news/</span></tt> directory.</p>
</div>
</div>
<div class="section" id="news-item-clients">
<h2><a class="toc-backref" href="#id35" name="news-item-clients">News Item Clients</a></h2>
<p>Once a news item is marked for reading, third party tools (or traditional core
Unix tools) can be used to display and view the news files.</p>
<p>When a news item is read, its name should be removed from the <tt class="docutils literal"><span class="pre">news.unread</span></tt>
file. News clients may add the name to a <tt class="docutils literal"><span class="pre">news.read</span></tt> file in the same
directory with the same file format.</p>
<p>An <tt class="docutils literal"><span class="pre">eselect</span></tt> <a class="footnote-reference" href="#eselect" id="id15" name="id15">[3]</a> module shall be created as the 'suggested' display
tool; other display tools (for example, a news to email forwarder, which would
be ideal for users who sync on a <tt class="docutils literal"><span class="pre">cron</span></tt>) are left as options for those who
desire them.</p>
</div>
<div class="section" id="news-item-removal">
<h2><a class="toc-backref" href="#id36" name="news-item-removal">News Item Removal</a></h2>
<p>News items can be removed (by removing the news file from the main tree) when
they are no longer relevant, if they are made obsolete by a future news item or
after a long period of time. This is the same as the method used for <tt class="docutils literal"><span class="pre">updates</span></tt>
entries.</p>
</div>
</div>
<div class="section" id="integration-with-existing-systems">
<h1><a class="toc-backref" href="#id37" name="integration-with-existing-systems">Integration with Existing Systems</a></h1>
<p>It would be simple to convert these news items into the format used for news
items on the Gentoo website or posts for the <tt class="docutils literal"><span class="pre">gentoo-announce</span></tt> mailing list.</p>
<p>There is an existing automated tool <a class="footnote-reference" href="#forums-glsa" id="id16" name="id16">[4]</a> for posting GLSAs to the
forums. A similar tool can be used for these news items.</p>
</div>
<div class="section" id="backwards-compatibility">
<h1><a class="toc-backref" href="#id38" name="backwards-compatibility">Backwards Compatibility</a></h1>
<p>Backwards compatibility is not a concern here. Existing tools will simply ignore
the <tt class="docutils literal"><span class="pre">news/</span></tt> directory.</p>
</div>
<div class="section" id="reference-implementation">
<h1><a class="toc-backref" href="#id39" name="reference-implementation">Reference Implementation</a></h1>
<div class="section" id="portage-code">
<h2><a class="toc-backref" href="#id40" name="portage-code">Portage Code</a></h2>
<p>TODO</p>
</div>
<div class="section" id="simple-eselect-news-client">
<h2><a class="toc-backref" href="#id41" name="simple-eselect-news-client">Simple <tt class="docutils literal docutils literal"><span class="pre">eselect</span></tt> News Client</a></h2>
<p>TODO Removed until the exact format details are figured out.</p>
</div>
<div class="section" id="simple-news-to-mail-forwarder">
<h2><a class="toc-backref" href="#id42" name="simple-news-to-mail-forwarder">Simple News to Mail Forwarder</a></h2>
<p>TODO Removed until the exact format details are figured out.</p>
</div>
</div>
<div class="section" id="credits">
<h1><a class="toc-backref" href="#id43" name="credits">Credits</a></h1>
<p>The idea behind notifying users of news updates via Portage comes from Stuart
Herbert <a class="footnote-reference" href="#stuart-blog" id="id17" name="id17">[15]</a>.</p>
<p>Thanks to Lance Albertson, Stephen Bennett, Donnie Berkholz, Grant Goodyear,
Brian Harring, Dan Meltzer, Jason Stubbs, Paul de Vrieze and Alec Warner for
input.  Some of the ideas presented here are theirs, others go completely
against their suggestions.</p>
</div>
<div class="section" id="example-files">
<h1><a class="toc-backref" href="#id44" name="example-files">Example Files</a></h1>
<p>TODO Removed until the exact format details are figured out.</p>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id45" name="references">References</a></h1>
<table class="docutils footnote" frame="void" id="bug-11359" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1" name="bug-11359">[1]</a></td><td>Bugzilla Bug 11359
&quot;[NEW FEATURE] pkg_postinst/pkg_preinst ewarn/einfo logging&quot;,
<a class="reference" href="https://bugs.gentoo.org/show_bug.cgi?id=11359">https://bugs.gentoo.org/show_bug.cgi?id=11359</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="docs-policy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8" name="docs-policy">[2]</a></td><td>Gentoo XML Guide, Daniel Robbins et al.,
<a class="reference" href="http://www.gentoo.org/doc/en/xml-guide.xml">http://www.gentoo.org/doc/en/xml-guide.xml</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="eselect" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15" name="eselect">[3]</a></td><td>eselect modular framework for configuration and
administration utilities,
<a class="reference" href="http://www.gentoo.org/proj/en/eselect/index.xml">http://www.gentoo.org/proj/en/eselect/index.xml</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="forums-glsa" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16" name="forums-glsa">[4]</a></td><td>Forums user GLSA,
<a class="reference" href="http://forums.gentoo.org/profile.php?mode=viewprofile&amp;u=55648">http://forums.gentoo.org/profile.php?mode=viewprofile&amp;u=55648</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="forums-apache2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a name="forums-apache2">[5]</a></td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> Forums thread &quot;Gentoo Apache2 Config Change Idiocy&quot;,
<a class="reference" href="http://forums.gentoo.org/viewtopic-t-384368.html">http://forums.gentoo.org/viewtopic-t-384368.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="glep-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11" name="glep-1">[6]</a></td><td>GLEP 1: &quot;GLEP Purpose and Guidelines&quot;, Grant Goodyear,
<a class="reference" href="http://www.gentoo.org/proj/en/glep/glep-0001.html">http://www.gentoo.org/proj/en/glep/glep-0001.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="glep-22" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12" name="glep-22">[7]</a></td><td>GLEP 22: &quot;New &quot;keyword&quot; system to incorporate various
userlands/kernels/archs&quot;, Grant Goodyear,
<a class="reference" href="http://www.gentoo.org/proj/en/glep/glep-0022.html">http://www.gentoo.org/proj/en/glep/glep-0022.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="glep-31" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9" name="glep-31">[8]</a></td><td>GLEP 31: &quot;Character Sets for Portage Tree Items&quot;, Ciaran
McCreesh,
<a class="reference" href="http://www.gentoo.org/proj/en/glep/glep-0031.html">http://www.gentoo.org/proj/en/glep/glep-0031.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="glep-34" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6" name="glep-34">[9]</a></td><td>GLEP 34: &quot;Per-Category metadata.xml Files&quot;, Ciaran McCreesh,
<a class="reference" href="http://www.gentoo.org/proj/en/glep/glep-0034.html">http://www.gentoo.org/proj/en/glep/glep-0034.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="glep-36" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4" name="glep-36">[10]</a></td><td>GLEP 36: &quot;Subversion/CVS for Gentoo Hosted Projects&quot;, Aaron
Walker,
<a class="reference" href="http://www.gentoo.org/proj/en/glep/glep-0036.html">http://www.gentoo.org/proj/en/glep/glep-0036.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="iso-639" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5" name="iso-639">[11]</a></td><td>ISO 639 &quot;Code for the representation of names of languages&quot;</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ramereth-repo" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14" name="ramereth-repo">[12]</a></td><td>&quot;Re: [gentoo-dev] GLEP ??: Critical News Reporting&quot;, Lance
Albertson,
<a class="reference" href="http://marc.theaimsgroup.com/?l=gentoo-dev&amp;m=113111585907703&amp;w=2">http://marc.theaimsgroup.com/?l=gentoo-dev&amp;m=113111585907703&amp;w=2</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="rfc-822" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10" name="rfc-822">[13]</a></td><td><a class="reference" href="http://www.faqs.org/rfcs/rfc822.html">RFC 822</a> &quot;Standard for the format of ARPA Internet text messages&quot;</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="rfc-3629" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7" name="rfc-3629">[14]</a></td><td><a class="reference" href="http://www.faqs.org/rfcs/rfc3629.html">RFC 3629</a>: &quot;UTF-8, a transformation format of ISO 10646&quot;
<a class="reference" href="http://www.ietf.org/rfc/rfc3629.txt">http://www.ietf.org/rfc/rfc3629.txt</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="stuart-blog" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17" name="stuart-blog">[15]</a></td><td>&quot;Favouring an automatic news mechanism&quot;, Stuart Herbert,
<a class="reference" href="http://stu.gnqs.org/diary/gentoo.php/2005/10/28/favouring_an_automatic_news_mechanism">http://stu.gnqs.org/diary/gentoo.php/2005/10/28/favouring_an_automatic_news_mechanism</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id19" name="id18">[16]</a></td><td><a class="reference" href="glep-0042-extras/example-news-item.txt">glep-0042-extras/example-news-item.txt</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="copyright">
<h1><a class="toc-backref" href="#id46" name="copyright">Copyright</a></h1>
<p>This document has been placed in the public domain.</p>
<!-- vim: set tw=80 fileencoding=utf-8 spell spelllang=en et : -->
</div>

</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="glep-0042.txt">View document source</a>.
Generated on: 2005-12-11 01:37 UTC.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>


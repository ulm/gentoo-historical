<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
  <title>GLEP 56 -- USE flag descriptions in metadata</title>
  <link rel="stylesheet" href="tools/glep.css" type="text/css" />
</head>
<body bgcolor="white">
<table class="navigation" cellpadding="0" cellspacing="0"
       width="100%" border="0">
<tr><td class="navicon" width="150" height="35">
<a href="http://www.gentoo.org/" title="Gentoo Linux Home Page">
<img src="http://www.gentoo.org/images/gentoo-new.gif" alt="[Gentoo]"
 border="0" width="150" height="35" /></a></td>
<td class="textlinks" align="left">
[<b><a href="http://www.gentoo.org/">Gentoo Linux Home</a></b>]
[<b><a href="http://www.gentoo.org/proj/en/glep">GLEP Index</a></b>]
[<b><a href="http://www.gentoo.org/proj/en/glep/glep-0056.txt">GLEP Source</a></b>]
</td></tr></table>
<table class="rfc2822 docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">GLEP:</th><td class="field-body">56</td>
</tr>
<tr class="field"><th class="field-name">Title:</th><td class="field-body">USE flag descriptions in metadata</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">1.2</td>
</tr>
<tr class="field"><th class="field-name">Last-Modified:</th><td class="field-body"><a class="reference" href="http://www.gentoo.org/cgi-bin/viewcvs.cgi/xml/htdocs/proj/en/glep/glep-0056.txt?cvsroot=gentoo">2008/07/10 18:15:05</a></td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Doug Goldstein &lt;cardoe&#32;&#97;t&#32;gentoo.org&gt;</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Draft</td>
</tr>
<tr class="field"><th class="field-name">Type:</th><td class="field-body">Standards Track</td>
</tr>
<tr class="field"><th class="field-name">Content-Type:</th><td class="field-body"><a class="reference" href="glep-0002.html">text/x-rst</a></td>
</tr>
<tr class="field"><th class="field-name">Created:</th><td class="field-body">03-Jun-2008</td>
</tr>
<tr class="field"><th class="field-name">Post-History:</th><td class="field-body">13-Jun-2008</td>
</tr>
</tbody>
</table>
<hr />
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#abstract" id="id11" name="id11">Abstract</a></li>
<li><a class="reference" href="#motivation" id="id12" name="id12">Motivation</a></li>
<li><a class="reference" href="#specification" id="id13" name="id13">Specification</a></li>
<li><a class="reference" href="#credits" id="id14" name="id14">Credits</a></li>
<li><a class="reference" href="#references" id="id15" name="id15">References</a></li>
<li><a class="reference" href="#backwards-compatibility" id="id16" name="id16">Backwards Compatibility</a></li>
<li><a class="reference" href="#copyright" id="id17" name="id17">Copyright</a></li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id11" id="abstract" name="abstract">Abstract</a></h1>
<p>This GLEP proposes to add per-package USE flag descriptions to each package's
metadata.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id12" id="motivation" name="motivation">Motivation</a></h1>
<p>Gives Gentoo users the ability to better identify how USE flags affect their
installations of a given package. For example, many global USE flags have very
generic descriptions but no specifics on how it affects a certain package.
Specifically speaking, an example would be net-print/cups and the 'jpeg' USE
flag. Does this flag mean you won't be able to print jpeg files? You can print
them directly? It's interface won't use jpeg files.</p>
<blockquote>
<ul class="simple">
<li>Motivator References: <a class="footnote-reference" href="#motivators1" id="id1" name="id1">[6]</a>, <a class="footnote-reference" href="#motivators2" id="id2" name="id2">[7]</a>, <a class="footnote-reference" href="#motivators3" id="id3" name="id3">[8]</a>,
and <a class="footnote-reference" href="#motivators4" id="id4" name="id4">[9]</a></li>
</ul>
</blockquote>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id13" id="specification" name="specification">Specification</a></h1>
<p>This GLEP proposes the addition of <tt class="docutils literal"><span class="pre">&lt;use&gt;</span></tt> XML tag that is only allowed to
appear inside of a <tt class="docutils literal"><span class="pre">&lt;pkgmetadata&gt;</span></tt> XML tag.</p>
<blockquote>
<ul>
<li><p class="first">Inside the <tt class="docutils literal"><span class="pre">&lt;use&gt;</span></tt> XML tag, the <tt class="docutils literal"><span class="pre">&lt;flag&gt;</span></tt> XML tag is allowed to appear
once per USE flag as specified by the <tt class="docutils literal"><span class="pre">'name'</span></tt> attribute with the
following exception:</p>
<ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">'restrict'</span></tt> atttribute can limit to specific versions of the
package, where the attribute value must be a valid CPV as defined by the
<cite>Gentoo Developer Handbook</cite> <a class="footnote-reference" href="#devhandbook" id="id5" name="id5">[4]</a>.  This follows the current
behavior of the <tt class="docutils literal"><span class="pre">'restrict'</span></tt> attribute in metadata.xml.<ul>
<li>e.g. A USE flag may have one behavior for version 0.1 of a package,
while version 0.2, the USE flag may differ slightly.</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Each <tt class="docutils literal"><span class="pre">&lt;flag&gt;</span></tt> XML tag requires a 'name' attribute which is the full USE
flag name as it would appear in the IUSE section of the ebuild.</p>
<blockquote>
<ul class="simple">
<li>e.g. &quot;video_cards_i810&quot; or &quot;alsa&quot;</li>
</ul>
</blockquote>
</li>
<li><p class="first">Each <tt class="docutils literal"><span class="pre">&lt;flag&gt;</span></tt> XML tag allows 0 or more nested <tt class="docutils literal"><span class="pre">&lt;pkg&gt;</span></tt> XML tags whose
character data is a valid CP or CPV as defined by the
<cite>Gentoo Development Guide - Ebuild File Format</cite> <a class="footnote-reference" href="#devmanual" id="id6" name="id6">[5]</a>.</p>
</li>
<li><p class="first">Each <tt class="docutils literal"><span class="pre">&lt;flag&gt;</span></tt> XML tag allows 0 or more nested <tt class="docutils literal"><span class="pre">&lt;cat&gt;</span></tt> XML tags whose
character data is a valid category.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">&lt;use&gt;</span></tt> XML tag may appear multiple times inside of the
<tt class="docutils literal"><span class="pre">&lt;pkgmetadata&gt;</span></tt> XML tag if and only if it contains a different <tt class="docutils literal"><span class="pre">'lang'</span></tt>
attribute value.</p>
<ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">lang</span></tt> attribute follows the documented <tt class="docutils literal"><span class="pre">lang</span></tt> attribute in the
<cite>Gentoo Developer Handbook</cite> <a class="footnote-reference" href="#devhandbook" id="id7" name="id7">[4]</a>.</li>
</ul>
</li>
</ul>
</blockquote>
<p>Documentation for the Developer Manual and the metadata.dtd can be found in
Gentoo's Bugzilla <a class="footnote-reference" href="#use-flag-metadata-bug" id="id8" name="id8">[1]</a> bug #199788.</p>
<p>The following are two concrete examples in tree, <a class="footnote-reference" href="#use-flag-metadata-example1" id="id9" name="id9">[2]</a>
and <a class="footnote-reference" href="#use-flag-metadata-example2" id="id10" name="id10">[3]</a>.</p>
<p>And the following is an embedded example and not from a real package:</p>
<pre class="literal-block">
&lt;use&gt;
        &lt;flag name='acpi'&gt;Enables HAL to attempt to read from
        /proc/acpi/event, if unavailable, HAL will read events from
        &lt;pkg&gt;sys-power/acpid&lt;/pkg&gt;. If you need multiple acpi readers,
        ensure acpid is in your default runlevel
        (rc-update add acpid default) along with HAL. This will also
        enable HAL to read Toshiba and IBM acpi events which do not
        get sent via /proc/acpi/event&lt;/flag&gt;
        &lt;flag name='spell'&gt;Enables spell checking capability using
        dictionaries found in &lt;cat&gt;app-dict&lt;/cat&gt;&lt;/flag&gt;
&lt;/use&gt;
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id14" id="credits" name="credits">Credits</a></h1>
<p>Thanks to the following persons for their input on or related to this GLEP
(even though they might not have known it):
Diego Pettenò (flameeyes), Alec Warner (antarus), Joshua Nichols (nichoj),
Steve Dibb (beandog), and Tiziano Müller (dev-zero)</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id15" id="references" name="references">References</a></h1>
<table class="docutils footnote" frame="void" id="use-flag-metadata-bug" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8" name="use-flag-metadata-bug">[1]</a></td><td><a class="reference" href="http://bugs.gentoo.org/show_bug.cgi?id=199788">http://bugs.gentoo.org/show_bug.cgi?id=199788</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="use-flag-metadata-example1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9" name="use-flag-metadata-example1">[2]</a></td><td><a class="reference" href="http://sources.gentoo.org/viewcvs.py/gentoo-x86/sys-apps/hal/metadata.xml?view=markup">http://sources.gentoo.org/viewcvs.py/gentoo-x86/sys-apps/hal/metadata.xml?view=markup</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="use-flag-metadata-example2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10" name="use-flag-metadata-example2">[3]</a></td><td><a class="reference" href="http://sources.gentoo.org/viewcvs.py/gentoo-x86/media-tv/mythtv/metadata.xml?view=markup">http://sources.gentoo.org/viewcvs.py/gentoo-x86/media-tv/mythtv/metadata.xml?view=markup</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="devhandbook" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a name="devhandbook">[4]</a></td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> <a class="reference" href="http://www.gentoo.org/proj/en/devrel/handbook/handbook.xml?part=2&amp;chap=4">http://www.gentoo.org/proj/en/devrel/handbook/handbook.xml?part=2&amp;chap=4</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="devmanual" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6" name="devmanual">[5]</a></td><td><a class="reference" href="http://devmanual.gentoo.org/ebuild-writing/file-format/index.html">http://devmanual.gentoo.org/ebuild-writing/file-format/index.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="motivators1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1" name="motivators1">[6]</a></td><td><a class="reference" href="http://blog.flameeyes.eu/articles/2007/11/19/lets-actually-get-some-metadata">http://blog.flameeyes.eu/articles/2007/11/19/lets-actually-get-some-metadata</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="motivators2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2" name="motivators2">[7]</a></td><td><a class="reference" href="http://blog.cardoe.com/archives/2007/11/19/use-flag-metadata/">http://blog.cardoe.com/archives/2007/11/19/use-flag-metadata/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="motivators3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3" name="motivators3">[8]</a></td><td><a class="reference" href="http://blog.cardoe.com/archives/2007/11/23/metadataxml-updates-examples/">http://blog.cardoe.com/archives/2007/11/23/metadataxml-updates-examples/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="motivators4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4" name="motivators4">[9]</a></td><td><a class="reference" href="http://technicalpickles.com/posts/pidgin-idle-time">http://technicalpickles.com/posts/pidgin-idle-time</a></td></tr>
</tbody>
</table>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id16" id="backwards-compatibility" name="backwards-compatibility">Backwards Compatibility</a></h1>
<p>No changes are necessary to existing <tt class="docutils literal"><span class="pre">metadata.xml</span></tt> files. Information in
the new tags is not mandatory. Tools that currently read <tt class="docutils literal"><span class="pre">metadata.xml</span></tt>
files may break if written poorly, while well written tools should just ignore
the additional elements. Tools which are capable of handling the new tags
should prefer their data over <tt class="docutils literal"><span class="pre">use.desc</span></tt> and <tt class="docutils literal"><span class="pre">use.local.desc</span></tt>.</p>
<p>USE flags still must be defined in <tt class="docutils literal"><span class="pre">use.desc</span></tt> or <tt class="docutils literal"><span class="pre">use.local.desc</span></tt>. If the
USE flag is not found in either <tt class="docutils literal"><span class="pre">use.desc</span></tt> or <tt class="docutils literal"><span class="pre">use.local.desc</span></tt>, the
information contained within the new tags in <tt class="docutils literal"><span class="pre">metadata.xml</span></tt> must be ignored
and QA tools should warn as they currently do.</p>
<p>Once this GLEP is approved, the Gentoo Infrastructure Team will work to remove
the <tt class="docutils literal"><span class="pre">use.local.desc</span></tt> file from CVS and it will be auto-generated for rsync.
This will ensure that backwards compatibility is not broken for users of
non-CVS trees. At this time, QA tools will need to be updated to verify the
contents of <tt class="docutils literal"><span class="pre">metadata.xml</span></tt> containing the necessary tags which would appear
in <tt class="docutils literal"><span class="pre">use.local.desc</span></tt>.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id17" id="copyright" name="copyright">Copyright</a></h1>
<p>This document is placed into the public domain.</p>
<!-- vim: set ft=glep tw=72 : -->
</div>

</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="glep-0056.txt">View document source</a>.
Generated on: 2008-07-10 18:23 UTC.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>


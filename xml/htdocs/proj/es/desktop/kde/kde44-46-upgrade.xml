<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE guide SYSTEM "/dtd/guide.dtd">
<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/es/desktop/kde/Attic/kde44-46-upgrade.xml,v 1.1 2011/04/25 09:55:20 nimiux Exp $ -->

<guide lang="es">
<title>Guía de actualización Gentoo KDE 4.4 - 4.6</title>

<author title="Author">
  <mail link="dilfridge"/>
</author>
<author title="Author">
 <mail link="tampakrap" />
</author>
<author title="Author">
 <mail link="ssuominen" />
</author>
<author title="Traductor">
  <mail link="nimiux"/>
</author>

<abstract>
Esta página ofrece algunos consejos para que la actualización desde
KDE SC 4.4 a KDE SC 4.6 sea lo más cómoda posible.
</abstract>

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->
<license/>

<version>0.1</version>
<date>2011-04-09</date>

<chapter>
<title>Introducción</title>
<section>
<title>Acerca de la actualización</title>
<body>

<p>
Con la actualización estable de KDE desde KDE SC 4.4.5 a KDE SC 4.6.2, se
sube a una versión mayor. Naturalmente, se ha desplazado alguna
funcionalidad entre paquetes, algunos han sido reemplazados o descartados.
Como norma general, la actualización debería ser cómoda. Esta página
recoge algunos consejos y trucos para aquellos casos en que las cosas no
van como debieran...
</p>

</body>
</section>
</chapter>

<chapter>
<title>Problemas antes y durante la actualización</title>
<section>
<title>Ajustes USE que deben ser activados</title>
<body>

<p>
Antes de actualizar su sistema, se recomienda que active o desactive
algunos ajustes USE.
Se detallan a continuación estos ajustes:
</p>

<table>
  <tr>
    <th>Ajuste</th>
    <th>Explicación</th>
  </tr>
  <tr>
    <ti>consolekit</ti>
    <ti>Activa el marco de trabajo consolekit para la definición y
        seguimiento de usuarios, sesiones y asientos
    </ti>
  </tr>
  <tr>
    <ti>dbus</ti>
    <ti>Activa el uso del sistema de mensajes dbus</ti>
  </tr>
  <tr>
    <ti>policykit</ti>
    <ti>Activa el marco de trabajo <b>polkit</b> para el control de los
        privilegios de los servicios de todo el sistema.
    </ti>
  </tr>
  <tr>
    <ti>udev</ti>
    <ti>Activa el soporte de udev (nombrado dinámico y persistente de
        dispositivos en Linux)
    </ti>
  </tr>
  <tr>
    <ti>-hal</ti>
    <ti>DESACTIVA el uso de sys-apps/hal para el acceso al hardware</ti>
  </tr>
</table>

<p>
Observe que otras combinaciones pueden ser técnicamente posibles, pero
puede que no estén soportadas, no comprobadas o pueden llevar a una
pérdida inesperada de funcionalidad.
</p>

<p>
Si ha modificado algún ajuste USE global, puede incluir posteriormente el
ajuste -N cuando ejecute el comando emerge, el cual, actualizará su
sistema, por ejemplo:
</p>

<pre caption="Actualizado world después de un cambio en los ajustes USE">
# <i>emerge -uDNav world</i>
</pre>

</body>
</section>
<section>
<title>Paquetes que no debe seleccionar o hacer unmerge después de la actualización</title>
<body>

<p>
KDE utiliza algunos paquetes aparte de kde-base para servicios específicos.
Por ejemplo la integración de bluetooth se realiza en KDE SC 4.4 usando
net-wireless/kbluetooth. KDE SC 4.6 utiliza un nuevo sistema bluetooth
ofrecido por net-wireless/bluedevil, por lo que kbluetooth y bluedevil
no pueden ser instalados a la vez. Normalmente portage debería resolver
esto automáticamente. Sin embargo, si tiene net-wireless/kbluetooth en
su fichero world, portage no lo desinstalará, bloqueando completamente
la actualización.
En este caso, necesitará ejecutar el siguiente comando:
</p>

<pre caption="Eliminando (por ejemplo) net-wireless/kbluetooth de su fichero world">
# <i>emerge --deselect net-wireless/kbluetooth</i>
</pre>

<p>
Una vez hecho esto, portage debería hacer mejor su trabajo para
resolver la actualización. Una lista de estos paquetes se da más abajo.
</p>

<table>
  <tr>
    <th>Paquete usado por KDE 4.4</th>
    <th>Reemplazado por</th>
    <th>Comentarios</th>
  </tr>
  <tr>
    <ti>net-wireless/kbluetooth</ti>
    <ti>net-wireless/bluedevil</ti>
    <ti>Se instala por el uso del ajuste USE bluetooth</ti>
  </tr>
  <tr>
    <ti>kde-misc/filelight</ti>
    <ti>kde-base/filelight</ti>
    <ti>Ahora está en la distribución principal de KDE</ti>
  </tr>
</table>

</body>
</section>
</chapter>

<chapter>
<title>Acciones a realizar después de la actualización</title>

<section>
<title>Paquetes que debe eliminar después de la actualización</title>
<body>

<p>
KDE SC 4.6 no se apoya en HAL. Debido a que se ha descartado HAL y éste
interfiere con los nuevos mecanismos de acceso al hardware, debe ser
eliminado después de la actualización. Detenga el demonio HAL y
desinstálelo, al igual que los ahora obsoletos devicekit y policykit (si
algunos de estos paquetes no estaban instalados, la situación es correcta
igualmente):
</p>

<pre caption="Parando y desistalando HAL y asociados">
# <i>/etc/init.d/hald stop</i>
# <i>emerge -cav hal hal-info policykit devicekit devicekit-disks devicekit-power</i>
</pre>

<p>
Observe que está eliminando el antiguo <b>policykit</b>, su sucesor es
<b>polkit</b>. Este cambio debería ser transparente (y de hecho el ajuste
USE continúa llamándose <b>policykit</b>, no se confunda con esto).
</p>

<p>
Si llegado a este punto, observa un mensaje indicando que hal no puede ser
desinstalado debido a que algunos paquetes lo necesitan, por favor,
compruebe qué paquetes son los que lo necesitan. Esto se considera un
fallo de estos paquetes y debe ser reportado y corregido, ya que hal
pronto será eliminado. Por favor, considere desinstalar los paquetes que
necesitan HAL, o actualícelos a una versión correcta que no necesite
hal.
</p>

<p>
Para terminar, cuando se ha eliminado hal, puede igualmente eliminar su
guión de arranque del nivel de ejecución por defecto:
</p>

<pre caption="Eliminando el guión de arranque hald de los niveles de ejecución">
# <i>rc-update del hald</i>
</pre>

<p>
Para asegurarse completamente de que hal nunca vuelva por accidente, puede
añadir una entrada al fichero package.mask:
</p>

<pre caption="/etc/portage/package.mask">
sys-apps/hal
</pre>

<p>
Además, si ha añadido soporte para estos paquetes, puede que tenga que
añadir consolekit y dbus al nivel de ejecución por defecto:
</p>

<pre caption="Añadiendo los guiones de inicio de consolekit y dbus al nivel de ejecución por defecto">
# <i>rc-update add dbus default</i>
# <i>rc-update add consolekit default</i>
</pre>

<p>
Si configura su propio núcleo, entonces querrá instalar un nuevo núcleo con
las siguientes opciones:
</p>

<pre caption="Ajustes del núcleo recomendados">
CONFIG_USB_SUSPEND=y
CONFIG_IDE=n
CONFIG_AUDITSYSCALL=y
</pre>

<p>
Ahora, puede que quiera reiniciar su sistema (para eliminar los restos de
hal, tener el nuevo núcleo y arrancar consolekit etc).
</p>

</body>
</section>
<section>
<title>Paquetes que debe actualizar</title>
<body>

<p>
Algunas aplicaciones desarrolladas para KDE SC 4.4 no compilarán
correctamente con KDE SC 4.6. Además, las nuevas versiones de las
aplicaciones puede que necesiten KDE SC 4.6 para sus nuevas características
y no funcionarán con KDE SC 4.4...
Intentamos estabilizar nuevas versiones con KDE SC 4.6 de forma que nadie
tenga estos problemas. En caso de dudas, abajo se muestra información
relevante para una comparativa.
</p>

<table>
  <tr>
    <th>Nombre del paquete</th>
    <th>Versión máxima para KDE 4.4</th>
    <th>Versión mínima para KDE 4.6</th>
  </tr>
  <tr>
    <ti>media-gfx/digikam</ti>
    <ti>1.2</ti>
    <ti></ti>
  </tr>
  <tr>
    <ti>media-plugins/kipi-plugins</ti>
    <ti>1.2</ti>
    <ti></ti>
  </tr>
  <tr>
    <ti>app-office/koffice-libs</ti>
    <ti>2.2.2</ti>
    <ti>2.3.2</ti>
  </tr>
</table>

</body>
</section>
</chapter>

<chapter>
<title>Posibles problemas una vez finalizada la actualización</title>

<section>
<title>Elimine la ventana de la herramienta de migración KResource</title>
<body>

<p>
Se ha informado de que la ventana de la herramienta de migración KResource
(KResource Migration Tool) aparece cada vez que se ingresa en el sistema.
No hay todavía una solución del todo correcta para esto, pero puede ver
una forma de resolverlo en <uri link="https://bugs.gentoo.org/353200">
la incidencia 353200</uri>.
</p>

</body>
</section>

<section>
<title>Reconstruyendo la base de datos de aplicaciones</title>
<body>

<p>
Si su KMenu no muestra ninguna aplicación, probablemente necesitará
reconstruir la caché de configuración de KDE. Esto también servirá para
corregir cualquier problema relacionado con KMenu, por ejemplo la
desaparición de los iconos.
Ejecute el siguiente comando con la cuenta de usuario que tenga estos
problemas:
</p>

<pre caption="Comando kbuildsycoca">
$ <i>kbuildsycoca4 --noincremental</i>
</pre>

</body>
</section>

<section>
<title>Doble hibernación o fallo después de la hibernación (incidencia 363363)</title>
<body>

<p>
KDE 4.6 gestiona los eventos del "botón de suspensión" por si mismo y el
sistema hiberna de forma correcta. Si ha configurado manualmente otros
programas para gestionar estos eventos (por ejemplo acpid) por favor,
desactívelos, o de lo contrario puede obtener una doble hibernación y/o
inestabilidad en su sistema.
</p>

</body>
</section>
</chapter>
</guide>

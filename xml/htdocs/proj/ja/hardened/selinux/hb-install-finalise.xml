<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/ja/hardened/selinux/Attic/hb-install-finalise.xml,v 1.1 2005/09/06 16:34:20 idani Exp $ -->

<!-- Original revision: 1.1 -->

<sections>
<section>
<title>最後の再ラベル</title>
<subsection>
<body>
<p>
Gentooが再起動したら、ほぼ確実に、いくらかのファイルが先ほどの再ラベル付けと再起動後とで変更されています。
全てのデーモンとプロセスが正しく動作することを確実にするために、もう一度再ラベルを行わなければなりません。
</p>
<pre caption="2回目のファイルシステムの再ラベル付け">
# <i>cd /etc/security/selinux/src/policy</i>
# <i>make relabel</i>
</pre>
</body>
</subsection>
</section>

<section>
<title>ユーザ管理</title>
<subsection>
<title>日常作業で使用するためのユーザを追加</title>
<body>

<p>
Unix/Linux システム上で、rootユーザで作業するのは<e>危険</e>であり、できるだけ避けるべきです。したがって、日常作業で使用するためのユーザを追加することが<e>強く</e>推奨されます。
</p>

<p>
例えば、<c>wheel</c>グループ(<c>su</c>を使ってrootになることができる)、<c>users</c>グループ(全てのユーザのデフォルト)そして<c>audio</c>グループ(オーディオデバイスを使用することができる)に所属する<c>john</c>というユーザを作るときには、まずrootでログインします(rootだけがユーザを作ることができます)。
</p>

<pre caption="日常作業で使用するためのユーザを作成">
Login: <i>root</i>
Password: <comment>(rootのパスワード)</comment>

# <i>useradd john -m -G users,wheel,audio,tty -s /bin/bash</i>
# <i>passwd john</i>
Password: <comment>(johnのパスワードを入力)</comment>
Re-enter password: <comment>(確認のため再度パスワードを入力)</comment>
</pre>

<p>
もしこのユーザがrootとして作業する必要があれば、一時的にroot権限を持つために<c>su -</c>を使うことができます。
また、<c>sudo</c>パッケージを使うこともできます。これは正しく設定されていればとても安全な方法です。
ユーザは<c>staff_r</c>と<c>sysadm_r</c> roleにも追加されなければなりません。
ユーザファイル(/etc/security/selinux/src/policy/users)を編集し、以下の行(例として上記ユーザを使用)を追加しなければなりません。
</p>

<pre caption="ユーザにroleを追加">
user john roles { staff_r sysadm_r };
</pre>

<p>
これが効果を現すために、ポリシーがロードされなければなりません。
詳しい情報は<uri link="?part=4&amp;chap=1#doc_chap3">SELinuxの概観</uri>を参照してください。
</p>

</body>
</subsection>
</section>
<section>
<title>自由選択: GRPパッケージのインストール</title>
<body>

<impo>
この部分の対象はGRPユーザのみです。他のユーザはこの部分を飛ばして、<uri link="?part=1&amp;chap=12">これからどうすればいいの？</uri>に進んでください。
</impo>

<p>

あなたのシステムが立ち上がったら、あなたが作成したユーザ(例えば<c>john</c>)としてログオンし、<c>su -</c>でroot権限を取得してください。
</p>

<pre caption="root権限を取得">
$ <i>newrole -r sysadm_r</i>
Authenticating john.
Password: <comment>(johnのパスワードを入力)</comment>
$ <i>su -</i>
Password: <comment>(rootのパスワードを入力)</comment>
</pre>

<p>

2枚目のCD (Gentoo Packages CD) からビルド済バイナリを探すように、Portageの設定を変更する必要があります。
まずこのCDをマウントします。
</p>

<pre caption="Packages CDをマウント">
<comment>(CDトレーにPackages CD を乗せます)</comment>
# <i>mount /mnt/cdrom</i>
</pre>

<p>

ビルド済パッケージを見つけるために<path>/mnt/cdrom</path>を使うように、Portageを設定します。
</p>

<pre caption="/mnt/cdromを使うように、Portageを設定">
# <i>ls /mnt/cdrom</i>

<comment>(/mnt/cdrom/packagesディレクトリが存在する場合)</comment>
# <i>export PKGDIR="/mnt/cdrom/packages"</i>

<comment>(その他の場合)</comment>
# <i>export PKGDIR="/mnt/cdrom"</i>
</pre>

<p>
これで好きなパッケージをインストールすることができます。Packages CDにはビルド済バイナリが収録されています。
例えばKDEをインストールするには、以下のコマンドを実行します。
</p>

<pre caption="Installing KDE">
# <i>emerge --usepkg kde</i>
</pre>

<p>

バイナリを今インストールするようにしてください。<c>emerge sync</c>してPortageをアップデートしてしまうと(具体的な手順は後で出てきます)、アップデートされたPortageの中のebuildとビルド済バイナリとが合わなくなる可能性があります。
<c>emerge --usepkg</c>のかわりに<c>emerge --usepkgonly</c>を使えば、この問題を回避できるかもしれません。
</p>

<p>

おめでとうございます。あなたのシステムは完成です！Gentooについてさらに知るためには、<uri link="?part=1&amp;chap=12">これからどうすればいいの？</uri>を読んでください。
</p>

</body>
</section>
</sections>

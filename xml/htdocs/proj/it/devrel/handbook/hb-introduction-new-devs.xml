<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/1.0 -->


<sections>
<section>
<title>Utilizzo del CVS</title>
<subsection>
<title>Introduzione</title>
<body>

<p>
Questa guida non è intesa per essere un manuale sull'utilizzo del CVS; per questo guarda la pagina delle informazioni sul CVS oppure <uri>http://www.gentoo.org/doc/it/cvs-tutorial.xml</uri>.
Questa guida mira specialmente sull'uso del CVS e del Repoman nell'ebuild tree di Gentoo. 
</p>

</body>
</subsection>
<subsection>
<title>Configurazione</title>
<body>

<p>
Tipicamente, nel tuo <path>~/.cvsrc</path> dovrai avere qualcosa del genere:
</p>

<pre caption="~/.cvsrc">
cvs -q -z0
diff -u -B
checkout -P
update -d -P
</pre>

<p>
Per essere sicuri che i digests sono corretti, per favore metti <c>cvs</c> nelle tue impostazioni <c>FEATURES</c>.
</p>

<p>
Da ultimo, ad alcune persone che usano il CVS piace usare la compressione (-z#). Chiediamo agli sviluppatori che non hanno una connessione dialup di usare per favore -z0 - con il contenuto del nostro repository CVS ed il caricamento sul nostro server CVS, in quanto vi è un <e>incremento</e> della velocità senza compressione.  
</p>

</body>
</subsection>

<subsection>
<title>Controlli</title>
<body>

<p>
Ci sono molti moduli utili nel repository del CVS di Gentoo. Gli ebuils sono tenuti nel modulo <path>gentoo-x86</path>. <path>gentoo-src</path> contiene diversi progetti - alcuni utili, alcuni inattivi. <path>gentoo</path> contiene gli XML per il sito web, documentazione, cartelle degli sviluppatori, immagini per gli sviluppatori e altro ancora.
</p>

<pre caption="Controllo di gentoo-x86">
# cvs -d username@cvs.gentoo.org:/var/cvsroot co gentoo-x86
</pre>

<p>
Ogni volta, prima di lavorare con il tree, è sempre una buona idea di fare un'aggiornamento per controllare i cambiamenti e prevenire conflitti. Puoi aggiornare ogni singola sottocartella del tree se non vuoi fare un aggiornamento completo, ma ogni tanto è buona prassi aggiornare tutto il tree:
</p>
		
<pre caption="Aggiornamento di gentoo-x86">
# cd gentoo-x86
# cvs update
</pre>

</body>
</subsection>

<subsection>
<title>Aggiornamento del portage</title>
<body>

<p>
Se vuoi usare il CVS come tuo Portage tree primario, puoi aggiungere le seguenti linee al tuo <path>/etc/make.conf</path>, rimpiazzando <c>you</c> con il tuo nome utente:
</p>

<pre caption="Cambiamenti al /etc/make.conf per usare il CVS">
SYNC="cvs://you@cvs.gentoo.org:/var/cvsroot"
CVSROOT=":ext:you@cvs.gentoo.org:/var/cvsroot"
</pre>

<p>
Quando vuoi usare il CVS come tuo Portage tree primario o non, devi assicurarti che <c>cvs</c> sia nelle tue <c>FEATURES</c> in <path>/etc/make.conf</path>. Questo assicura che il Portage scarica tutti i files e le referenze agli ebuild nel suo <c>SRC_URI</c> quando fai un digest.
</p>

<p>
Puoi aggiungere <c>digest</c> nelle tue <c>FEATURES</c>, lasciando creare automaticamente al Portage nuovi digest. Puoi anche aggiungere <c>autoaddcvs</c> così <c>repoman</c>, il tool con cui committerai gli ebuilds, automaticamente aggiungerà per te i digests mancanti nel CVS. 
</p>

<p>
Nelle architetture supportate, devi anche avere <c>sandbox</c> nelle tue <c>FEATURES</c> per assicurarti che gli ebuilds non modificano direttamente il filesystem root.
</p>

</body>
</subsection>

<subsection>
<title>Aggiungere/Rimuovere</title>
<body>

<p>
Ammettiamo che sei pronto per aggiungere un nuovo pacchetto, <c>foo</c>, in app-misc:
</p>

<pre>
<comment>(Sostituisci CVSROOT con il percorso del tuo CVS tree da controllare.)</comment>
# cd $CVSROOT/app-misc
<comment>(Aggiornare sempre prima di lavorare in una parte del CVS tree!)</comment>
# cvs update
# mkdir foo
<comment>(Qui, aggiungiamo al repository CVS la directory per il pacchetto foo .)</comment>
# cvs add foo
# cd foo
<comment>(È meglio mantenere le varie versioni in progresso degli ebuilds in un percorso diverso da quello del tree CVS.)</comment>
# cp /path/to/foo-1.0.ebuild ./
<comment>[Non dimenticarsi di creare un ChangeLog - guarda la pagina del manuale per echangelog.]</comment>
<comment>(Assicurati che PORTDIR_OVERLAY è impostato alla directory del CVS quando crei i digests.)</comment>
# ebuild foo-1.0.ebuild digest
# cvs add foo-1.0.ebuild ChangeLog files
<comment>(FEATURES=autoaddcvs fa questo per te...)</comment>
# cvs add files/digest-foo-1.0
</pre>

<p>
Ricordati anche di aggiungere un file metadata.xml con le informazioni per il mantenimento. Guarda la sezione <uri link="?part=2&amp;chap=4">Gentoo
Metadata</uri> per maggiori informazioni.
</p>

<p>
A questo punto, sei pronto per committare (guarda la sezione Commits più sotto). Ma se vuoi rimuovere foo-1.0 per mettere foo-1.1?
</p>

<pre>
# cd CVSROOT/app-misc/foo
# cvs update
# rm foo-1.0.ebuild files/digest-foo-1.0 <comment>(Prima i files devono essere eliminati...)</comment>
# cvs remove foo-1.0.ebuild files/digest-foo-1.0
</pre>

<p>
E adesso dei pronto per committare (guarda la sezione Commits più sotto).
</p>

</body>
</subsection>
<subsection>
<title>Commits</title>
<body>

<p>
Usa sempre <c>repoman commit</c> piuttosto che <c>cvs commit</c>. Repoman è un'utility di qualità (QA) che ottimizza controlli base e crea Manifest. Se una qualsiasi parte dell'ouput di repoman non è chiara, guarda <c>man repoman</c>. In più, se sei stanco di digitare la tua passphrase ripetutamente, può aiutarti keychain (<uri>http://www.gentoo.org/proj/en/keychain.xml</uri>).
</p>
		
<pre>
<comment>[Assicurati che non ci sono files appartenenti a root prima di avviare repoman!]</comment>
<comment>("scan" percorre la directory corrente per gli scopi di QA. "full" è più completo.)</comment>
# repoman scan
<comment>("commit" esegue uno scan, poi committa, intanto aggiorna anche i digests. Assicurati di aggiungere un messaggio utile e dettagliato al ChangeLog del CVS...)</comment>
# repoman commit
</pre>

</body>
</subsection>
</section>

<section>
<title>Informazioni varie</title>
<subsection>
<title>Trasmettere files su un mirrors</title>
<body>

<p>
La procedura per aggiungere un nuovo distfiles in un mirror di Gentoo è veramente semplice: copialo nella directory <path>/space/distfiles-local</path> su <path>dev.gentoo.org</path>.
</p>

</body>
</subsection>
<subsection>
<title>Mail</title>
<body>

<p>
La nostra infrastruttura permette agli sviluppatori di gestire le loro email. <uri>http://www.gentoo.org/proj/en/infrastructure/dev-email.xml</uri> contiene le istruzioni per come configurare il tuo email gentoo.org.
</p>

</body>
</subsection>
</section>
</sections>

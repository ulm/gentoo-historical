<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sections SYSTEM "/dtd/book.dtd">

<!-- $Header: /var/cvsroot/gentoo/xml/htdocs/proj/it/devrel/handbook/Attic/hb-guide-metadata.xml,v 1.6 2008/02/28 20:52:42 scen Exp $ -->

<!-- The content of this document is licensed under the CC-BY-SA license -->
<!-- See http://creativecommons.org/licenses/by-sa/2.5 -->

<!-- This document was last synced to:
     cvs://gentoo/gentoo/xml/htdocs/doc/en/metadata.xml :: R1.4.  -->

<sections>
<version>1.0.4</version>
<date>2007-07-31</date>

<section>
<title>Perché c'è il bisogno di metadata.xml</title>
<subsection>
<body>

<p>
Il file <c>metadata.xml</c> ha lo scopo di fornire informazioni extra sugli
ebuild. il file <c>metadata.xml</c> dovrebbe esistere nella directory di ogni
pacchetto. Un file 'scheletro' può essere trovato come <c>skel.metadata.xml</c>
nel portage tree.
</p>

<note>
Si prega di eseguire <c>xmllint --valid metadata.xml</c> prima di sottoporre un
file <c>metadata.xml</c>. Gli sviluppatori sperano di aggiungere presto a
repoman il supporto per <c>metadata.xml</c>.
</note>

</body>
</subsection>
</section>

<section>
<title>Struttura di Metadata</title>
<subsection>
<body>

<p>
Un file <c>metadata.xml</c> può contenere un certo numero di tag:
</p>

<table>
<tr>
  <th>tag</th>
  <th>descrizione</th>
</tr>
<tr>
  <ti><brite>&lt;pkgmetadata&gt;</brite></ti>
  <ti>
    Questo è l'elemento principale del file metadata.xml per i pacchetti. Non ha
    attributi. Il sottotag che richiede è: <brite>&lt;herd&gt;</brite>.
    Inoltre sono consentiti i seguenti tag: <brite>&lt;email&gt;</brite> per
    un'indirizzo email generico del gruppo, <brite>&lt;maintainer&gt;</brite>, e
    <brite>&lt;longdescription&gt;</brite>.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;catmetadata&gt;</brite></ti>
  <ti>
    Questo è l'elemento principale del file metadata.xml per le categorie, in
    base a <uri link="/proj/en/glep/glep-0034.html">GLEP 34</uri>. Non ha
    attributi, e contiene un certo numero di tag
    <brite>&lt;longdescription&gt;</brite>, ognuno per ogni lingua differente.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;herd&gt;</brite></ti>
  <ti>
    Ci deve essere almeno un sottotag 'herd' (ndT 'gruppo', nel resto della
    guida verrà utilizzata questo termine). Il contenuto di questo tag deve
    corrispondere al nome di un gruppo così come specificato nel file <uri
    link="http://sources.gentoo.org/viewcvs.py/*checkout*/gentoo/xml/htdocs/proj/en/metastructure/herds/herds.xml?content-type=text/plain&amp;rev=HEAD">herds.xml</uri>.
    oppure all'herd "no-herd". Deve essere presente almeno una volta.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;maintainer&gt;</brite></ti>
  <ti>
    Oltre ad appartenere ad un gruppo, un pacchetto deve poter essere mantenuto
    direttamente. I responsabili di un pacchetto devono essere specificati con
    il tag <brite>&lt;maintainer&gt;</brite>. Questo tag richiede un sottotag:
    <brite>&lt;email&gt;</brite>. Ha due sottotag opzionali:
    <brite>&lt;name&gt;</brite>, e <brite>&lt;description&gt;</brite>.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;email&gt;</brite></ti>
  <ti>
    Contiene l'indirizzo e-mail del responsabile del pacchetto. E'
    obbligatorio.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;name&gt;</brite></ti>
  <ti>
    Contiene del testo libero con il nome del responsabile del pacchetto. E'
    opzionale.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;description&gt;</brite></ti>
  <ti>
    Questo tag contiene una descrizione dello stato del pacchetto, o per esempio
    una nota indicante che se qualcuno è interessato può farsi carico del
    mantenimento del pacchetto. E' opzionale.
  </ti>
</tr>
<tr>
  <ti><brite>&lt;longdescription&gt;</brite></ti>
  <ti>
    Questo tag contiene una descrizione del pacchetto. Questo per aumentare il
    campo DESCRIPTION negli ebuild.
  </ti>
</tr>
</table>

<p>
Ci sono anche degli attributi che possono essere usati con questi tag. Sono
tutti opzionali:
</p>

<table>
<tr>
  <th>attributo</th>
  <th>tag</th>
  <th>descrizione</th>
</tr>
<tr>
  <ti>lang</ti>
  <ti>
    <brite>&lt;description&gt;</brite>,<brite>&lt;longdescription&gt;</brite>
  </ti>
  <ti>
    In ogni caso in cui sia richiesta una descrizione, ci deve essere
    <e>almeno</e> una descrizione in inglese. Se viene fornita una descrizione
    aggiuntiva in un'altra lingua, questo attributo viene utilizzato per
    specificare la lingua utilizzata. Il formato è quello di un codice a due
    caratteri in base alla lingua, come definito nella norma <uri
    link="http://www.w3.org/WAI/ER/IG/ert/iso639.htm#2letter">ISO-639-1</uri>.
  </ti>
</tr>
<tr>
  <ti>restrict</ti>
  <ti>
    <brite>&lt;herd&gt;</brite>,
    <brite>&lt;maintainer&gt;</brite>, <brite>&lt;longdescription&gt;</brite>
  </ti>
  <ti>
    L'attributo restrict permette di limitare l'applicazione di alcuni tag a
    determinate versioni del pacchetto. Quando questo attributo è utilizzato,
    deve esistere anche un tag senza questo attributo. Il tag senza l'attributo
    restrict verrà utilizzato come predefinito. Il formato dell'attributo
    restrict è quello della flag DEPEND, eccetto che per "&lt;" e per "&gt;"
    che devono essere specificati da &amp;lt; e &amp;gt;.<br />
    <br/>
    Ad esempio nel pacchetto db <c>restrict="&gt;=sys-libs/db-3.2.9-r5"</c>
    nel tag maintainer mostra che si stanno attualmente mantenendo tutte le
    versioni maggiori della 3.2.9-r5.
  </ti>
</tr>
</table>

</body>
</subsection>
</section>

<section>
<title>Esempi di Metadata</title>
<subsection>
<title>Primo Esempio</title>
<body>

<p>
Nel primo esempio viene mostrato il <path>metadata.xml</path> di OpenOffice i
cui ebuild sono completamente gestiti da un gruppo chiamato <c>openoffice</c>:
</p>

<pre caption="Pacchetto mantenuto da un gruppo">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE pkgmetadata SYSTEM "/dtd/metadata.dtd"&gt;
&lt;pkgmetadata&gt;
  &lt;herd&gt;openoffice&lt;/herd&gt;
  &lt;longdescription&gt;
    OpenOffice is the  opensource version of staroffice.
    This ebuild allows you to compile it yourself. Unfortunately this
    compilation can take up to a day depending on the speed of your computer.
    It will however make a snappier openoffice than the binary version.
  &lt;/longdescription&gt;
&lt;/pkgmetadata&gt;
</pre>

<p>
Il gruppo <c>openoffice</c> è definito nel file <path>herds.xml</path> dal
<uri link="/proj/en/metastructure">Gentoo Metastructure Project</uri>:
</p>

<note>
Questo esempio potrà essere sorpassato quando verrà letto. E' solo un'esempio.
</note>

<pre caption="Esempio Gruppo OpenOffice">
&lt;herd&gt;
  &lt;name&gt;openoffice&lt;/name&gt;
  &lt;email&gt;openoffice@gentoo.org&lt;/email&gt;
  &lt;description&gt;openoffice related packages&lt;/description&gt;
  &lt;maintainer&gt;&lt;email&gt;pauldv@gentoo.org&lt;/email&gt;&lt;/maintainer&gt;
  &lt;maintainer&gt;&lt;email&gt;brad@gentoo.org&lt;/email&gt;&lt;/maintainer&gt;
&lt;/herd&gt;
</pre>

<p>
Se ci si vuole aggiungere (o togliere) da un gruppo, modificare il file
<path>herds.xml</path> che si trova in
<path>[gentoo]/xml/htdocs/proj/en/metastructure/herds</path> nel repository
CVS di Gentoo. Assicurarsi di conoscere l'alias e-mail corrispondente al gruppo
(ad esempio il gruppo "sound" ha <mail
link="sound@gentoo.org">sound@gentoo.org</mail>) e aggiungersi all'alias
(modificando <path>/var/mail/alias/misc/&lt;nome alias&gt;</path> su
dev.gentoo.org).
</p>

</body>
</subsection>
<subsection>
<title>Secondo Esempio</title>
<body>

<p>
Come secondo esempio viene proposto il <path>metadata.xml</path> di
<c>mirrorselect</c>. Questo ebuild è mantenuto dal gruppo <c>tools-portage</c>,
ma ha un mantenitore distinto.
</p>

<pre caption="Pacchetto appartenente ad un Gruppo ma con Mantenitore distinto">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd"&gt;
&lt;pkgmetadata&gt;
  &lt;herd&gt;tools-portage&lt;/herd&gt;
  &lt;maintainer&gt;
    &lt;email&gt;johnm@gentoo.org&lt;/email&gt;
    &lt;name&gt;John Mylchreest&lt;/name&gt;
  &lt;/maintainer&gt;
  &lt;longdescription&gt;
    This utility is used to select the fastest mirror (distfiles) and provide a
    nicer front-end for mirror selection (both rsync + distfiles) to a user.
  &lt;/longdescription&gt;
&lt;/pkgmetadata&gt;
</pre>

</body>
</subsection>
</section>
</sections>
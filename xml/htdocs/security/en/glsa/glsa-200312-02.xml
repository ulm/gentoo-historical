<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE glsa SYSTEM "http://www.gentoo.org/dtd/glsa.dtd">
<?xml-stylesheet href="/xsl/glsa.xsl" type="text/xsl"?>
<?xml-stylesheet href="/xsl/guide.xsl" type="text/xsl"?>

<glsa id="200312-02">
  <title>Linux kernel: do_brk() local privilege escalation vulnerability</title>
  <synopsis>
    A flaw in the do_brk() function of the Linux kernel 2.4.22 and earlier can
    be exploited by local users or malicious services to gain root privileges.
  </synopsis>
  <product type="ebuild">Kernel</product>
  <announced>2003-12-04</announced>
  <revised>2003-12-04: 01</revised>
  <bug>34844</bug>
  <access>local</access>
  <affected>
    <package name="aa-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.23_pre6-r3</unaffected>
      <vulnerable range="lt">2.4.23_pre6-r3</vulnerable>
    </package>
    <package name="ck-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r3</unaffected>
      <vulnerable range="lt">2.4.22-r3</vulnerable>
    </package>
    <package name="gentoo-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.20-r9</unaffected>
      <vulnerable range="lt">2.4.20-r9</vulnerable>
    </package>
    <package name="gentoo-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r1</unaffected>
      <vulnerable range="lt">2.4.22-r1</vulnerable>
    </package>
    <package name="grsec-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22.1.9.12-r1</unaffected>
      <vulnerable range="lt">2.4.22.1.9.12-r1</vulnerable>
    </package>
    <package name="grsec-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22.2.0_rc3-r1</unaffected>
      <vulnerable range="lt">2.4.22.2.0_rc3-r1</vulnerable>
    </package>
    <package name="gs-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.23_pre8-r1</unaffected>
      <vulnerable range="lt">2.4.23_pre8-r1</vulnerable>
    </package>
    <package name="hardened-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r1</unaffected>
      <vulnerable range="lt">2.4.22-r1</vulnerable>
    </package>
    <package name="hardened-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r1</unaffected>
      <vulnerable range="lt">2.4.22-r1</vulnerable>
    </package>
    <package name="ia64-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r1</unaffected>
      <vulnerable range="lt">2.4.22-r1</vulnerable>
    </package>
    <package name="mips-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r4</unaffected>
      <vulnerable range="lt">2.4.22-r4</vulnerable>
    </package>
    <package name="mips-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r5</unaffected>
      <vulnerable range="lt">2.4.22-r5</vulnerable>
    </package>
    <package name="openmosix-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r1</unaffected>
      <vulnerable range="lt">2.4.22-r1</vulnerable>
    </package>
    <package name="ppc-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r3</unaffected>
      <vulnerable range="lt">2.4.22-r3</vulnerable>
    </package>
    <package name="ppc-sources-benh" auto="yes" arch="*">
      <unaffected range="ge">2.4.20-r9</unaffected>
      <vulnerable range="lt">2.4.20-r9</vulnerable>
    </package>
    <package name="ppc-sources-benh" auto="yes" arch="*">
      <unaffected range="ge">2.4.21-r2</unaffected>
      <vulnerable range="lt">2.4.21-r2</vulnerable>
    </package>
    <package name="ppc-sources-benh" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r3</unaffected>
      <vulnerable range="lt">2.4.22-r3</vulnerable>
    </package>
    <package name="ppc-sources-crypto" auto="yes" arch="*">
      <unaffected range="ge">2.4.20-r1</unaffected>
      <vulnerable range="lt">2.4.20-r1</vulnerable>
    </package>
    <package name="selinux-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.21-r5</unaffected>
      <vulnerable range="lt">2.4.21-r5</vulnerable>
    </package>
    <package name="sparc-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.23</unaffected>
      <vulnerable range="lt">2.4.23</vulnerable>
    </package>
    <package name="usermode-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.22-r1</unaffected>
      <vulnerable range="lt">2.4.22-r1</vulnerable>
    </package>
    <package name="wolk-sources" auto="yes" arch="*">
      <unaffected range="ge">4.10_pre7-r1</unaffected>
      <vulnerable range="lt">4.10_pre7-r1</vulnerable>
    </package>
    <package name="wolk-sources" auto="yes" arch="*">
      <unaffected range="ge">4.9-r2</unaffected>
      <vulnerable range="lt">4.9-r2</vulnerable>
    </package>
    <package name="xfs-sources" auto="yes" arch="*">
      <unaffected range="ge">2.4.20-r4</unaffected>
      <vulnerable range="lt">2.4.20-r4</vulnerable>
    </package>
  </affected>
  <background>
    <p>
    The Linux kernel is responsible for memory management in a working system.
    </p>
  </background>
  <description>
    <p>
    Lack of proper bounds checking exists in the do_brk() kernel function in
    Linux kernels prior to 2.4.23.  This bug can be used to give a userland
    program or malicious service access to the full kernel address space and
    gain root privileges.  This issue is known to be exploitable.
    </p>
    <p>
    All kernel ebuilds in Portage have been bumped or patched and do not contain
    this vulnerability.
    </p>
  </description>
  <impact type="high">
    <p>
    A userland program or malicious service can gain access to the full kernel
    address space gain root privileges.
    </p>
  </impact>
  <workaround>
    <p>
    There is no known workaround at this time.
    </p>
  </workaround>
  <resolution>
    <p>
    It is recommended that all Gentoo Linux users upgrade their machines to use
    the latest stable version of their preferred kernel sources.
    </p>
    <code>
    # emerge sync
    # emerge -pv [your preferred kernel sources]
    # emerge [your preferred kernel sources]
    # [update the /usr/src/linux symlink]
    # [compile and install your new kernel]
    # [emerge any necessary kernel module ebuilds]
    # [reboot]</code>
  </resolution>
  <references>
    <uri link="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0961">CAN-2003-0961</uri>
  </references>
</glsa>

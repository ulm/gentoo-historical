# ChangeLog for Gentoo Linux Installer
# Copyright 2005 Gentoo Technologies, Inc.
# $Header: /var/cvsroot/gentoo/src/installer/ChangeLog,v 1.293 2005/07/24 20:35:37 agaffney Exp $

*GLI-0.1_alpha (4 Apr 2005)

  24 Jul 2005; Andrew Gaffney <agaffney@gentoo.org>
  Add _dynamic_stage3 option to IP.
  Add check for that option to dynamic stage3 code in ArchTemplate.

  24 Jul 2005; Preston Cody <codeman@gentoo.org>
  changed default values of cron/logger in IP.
  moved GenDialog IP init out to the individual files.  gli-dialog's version
    will change quite a bit.
  
  22 Jul 2005; Preston Cody <codeman@gentoo.org>
  added ppcArchTemplate.  blank now. working on yaboot.
  modified ArchTemplate for amd64 and ppc custom kernels.
  skeleton implementation of _configure_yaboot.
  small fixes to other templates.

  21 Jul 2005; Preston Cody <codeman@gentoo.org>
  GenDialog updates. changed comment in IP.
  
  07 Jul 2005; Robin H. Johnson <robbat2@gentoo.org> 
  src/GLIInstallProfile.py:
  Fix codeman's screwup of changing the service seperator to ',' in the parser
  without changing it in the serialization code! Also document this in a
  comment so you find it easier. Everybody needs to make sure they update
  their install profiles!

  07 Jul 2005; Robin H. Johnson <robbat2@gentoo.org> 
  src/GLIArchitectureTemplate.py:
  Fix casting of list to string and concat of None with string, as well as
  commented prototype of checking that mounting actually worked (found a case
  where mount can return success, but the mount won't be done).

  07 Jul 2005; Robin H. Johnson <robbat2@gentoo.org> 
  src/templates/x86ArchitectureTemplate.py:
  Remove TEMP UGLY HACK of time.sleep(5), and replace it with a while loop
  checking for the device, and sleeping 1 second each time.

  07 Jul 2005; Robin H. Johnson <robbat2@gentoo.org> 
  src/templates/x86ArchitectureTemplate.py:
  Refactor install_bootloader code and _install_{grub,lilo} so that 'none' for
  bootloader works again. Also rename _install_{grub,lilo} to
  _configure_{grub,lilo} since they don't install the loaders anymore
  themselves.

  7 Jul 2005; Preston Cody <codeman@gentoo.org>
  fix global USE flags to not include the arch types at the end.
  updates to GenDialog and gli-d.
  
  6 Jul 2005; Preston Cody <codeman@gentoo.org>
  fixing bootloader code for no initrd and initrd->initramfs naming change.
  
  6 Jul 2005; Andrew Gaffney <agaffney@gentoo.org>
  Proper comments and parameters to GLIException in install_mta()
  Allow optional exclusion of HTTP, FTP, and/or RSYNC mirrors in list_mirrors()
  Add strip() to list_mirrors(), list_subarch_from_mirror() and
  list_tarball_from_mirror() to eliminate blank last item.

  5 Jul 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added stage3 generation code.

  5 Jul 2005; Preston Cody <codeman@gentoo.org>
  Added sleep(5) to partitioning code, temp got rid of the NOCOLOR in _emerge
  Mild changes to GenDialog.
  
  30 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Remove separate install step configure_rc_conf() since it's handled by
  update_config_files()
  Make a copy of newvalues in _edit_config() so quotes aren't added when the
  function is called twice on the same file.

  29 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Missing \ in sed in _get_packages_to_emerge()
  Removed explicit emerging of hotplug and no longer add it to the runlevel.
  Check in _quickpkg_deps() to ignore blank package names returned from
  _get_packages_to_emerge()

  28 Jun 2005; Preston Cody <codeman@gentoo.org>
  fixed agaffney's missing = and extra : in x86AT. commented out crashing line
  in the dialog.py gauge code.
  
  28 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Add code to update_config_files() to go through etc_files and update stuff.
  Check to see that _etc_files['make.conf'] exists in get_make_conf()
  Only use float() in partition xml parsing code if type == "free"

  28 Jun 2005; Preston Cody <codeman@gentoo.org>
  finished almost all internationalization of GenDialog.
  attempt at fixing rc.conf function. moved 3 generate functions out of 
  fe/gtk/RcDotConf and put them in Utility. fixed self bug.
  added dialog.py to the fe/dialog directory so it actually gets used.
  
  27 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Roll rc_conf and make_conf into master etc_files structure in InstallProfile.

  27 Jun 2005; Preston Cody <codeman@gentoo.org>
  fix extra entry in list_mirrors()
  beginning internationalization runthrough.
  
  26 Jun 2005; Preston Cody <codeman@gentoo.org>
  added dialog.py to /src temporarily until it gets accepted upstream.
  fix for unused value in form in dialog.py and changed heights.
  fix GenDialog forms.

  25 Jun 2005; Preston Cody <codeman@gentoo.org>
  Changed hostname/domainname for new baselayout.
  Changed _add_to_runlevel errors to logs.
  Updated TODO list to show status of GenDialog
  More updates to GenDialog including two checklists that probably won't work.
  update IP to use comma-separated list instead of space separated for services.

  24 Jun 2005; Preston Cody <codeman@gentoo.org>
  Add dhcp_options to the CC, CConfig, and GenDialog.  More overall changes to
  GenDialog as it gets closer to completion.
  
  22 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Modify get_eth_info() to take a full interface name (eth0 fex). float()
  instead of int() in add_partition_device_partition() for minor (closes 96804)

  21 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changed setup_network_post to check for 'interfaces[interface][0] != "dhcp"'
  instead of 'interfaces[interface][1]' since DHCP uses that field for its
  options. setup_network_post() writes custom DHCP options to /etc/conf.d/net.

  20 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Apply spawn() patch from #96644 (with minor changes). Make sure the return
  value from all spawn() calls is checked with GLIUtility.exitsuccess(). Fix
  small error with <pipe>.close() returning None. Fix space vs. tab issue.
  Fix undefined variable 'output' issue in spawn().

  20 Jun 2005; Preston Cody <codeman@gentoo.org>
  More updates to GenDialog and gli-d.
  
  19 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Modify list_mirrors() to return a list of mirror URL/name pairs.

  19 Jun 2005; Preston Cody <codeman@gentoo.org>
  Adding gli-dialog.py.  Updates to GenDialog.  Added function to GLIUtility to
  get subarch.
  
  16 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Backend partitioning will create disklabel is none exists. Installprofile
  defaults to "" now instead of "msdos" for disklabel type. Fix for
  mount_local_partitions() to remember device along with minor in the
  parts_to_mount dict (closes #96319). mount_local_partitions() cleanups and
  add else block to log unsupported netmount types to mount_network_shares()

  15 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py:
  Refactor kernel_compile common stuff, fix 2.4 build process.
  src/fe/cli/clife.py:
  Logging system.
  src/GLIUtility.py, src/GLIStorageDevice.py:
  Add comments about re-writes needed for boxes without sysfs.

  15 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py:
  2.4 support (pull version data from /usr/src/linux/Makefile), incl. 
  'make dep' call for custom compile. build_mode support for prepare-only and
  none types completed. custom compile function chains shell functions in
  spawned script, to allow for catching all errors.

  15 Jun 2005; Preston Cody <codeman@gentoo.org>
  fixed up build_kernel in ArchTemplate for build_mode as well as in dialogfe
  and GenDialog.  other gendialog updates as well.  kernel updates untested.
  
  14 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIInstallProfile.py:
  Change structure of etc-portage stuff. The serialization was broken before my
  last commit, and I am the only person that's ever used it. The new schema is
  as follows:
  <etc-portage>
    <file name="package.mask"/>
    <file name="package.unmask">
      <entry atom="sys-kernel/openmosix-sources"/>
    </file>
    <file name="package.use">
      <entry atom="sys-libs/db">
        -java
      </entry>
      <entry atom="dev-libs/cyrus-sasl">
        -ldap
      </entry>
    </file>
  </etc-portage>


  13 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIInstallProfile.py:
  Add new entry for gli-profile/kernel-build-method item. Add missing
  serialize_etc_portage (temporary). Make serialize_make_conf always print the
  keys in the same order.  

  13 Jun 2005; Robin H. Johnson <robbat2@gentoo.org> 
  src/GLIArchitectureTemplate.py:
  Clean up commenting used by _edit_config(), and fix bug where wrong comment
  was repeatedly appended to make.conf.
  
  13 Jun 2005; Robin H. Johnson <robbat2@gentoo.org> 
  src/GLIArchitectureTemplate.py:
  Put some Linux-2.6 specific code under a if statement. Store list of
  successfully mounted swap device for using swapoff. Add proper error checking
  to install_packages and install_filesystem_tools. Fixed namespace conflicts on
  'file'. Clean up some redundant code (thanks to pychecker).'

  13 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fix typos: get_extended() instead of get_extended_partition(). Added
  list_mirrors() and list_stage_tarballs_from_mirror() functions to GLIUtility.
  Change _emerge("sync") call to direct call to spawn to avoid 'emerge -k sync'

  12 Jun 2005; John N. Laliberte <allanonjl@gentoo.org>
  GLIInstallProfile.py: add missing set for dhcp_options if a tuple is passed
  in add_network_interface.

  12 Jun 2005; Robin H. Johnson <robbat2@gentoo.org> src/GLIArchitectureTemplate.py:
  ensure PORTAGE_TMPDIR/PORT_LOGDIR/PORTDIR_OVERLAY/PKGDIR exist prior to any
  usage - this caused a failure for stage1/stage2 previously. swapoff for swap
  space at end of install. Mount /dev, /dev/shm, /dev/pts and /sys during
  prepare_chroot.
  
  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org> +src/cli/clife.py,
  +src/cli/README, +src/fe/installer-cli, +src/fe/installer-dialog, 
  +src/fe/installer-gtk:
  Add new automated CLI frontend. Add scripts that are the intended means to
  use each frontend.

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIClientController.py:
  Add null type to network config, for cases where the interface is already up
  and should not be touched (netboot for example).

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py:
  pcmcia is not a variable name for a call to _add_to_runlevel, it should be a
  string!. Try to use binary packages if available by default.

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py:
  More error checking for _add_to_runlevel, to ensure that the init script
  actually exists before we try to add it. set_services phase must take place
  after the package installation, otherwise the init scripts might not exist.
  Find the correct init script for the cron and logging daemons, and add that
  instead of the package atom.

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py:
  Fix up _edit_config so that it works if the file doesn't already exist. Fix
  usage of 'file' to 'contents' for the variable name, as it shadows
  __builtin__.file.

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py:
  Add MTA install code, and include MTA install phase. Ensure
  PORT_LOGDIR/PORTDIR_OVERLAY are created in _emerge if needed. Add support
  for 'none' kernel config for build_kernel phase. Put kernel_script in
  /var/tmp instead of /root for build_kernel phase.

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org> src/GLIInstallProfile.py:
  Rename mta variables to match syslog/cron variables.
  
  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py, src/templates/x86ArchitectureTemplate.py,
  src/.cvsignore, src/fe/dialog/.cvsignore, src/fe/gtk/.cvsignore,
  src/fe/net/client/.cvsignore, src/fe/net/server/.cvsignore,
  src/templates/.cvsignore, src/tests/.cvsignore:
  Refactor partition formatting again to include error checking. Allow 'none'
  for kernel and bootloader specifications. Add .cvsignore files for .py[co].

  11 Jun 2005; Robin H. Johnson <robbat2@gentoo.org>
  src/GLIArchitectureTemplate.py, src/templates/x86ArchitectureTemplate.py:
  Refactor _emerge to remove duplicate code. Refactor mkfs code in backend to
  only have a single spawn call.

  11 Jun 2005; Preston Cody <codeman@gentoo.org>
  refixed samyron's fix of set_architecture_template.
  
  11 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Move /tmp/spawn.sh and /tmp/post-install to /var/tmp since that should always
  be executable.

  10 Jun 2005; Scott Myron <samyron@gentoo.org>
  Fixed one of the FIXME's in the ClientConfiguration. There is now some
  error checking when you call set_architecture_template.

  10 Jun 2005; Preston Cody <codeman@gentoo.org>
  moved the mkfsopts input to the partition options menu instead of the during
  the creation process.  updated GenDialog to say it supports reiserfs v3.
  
  9 Jun 2005; Robin H. Johnson <robbat2@gentoo.org> src/GLIInstallProfile.py,
  src/GLIStorageDevice.py, fe/dialog/dialogfe.py:
  Complete support for 'mkfsopts' parameter in main system and dialogfe.
  Add support for other partition types to dialogfe.
  Fix all usages of int(possible_big_number) to long(possible_bit_number) to
  avoid integer overflows and wraparounds.

  9 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Removed start/end from XML output and added mkfsopts to partitioning info.
  'mkfsopts' parameter is now used and support for creating xfs, jfs, and
  reiserfs is now in (patch from robbat2). Change '_parser' to 'self._parser'
  in GLIClientConfiguration. Change from .1 and .9 to constants for
  partitioning. Fix free space overwriting bug. Remove a few unused functions
  from rewrite. Fix call to get_partition_at()

  8 Jun 2005; Preston Cody <codeman@gentoo.org>
  Updates to GenDialog and dialogfe.
  
  7 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Typo (%$^&#$!) fix in GLIStorageDevice. Minor fix recommended by pychecker

  6 Jun 2005; Preston Cody <codeman@gentoo.org>
  more GenDialog updates to partitioning.
  
  5 Jun 2005; Preston Cody <codeman@gentoo.org>
  Indenting issue in GLISD/get_ordered_partition_list.
  updates to GenDialog partitioning and added default UTC for timezone in IP.
  
  5 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added GLISD.get_model()

  3 Jun 2005; Preston Cody <codeman@gentoo.org>
  Added get_eth_devices() to GLIUtility.  Updated netfe.py to newest version.
  More updates to GenDialog :)
  
  3 Jun 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added get_interface_realname() function.

  2 Jun 2005; Preston Cody <codeman@gentoo.org>
  Added auto-save of CConfig and copying to new /root after install.
  yet even more GenDialog updates.
  
  1 Jun 2005; Preston Cody <codeman@gentoo.org>
  removed print statement from GLISD.  more updates to GenDialog.
  
  31 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Not being able to fetch the stage tarball is now an exception. Chroot wrapper
  passes along exit code. Fix typo in GLIStorageDevice causing mountopts to be
  loaded from XML as ['mountopts']. Changed 'data' to 'self.data' in a few
  places in GLIClientConfiguration.

  27 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fix mount_local_partitions(), configure_fstab(), and
  install_filesystem_tools() to use GLISD directly. A few more fixes for same.
  A few more fixes for templates/x86Archtemplate

  27 May 2005; Preston Cody <codeman@gentoo.org>
  Removed more unused code from CConfig.  Updated GLIGenDialog, but it is still
  a work in progress.
  
  24 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changes in IP, GLISD, and templates/x86Archtemplate for IP using GLISD
  directly. GLISD can now handle data imported from XML.

  22 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Missing colon in GLIClientConfiguration. Add fix to GLIStorageDevice to
  handle blank (no disklabel) disks.

  20 May 2005; Preston Cody <codeman@gentoo.org>
  HUGE Reorganization of the InstallProfile.  All sections alphabetized, cleaned
  up, documented, and separated out serialization and grouped all sections.
  
  19 May 2005; Preston Cody <codeman@gentoo.org>
  Reorganization of ClientConfiguration and gutting of unused functions.
  Removed verbose option from CC.  Moved import statement in IP and CConfig up.
  
  18 May 2005; Preston Cody <codeman@gentoo.org>
  Fix use of /mnt/gentoo instead of _chroot_dir in finishing_cleanup
  
  17 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fixed bug in finishing_cleanup(). Fix a late-night coding error in
  partitioning. CC serializes install profile to disk and prepare_chroot()
  copies it into /mnt/gentoo/root

  16 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Moved URI parsing into new function parse_uri()

  14 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added XMLParser module.

  13 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fix is_realstring() and rewrite is_uri() to use a regex to parse the URI.
  Minor fix to is_uri() regex to allow hyphens in hostname.

  12 May 2005; Preston Cody <codeman@gentoo.org>
  Updated finishing_cleanup for new unmounting method from agaffney.
  
  12 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fix GLILogger to use correct time format string. Fix _edit_config() to
  properly comment out variables. Fix minor bug in finishing_cleanup(). Add
  unicode support to is_realstring().

  11 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added --nocolor to all emerge calls. Fix is_eth_device to test for zero
  return value instead of non-zero. Add code to output a traceback to the
  install log in the event of a GLI or non-GLI exception. Use NOCOLOR=yes
  instead of --nocolor.

  10 May 2005; Preston Cody <codeman@gentoo.org>
  Added GLIGenDialog.py to make a generic class for the dialog functions that
  can be used by both dialogfe and the netfe/be. updated both for new filename.
  date changes. 2004->2005.
  
  10 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Removed 'quiet=True' from spawn() calls

  10 May 2005; Preston Cody <codeman@gentoo.org>
  Updated GLIUtility with patches from chotchki.  Also added documentation
  
  9 May 2005; Preston Cody <codeman@gentoo.org>
  Added the function for set_etc_portage to ArchTemplate.  no step for it yet.
  Updated _edit_config in ArchTemplate, make_config, and various other fixes
  from bug #89683, mostly touchups.
  
  6 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  GLIStorageDevice cleanup patch from bug #91761

  3 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fixed timezone code to not link to /mnt/gentoo/usr/share/zoneinfo/blah. Fix
  _edit_config(). Error logging casts 'error' to str

  2 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  Exceptions received in CC are logged before being passed to the FE. Added
  code to CC to handle exceptions *not* thrown by the installer itself.

  1 May 2005; Andrew Gaffney <agaffney@gentoo.org>
  get_max_mb_for_resize() returns -1 if not self.resizeable

  30 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  More dirty rsync hacks :-/

  29 Apr 2005; Preston Cody <codeman@gentoo.org>
  Patches from chotchki (bug #90325) to improve CC networking.  untested.
  
  29 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Proxies patch from chotchki (bug #90147). Fixed == instead of = typos in
  GLIStorageDevice (pointed out by chotchki). Fixed missing int()s. Split
  'custom' sync option into 'none' and 'snapshot'. Minor fixes to
  GLIStorageDevice as suggested by pychecker. Fix minor bug in
  _get_packages_to_emerge(). Fix _quickpkg_deps() to call
  _get_packages_to_emerge()

  28 Apr 2005; Preston Cody <codeman@gentoo.org>
  Added group-adding code to set_users in ArchTemplate

  27 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added post-install script code

  23 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fixed encapsulation issues in GLIClientController (bug #90141)

  22 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Update resizing code in GLIStorageDevice

  17 Apr 2005; Preston Cody <codeman@gentoo.org>
  Update AUTHORS, NEWS, TODO.  Added documentation to GLILogger.

  17 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Reverted change to ArchTemplate and added support for commented line in old
  code.

  16 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changed _edit_config() to modify value in-place instead of commenting out and
  adding the new value to the end of the file.

  15 Apr 2005; Preston Cody <codeman@gentoo.org>
  Back.  Did the docuementation thang for ArchTemplate and ClientConfiguration.
  Also updated TODO list.

  14 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Use blackace's one-liner to add comments for all function for use with
  pythondoc.

  13 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Moved 'end >= device_sectors' check out of loop to check for next partition's
  start point (thanks to Marco Djukic). Fix >4 primary partitions on non-x86.
  Partitioning code now tracks start/end of extended for placing logicals. End
  point of logical is now adjusted along with start.

  11 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Finish overhaul of backend partitioning code. Fixed all bugs that stood in
  the way of partitioning from a blank disk. Add int() around access to minor
  key in partition information due to new partition code leaving them as float.

  10 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  tidy_partitions() function in GLIStorageDevice. Tweaks to tidy code

  9 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Major GLIStorageDevice overhaul...all MB now instead of sectors.

  8 Apr 2005; Scott Myron <samyron@gentoo.org>
  Added support for DHCP options and MAC addresses in the InstallProfile.

  3 Apr 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changed mountopts check to work for blank and whitespace. Pipe emerge through
  sed to properly strip out junk.

  2 Apr 2005; Preston Cody <codeman@gentoo.org>
  fixed the way set_timezone works.  added hotplug/coldplug for livecd-kernel
  added --emptytree to stage2. fixed ethx not being added to runlevel defalt.
  
  31 Mar 2005; Preston Cody <codeman@gentoo.org>
  Fixed indent problem in GLICController
  
  30 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Check for disklabel type "loop" and use the device name without a minor.

  29 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Remove /tmp/compile_output.log and /var/log/install.log when install is
  complete. Added code to (hopefully) keep 2nd thread running after install.
  Patch from zahna for extra arguments to the kernel. Patch from zahna to add
  get_eth_info() function. Remove most of content in amd64ArchTemplate and
  make it inherit from x86Archtemplate. kernel_args -> bootloader_kernel_args

  28 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added 'append_log=True' to all spawn() calls using logfile=. Append to log
  when unpacking tarball.

  28 Mar 2005; Preston Cody <codeman@gentoo.org>
  rewrote filesystem_tools.  looks like it works so ripping out all the old
  filesystem_tools code.
  
  26 Mar 2005; Preston Cody <codeman@gentoo.org>
  Changed the print statements to logging in the partitioning BE code.
  the logger may need to be imported to the x86archtemplate. unknown yet.
  Added the finishing_cleanup function.
  added a fix to the logger from BenUrban
  
  25 Mar 2005; Preston Cody <codeman@gentoo.org>
  changed InstallProfile to remove is_uri check on kernel, stage, and portage
  URIs.  The blank uri check has been commented out.
  ripped out error checking of set_services.  this is done by _add_to_runlevel.
  
  25 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  set_stage_tarball_uri() doesn't raise an exception on a blank string.

  24 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  GRP-ish quickpkg code pulls PKGDIR and PORTAGE_TMPDIR from make.conf info in
  the install profile if available. Commented out spawn() debugging prints

  23 Mar 2005; Preston Cody <codeman@gentoo.org>
  small changes to setup_network_post. moved adding to runlevel of net.x to
  after the device gets symlinked.  added domainname runlevel command.
  
  23 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  minor fix (hopefully) to livecd-kernel code. Removed call to mkvardb in
  livecd-kernel code as it's now done by catalyst. Switch _emerge() call to
  spawn() call in livecd-kernel code to pass environment variables.
  livecd-kernel code pulls PKGDIR and PORTAGE_TMPDIR from make.conf info in
  the install profile if available.

  23 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added code to build_kernel() and emerge_kernel_sources() in ArchTemplate
  to handle installing the livecd kernel into the new system.

  22 Mar 2005; Preston Cody <codeman@gentoo.org>
  should emerge hotplug and coldplug before adding them to runlevel.

  21 Mar 2005; Preston Cody <codeman@gentoo.org>
  took chroot out of grub_install command. 

  21 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changed chroot wrapper code in spawn() to write the wrapper the python way
  instead of the bash way to avoid quote conflicts.  Added
  'logfile=self._compile_logfile' to a number of spawn() calls. Added new
  hash_password() function to GLIUtility. Remove command to 'rm /tmp/spawn.sh'
  as it breaks the piping.

  20 Mar 2005; Preston Cody <codeman@gentoo.org>
  Added the amd64ArchitectureTemplate, mostly a copy of x86 without lilo.

  20 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added _get_packages_to_emerge() to GLIArchitectureTemplate and calls in
  stage1() and stage2(). Added 'origminor' parameter to GLIStorageDevice and
  GLIInstallProfile.

  19 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fixed a couple bugs in add_netmount() in GLIInstallProfile. spawn() outputs
  to the actual tty8 with display_on_tty8 flag. Compile output logfile moved
  into /mnt/gentoo in prepare_chroot()

  18 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Add sigunmask.c contributed by d_m (on freenode) to counteract python's
  retarted behavior regarding threads and signals. Add code to convert MB/%/*
  to start/end sectors

  17 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Add 2>&1 to cmd in spawn()

  16 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Modified GLIUtility.exitsuccess() to work with return value from
  commands.getstatusoutput instead of os.waitpid(). spawn() automatically
  creates wrapper script for commands run inside chroot so multiple commands
  and redirection can be used. Change exitsuccess() back. Added 'chmod a+x'
  for the generated script from spawn()

  16 Mar 2005; Preston Cody <codeman@gentoo.org>
  Removed default values for stage tarball URI and portage tree URI from
  InstallProfile.  These should be set by the FEs.  also added services step to
  ArchTemplate and coldplug/hotplug runlevels to the genkernel step.
  Possibly fixed CC DHCP bug with -n. (thx agaffney)

  14 Mar 2005; Preston Cody <codeman@gentoo.org>
  Small fix for setting the default gateway.  Also added feature to dialogfe.
  
  7 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Switched spawn() over to commands.getstatusoutput() instead of fork/waitpid

  1 Mar 2005; Preston Cody <codeman@gentoo.org>
  Fixed a bunch of true -> True typos. lots of em
  only write new resolv.conf if there are dns servers listed.
  
  1 Mar 2005; Andrew Gaffney <agaffney@gentoo.org>
  Commented out 'display_on_tty8=True' in start_portmap()

  18 Feb 2005; Preston Cody <codeman@gentoo.org>
  added progress bar to dialogfe and fix logger bug in ArchTemplate.
  
  18 Feb 2005; Andrew Gaffney <agaffney@gentoo.org>
  Created GLISayWhat module. Renamed GLISayWhat to GLILocalization. Moved
  lang parameter to __init__()
  
  10 Feb 2005; Preston Cody <codeman@gentoo.org>
  updates to TODO list.

  6 Feb 2005; Andrew Gaffney <agaffney@gentoo.org>
  Initial code for quickpkg GRP support. Fix loop to grab packages from
  'emerge -p blah'

  6 Feb 2005; Preston Cody <codeman@gentoo.org>
  check for dhcp in the network stuff and emerge it if it is.
  added quickpkg to TODO list

  5 Feb 2005; Preston Cody <codeman@gentoo.org>
  Changed the raising of 'warning' exceptions to a simple log of the error
  so that the installer can continue.

  3 Feb 2005; Preston Cody <codeman@gentoo.org>
  Some big changes.  First, changed most output to display_on_tty8.
  Second, added log lines to all templates.  Some smaller fixes such as typos.
  Also did some cleanups of old commented lines.

  1 Feb 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changed tty8 output to a fifo. Minor GLIStorageDevice fix thanks to BenUrban.
  Undo change with fix. Escaping fix in GLIStorageDevice.py

  31 Jan 2005; Preston Cody <codeman@gentoo.org>
  more updates to TODO list.  hopefully we'll soon start removing items instead
  of adding them.

  29 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Changed the way GLIStorageDevice.get_max_sectors_for_resize() works

  27 Jan 2005; Preston Cody <codeman@gentoo.org>
  updated TODO list. (again)

  25 Jan 2005; Preston Cody <codeman@gentoo.org>
  changed output of portmap start to display_on_tty8.
  fixed bootloader for udev and multiple kernels
  fixed custom kernel config (again)

  22 Jan 2005; Preston Cody <codeman@gentoo.org>
  changed default value of CC._enable_ssh to True because this is smart.
  added code to allow custom kernel .config. may be unstable and break. sorry.

  21 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  partition() now waits until after it checks for partition flags before delete
  the partitions :P

  19 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Updated TODO. swapon failure it temporarily not an error. swapon is an error
  again. is_uri() check only performed on portage_tree_snapshot_uri if it isn't
  blank.

  19 Jan 2005; Preston Cody <codeman@gentoo.org>
  Various fixes related to the add_users function.  Still not yet finished.
  Added things to the TODO list.  Lets start using that!

  18 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added code to x86Template to format newly created partitions. Also added
  some error checking code. GLIStorageDevice passes 'minor' with data to
  InstallProfile. Added partition() call back in ArchTemplate. Fixed NFS
  mounting code.

  18 Jan 2005; Preston Cody <codeman@gentoo.org>
  Took out unnecessary setting of random livecd root password. the cd already
  sets it randomly.
  
  15 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Took out an unneeded step from CC's run()

  15 Jan 2005; Preston Cody	<codeman@gentoo.org>
  Attempt at detecting and adding windows partitions to lilo.
  
  14 Jan 2005; Preston Cody <codeman@gentoo.org>
  Added lilo code and cleaned up lilo code.  also do_partitioning renamed to 
  partition. fixed misc exit_status => exitstatus typo.
  
  11 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added basic code for resizing filesystems with pyparted. Fixed code for
  resizing ntfs and ext2/3.

  10 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Fixed partition() in x86Template so that it scans through logicals and deletes
  before deleting containing extended partition. Also clears partition table to
  be safe before third pass.

  08 Jan 2005; Preston Cody <codeman@gentoo.org>
  Added mount_network_shares. not able to test it from this computer.  
  will test when i get back to school.
  also added start_portmap to the client_controller as an always-do.
  agaffney says this is needed for NFS mounts to work.
  
  08 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Partial rewrite of partitioning code in x86Template. No longer shells out to
  parted to perform actions, now uses all pyparted calls. Code "works" in a
  test, but still needs lots of TLC. Also modified tests/install.py to work
  with x86Template and GLIClientConfiguration.

  07 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Initial move of partitioning code from ArchTemplate to x86Template.

  07 Jan 2005; Preston Cody <codeman@gentoo.org>
  Added grp_install and services to InstallProfile. forgot about the set_root_password

  07 Jan 2005; Preston Cody <codeman@gentoo.org>
  Fixed a few more edit_configs.  fixed a chroot multicommand bug thanks to agaffney.
  Test Install ran very well (skipping partitioning).

  05 Jan 2005; Preston Cody <codeman@gentoo.org>
  My mid-day update.  rewrote mount_local_partitions for order of mounting. fixed prepare_chroot
  rewrote configure_fstab and install_bootloader for new partition format.  fixed a few _edit_configs.
  some may still have eluded me.

  05 Jan 2005; Preston Cody <codeman@gentoo.org>
  Overhauled the entire ArchTemplate and did a lot of other misc fixes in order to test it.
  Just finished mount_local_partitions in GLIArchitectureTemplate

  05 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  Added get_num_sectors() to GLIStorageDevice.

  04 Jan 2005; Andrew Gaffney <agaffney@gentoo.org>
  GLIStorageDevice now tracks partition boundaries in sectors instead of cylinders.
  Also now ignores <=100 sectors for free space. Removed remaining depends stuff
  from GLIInstallProfile.

  20 Dec 2004; Andrew Gaffney <agaffney@gentoo.org>
  GLIStorageDevice returns "unknown" instead of "" for get_type()

  19 Dec 2004; Andrew Gaffney <agaffney@gentoo.org>
  Added get_extended_partition() to GLIStorageDevice. Rewrote get_logicals() to
  actually work. Commented out resizability checking code for speed.

  17 Dec 2004; Andrew Gaffney <agaffney@gentoo.org>
  Switched to using dumpe2fs to determine free space left in ext2/3 filesystem in
  GLIStorageDevice at the suggestion of plors

  10 Dec 2004; Andrew Gaffney <agaffney@gentoo.org>
  Added a function to GLIUtility to pull a value from a make.conf-style config
  file. Minor type fix to GLIInstallProfile.py

  09 Dec 2004; Andrew Gaffney <agaffney@gentoo.org>
  Added code in GLIArchitectureTemplate.py to write netmounts into fstab. Separated
  network mounts from partition data structure in GLIInstallProfile

  27 Nov 2004; Andrew Gaffney <agaffney@gentoo.org>
  Changed the way GLIStorageDevice.py determines the amount a ext2/3 filesystem
  can be resized.

  27 Oct 2004; Preston Cody <codeman@gentoo.org>
  Added some of the final functions to GLIInstallTemplate.
  Yes this project is still active despite rare use of the Changelog!

  11 Jun 2004; Nathaniel McCallum <npmccallum@gentoo.org>
  Added the GLIPartitionTools.py file.  This is a temporary insertion of 
  partitioning tools that will eventually go into their own package.

  27 Mar 2004; Nathaniel McCallum <npmccallum@gentoo.org>
  Added InstallProfileTODO.txt.  Added GLIClientConfiguration.py (contains run-time
  for the program).  Added __init__(install_profile, client_configuration) to 
  GLI.InstallProfile.  This sets install_profile and client_configuration once so as
  to avoid constantly passing stuff every time we call a method.

  26 Mar 2004; Nathaniel McCallum <npmccallum@gentoo.org>

  Added another private method to GLI.InstallTemplate.  _edit_config() modifies config
  files without messing up all the other stuff in them.  This will be used for making
  changes to make.conf, rc.conf, /etc/conf.d/net, etc...

  25 Mar 2004; Nathaniel McCallum <npmccallum@gentoo.org>

  Added GLI.InstallTemplate framework.  This is not yet functional.  However, it does
  have a few basic things.  I added two private methods.  One is _depends().  This
  will be used for dependency checking (ie. unpacking a tarball requires that
  partitioning has been done).  The other is _exec_in_chroot().  This is the exact
  same syntax as os.system(), however, instead of being run in the liveCD
  environment, it runs in the chroot.  This requires a bit of fork() magic, so I 
  isolated the code.  Hope to work more this week to get this class formed...

  14 Feb 2004; Eric Sammer <esammer@gentoo.org>

  Added SAX parsing. Made GLI.InstallProfile a subclass of xml.sax.ContentHandler for
  obvious reasons. Switched kernel_modules and users to be lists instead of tuples
  to allow for easier modification (mutable, rather than immutable objects). Updated
  existing pydoc and added more. Implemented body of GLI.InstallProfile.parse().
  Cleaned file format of GLI.py a bit. Fixed all accessors to use self references.
  Added initial unit test code.

  9 Feb 2004; Eric Sammer <esammer@gentoo.org>

  Added initial changelog. Setting up the basic structure of the CVS repository
  for the project. Added the UML class diagram in docs. Added a skeletal GLI
  python module. Added misc files such news, authors, etc.

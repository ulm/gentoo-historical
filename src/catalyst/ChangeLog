# ChangeLog for gentoo/src/catalyst 
# Copyright 2002-2004 Gentoo Technologies, Inc.; Distributed under the GPL v2
# $Header: /var/cvsroot/gentoo/src/catalyst/Attic/ChangeLog,v 1.66 2004/06/18 18:06:21 zhen Exp $

  18 Jun 2004; John Davis <zhen@gentoo.org> catalyst,
  modules/catalyst_support.py, modules/generic_stage_target.py,
  targets/stage1/build.sh, targets/stage1/stage1-chroot.sh,
  targets/stage2/stage2-chroot.sh, targets/stage3/stage3-chroot.sh:
  stage resuming functionality should be working. I still have to work on GRP
  and livecds, but they should not be hard. I could not incorporate emerge
  --resume into stage resuming functionality because in some instances, portage
  is remerged (bootstrap, stage2), which wipes out the resume data and puts
  catalyst into an infinite portage merging loop (very unproductive, trust me ;)
  ). I also made some small tweaks to the stage target scripts which clean up
  the envscript stuff. Not noticable performance wise, but it makes me feel all
  warm and fuzzy to know that it is programmed absolutely correctly ;)

  16 Jun 2004; John Davis <zhen@gentoo.org> TODO, modules/catalyst_support.py,
  modules/generic_stage_target.py:
  revamped the cmd() structure so that it could properly return error codes.
  Please note that this might break catalyst until there is some further
  testing. SO DO NOT USE IT FOR BUILDING ANYTHING IMPORTANT (yet). The benefit
  of me doing this is that SIGINT (ctrl-c) makes catalyst die nice and proper
  now. Additionally, catalyst will stop when there is an error with an ebuild
  ... it didn't do this before, it just plowed along and packed things up.
  
  Much thanks to <carpaski@gentoo.org> for (writing) pointing me to the spawn() code in
  portage.py and then answering my noob questions.

  13 Jun 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/x86-archscript.sh, livecd/runscript-support/kmerge.sh,
  livecd/runscript-support/livecdfs-update.sh:
  some last minute fixins
  (stuff to work with the new genkernel)

  13 Jun 2004; John Davis <zhen@gentoo.org> catalyst:
  rolling out 1.0.8.1

  11 Jun 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh, modules/livecd_stage2_target.py:
  new key, livecd/fsscript. use this to run commands in the livecdfs before it
  is made into an iso

  10 Jun 2004; John Davis <zhen@gentoo.org>
  livecd/runscript-support/kmerge.sh,
  livecd/runscript-support/livecdfs-update.sh,
  livecd/runscript-support/post-kmerge.sh,
  livecd/runscript-support/pre-kmerge.sh:
  two new functions for livecd-stage2: livecd/rcadd and livecd/rcdel. these two
  functions control what scripts are added to their respective runlevels. This
  option would be specified like so in the spec file: livecd/rcadd:
  metalog:default foo:boot. the syntax is the same for livecd/rcdel.

  08 Jun 2004; John Davis <zhen@gentoo.org> modules/builder.py,
  modules/catalyst_support.py, modules/livecd_stage2_target.py:
  livecd-stage2 traced back when boot/kernel/x/config was an empty string, fixed
  the code to give a nice error msg instead of a cryptic traceback

  04 Jun 2004; John Davis <zhen@gentoo.org>
  livecd/runscript-support/livecdfs-update.sh:
  small fix for bootsplash, needed to link clst_livecd_bootsplash to
  /etc/bootsplash/default

  04 Jun 2004; John Davis <zhen@gentoo.org> modules/generic_stage_target.py,
  targets/embedded/embedded-chroot.sh,
  targets/embedded/embedded-preclean-chroot.sh, targets/grp/grp-chroot.sh,
  targets/grp/grp-preclean-chroot.sh, targets/grp/grp.sh,
  targets/livecd-stage1/livecd-stage1-chroot.sh,
  targets/livecd-stage1/livecd-stage1-preclean-chroot.sh,
  targets/livecd-stage1/livecd-stage1.sh, targets/stage1/stage1-chroot.sh,
  targets/stage1/stage1-preclean1-chroot.sh, targets/stage1/stage1.sh,
  targets/stage2/stage2-chroot.sh, targets/stage2/stage2-preclean-chroot.sh,
  targets/stage3/stage3-chroot.sh, targets/stage3/stage3-preclean-chroot.sh,
  targets/tinderbox/tinderbox-chroot.sh,
  targets/tinderbox/tinderbox-preclean-chroot.sh,
  targets/tinderbox/tinderbox.sh:
  Fixes bug 51603, a lot of distcc fixups (has to do w/ bind mounts and such)

  02 Jun 2004; John Davis <zhen@gentoo.org> modules/snapshot_target.py:
  Fixes to address bugs #51072 and #52045. The snapshot logic was tweaked to be
  more efficient, and I added a new snapshot specfile option, portdir_overlay.
  It should be a full path pointing to a portage overlay dir.

  27 May 2004; John Davis <zhen@gentoo.org>
  livecd/cdtar/silo-1.3.1-cdtar.tar.bz2,
  livecd/cdtar/silo-1.3.2-sparc64-cdtar.tar.bz2,
  livecd/cdtar/silo-1.4.4-sparc32-cdtar.tar.bz2,
  livecd/runscript/default-runscript.sh:
  added updated silos and fixed motd bug

  22 May 2004; John Davis <zhen@gentoo.org> REMARKS, catalyst:
  rolling out version 1.0.8

  22 May 2004; John Davis <zhen@gentoo.org>
  livecd/runscript-support/kmerge.sh,
  livecd/runscript-support/livecdfs-update.sh,
  modules/livecd_stage2_target.py:
  added key livecd/bootsplash

  21 May 2004; John Davis <zhen@gentoo.org> arch/sparc.py, arch/sparc64.py,
  livecd/runscript/sparc-archscript.sh,
  livecd/runscript/sparc64-archscript.sh:
  sparc fixup patches from gustavoz at g.org

  20 May 2004; John Davis <zhen@gentoo.org> modules/livecd_stage2_target.py:
  added support for blacklisting modules via hotplug in livecd-stage2. spec key
  is livecd/modblacklist

  19 May 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh, modules/livecd_stage2_target.py,
  livecd/runscript/x86-archscript.sh:
  added support for livecd/overlay, changed vga=0x317 to vga=791
  in the x86 archscript as it is a more standard setting and should
  work on more hardware

  17 May 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh, livecd/runscript/x86-archscript.sh,
  livecd/runscript-support/kmerge.sh,
  livecd/runscript-support/livecdfs-update.sh,
  modules/livecd_stage2_target.py:
  fixes for the genkernel arg handling - we can now do it on a per-kernel basis.
  we also now have basic motd copying support for more branded livecds

  16 May 2004; John Davis <zhen@gentoo.org>
  livecd/runscript-support/kmerge.sh, modules/livecd_stage2_target.py:
  added a feature to the livecd-stage2 specfile called "livecd/genkernel_args"
  for passing args to genkernel. gmsoft@gentoo.org requested this one.

  16 May 2004; John Davis <zhen@gentoo.org> catalyst,
  modules/catalyst_support.py, modules/embedded_target.py,
  modules/generic_stage_target.py, modules/generic_target.py,
  modules/grp_target.py, modules/livecd_stage1_target.py,
  modules/livecd_stage2_target.py, modules/stage1_target.py,
  modules/stage2_target.py, modules/stage3_target.py,
  modules/tinderbox_target.py, targets/stage1/stage1-preclean2-chroot.sh:
  finally parsed out targets.py. fixed gcc-config typo in stage1 the stage1 that
  caused gcc profile problems.

  12 May 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh, livecd/runscript-support/kmerge.sh,
  livecd/runscript-support/livecdfs-update.sh,
  livecd/runscript-support/post-kmerge.sh,
  livecd/runscript-support/pre-kmerge.sh, modules/catalyst_support.py,
  modules/targets.py:
  fixed default-runscript.sh so that it is easier to read (no more chroot >> EOF
  silliness). Most notably, I have taken advantage of the update-modules
  --assume-kernel fix from agriffis so that we can actually use 3rd party
  modules now. Please note that >=baselayout-1.9.0 is required.

  02 May 2004; Olivier Crete <tester@gentoo.org>
  arch/x86.py:
  Added forgotten CHOST for i386 subarch

  30 Apr 2004; John Davis <zhen@gentoo.org>
  livecd/cdtar/isolinux-2.08-cdtar.tar.bz2,
  livecd/cdtar/isolinux-2.08-memtest86+-cdtar.tar.bz2,
  livecd/cdtar/isolinux-2.08-memtest86-cdtar.tar.bz2,
  livecd/files/x86-help.msg, livecd/runscript/x86-archscript.sh:
  lots of changes
  -fixed 2004.0 branding in the isolinux cdtar
  -fixed up acpi stuff in the runscripts
  -fixed up the x86 help message and corrected the numerous errors in it

  26 Apr 2004; John Davis <zhen@gentoo.org> catalyst,
  livecd/runscript/default-runscript.sh:
  fixed the /etc/issue /O macro issue, and changed the version in catalyst to
  1.0.7. we are ready for release

  16 Apr 2004; John Davis <zhen@gentoo.org> targets/stage1/stage1-chroot.sh:
  fix for the problem that gustavoz found wrt the /dev creation stuff not
  detecting arches. also an efficiency fix for stage1 building

  14 Apr 2004; John Davis <zhen@gentoo.org>
  targets/embedded/embedded-chroot.sh,
  targets/embedded/embedded-preclean-chroot.sh, targets/embedded/embedded.sh,
  targets/grp/grp.sh, targets/livecd-stage1/livecd-stage1-chroot.sh,
  targets/livecd-stage1/livecd-stage1-preclean-chroot.sh,
  targets/livecd-stage1/livecd-stage1.sh, targets/stage1/stage1-chroot.sh,
  targets/stage1/stage1-preclean1-chroot.sh, targets/stage1/stage1.sh,
  targets/stage2/stage2-chroot.sh, targets/stage2/stage2-preclean-chroot.sh,
  targets/stage2/stage2.sh, targets/stage3/stage3-chroot.sh,
  targets/stage3/stage3.sh, targets/tinderbox/tinderbox-chroot.sh,
  targets/tinderbox/tinderbox-preclean-chroot.sh,
  targets/tinderbox/tinderbox.sh:
  fix for bug #47733 - fixes for distcc and an envscript bugfix

  13 Apr 2004; John Davis <zhen@gentoo.org> modules/targets.py:
  fix for bug 47626

  12 Apr 2004; John Davis <zhen@gentoo.org> modules/catalyst_support.py,
  targets/embedded/cramfs-runscript.sh, targets/embedded/embedded-chroot.sh,
  targets/embedded/embedded-preclean-chroot.sh, targets/embedded/embedded.sh,
  targets/grp/grp-chroot.sh, targets/grp/grp-preclean-chroot.sh,
  targets/grp/grp.sh, targets/livecd-stage1/livecd-stage1-chroot.sh,
  targets/livecd-stage1/livecd-stage1-preclean-chroot.sh,
  targets/livecd-stage1/livecd-stage1.sh, targets/stage1/stage1-chroot.sh,
  targets/stage1/stage1-preclean1-chroot.sh,
  targets/stage1/stage1-preclean2-chroot.sh, targets/stage1/stage1.sh,
  targets/stage2/stage2-chroot.sh, targets/stage2/stage2-preclean-chroot.sh,
  targets/stage2/stage2.sh, targets/stage3/stage3.sh,
  targets/tinderbox/tinderbox.sh:
  lots of cleanup on the bash backend. take a look @ the code and report bugs to
  zhen@gentoo.org please.

  06 Apr 2004; John Davis <zhen@gentoo.org> targets/stage1/stage1-chroot.sh:
  fix for /dev in stage1

  05 Apr 2004; John Davis <zhen@gentoo.org> modules/targets.py:
  bugfix for #46861

  04 Apr 2004; Benjamin Judas <beejay@gentoo.org> 
  livecd/kconfig/config-2004.1-gentoo-dev-sources-2.6.3-r1,
  livecd/kconfig/config-2004.1-xfs-sources-2.4.24-r3:
  Added the two kernel-configs for 2004.1 x86

  04 Apr 2004; John Davis <zhen@gentoo.org> targets/embedded/embedded.sh,
  targets/grp/grp.sh, targets/stage1/stage1-chroot.sh,
  targets/stage2/stage2.sh, targets/stage3/stage3.sh,
  targets/tinderbox/tinderbox.sh:
  fix to address missing /dev in stages, fixed path for env-update in all of the
  targets

  02 Apr 2004; John Davis <zhen@gentoo.org> modules/targets.py:
  use broken for grp, livecd-stage1, tinderbox, etc. fixed

  01 Apr 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh:
  added in fix for the module.conf stuff courtesy of Benjamin Judas
  <beejay@gentoo.org>

  01 Apr 2004; John Davis <zhen@gentoo.org> catalyst, files/catalyst.conf,
  files/x86-help.msg:
  cosmetic touchups for 1.0.5

  31 Mar 2004; John Davis <zhen@gentoo.org> targets/stage2/stage2.sh:
  added support to the stage2 for stackable profiles bootstrap

  31 Mar 2004; John Davis <zhen@gentoo.org> arch/sparc.py, modules/targets.py:
  sparc compatibility patches from gustavoz@gentoo.org added. These patches add
  support for sparc32/64 build compatibility

  30 Mar 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh, modules/targets.py,
  targets/stage1/build.sh:
  fix for bug 46022, more stackable profile fixes, embedded patches added

  26 Mar 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/default-runscript.sh, modules/targets.py,
  targets/grp/grp.sh, targets/livecd-stage1/livecd-stage1.sh,
  targets/stage1/stage1-chroot.sh, targets/stage2/stage2.sh,
  targets/stage3/stage3.sh, targets/tinderbox/tinderbox.sh:
  fixes for bugs #44625 and #45805

  24 Mar 2004; John Davis <zhen@gentoo.org> catalyst,
  livecd/cdtar/isolinux-2.08-memtest86-cdtar.tar.bz2,
  livecd/runscript/default-runscript.sh, livecd/runscript/x86-archscript.sh:
  memtest is in. if you want to use it, check out the memtest86 cd tarball
  Also, fixes for bugs 45078, 45188, 44306

  23 Mar 2004; John Davis <zhen@gentoo.org>
  livecd/runscript/alpha-archscript.sh, livecd/runscript/hppa-archscript.sh,
  livecd/runscript/ppc-archscript.sh, livecd/runscript/sparc64-archscript.sh,
  livecd/runscript/x86-archscript.sh, modules/targets.py,
  targets/livecd-stage3/unmerge.sh:
  added "livecd/iso" to targets.py and fixed up the archscripts so that isos are
  created at the end of the livecd-stage2 process.

  22 Mar 2004; John Davis <zhen@gentoo.org> modules/targets.py,
  targets/embedded/embedded.sh:
  preliminary embedded support added thanks to david@futuretel.com (mut3x)

  19 Mar 2004; John Davis <zhen@gentoo.org> targets/grp/grp.sh,
  targets/stage1/stage1.sh, targets/stage3/stage3.sh:
  removing the hardened-gcc deps since the package itself is deprecated'

  05 Mar 2004; John Davis <zhen@gentoo.org> catalyst:
  changing location of /etc/catalyst.conf to /etc/catalyst/catalyst.conf

  04 Mar 2004; John Davis <zhen@gentoo.org> alpha-isogen.sh,
  examples/livecd/alpha/alpha-livecd-stage1-20040225.spec,
  examples/livecd/alpha/alpha-livecd-stage2-20040225.spec,
  examples/livecd/alpha/config-2.4.21-r4-alpha,
  examples/livecd/alpha/config-2.4.21-r4-jensen,
  examples/livecd/alpha/config-2.4.21-r4-legacy,
  examples/livecd/cdtar/aboot-0.9-r1-cdtar.tar.bz2,
  examples/livecd/runscript/alpha-archscript.sh, files/catalyst.conf:
  fixes for bugs 43676, 43701. Alpha support added as well.

  25 Feb 2004; Pieter Van den Abeele <pvdabeel@gentoo.org>: 
  added powerpc livecd support, preparing for 2004.0 release. Preliminary 
  kde/gnome cd specs added.

  18 Feb 2004; John Davis <zhen@gentoo.org> files/catalyst.conf:
  fix in catalyst.conf for bug #42044

  13 Feb 2004; John Davis <zhen@gentoo.org> sparc64-isogen.sh, arch/sparc.py,
  arch/sparc64.py, examples/livecd/runscript/sparc64-archscript.sh,
  examples/livecd/sparc64/config-2.4.24-sparc64:
  sparc fixups contributed by Gustavo Zacarias <gustavoz@gentoo.org>

  12 Feb 2004; Daniel Robbins <drobbins@gentoo.org>: fixed bugs in previous
  feature additions (see 11 Feb 2004) and added support for a $clst_conf 
  environment variable. You can use the $clst_conf variable to point to
  a file to use in place of /etc/catalyst.conf. By setting this variable
  in your shell, catalyst can easily be used by multiple people on the
  same machine. Also, ccache support now works for genkernel.
  
  11 Feb 2004; Daniel Robbins <drobbins@gentoo.org>: removed file for
  livecd-stage2 target, as this is handled by the runscript now. Added support
  for "/boot/kernel/foo/use", "/boot/kernel/foo/packages," and made
  "/boot/kernel/foo/extraversion" an optional rather than required parameter.
  The aforementioned "packages" is used to specify kernel-related packages
  (like module ebuilds) to merge with each kernel, and the new "use" option is
  used to specify the USE settings you'd like exported to the environment
  during kernel as well as kernel "packages" build.

  10 Feb 2004; John Davis <zhen@gentoo.org> README, TODO, catalyst,
  modules/builder.py, modules/catalyst_support.py, modules/targets.py,
  targets/grp/grp.sh, targets/livecd-stage1/livecd-stage1.sh,
  targets/livecd-stage2/livecd-stage2.sh, targets/stage1/stage1-chroot.sh,
  targets/stage2/stage2.sh, targets/stage3/stage3.sh,
  targets/tinderbox/tinderbox.sh:
  added envscripts support (fixes bug #39832) massive cleanup of tree to prepare
  it for ebuild - added headers to everything and removed deprecated dirs

  14 Jan 2004; zhen <zhen@gentoo.org> arch/mips.py, modules/targets.py:
  adding Kumba's patches for MIPS

  16 Dec 2003; Guy Martin <gmsoft@gentoo.org> : arch/hppa.py,modules/targets.py :
  Added hppa specific code.

  29 Nov 2003; Daniel Robbins <drobbins@gentoo.org>: Tinderbox target added. See
  tinderbox examples in examples/ dir.
  
  08 Nov 2003; Daniel Robbins <drobbins@gentoo.org>: spec file support integrated
  into catalyst. Use "-f/--file specfile" as argument; see examples dir for examples.
  "grp" target now functional. See examples/x86-grp-20031102.spec for an example of
  how to use it.
 
  08 Nov 2003; Daniel Robbins <drobbins@gentoo.org>: support functions for spec
  file parsing and reading added. Will get added to the code soon.
  
  05 Nov 2003; Daniel Robbins <drobbins@gentoo.org>: Many bug fixes later, things
  seem to be working well for stage1/2/3 so I've added a README.
  
  28 Oct 2003; Daniel Robbins <drobbins@gentoo.org>: Significant rework of code
  structure. Everything is falling nicely into place.
  
  28 Oct 2003; Daniel Robbins <drobbins@gentoo.org>: Exception handling fully-
  integrated into current prototype code.
  
  27 Oct 2003; Daniel Robbins <drobbins@gentoo.org>: beginning of exception
  handling integration, got some of the target code nicely fleshed out.
  
  24 Oct 2003; Daniel Robbins <drobbins@gentoo.org>: major code rework in 
  progress on the python parts.
  
  17 Oct 2003; zhen <zhen@gentoo.org> files/grp/x86/x86.conf,
  files/grp/x86/x86.pkg.cd1, files/grp/x86/x86.pkg.cd2, files/grp/x86/x86.src,
  files/livecd/x86-basic/base.pkg, files/livecd/x86-basic/kern.pkg:
  for organiation's sake, I have moved the files, such as livecd foundations,
  into catalyst/files. It will make it easier for us when ebuild time comes
  around.

  15 Oct 2003; zhen <zhen@gentoo.org> targets/stage3/stage3.sh:
  All preliminary target build scripts are now added and coded to near as spec
  that we can have at this point.

  14 Oct 2003; Daniel Robbins <drobins@gentoo.org>: new and improved ChangeLog;
  snapshots now work ("./catalyst-util.py snap 20031014",) and snapshotting
  cleans up after itself (temp files deleted,) something that should be
  continued as much as reasonably possible in other parts of catalyst. Also, we
  have /etc/catalyst.conf config file reading stub code completed, and internal
  fall-backs to reasonable global config defaults completed.
  
 

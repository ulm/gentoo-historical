From c162cadb1a77262c72a181c7514f9d79b5946c46 Mon Sep 17 00:00:00 2001
From: =?utf-8?q?R=C3=A9mi=20Denis-Courmont?= <rdenis@simphalempin.com>
Date: Wed, 20 Aug 2008 23:06:32 +0300
Subject: [PATCH] TTA: potential 0 divider
 (cherry picked from commit f789b29e0730f8c8e288517d1bd7956a8cfbb214)

---
 modules/demux/tta.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/modules/demux/tta.c b/modules/demux/tta.c
index e400908..47f83a4 100644
--- a/modules/demux/tta.c
+++ b/modules/demux/tta.c
@@ -111,6 +111,11 @@ static int Open( vlc_object_t * p_this )
     fmt.audio.i_channels = GetWLE( &p_header[6] );
     fmt.audio.i_bitspersample = GetWLE( &p_header[8] );
     fmt.audio.i_rate = GetDWLE( &p_header[10] );
+    if( fmt.audio.i_rate == 0 )
+    {
+        free( p_sys );
+        return VLC_EGENERIC;
+    }
 
     p_sys->i_datalength = GetDWLE( &p_header[14] );
     p_sys->i_framelength = TTA_FRAMETIME * fmt.audio.i_rate;
-- 
1.5.6.5


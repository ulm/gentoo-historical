commit 7c39ad95f5632f04e8d082c6fe44fdfed90fd897
Author: Alexis Ballier <aballier@gentoo.org>
Date:   Mon Jul 13 12:35:48 2009 +0200

    Make sure vlc_release doesn't destroy a non existent spinlock.
    
    This was actually fixed by [697457bcb66171897605b1c88150f3bb7eb075c6] but then [952a943ae25ba8f22e4e70eb0f55b4c0cee069b8] came which made it useless.
    
    Signed-off-by: RÃ©mi Denis-Courmont <remi@remlab.net>

Index: vlc-1.0.0/src/libvlc.c
===================================================================
--- vlc-1.0.0.orig/src/libvlc.c
+++ vlc-1.0.0/src/libvlc.c
@@ -195,7 +195,7 @@ void vlc_release (gc_object_t *p_gc)
     assert (refs != (uintptr_t)(-1)); /* reference underflow?! */
     if (refs == 0)
     {
-#ifdef USE_SYNC
+#if defined (__GCC_HAVE_SYNC_COMPARE_AND_SWAP_4)
 #elif defined (WIN32) && defined (__GNUC__)
 #elif defined(__APPLE__)
 #else

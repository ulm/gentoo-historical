--- src/lib/rpc/svc_auth_gss.c.orig	2008-03-19 21:35:43.000000000 +0100
+++ src/lib/rpc/svc_auth_gss.c	2008-03-19 21:37:05.000000000 +0100
@@ -671,7 +671,7 @@
 
 	gd = SVCAUTH_PRIVATE(auth);
 
-	if (gd->cname.length == 0)
+	if (gd->cname.length == 0 || gd->cname.length >= SIZE_MAX)
 		return (NULL);
 
 	if ((pname = malloc(gd->cname.length + 1)) == NULL)

# $Header: /var/cvsroot/gentoo/admin/www.gentoo.org/conf/apache.conf,v 1.4 2003/01/30 07:12:13 rajiv Exp $

# This file contains options which affect the main apache server and all
# virtual hosts running on this machine. If this machine is running as only
# www.gentoo.org you should use this file as the main apache conf file.
#
# If this server is handling other virtual hosts besides www.gentoo.org,
# include only the virtual host specific configurations by adding this
# line to the end of /etc/apache/conf/httpd.conf:
#
#   Include /home/httpd/gentoo-src/gentoo-xml/conf/www.gentoo.org.conf
#
# For the second case, you should also read the options below and use any
# as you feel are appropriate.

ServerType standalone
ServerRoot /etc/apache
User apache
Group apache
PidFile /var/run/apache.pid
ScoreBoardFile /etc/apache/apache.scoreboard
ResourceConfig /dev/null
AccessConfig /dev/null

LoadModule mmap_static_module modules/mod_mmap_static.so
LoadModule env_module         modules/mod_env.so
LoadModule config_log_module  modules/mod_log_config.so
LoadModule agent_log_module   modules/mod_log_agent.so
LoadModule referer_log_module modules/mod_log_referer.so
LoadModule mime_magic_module  modules/mod_mime_magic.so
LoadModule mime_module        modules/mod_mime.so
LoadModule negotiation_module modules/mod_negotiation.so
LoadModule status_module      modules/mod_status.so
LoadModule info_module        modules/mod_info.so
LoadModule includes_module    modules/mod_include.so
LoadModule autoindex_module   modules/mod_autoindex.so
LoadModule dir_module         modules/mod_dir.so
LoadModule cgi_module         modules/mod_cgi.so
LoadModule asis_module        modules/mod_asis.so
LoadModule imap_module        modules/mod_imap.so
LoadModule action_module      modules/mod_actions.so
LoadModule speling_module     modules/mod_speling.so
LoadModule userdir_module     modules/mod_userdir.so
LoadModule proxy_module       modules/libproxy.so
LoadModule alias_module       modules/mod_alias.so
LoadModule rewrite_module     modules/mod_rewrite.so
LoadModule access_module      modules/mod_access.so
LoadModule auth_module        modules/mod_auth.so
LoadModule anon_auth_module   modules/mod_auth_anon.so
LoadModule dbm_auth_module    modules/mod_auth_dbm.so
LoadModule db_auth_module     modules/mod_auth_db.so
LoadModule digest_module      modules/mod_digest.so
LoadModule cern_meta_module   modules/mod_cern_meta.so
LoadModule expires_module     modules/mod_expires.so
LoadModule headers_module     modules/mod_headers.so
LoadModule usertrack_module   modules/mod_usertrack.so
LoadModule example_module     modules/mod_example.so
LoadModule unique_id_module   modules/mod_unique_id.so
LoadModule setenvif_module    modules/mod_setenvif.so
LoadModule vhost_alias_module	modules/mod_vhost_alias.so

ClearModuleList
AddModule mod_mmap_static.c
AddModule mod_env.c
AddModule mod_log_config.c
AddModule mod_log_agent.c
AddModule mod_log_referer.c
AddModule mod_mime_magic.c
AddModule mod_mime.c
AddModule mod_negotiation.c
AddModule mod_status.c
AddModule mod_info.c
AddModule mod_include.c
AddModule mod_autoindex.c
AddModule mod_dir.c
AddModule mod_cgi.c
AddModule mod_asis.c
AddModule mod_imap.c
AddModule mod_actions.c
AddModule mod_speling.c
AddModule mod_userdir.c
AddModule mod_proxy.c
AddModule mod_alias.c
AddModule mod_rewrite.c
AddModule mod_access.c
AddModule mod_auth.c
AddModule mod_auth_anon.c
AddModule mod_auth_dbm.c
AddModule mod_auth_db.c
AddModule mod_digest.c
AddModule mod_cern_meta.c
AddModule mod_expires.c
AddModule mod_headers.c
AddModule mod_usertrack.c
AddModule mod_example.c
AddModule mod_unique_id.c
AddModule mod_so.c
AddModule mod_setenvif.c
AddModule mod_vhost_alias.c

Port 80
Listen 80
Timeout 300
MaxKeepAliveRequests 100
KeepAliveTimeout 15
MinSpareServers 15
MaxSpareServers 25
StartServers 20
MaxClients 150
MaxRequestsPerChild 500

ServerName www.gentoo.org
ServerAdmin www@gentoo.org
DocumentRoot /home/httpd/gentoo-src/gentoo-xml/htdocs
UseCanonicalName On
HostnameLookups Off
ServerSignature On
AccessFileName .htaccess

ErrorLog logs/error_log
CustomLog logs/access_log combined env=!VLOG
LogLevel warn

<Directory /home/httpd/cgi-bin>
    AllowOverride All
    Options ExecCGI
    Order allow,deny
    Allow from all
</Directory>

<IfModule mod_dir.c>
    DirectoryIndex index.xml index.html
</IfModule>

<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files>

DefaultType text/plain
<IfModule mod_mime.c>
    TypesConfig conf/mime.types
</IfModule>
<IfModule mod_mime_magic.c>
    MIMEMagicFile conf/magic
</IfModule>

<IfModule mod_alias.c>
    ScriptAlias /cgi-bin/ /home/httpd/cgi-bin/
</IfModule>

<IfModule mod_setenvif.c>
    BrowserMatch "Mozilla/2" nokeepalive
    BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
    BrowserMatch "RealPlayer 4\.0" force-response-1.0
    BrowserMatch "Java/1\.0" force-response-1.0
    BrowserMatch "JDK/1\.0" force-response-1.0
</IfModule>

<IfDefine PERL>
	LoadModule perl_module extramodules/libperl.so
	AddModule mod_perl.c

	PerlModule AxKit
	SetHandler perl-script
	PerlHandler Apache::AxKit::StyleChooser::PathInfo AxKit
	AxAddStyleMap application/x-xpathscript Apache::AxKit::Language::XPathScript
	AddHandler axkit .xml
	AxAddStyleMap text/xsl Apache::AxKit::Language::LibXSLT
</IfDefine>

<IfDefine GZIP>
	LoadModule gzip_module extramodules/mod_gzip.so
	AddModule mod_gzip.c

	Include conf/addon-modules/mod_gzip.conf
	LogFormat "%h %l %u %t \"%r\" %>s %b %b mod_gzip: %{mod_gzip_compression_ratio}npct." gzip
</IfDefine>

<IfModule mod_status.c>
	<Location /server-status>
		SetHandler server-status
		Order deny,allow
		Deny from all
		Allow from 127.0.0.1 216.110.76.37 216.110.80.169
	</Location>
	ExtendedStatus On
</IfModule>

<IfModule mod_info.c>
	<Location /server-info>
		SetHandler server-info
		Order deny,allow
		Deny from all
		Allow from 127.0.0.1 216.110.76.37 216.110.80.169
	</Location>
</IfModule>

<IfModule mod_perl.c>
	<Location /perl-status>
		SetHandler perl-script
		Order deny,allow
		Deny from all
		PerlHandler Apache::Status
		Allow from 127.0.0.1 216.110.76.37 216.110.80.169
	</Location>
</IfModule>

NameVirtualHost *
Include /home/httpd/gentoo-src/gentoo-xml/conf/www.gentoo.org.conf

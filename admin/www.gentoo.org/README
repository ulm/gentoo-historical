$Header: /var/cvsroot/gentoo/admin/www.gentoo.org/README,v 1.3 2003/02/24 04:41:57 rajiv Exp $

Hi There!

Here are some simple instructions on how to configure and update this site, written by 
Daniel Robbins on 09 Nov 2002. Updated by Rajiv Manglani.

Here is how you would typically go about setting up a gentoo.org Web site from scratch assuming the machine will handle only www.gentoo.org:

1) install apache, AxKit, mod_gzip, keychain
2) add a 'gweb' user with home dir /home/httpd
3) setup gweb ssh pub/priv keys
4) setup gweb .bash_profile to call keychain
5) as root do this:
$ cd /etc/apache/conf
$ mkdir gentoo
$ chgrp wheel gentoo
$ chmod g+w gentoo
6) as yourself (or another user in the wheel group on the webserver, and in the cvsadmin group on cvs.gentoo.org):
$ cd /etc/apache/conf
$ cvs -d:ext:cvs.gentoo.org:/home/cvsroot co gentoo/admin
7) back as root
$ cd /etc/apache/conf
$ rm apache.conf
$ ln -s gentoo/admin/www.gentoo.org/conf/apache.conf
8) login as gweb, and do this:
$ cd /home/httpd
$ export CVS_RSH=ssh
$ cvs -d:ext:cvs.gentoo.org:/home/cvsroot co gentoo/xml
$ cvs -d:ext:cvs.gentoo.org:/home/cvsroot co gentoo-x86
$ export WEBROOT=/home/httpd/gentoo/xml/htdocs
$ export WEBSCRIPTS=/etc/apache/conf/gentoo/admin/www.gentoo.org/scripts
$ cd $WEBSCRIPTS
$ ./nightly.sh (to generate dynamic content)
9) edit /etc/conf.d/apache to include:  APACHE_OPTS="-D PERL -D GZIP"
10) start apache. The site is up and running.
11) add /etc/apache/conf/gentoo/admin/www.gentoo.org/scripts/nightly.sh to gweb's crontab to keep the site continually up-to-date.

If the machine will handle other virtual hosts, see the config files in /etc/apache/conf/gentoo/admin/www.gentoo.org/conf/vhost.conf for instructions.

Here is how to update the site. Log in as gweb, then:

$ cd /home/httpd/gentoo/xml/htdocs
$ cvs -q update -dP
$ cd /etc/apache/conf/gentoo/admin/www.gentoo.org/scripts/
$ (run scripts as necessary to regenerate portions of the site/sync images to ibiblio)

Best Regards,

Daniel Robbins & Rajiv Manglani
